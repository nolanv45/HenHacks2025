{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from \"../../../Graphic.js\";\nimport { _ as t } from \"../../../chunks/languageUtils.js\";\nimport { SqlExpressionAdapted as i, OriginalField as s, AdaptedFeatureSet as n } from \"./Adapted.js\";\nimport r from \"./AttributeFilter.js\";\nimport a from \"./OrderBy.js\";\nimport { FeatureSetError as o, FeatureSetErrorCodes as l } from \"../support/errorsupport.js\";\nimport d from \"../support/FeatureSet.js\";\nimport u from \"../support/IdSet.js\";\nimport f from \"../support/OrderbyClause.js\";\nimport { IdState as c, layerGeometryEsriConstants as p, FeatureServiceDatabaseType as h } from \"../support/shared.js\";\nimport { isSingleField as g, toWhereClause as _, predictType as m, scanForField as y, reformulateWithoutField as b } from \"../support/sqlUtils.js\";\nimport w from \"../support/StatsField.js\";\nimport { createMD5Hash as F, outputTypes as I } from \"../../../core/MD5.js\";\nimport { aggregateFunction as S } from \"../../../core/sql/AggregateFunctions.js\";\nimport { DateOnly as x } from \"../../../core/sql/DateOnly.js\";\nimport { SqlTimeStampOffset as D } from \"../../../core/sql/SqlTimestampOffset.js\";\nimport { TimeOnly as j } from \"../../../core/sql/TimeOnly.js\";\nimport k from \"../../../core/sql/WhereClause.js\";\nimport C from \"../../../geometry/SpatialReference.js\";\nimport A from \"../../../layers/support/Field.js\";\nimport T from \"../../../layers/support/FieldsIndex.js\";\nfunction G(e) {\n  if (!e) return \"COUNT\";\n  switch (e.toLowerCase()) {\n    case \"max\":\n      return \"MAX\";\n    case \"var\":\n    case \"variance\":\n      return \"VAR\";\n    case \"avg\":\n    case \"average\":\n    case \"mean\":\n      return \"AVG\";\n    case \"min\":\n      return \"MIN\";\n    case \"sum\":\n      return \"SUM\";\n    case \"stdev\":\n    case \"stddev\":\n      return \"STDDEV\";\n    case \"count\":\n      return \"COUNT\";\n  }\n  return \"COUNT\";\n}\nclass O extends d {\n  constructor(e) {\n    super(e), this._decodedStatsfield = [], this._decodedGroupbyfield = [], this._candosimplegroupby = !0, this.phsyicalgroupbyfields = [], this.objectIdField = \"ROW__ID\", this._internalObjectIdField = \"ROW__ID\", this._adaptedFields = [], this.declaredClass = \"esri.arcade.featureset.actions.Aggregate\", this._uniqueIds = 1, this._maxQuery = 10, this._maxProcessing = 10, this._parent = e.parentfeatureset, this._config = e;\n  }\n  isTable() {\n    return !0;\n  }\n  async _getSet(e) {\n    if (null === this._wset) {\n      const t = await this._getFilteredSet(\"\", null, null, null, e);\n      return this._wset = t, this._wset;\n    }\n    return this._wset;\n  }\n  _isInFeatureSet() {\n    return c.InFeatureSet;\n  }\n  _nextUniqueName(e) {\n    for (; 1 === e[\"T\" + this._uniqueIds.toString()];) this._uniqueIds++;\n    const t = \"T\" + this._uniqueIds.toString();\n    return e[t] = 1, t;\n  }\n  _convertToEsriFieldType(e) {\n    return e;\n  }\n  _initialiseFeatureSet() {\n    const e = {};\n    let t = !1,\n      n = 1;\n    const r = this._parent ? this._parent.getFieldsIndex() : new T([]);\n    for (this.objectIdField = \"ROW__ID\", this.globalIdField = \"\"; !1 === t;) {\n      let e = !1;\n      for (let t = 0; t < this._config.groupbyfields.length; t++) if (this._config.groupbyfields[t].name.toLowerCase() === this.objectIdField.toLowerCase()) {\n        e = !0;\n        break;\n      }\n      if (!1 === e) for (let t = 0; t < this._config.statsfields.length; t++) if (this._config.statsfields[t].name.toLowerCase() === this.objectIdField.toLowerCase()) {\n        e = !0;\n        break;\n      }\n      !1 === e ? t = !0 : (this.objectIdField = \"ROW__ID\" + n.toString(), n++);\n    }\n    for (const i of this._config.statsfields) {\n      const e = new w();\n      e.field = i.name, e.tofieldname = i.name, e.workingexpr = i.expression instanceof k ? i.expression : k.create(i.expression, {\n        fieldsIndex: r,\n        timeZone: this.dateFieldsTimeZoneDefaultUTC\n      }), e.typeofstat = G(i.statistic), this._decodedStatsfield.push(e);\n    }\n    this._decodedGroupbyfield = [];\n    for (const i of this._config.groupbyfields) {\n      const e = {\n        name: i.name,\n        singlefield: null,\n        tofieldname: i.name,\n        expression: i.expression instanceof k ? i.expression : k.create(i.expression, {\n          fieldsIndex: r,\n          timeZone: this.dateFieldsTimeZoneDefaultUTC\n        }),\n        sqlType: null\n      };\n      this._decodedGroupbyfield.push(e);\n    }\n    if (null !== this._parent) {\n      this.geometryType = this._parent.geometryType, this.spatialReference = this._parent.spatialReference, this.hasM = this._parent.hasM, this.hasZ = this._parent.hasZ, this.typeIdField = \"\";\n      for (const t of this._parent.fields) e[t.name.toUpperCase()] = 1;\n      this.types = null, this.subtypes = null, this.subtypeField = \"\";\n    } else this.geometryType = p.point, this.typeIdField = \"\", this.types = null, this.subtypes = null, this.subtypeField = \"\", this.spatialReference = new C({\n      wkid: 4326\n    });\n    this.fields = [];\n    const a = new w();\n    a.field = this._nextUniqueName(e), a.tofieldname = this.objectIdField, a.workingexpr = k.create(this._parent.objectIdField, {\n      fieldsIndex: this._parent.getFieldsIndex(),\n      timeZone: this.dateFieldsTimeZoneDefaultUTC\n    }), a.typeofstat = \"MIN\", this._decodedStatsfield.push(a);\n    for (const s of this._decodedGroupbyfield) {\n      const t = new A();\n      if (s.name = this._nextUniqueName(e), t.name = s.tofieldname, t.alias = t.name, g(s.expression)) {\n        const e = this._parent.getField(_(s.expression, h.Standardised));\n        if (!e) throw new o(l.AggregationFieldNotFound);\n        s.name = e.name, s.singlefield = e.name, this.phsyicalgroupbyfields.push(e.name), t.type = e.type, s.sqlType = e.type;\n      } else {\n        t.type = this._convertToEsriFieldType(m(s.expression, this._parent.fields));\n        const e = new A();\n        e.name = s.name, e.alias = e.name, this.phsyicalgroupbyfields.push(s.name), this._adaptedFields.push(new i(e, s.expression)), this._candosimplegroupby = !1, s.sqlType = t.type;\n      }\n      this.fields.push(t);\n    }\n    if (this._adaptedFields.length > 0) for (const i of this._parent.fields) this._adaptedFields.push(new s(i));\n    for (let i = 0; i < this._decodedStatsfield.length; i++) {\n      const t = new A();\n      let s = null;\n      const n = this._decodedStatsfield[i];\n      n.field = this._nextUniqueName(e), n.tofieldname === this.objectIdField && (this._internalObjectIdField = n.field), t.name = n.tofieldname, t.alias = t.name;\n      const r = null !== n.workingexpr && g(n.workingexpr) ? _(n.workingexpr, h.Standardised) : \"\";\n      switch (this._decodedStatsfield[i].typeofstat) {\n        case \"SUM\":\n          if (\"\" !== r) {\n            if (s = this._parent.getField(r), !s) throw new o(l.AggregationFieldNotFound);\n            t.type = s.type;\n          } else t.type = \"double\";\n          break;\n        case \"MIN\":\n        case \"MAX\":\n          if (\"\" !== r) {\n            if (s = this._parent.getField(r), !s) throw new o(l.AggregationFieldNotFound);\n            t.type = s.type;\n          } else t.type = \"double\";\n          break;\n        case \"COUNT\":\n          t.type = \"integer\";\n          break;\n        case \"STDDEV\":\n        case \"VAR\":\n        case \"AVG\":\n          if (\"\" !== r && (s = this._parent.getField(r), !s)) throw new o(l.AggregationFieldNotFound);\n          t.type = \"double\";\n      }\n      this.fields.push(t);\n    }\n  }\n  async _canDoAggregates() {\n    return !1;\n  }\n  async _getFeatures(e, t, i, s) {\n    -1 !== t && this._featureCache[t];\n    const n = this._maxQuery;\n    return !0 === this._checkIfNeedToExpandKnownPage(e, n) ? (await this._expandPagedSet(e, n, 0, 0, s), this._getFeatures(e, t, i, s)) : \"success\";\n  }\n  async _getFilteredSet(e, t, i, s, o) {\n    if (\"\" !== e) return new u([], [], !0, null);\n    let l = null;\n    const d = {\n      ordered: !1,\n      nowhereclause: !1\n    };\n    if (await this._ensureLoaded(), null !== i) for (let n = 0; n < this._decodedStatsfield.length; n++) if (!0 === y(i, this._decodedStatsfield[n].tofieldname)) {\n      d.nowhereclause = !0, i = null;\n      break;\n    }\n    if (null !== s) {\n      d.ordered = !0;\n      for (let e = 0; e < this._decodedStatsfield.length; e++) if (!0 === s.scanForField(this._decodedStatsfield[e].tofieldname)) {\n        s = null, d.ordered = !1;\n        break;\n      }\n      if (null !== s) for (const e of this._decodedGroupbyfield) if (null === e.singlefield && !0 === s.scanForField(e.tofieldname)) {\n        s = null, d.ordered = !1;\n        break;\n      }\n    }\n    if (!1 !== this._candosimplegroupby && (await this._parent._canDoAggregates(this.phsyicalgroupbyfields, this._decodedStatsfield, \"\", null, null))) {\n      let e = null;\n      i && (e = this._reformulateWhereClauseWithoutGroupByFields(i));\n      let t = null;\n      s && (t = this._reformulateOrderClauseWithoutGroupByFields(s));\n      const n = await this._parent._getAggregatePagesDataSourceDefinition(this.phsyicalgroupbyfields, this._decodedStatsfield, \"\", null, e, t, this._internalObjectIdField);\n      return this._checkCancelled(o), l = !0 === d.nowhereclause ? new u(n._candidates.slice().concat(n._known.slice()), [], !0 === d.ordered && n._ordered, this._clonePageDefinition(n.pagesDefinition)) : new u(n._candidates.slice(), n._known.slice(), !0 === d.ordered && n._ordered, this._clonePageDefinition(n.pagesDefinition)), l;\n    }\n    let c = this._parent;\n    if (this._adaptedFields.length > 0 && (c = new n({\n      parentfeatureset: this._parent,\n      adaptedFields: this._adaptedFields,\n      extraFilter: null\n    })), !0 === d.nowhereclause) l = new u([\"GETPAGES\"], [], !1, {\n      aggregatefeaturesetpagedefinition: !0,\n      resultOffset: 0,\n      resultRecordCount: this._maxQuery,\n      internal: {\n        fullyResolved: !1,\n        workingItem: null,\n        type: \"manual\",\n        iterator: null,\n        set: [],\n        subfeatureset: new a({\n          parentfeatureset: c,\n          orderbyclause: new f(this.phsyicalgroupbyfields.join(\",\") + \",\" + this._parent.objectIdField + \" ASC\")\n        })\n      }\n    });else {\n      let e = c;\n      if (null !== i) {\n        let t = null;\n        i && (t = this._reformulateWhereClauseWithoutGroupByFields(i)), e = new r({\n          parentfeatureset: e,\n          whereclause: t\n        });\n      }\n      l = new u([\"GETPAGES\"], [], !1, {\n        aggregatefeaturesetpagedefinition: !0,\n        resultOffset: 0,\n        resultRecordCount: this._maxQuery,\n        internal: {\n          fullyResolved: !1,\n          workingItem: null,\n          type: \"manual\",\n          iterator: null,\n          set: [],\n          subfeatureset: new a({\n            parentfeatureset: e,\n            orderbyclause: new f(this.phsyicalgroupbyfields.join(\",\") + \",\" + this._parent.objectIdField + \" ASC\")\n          })\n        }\n      });\n    }\n    return l;\n  }\n  _reformulateWhereClauseWithoutStatsFields(e) {\n    for (const t of this._decodedStatsfield) e = b(e, t.tofieldname, _(t.workingexpr, h.Standardised), this._parent.getFieldsIndex());\n    return e;\n  }\n  _reformulateWhereClauseWithoutGroupByFields(e) {\n    for (const t of this._decodedGroupbyfield) t.tofieldname !== t.name && (e = b(e, t.tofieldname, _(t.expression, h.Standardised), this._parent.getFieldsIndex()));\n    return e;\n  }\n  _reformulateOrderClauseWithoutGroupByFields(e) {\n    const t = [];\n    for (const i of this._decodedGroupbyfield) i.tofieldname !== i.name && t.push({\n      field: i.tofieldname,\n      newfield: i.name\n    });\n    return t.length > 0 ? e.replaceFields(t) : e;\n  }\n  _clonePageDefinition(e) {\n    return null === e ? null : !0 === e.aggregatefeaturesetpagedefinition ? {\n      aggregatefeaturesetpagedefinition: !0,\n      resultRecordCount: e.resultRecordCount,\n      resultOffset: e.resultOffset,\n      internal: e.internal\n    } : this._parent._clonePageDefinition(e);\n  }\n  async _refineSetBlock(e, t, i) {\n    if (!0 === this._checkIfNeedToExpandCandidatePage(e, this._maxQuery)) return await this._expandPagedSet(e, this._maxQuery, 0, 0, i), this._refineSetBlock(e, t, i);\n    this._checkCancelled(i);\n    const s = e._candidates.length;\n    this._refineKnowns(e, t);\n    e._candidates.length;\n    return e._candidates.length, e;\n  }\n  _expandPagedSet(e, t, i, s, n) {\n    return this._expandPagedSetFeatureSet(e, t, i, s, n);\n  }\n  async _getPhysicalPage(t, i, s) {\n    if (!0 === t.pagesDefinition.aggregatefeaturesetpagedefinition) return this._sequentialGetPhysicalItem(t, t.pagesDefinition.resultRecordCount, s, []);\n    const n = await this._getAgregagtePhysicalPage(t, i, s);\n    for (const r of n) {\n      const t = {\n          geometry: r.geometry,\n          attributes: {}\n        },\n        i = {};\n      for (const e in r.attributes) i[e.toLowerCase()] = r.attributes[e];\n      for (const e of this._decodedGroupbyfield) t.attributes[e.tofieldname] = i[e.name.toLowerCase()];\n      for (const e of this._decodedStatsfield) t.attributes[e.tofieldname] = i[e.field.toLowerCase()];\n      this._featureCache[t.attributes[this.objectIdField]] = new e(t);\n    }\n    return n.length;\n  }\n  _sequentialGetPhysicalItem(e, t, i, s) {\n    return new Promise((n, r) => {\n      null === e.pagesDefinition.internal.iterator && (e.pagesDefinition.internal.iterator = e.pagesDefinition.internal.subfeatureset.iterator(i)), !0 === e.pagesDefinition.internal.fullyResolved || 0 === t ? n(s.length) : this._nextAggregateItem(e, t, i, s, r => {\n        null === r ? n(s.length) : (t -= 1, n(this._sequentialGetPhysicalItem(e, t, i, s)));\n      }, r);\n    });\n  }\n  _nextAggregateItem(e, i, s, n, r, a) {\n    try {\n      t(e.pagesDefinition.internal.iterator.next()).then(t => {\n        if (null === t) {\n          if (null !== e.pagesDefinition.internal.workingItem) {\n            const t = this._calculateAndAppendAggregateItem(e.pagesDefinition.internal.workingItem);\n            n.push(t), e.pagesDefinition.internal.workingItem = null, e.pagesDefinition.internal.set.push(t.attributes[this.objectIdField]), e.pagesDefinition.internal.fullyResolved = !0, r(null);\n          } else e.pagesDefinition.internal.fullyResolved = !0, r(null);\n        } else {\n          const o = this._generateAggregateHash(t);\n          if (null === e.pagesDefinition.internal.workingItem) e.pagesDefinition.internal.workingItem = {\n            features: [t],\n            id: o\n          };else {\n            if (o !== e.pagesDefinition.internal.workingItem.id) {\n              const s = this._calculateAndAppendAggregateItem(e.pagesDefinition.internal.workingItem);\n              return n.push(s), e.pagesDefinition.internal.workingItem = null, e.pagesDefinition.internal.set.push(s.attributes[this.objectIdField]), i -= 1, e.pagesDefinition.internal.workingItem = {\n                features: [t],\n                id: o\n              }, void r(s);\n            }\n            e.pagesDefinition.internal.workingItem.features.push(t);\n          }\n          this._nextAggregateItem(e, i, s, n, r, a);\n        }\n      }, a);\n    } catch (o) {\n      a(o);\n    }\n  }\n  _calculateFieldStat(e, t, i) {\n    const s = [];\n    for (const n of e.features) if (null !== t.workingexpr) {\n      const e = t.workingexpr.calculateValue(n);\n      null !== e && (e instanceof x || e instanceof j ? s.push(e.toNumber()) : e instanceof D ? s.push(e.toMilliseconds()) : s.push(e));\n    } else s.push(null);\n    i.attributes[t.tofieldname] = S(t.typeofstat, [s]);\n  }\n  _calculateAndAppendAggregateItem(t) {\n    const i = {\n      attributes: {},\n      geometry: null\n    };\n    for (const e of this._decodedGroupbyfield) {\n      const s = e.singlefield ? t.features[0].attributes[e.singlefield] : k.convertValueToStorageFormat(e.expression.calculateValue(t.features[0]), e.sqlType);\n      i.attributes[e.tofieldname] = s;\n    }\n    for (const e of this._decodedStatsfield) this._calculateFieldStat(t, e, i);\n    const s = [];\n    for (let e = 0; e < this._decodedStatsfield.length; e++) s.push(this._calculateFieldStat(t, this._decodedStatsfield[e], i));\n    return this._featureCache[i.attributes[this.objectIdField]] = new e({\n      attributes: i.attributes,\n      geometry: i.geometry\n    }), i;\n  }\n  _generateAggregateHash(e) {\n    let t = \"\";\n    for (const i of this._decodedGroupbyfield) {\n      const s = i.singlefield ? e.attributes[i.singlefield] : i.expression.calculateValue(e);\n      t += null == s ? \":\" : \":\" + s.toString();\n    }\n    return F(t, I.String);\n  }\n  async _stat() {\n    return {\n      calculated: !1\n    };\n  }\n  async getFeatureByObjectId() {\n    return null;\n  }\n  static registerAction() {\n    d._featuresetFunctions.groupby = function (e, t) {\n      return new O({\n        parentfeatureset: this,\n        groupbyfields: e,\n        statsfields: t\n      });\n    };\n  }\n}\nexport { O as default };","map":{"version":3,"names":["e","_","t","SqlExpressionAdapted","i","OriginalField","s","AdaptedFeatureSet","n","r","a","FeatureSetError","o","FeatureSetErrorCodes","l","d","u","f","IdState","c","layerGeometryEsriConstants","p","FeatureServiceDatabaseType","h","isSingleField","g","toWhereClause","predictType","m","scanForField","y","reformulateWithoutField","b","w","createMD5Hash","F","outputTypes","I","aggregateFunction","S","DateOnly","x","SqlTimeStampOffset","D","TimeOnly","j","k","C","A","T","G","toLowerCase","O","constructor","_decodedStatsfield","_decodedGroupbyfield","_candosimplegroupby","phsyicalgroupbyfields","objectIdField","_internalObjectIdField","_adaptedFields","declaredClass","_uniqueIds","_maxQuery","_maxProcessing","_parent","parentfeatureset","_config","isTable","_getSet","_wset","_getFilteredSet","_isInFeatureSet","InFeatureSet","_nextUniqueName","toString","_convertToEsriFieldType","_initialiseFeatureSet","getFieldsIndex","globalIdField","groupbyfields","length","name","statsfields","field","tofieldname","workingexpr","expression","create","fieldsIndex","timeZone","dateFieldsTimeZoneDefaultUTC","typeofstat","statistic","push","singlefield","sqlType","geometryType","spatialReference","hasM","hasZ","typeIdField","fields","toUpperCase","types","subtypes","subtypeField","point","wkid","alias","getField","Standardised","AggregationFieldNotFound","type","_canDoAggregates","_getFeatures","_featureCache","_checkIfNeedToExpandKnownPage","_expandPagedSet","ordered","nowhereclause","_ensureLoaded","_reformulateWhereClauseWithoutGroupByFields","_reformulateOrderClauseWithoutGroupByFields","_getAggregatePagesDataSourceDefinition","_checkCancelled","_candidates","slice","concat","_known","_ordered","_clonePageDefinition","pagesDefinition","adaptedFields","extraFilter","aggregatefeaturesetpagedefinition","resultOffset","resultRecordCount","internal","fullyResolved","workingItem","iterator","set","subfeatureset","orderbyclause","join","whereclause","_reformulateWhereClauseWithoutStatsFields","newfield","replaceFields","_refineSetBlock","_checkIfNeedToExpandCandidatePage","_refineKnowns","_expandPagedSetFeatureSet","_getPhysicalPage","_sequentialGetPhysicalItem","_getAgregagtePhysicalPage","geometry","attributes","Promise","_nextAggregateItem","next","then","_calculateAndAppendAggregateItem","_generateAggregateHash","features","id","_calculateFieldStat","calculateValue","toNumber","toMilliseconds","convertValueToStorageFormat","String","_stat","calculated","getFeatureByObjectId","registerAction","_featuresetFunctions","groupby","default"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/arcade/featureset/actions/GroupBy.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from\"../../../Graphic.js\";import{_ as t}from\"../../../chunks/languageUtils.js\";import{SqlExpressionAdapted as i,OriginalField as s,AdaptedFeatureSet as n}from\"./Adapted.js\";import r from\"./AttributeFilter.js\";import a from\"./OrderBy.js\";import{FeatureSetError as o,FeatureSetErrorCodes as l}from\"../support/errorsupport.js\";import d from\"../support/FeatureSet.js\";import u from\"../support/IdSet.js\";import f from\"../support/OrderbyClause.js\";import{IdState as c,layerGeometryEsriConstants as p,FeatureServiceDatabaseType as h}from\"../support/shared.js\";import{isSingleField as g,toWhereClause as _,predictType as m,scanForField as y,reformulateWithoutField as b}from\"../support/sqlUtils.js\";import w from\"../support/StatsField.js\";import{createMD5Hash as F,outputTypes as I}from\"../../../core/MD5.js\";import{aggregateFunction as S}from\"../../../core/sql/AggregateFunctions.js\";import{DateOnly as x}from\"../../../core/sql/DateOnly.js\";import{SqlTimeStampOffset as D}from\"../../../core/sql/SqlTimestampOffset.js\";import{TimeOnly as j}from\"../../../core/sql/TimeOnly.js\";import k from\"../../../core/sql/WhereClause.js\";import C from\"../../../geometry/SpatialReference.js\";import A from\"../../../layers/support/Field.js\";import T from\"../../../layers/support/FieldsIndex.js\";function G(e){if(!e)return\"COUNT\";switch(e.toLowerCase()){case\"max\":return\"MAX\";case\"var\":case\"variance\":return\"VAR\";case\"avg\":case\"average\":case\"mean\":return\"AVG\";case\"min\":return\"MIN\";case\"sum\":return\"SUM\";case\"stdev\":case\"stddev\":return\"STDDEV\";case\"count\":return\"COUNT\"}return\"COUNT\"}class O extends d{constructor(e){super(e),this._decodedStatsfield=[],this._decodedGroupbyfield=[],this._candosimplegroupby=!0,this.phsyicalgroupbyfields=[],this.objectIdField=\"ROW__ID\",this._internalObjectIdField=\"ROW__ID\",this._adaptedFields=[],this.declaredClass=\"esri.arcade.featureset.actions.Aggregate\",this._uniqueIds=1,this._maxQuery=10,this._maxProcessing=10,this._parent=e.parentfeatureset,this._config=e}isTable(){return!0}async _getSet(e){if(null===this._wset){const t=await this._getFilteredSet(\"\",null,null,null,e);return this._wset=t,this._wset}return this._wset}_isInFeatureSet(){return c.InFeatureSet}_nextUniqueName(e){for(;1===e[\"T\"+this._uniqueIds.toString()];)this._uniqueIds++;const t=\"T\"+this._uniqueIds.toString();return e[t]=1,t}_convertToEsriFieldType(e){return e}_initialiseFeatureSet(){const e={};let t=!1,n=1;const r=this._parent?this._parent.getFieldsIndex():new T([]);for(this.objectIdField=\"ROW__ID\",this.globalIdField=\"\";!1===t;){let e=!1;for(let t=0;t<this._config.groupbyfields.length;t++)if(this._config.groupbyfields[t].name.toLowerCase()===this.objectIdField.toLowerCase()){e=!0;break}if(!1===e)for(let t=0;t<this._config.statsfields.length;t++)if(this._config.statsfields[t].name.toLowerCase()===this.objectIdField.toLowerCase()){e=!0;break}!1===e?t=!0:(this.objectIdField=\"ROW__ID\"+n.toString(),n++)}for(const i of this._config.statsfields){const e=new w;e.field=i.name,e.tofieldname=i.name,e.workingexpr=i.expression instanceof k?i.expression:k.create(i.expression,{fieldsIndex:r,timeZone:this.dateFieldsTimeZoneDefaultUTC}),e.typeofstat=G(i.statistic),this._decodedStatsfield.push(e)}this._decodedGroupbyfield=[];for(const i of this._config.groupbyfields){const e={name:i.name,singlefield:null,tofieldname:i.name,expression:i.expression instanceof k?i.expression:k.create(i.expression,{fieldsIndex:r,timeZone:this.dateFieldsTimeZoneDefaultUTC}),sqlType:null};this._decodedGroupbyfield.push(e)}if(null!==this._parent){this.geometryType=this._parent.geometryType,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=\"\";for(const t of this._parent.fields)e[t.name.toUpperCase()]=1;this.types=null,this.subtypes=null,this.subtypeField=\"\"}else this.geometryType=p.point,this.typeIdField=\"\",this.types=null,this.subtypes=null,this.subtypeField=\"\",this.spatialReference=new C({wkid:4326});this.fields=[];const a=new w;a.field=this._nextUniqueName(e),a.tofieldname=this.objectIdField,a.workingexpr=k.create(this._parent.objectIdField,{fieldsIndex:this._parent.getFieldsIndex(),timeZone:this.dateFieldsTimeZoneDefaultUTC}),a.typeofstat=\"MIN\",this._decodedStatsfield.push(a);for(const s of this._decodedGroupbyfield){const t=new A;if(s.name=this._nextUniqueName(e),t.name=s.tofieldname,t.alias=t.name,g(s.expression)){const e=this._parent.getField(_(s.expression,h.Standardised));if(!e)throw new o(l.AggregationFieldNotFound);s.name=e.name,s.singlefield=e.name,this.phsyicalgroupbyfields.push(e.name),t.type=e.type,s.sqlType=e.type}else{t.type=this._convertToEsriFieldType(m(s.expression,this._parent.fields));const e=new A;e.name=s.name,e.alias=e.name,this.phsyicalgroupbyfields.push(s.name),this._adaptedFields.push(new i(e,s.expression)),this._candosimplegroupby=!1,s.sqlType=t.type}this.fields.push(t)}if(this._adaptedFields.length>0)for(const i of this._parent.fields)this._adaptedFields.push(new s(i));for(let i=0;i<this._decodedStatsfield.length;i++){const t=new A;let s=null;const n=this._decodedStatsfield[i];n.field=this._nextUniqueName(e),n.tofieldname===this.objectIdField&&(this._internalObjectIdField=n.field),t.name=n.tofieldname,t.alias=t.name;const r=null!==n.workingexpr&&g(n.workingexpr)?_(n.workingexpr,h.Standardised):\"\";switch(this._decodedStatsfield[i].typeofstat){case\"SUM\":if(\"\"!==r){if(s=this._parent.getField(r),!s)throw new o(l.AggregationFieldNotFound);t.type=s.type}else t.type=\"double\";break;case\"MIN\":case\"MAX\":if(\"\"!==r){if(s=this._parent.getField(r),!s)throw new o(l.AggregationFieldNotFound);t.type=s.type}else t.type=\"double\";break;case\"COUNT\":t.type=\"integer\";break;case\"STDDEV\":case\"VAR\":case\"AVG\":if(\"\"!==r&&(s=this._parent.getField(r),!s))throw new o(l.AggregationFieldNotFound);t.type=\"double\"}this.fields.push(t)}}async _canDoAggregates(){return!1}async _getFeatures(e,t,i,s){-1!==t&&this._featureCache[t];const n=this._maxQuery;return!0===this._checkIfNeedToExpandKnownPage(e,n)?(await this._expandPagedSet(e,n,0,0,s),this._getFeatures(e,t,i,s)):\"success\"}async _getFilteredSet(e,t,i,s,o){if(\"\"!==e)return new u([],[],!0,null);let l=null;const d={ordered:!1,nowhereclause:!1};if(await this._ensureLoaded(),null!==i)for(let n=0;n<this._decodedStatsfield.length;n++)if(!0===y(i,this._decodedStatsfield[n].tofieldname)){d.nowhereclause=!0,i=null;break}if(null!==s){d.ordered=!0;for(let e=0;e<this._decodedStatsfield.length;e++)if(!0===s.scanForField(this._decodedStatsfield[e].tofieldname)){s=null,d.ordered=!1;break}if(null!==s)for(const e of this._decodedGroupbyfield)if(null===e.singlefield&&!0===s.scanForField(e.tofieldname)){s=null,d.ordered=!1;break}}if(!1!==this._candosimplegroupby&&await this._parent._canDoAggregates(this.phsyicalgroupbyfields,this._decodedStatsfield,\"\",null,null)){let e=null;i&&(e=this._reformulateWhereClauseWithoutGroupByFields(i));let t=null;s&&(t=this._reformulateOrderClauseWithoutGroupByFields(s));const n=await this._parent._getAggregatePagesDataSourceDefinition(this.phsyicalgroupbyfields,this._decodedStatsfield,\"\",null,e,t,this._internalObjectIdField);return this._checkCancelled(o),l=!0===d.nowhereclause?new u(n._candidates.slice().concat(n._known.slice()),[],!0===d.ordered&&n._ordered,this._clonePageDefinition(n.pagesDefinition)):new u(n._candidates.slice(),n._known.slice(),!0===d.ordered&&n._ordered,this._clonePageDefinition(n.pagesDefinition)),l}let c=this._parent;if(this._adaptedFields.length>0&&(c=new n({parentfeatureset:this._parent,adaptedFields:this._adaptedFields,extraFilter:null})),!0===d.nowhereclause)l=new u([\"GETPAGES\"],[],!1,{aggregatefeaturesetpagedefinition:!0,resultOffset:0,resultRecordCount:this._maxQuery,internal:{fullyResolved:!1,workingItem:null,type:\"manual\",iterator:null,set:[],subfeatureset:new a({parentfeatureset:c,orderbyclause:new f(this.phsyicalgroupbyfields.join(\",\")+\",\"+this._parent.objectIdField+\" ASC\")})}});else{let e=c;if(null!==i){let t=null;i&&(t=this._reformulateWhereClauseWithoutGroupByFields(i)),e=new r({parentfeatureset:e,whereclause:t})}l=new u([\"GETPAGES\"],[],!1,{aggregatefeaturesetpagedefinition:!0,resultOffset:0,resultRecordCount:this._maxQuery,internal:{fullyResolved:!1,workingItem:null,type:\"manual\",iterator:null,set:[],subfeatureset:new a({parentfeatureset:e,orderbyclause:new f(this.phsyicalgroupbyfields.join(\",\")+\",\"+this._parent.objectIdField+\" ASC\")})}})}return l}_reformulateWhereClauseWithoutStatsFields(e){for(const t of this._decodedStatsfield)e=b(e,t.tofieldname,_(t.workingexpr,h.Standardised),this._parent.getFieldsIndex());return e}_reformulateWhereClauseWithoutGroupByFields(e){for(const t of this._decodedGroupbyfield)t.tofieldname!==t.name&&(e=b(e,t.tofieldname,_(t.expression,h.Standardised),this._parent.getFieldsIndex()));return e}_reformulateOrderClauseWithoutGroupByFields(e){const t=[];for(const i of this._decodedGroupbyfield)i.tofieldname!==i.name&&t.push({field:i.tofieldname,newfield:i.name});return t.length>0?e.replaceFields(t):e}_clonePageDefinition(e){return null===e?null:!0===e.aggregatefeaturesetpagedefinition?{aggregatefeaturesetpagedefinition:!0,resultRecordCount:e.resultRecordCount,resultOffset:e.resultOffset,internal:e.internal}:this._parent._clonePageDefinition(e)}async _refineSetBlock(e,t,i){if(!0===this._checkIfNeedToExpandCandidatePage(e,this._maxQuery))return await this._expandPagedSet(e,this._maxQuery,0,0,i),this._refineSetBlock(e,t,i);this._checkCancelled(i);const s=e._candidates.length;this._refineKnowns(e,t);e._candidates.length;return e._candidates.length,e}_expandPagedSet(e,t,i,s,n){return this._expandPagedSetFeatureSet(e,t,i,s,n)}async _getPhysicalPage(t,i,s){if(!0===t.pagesDefinition.aggregatefeaturesetpagedefinition)return this._sequentialGetPhysicalItem(t,t.pagesDefinition.resultRecordCount,s,[]);const n=await this._getAgregagtePhysicalPage(t,i,s);for(const r of n){const t={geometry:r.geometry,attributes:{}},i={};for(const e in r.attributes)i[e.toLowerCase()]=r.attributes[e];for(const e of this._decodedGroupbyfield)t.attributes[e.tofieldname]=i[e.name.toLowerCase()];for(const e of this._decodedStatsfield)t.attributes[e.tofieldname]=i[e.field.toLowerCase()];this._featureCache[t.attributes[this.objectIdField]]=new e(t)}return n.length}_sequentialGetPhysicalItem(e,t,i,s){return new Promise(((n,r)=>{null===e.pagesDefinition.internal.iterator&&(e.pagesDefinition.internal.iterator=e.pagesDefinition.internal.subfeatureset.iterator(i)),!0===e.pagesDefinition.internal.fullyResolved||0===t?n(s.length):this._nextAggregateItem(e,t,i,s,(r=>{null===r?n(s.length):(t-=1,n(this._sequentialGetPhysicalItem(e,t,i,s)))}),r)}))}_nextAggregateItem(e,i,s,n,r,a){try{t(e.pagesDefinition.internal.iterator.next()).then((t=>{if(null===t)if(null!==e.pagesDefinition.internal.workingItem){const t=this._calculateAndAppendAggregateItem(e.pagesDefinition.internal.workingItem);n.push(t),e.pagesDefinition.internal.workingItem=null,e.pagesDefinition.internal.set.push(t.attributes[this.objectIdField]),e.pagesDefinition.internal.fullyResolved=!0,r(null)}else e.pagesDefinition.internal.fullyResolved=!0,r(null);else{const o=this._generateAggregateHash(t);if(null===e.pagesDefinition.internal.workingItem)e.pagesDefinition.internal.workingItem={features:[t],id:o};else{if(o!==e.pagesDefinition.internal.workingItem.id){const s=this._calculateAndAppendAggregateItem(e.pagesDefinition.internal.workingItem);return n.push(s),e.pagesDefinition.internal.workingItem=null,e.pagesDefinition.internal.set.push(s.attributes[this.objectIdField]),i-=1,e.pagesDefinition.internal.workingItem={features:[t],id:o},void r(s)}e.pagesDefinition.internal.workingItem.features.push(t)}this._nextAggregateItem(e,i,s,n,r,a)}}),a)}catch(o){a(o)}}_calculateFieldStat(e,t,i){const s=[];for(const n of e.features)if(null!==t.workingexpr){const e=t.workingexpr.calculateValue(n);null!==e&&(e instanceof x||e instanceof j?s.push(e.toNumber()):e instanceof D?s.push(e.toMilliseconds()):s.push(e))}else s.push(null);i.attributes[t.tofieldname]=S(t.typeofstat,[s])}_calculateAndAppendAggregateItem(t){const i={attributes:{},geometry:null};for(const e of this._decodedGroupbyfield){const s=e.singlefield?t.features[0].attributes[e.singlefield]:k.convertValueToStorageFormat(e.expression.calculateValue(t.features[0]),e.sqlType);i.attributes[e.tofieldname]=s}for(const e of this._decodedStatsfield)this._calculateFieldStat(t,e,i);const s=[];for(let e=0;e<this._decodedStatsfield.length;e++)s.push(this._calculateFieldStat(t,this._decodedStatsfield[e],i));return this._featureCache[i.attributes[this.objectIdField]]=new e({attributes:i.attributes,geometry:i.geometry}),i}_generateAggregateHash(e){let t=\"\";for(const i of this._decodedGroupbyfield){const s=i.singlefield?e.attributes[i.singlefield]:i.expression.calculateValue(e);t+=null==s?\":\":\":\"+s.toString()}return F(t,I.String)}async _stat(){return{calculated:!1}}async getFeatureByObjectId(){return null}static registerAction(){d._featuresetFunctions.groupby=function(e,t){return new O({parentfeatureset:this,groupbyfields:e,statsfields:t})}}}export{O as default};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}