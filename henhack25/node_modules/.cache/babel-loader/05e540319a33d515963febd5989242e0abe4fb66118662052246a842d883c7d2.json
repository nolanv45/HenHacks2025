{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport has from \"../../../../../core/has.js\";\nimport { AttributeDataType as t, hittestToleranceMobile as e, hittestToleranceDesktop as s, hittestToleranceSmallSymbol as i, hittestSmallSymbolThreshold as o } from \"../definitions.js\";\nimport { Effect as r } from \"./Effect.js\";\nimport { PixelFormat as n, PixelType as l } from \"../../../../webgl/enums.js\";\nclass c extends r {\n  constructor() {\n    super(...arguments), this.name = this.constructor.name, this.defines = [\"hittest\"];\n  }\n  dispose() {\n    null != this._fbo && this._fbo.dispose();\n  }\n  createOptions({\n    pixelRatio: t\n  }, r) {\n    if (!r.length) return null;\n    const n = r.shift(),\n      l = n.x,\n      c = n.y;\n    this._outstanding = n;\n    const a = has(\"esri-mobile\");\n    return {\n      type: \"hittest\",\n      distance: (a ? e : s) * t,\n      smallSymbolDistance: (a ? e : i) * t,\n      smallSymbolSizeThreshold: o,\n      position: [l, c]\n    };\n  }\n  bind(e) {\n    const {\n      context: s,\n      attributeView: i\n    } = e;\n    if (!i.size) return;\n    const o = i.getBlock(t.GPGPU);\n    if (null == o) return;\n    const r = o.getFBO(s);\n    s.setViewport(0, 0, i.size, i.size), s.bindFramebuffer(r), s.setColorMask(!0, !0, !0, !0), s.setClearColor(0, 0, 0, 0), s.clear(s.gl.COLOR_BUFFER_BIT | s.gl.DEPTH_BUFFER_BIT);\n  }\n  unbind() {}\n  draw(t) {\n    if (null == this._outstanding) return;\n    const e = this._outstanding;\n    this._outstanding = null, this._resolve(t, e.resolvers);\n  }\n  async _resolve(e, s) {\n    const {\n        context: i,\n        attributeView: o\n      } = e,\n      r = o.getBlock(t.GPGPU);\n    if (null == r) return void s.forEach(t => t.resolve([]));\n    const c = r.getFBO(i),\n      a = new Uint8Array(c.width * c.height * 4);\n    try {\n      await c.readPixelsAsync(0, 0, c.width, c.height, n.RGBA, l.UNSIGNED_BYTE, a);\n    } catch (u) {\n      return void s.forEach(t => t.resolve([]));\n    }\n    const h = [];\n    for (let t = 0; t < a.length; t += 4) {\n      const e = t / 4;\n      a[t] && h.push(e);\n    }\n    s.forEach(t => t.resolve(h));\n  }\n}\nexport { c as HittestEffect };","map":{"version":3,"names":["has","AttributeDataType","t","hittestToleranceMobile","e","hittestToleranceDesktop","s","hittestToleranceSmallSymbol","i","hittestSmallSymbolThreshold","o","Effect","r","PixelFormat","n","PixelType","l","c","constructor","arguments","name","defines","dispose","_fbo","createOptions","pixelRatio","length","shift","x","y","_outstanding","a","type","distance","smallSymbolDistance","smallSymbolSizeThreshold","position","bind","context","attributeView","size","getBlock","GPGPU","getFBO","setViewport","bindFramebuffer","setColorMask","setClearColor","clear","gl","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","unbind","draw","_resolve","resolvers","forEach","resolve","Uint8Array","width","height","readPixelsAsync","RGBA","UNSIGNED_BYTE","u","h","push","HittestEffect"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/2d/engine/webgl/effects/HittestEffect.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport has from\"../../../../../core/has.js\";import{AttributeDataType as t,hittestToleranceMobile as e,hittestToleranceDesktop as s,hittestToleranceSmallSymbol as i,hittestSmallSymbolThreshold as o}from\"../definitions.js\";import{Effect as r}from\"./Effect.js\";import{PixelFormat as n,PixelType as l}from\"../../../../webgl/enums.js\";class c extends r{constructor(){super(...arguments),this.name=this.constructor.name,this.defines=[\"hittest\"]}dispose(){null!=this._fbo&&this._fbo.dispose()}createOptions({pixelRatio:t},r){if(!r.length)return null;const n=r.shift(),l=n.x,c=n.y;this._outstanding=n;const a=has(\"esri-mobile\");return{type:\"hittest\",distance:(a?e:s)*t,smallSymbolDistance:(a?e:i)*t,smallSymbolSizeThreshold:o,position:[l,c]}}bind(e){const{context:s,attributeView:i}=e;if(!i.size)return;const o=i.getBlock(t.GPGPU);if(null==o)return;const r=o.getFBO(s);s.setViewport(0,0,i.size,i.size),s.bindFramebuffer(r),s.setColorMask(!0,!0,!0,!0),s.setClearColor(0,0,0,0),s.clear(s.gl.COLOR_BUFFER_BIT|s.gl.DEPTH_BUFFER_BIT)}unbind(){}draw(t){if(null==this._outstanding)return;const e=this._outstanding;this._outstanding=null,this._resolve(t,e.resolvers)}async _resolve(e,s){const{context:i,attributeView:o}=e,r=o.getBlock(t.GPGPU);if(null==r)return void s.forEach((t=>t.resolve([])));const c=r.getFBO(i),a=new Uint8Array(c.width*c.height*4);try{await c.readPixelsAsync(0,0,c.width,c.height,n.RGBA,l.UNSIGNED_BYTE,a)}catch(u){return void s.forEach((t=>t.resolve([])))}const h=[];for(let t=0;t<a.length;t+=4){const e=t/4;a[t]&&h.push(e)}s.forEach((t=>t.resolve(h)))}}export{c as HittestEffect};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}