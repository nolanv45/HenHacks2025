{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport { watch as t } from \"../../../../core/reactiveUtils.js\";\nimport { property as i } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/has.js\";\nimport \"../../../../core/Logger.js\";\nimport \"../../../../core/RandomLCG.js\";\nimport { subclass as r } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { sampleVectorField as o } from \"../../../../layers/support/rasterFunctions/vectorFieldUtils.js\";\nimport { RasterVFTileContainer as s } from \"../../engine/imagery/RasterVFTileContainer.js\";\nimport { BaseImageryTileSubView2D as l } from \"./BaseImageryTileSubView2D.js\";\nlet a = class extends l {\n  constructor() {\n    super(...arguments), this._handle = null, this.type = \"rasterVF\";\n  }\n  canUseWebGLForProcessing() {\n    return !1;\n  }\n  async fetchTile(e, t) {\n    t = {\n      ...t,\n      interpolation: \"nearest\",\n      requestProjectedLocalDirections: !0\n    };\n    const i = await this.layer.fetchTile(e.level, e.row, e.col, t);\n    return \"vector-magdir\" === this.layer.serviceRasterInfo?.dataType && i?.pixelBlock && (i.pixelBlock = await this.layer.convertVectorFieldData(i.pixelBlock, t)), i;\n  }\n  updateTileSource(e, t) {\n    const i = t.symbolizerParams,\n      {\n        tileData: r\n      } = e;\n    r.key = e.key, r.width = this._tileInfoView.tileInfo.size[0], r.height = this._tileInfoView.tileInfo.size[1];\n    const {\n        symbolTileSize: o\n      } = i,\n      {\n        source: s\n      } = t;\n    if (r.offset = this._getTileSymbolOffset(r.key, o), null != s?.pixelBlock) {\n      const e = {\n        extent: s.extent,\n        pixelBlock: s.pixelBlock\n      };\n      r.rawPixelData = e, r.symbolizerParameters = i, r.source = this._sampleVectorFieldData(s.pixelBlock, i, r.offset);\n    } else {\n      const e = [Math.round((this._tileInfoView.tileInfo.size[0] - r.offset[0]) / o), Math.round((this._tileInfoView.tileInfo.size[1] - r.offset[1]) / o)],\n        t = this.createEmptyTilePixelBlock(e);\n      r.source = t, r.symbolizerParameters = i;\n    }\n    return r.invalidateVAO(), Promise.resolve();\n  }\n  updateTileSymbolizerParameters(e, t) {\n    const i = t.local,\n      {\n        symbolTileSize: r\n      } = i,\n      {\n        tileData: o\n      } = e;\n    o.offset = this._getTileSymbolOffset(o.key, r);\n    const s = o.symbolizerParameters.symbolTileSize;\n    o.symbolizerParameters = i;\n    const l = o.rawPixelData?.pixelBlock;\n    return null != l && s !== r && (o.source = this._sampleVectorFieldData(l, o.symbolizerParameters, o.offset)), Promise.resolve();\n  }\n  attach() {\n    super.attach(), this.container = new s(this._tileInfoView), this.container.isCustomTilingScheme = this._isCustomTilingScheme, this._updateSymbolType(this.layer.renderer), this._handle = t(() => this.layer.renderer, e => this._updateSymbolType(e));\n  }\n  detach() {\n    super.detach(), this.container.removeAllChildren(), this._handle?.remove(), this._handle = null, this.container = null;\n  }\n  _getTileSymbolOffset(e, t) {\n    const i = e.col * this._tileInfoView.tileInfo.size[0] % t,\n      r = e.row * this._tileInfoView.tileInfo.size[1] % t;\n    return [i > t / 2 ? t - i : -i, r > t / 2 ? t - r : -r];\n  }\n  _sampleVectorFieldData(e, t, i) {\n    const {\n      symbolTileSize: r\n    } = t;\n    return o(e, \"vector-uv\", r, i);\n  }\n  _updateSymbolType(e) {\n    \"vector-field\" === e?.type && (this.container.symbolTypes = \"wind-barb\" === e.style ? [\"scalar\", \"triangle\"] : \"simple-scalar\" === e.style ? [\"scalar\"] : [\"triangle\"]);\n  }\n};\ne([i()], a.prototype, \"container\", void 0), e([i()], a.prototype, \"layer\", void 0), e([i()], a.prototype, \"type\", void 0), a = e([r(\"esri.views.2d.layers.imagery.VectorFieldTileView2D\")], a);\nconst n = a;\nexport { n as default };","map":{"version":3,"names":["_","e","watch","t","property","i","subclass","r","sampleVectorField","o","RasterVFTileContainer","s","BaseImageryTileSubView2D","l","a","constructor","arguments","_handle","type","canUseWebGLForProcessing","fetchTile","interpolation","requestProjectedLocalDirections","layer","level","row","col","serviceRasterInfo","dataType","pixelBlock","convertVectorFieldData","updateTileSource","symbolizerParams","tileData","key","width","_tileInfoView","tileInfo","size","height","symbolTileSize","source","offset","_getTileSymbolOffset","extent","rawPixelData","symbolizerParameters","_sampleVectorFieldData","Math","round","createEmptyTilePixelBlock","invalidateVAO","Promise","resolve","updateTileSymbolizerParameters","local","attach","container","isCustomTilingScheme","_isCustomTilingScheme","_updateSymbolType","renderer","detach","removeAllChildren","remove","symbolTypes","style","prototype","n","default"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/2d/layers/imagery/VectorFieldTileView2D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{watch as t}from\"../../../../core/reactiveUtils.js\";import{property as i}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/Logger.js\";import\"../../../../core/RandomLCG.js\";import{subclass as r}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{sampleVectorField as o}from\"../../../../layers/support/rasterFunctions/vectorFieldUtils.js\";import{RasterVFTileContainer as s}from\"../../engine/imagery/RasterVFTileContainer.js\";import{BaseImageryTileSubView2D as l}from\"./BaseImageryTileSubView2D.js\";let a=class extends l{constructor(){super(...arguments),this._handle=null,this.type=\"rasterVF\"}canUseWebGLForProcessing(){return!1}async fetchTile(e,t){t={...t,interpolation:\"nearest\",requestProjectedLocalDirections:!0};const i=await this.layer.fetchTile(e.level,e.row,e.col,t);return\"vector-magdir\"===this.layer.serviceRasterInfo?.dataType&&i?.pixelBlock&&(i.pixelBlock=await this.layer.convertVectorFieldData(i.pixelBlock,t)),i}updateTileSource(e,t){const i=t.symbolizerParams,{tileData:r}=e;r.key=e.key,r.width=this._tileInfoView.tileInfo.size[0],r.height=this._tileInfoView.tileInfo.size[1];const{symbolTileSize:o}=i,{source:s}=t;if(r.offset=this._getTileSymbolOffset(r.key,o),null!=s?.pixelBlock){const e={extent:s.extent,pixelBlock:s.pixelBlock};r.rawPixelData=e,r.symbolizerParameters=i,r.source=this._sampleVectorFieldData(s.pixelBlock,i,r.offset)}else{const e=[Math.round((this._tileInfoView.tileInfo.size[0]-r.offset[0])/o),Math.round((this._tileInfoView.tileInfo.size[1]-r.offset[1])/o)],t=this.createEmptyTilePixelBlock(e);r.source=t,r.symbolizerParameters=i}return r.invalidateVAO(),Promise.resolve()}updateTileSymbolizerParameters(e,t){const i=t.local,{symbolTileSize:r}=i,{tileData:o}=e;o.offset=this._getTileSymbolOffset(o.key,r);const s=o.symbolizerParameters.symbolTileSize;o.symbolizerParameters=i;const l=o.rawPixelData?.pixelBlock;return null!=l&&s!==r&&(o.source=this._sampleVectorFieldData(l,o.symbolizerParameters,o.offset)),Promise.resolve()}attach(){super.attach(),this.container=new s(this._tileInfoView),this.container.isCustomTilingScheme=this._isCustomTilingScheme,this._updateSymbolType(this.layer.renderer),this._handle=t((()=>this.layer.renderer),(e=>this._updateSymbolType(e)))}detach(){super.detach(),this.container.removeAllChildren(),this._handle?.remove(),this._handle=null,this.container=null}_getTileSymbolOffset(e,t){const i=e.col*this._tileInfoView.tileInfo.size[0]%t,r=e.row*this._tileInfoView.tileInfo.size[1]%t;return[i>t/2?t-i:-i,r>t/2?t-r:-r]}_sampleVectorFieldData(e,t,i){const{symbolTileSize:r}=t;return o(e,\"vector-uv\",r,i)}_updateSymbolType(e){\"vector-field\"===e?.type&&(this.container.symbolTypes=\"wind-barb\"===e.style?[\"scalar\",\"triangle\"]:\"simple-scalar\"===e.style?[\"scalar\"]:[\"triangle\"])}};e([i()],a.prototype,\"container\",void 0),e([i()],a.prototype,\"layer\",void 0),e([i()],a.prototype,\"type\",void 0),a=e([r(\"esri.views.2d.layers.imagery.VectorFieldTileView2D\")],a);const n=a;export{n as default};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}