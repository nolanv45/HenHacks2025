{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { isSome as t } from \"../../../core/arrayUtils.js\";\nimport { isArrayBuffer as r } from \"../../../core/typedArrayUtil.js\";\nimport { conjugate as e } from \"../../../core/libs/gl-matrix-2/math/quat.js\";\nimport { create as o } from \"../../../core/libs/gl-matrix-2/factories/quatf64.js\";\nimport { w as a } from \"../../../chunks/vec32.js\";\nimport { clone as i, create as f } from \"../../../core/libs/gl-matrix-2/factories/vec3f32.js\";\nimport n from \"../../../geometry/SpatialReference.js\";\nimport { projectBuffer as s } from \"../../../geometry/projection/projectBuffer.js\";\nimport { readGeometry as u, getAttributeValues as l, evaluateRenderer as m, filterInPlace as b } from \"./i3s/PointCloudWorkerUtil.js\";\nimport { Obb as p } from \"../support/orientedBoundingBox.js\";\nclass c {\n  transform(t) {\n    const e = this._transform(t),\n      o = [e.points.buffer, e.rgb.buffer];\n    null != e.pointIdFilterMap && o.push(e.pointIdFilterMap.buffer);\n    for (const a of e.attributes) \"buffer\" in a.values && r(a.values.buffer) && a.values.buffer !== e.rgb.buffer && o.push(a.values.buffer);\n    return Promise.resolve({\n      result: e,\n      transferList: o\n    });\n  }\n  _transform(r) {\n    const e = u(r.schema, r.geometryBuffer);\n    let o = e.length / 3,\n      a = null;\n    const i = new Array(),\n      f = l(r.primaryAttributeData, e, o);\n    null != r.primaryAttributeData && f && i.push({\n      attributeInfo: r.primaryAttributeData.attributeInfo,\n      values: f\n    });\n    const s = l(r.modulationAttributeData, e, o);\n    null != r.modulationAttributeData && s && i.push({\n      attributeInfo: r.modulationAttributeData.attributeInfo,\n      values: s\n    });\n    let c = m(r.rendererInfo, f, s, o);\n    if (r.filterInfo && r.filterInfo.length > 0 && null != r.filterAttributesData) {\n      const f = r.filterAttributesData.filter(t).map(t => {\n        const r = l(t, e, o),\n          a = {\n            attributeInfo: t.attributeInfo,\n            values: r\n          };\n        return i.push(a), a;\n      });\n      a = new Uint32Array(o), o = b(e, c, a, r.filterInfo, f);\n    }\n    for (const t of r.userAttributesData) {\n      const r = l(t, e, o);\n      i.push({\n        attributeInfo: t.attributeInfo,\n        values: r\n      });\n    }\n    3 * o < c.length && (c = new Uint8Array(c.buffer.slice(0, 3 * o))), I(e, o, r.elevationOffset);\n    const A = h(e, o, p.fromData(r.obbData), n.fromJSON(r.inSR), n.fromJSON(r.outSR));\n    return {\n      obbData: r.obbData,\n      points: A,\n      rgb: c,\n      attributes: i,\n      pointIdFilterMap: a\n    };\n  }\n}\nfunction h(t, r, o, n, u) {\n  if (!s(t, n, 0, t, u, 0, r)) throw new Error(\"Can't reproject\");\n  const l = i(o.center),\n    m = f(),\n    b = f(),\n    p = i(o.halfSize);\n  e(A, o.quaternion);\n  const c = new Float32Array(3 * r);\n  for (let e = 0; e < r; e++) {\n    let r = 3 * e;\n    m[0] = t[r] - l[0], m[1] = t[r + 1] - l[1], m[2] = t[r + 2] - l[2], a(b, m, A), p[0] = Math.max(p[0], Math.abs(b[0])), p[1] = Math.max(p[1], Math.abs(b[1])), p[2] = Math.max(p[2], Math.abs(b[2])), c[r++] = m[0], c[r++] = m[1], c[r] = m[2];\n  }\n  return o.halfSize = p, c;\n}\nfunction I(t, r, e) {\n  if (0 !== e) for (let o = 0; o < r; o++) t[3 * o + 2] += e;\n}\nconst A = o();\nfunction g() {\n  return new c();\n}\nexport { g as default };","map":{"version":3,"names":["isSome","t","isArrayBuffer","r","conjugate","e","create","o","w","a","clone","i","f","n","projectBuffer","s","readGeometry","u","getAttributeValues","l","evaluateRenderer","m","filterInPlace","b","Obb","p","c","transform","_transform","points","buffer","rgb","pointIdFilterMap","push","attributes","values","Promise","resolve","result","transferList","schema","geometryBuffer","length","Array","primaryAttributeData","attributeInfo","modulationAttributeData","rendererInfo","filterInfo","filterAttributesData","filter","map","Uint32Array","userAttributesData","Uint8Array","slice","I","elevationOffset","A","h","fromData","obbData","fromJSON","inSR","outSR","Error","center","halfSize","quaternion","Float32Array","Math","max","abs","g","default"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/3d/layers/PointCloudWorker.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{isSome as t}from\"../../../core/arrayUtils.js\";import{isArrayBuffer as r}from\"../../../core/typedArrayUtil.js\";import{conjugate as e}from\"../../../core/libs/gl-matrix-2/math/quat.js\";import{create as o}from\"../../../core/libs/gl-matrix-2/factories/quatf64.js\";import{w as a}from\"../../../chunks/vec32.js\";import{clone as i,create as f}from\"../../../core/libs/gl-matrix-2/factories/vec3f32.js\";import n from\"../../../geometry/SpatialReference.js\";import{projectBuffer as s}from\"../../../geometry/projection/projectBuffer.js\";import{readGeometry as u,getAttributeValues as l,evaluateRenderer as m,filterInPlace as b}from\"./i3s/PointCloudWorkerUtil.js\";import{Obb as p}from\"../support/orientedBoundingBox.js\";class c{transform(t){const e=this._transform(t),o=[e.points.buffer,e.rgb.buffer];null!=e.pointIdFilterMap&&o.push(e.pointIdFilterMap.buffer);for(const a of e.attributes)\"buffer\"in a.values&&r(a.values.buffer)&&a.values.buffer!==e.rgb.buffer&&o.push(a.values.buffer);return Promise.resolve({result:e,transferList:o})}_transform(r){const e=u(r.schema,r.geometryBuffer);let o=e.length/3,a=null;const i=new Array,f=l(r.primaryAttributeData,e,o);null!=r.primaryAttributeData&&f&&i.push({attributeInfo:r.primaryAttributeData.attributeInfo,values:f});const s=l(r.modulationAttributeData,e,o);null!=r.modulationAttributeData&&s&&i.push({attributeInfo:r.modulationAttributeData.attributeInfo,values:s});let c=m(r.rendererInfo,f,s,o);if(r.filterInfo&&r.filterInfo.length>0&&null!=r.filterAttributesData){const f=r.filterAttributesData.filter(t).map((t=>{const r=l(t,e,o),a={attributeInfo:t.attributeInfo,values:r};return i.push(a),a}));a=new Uint32Array(o),o=b(e,c,a,r.filterInfo,f)}for(const t of r.userAttributesData){const r=l(t,e,o);i.push({attributeInfo:t.attributeInfo,values:r})}3*o<c.length&&(c=new Uint8Array(c.buffer.slice(0,3*o))),I(e,o,r.elevationOffset);const A=h(e,o,p.fromData(r.obbData),n.fromJSON(r.inSR),n.fromJSON(r.outSR));return{obbData:r.obbData,points:A,rgb:c,attributes:i,pointIdFilterMap:a}}}function h(t,r,o,n,u){if(!s(t,n,0,t,u,0,r))throw new Error(\"Can't reproject\");const l=i(o.center),m=f(),b=f(),p=i(o.halfSize);e(A,o.quaternion);const c=new Float32Array(3*r);for(let e=0;e<r;e++){let r=3*e;m[0]=t[r]-l[0],m[1]=t[r+1]-l[1],m[2]=t[r+2]-l[2],a(b,m,A),p[0]=Math.max(p[0],Math.abs(b[0])),p[1]=Math.max(p[1],Math.abs(b[1])),p[2]=Math.max(p[2],Math.abs(b[2])),c[r++]=m[0],c[r++]=m[1],c[r]=m[2]}return o.halfSize=p,c}function I(t,r,e){if(0!==e)for(let o=0;o<r;o++)t[3*o+2]+=e}const A=o();function g(){return new c}export{g as default};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}