{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from \"../../../../request.js\";\nimport { throwIfAborted as o } from \"../../../../core/promiseUtils.js\";\nimport { join as t } from \"../../../../core/urlUtils.js\";\nimport { isHostedAgolService as r } from \"../../../support/arcgisLayerUrl.js\";\nimport { makeProgressManager as s, estimatedTransferTime as a } from \"../../../../support/progressUtils.js\";\nconst n = 1e6,\n  i = 20 * n,\n  p = 2e9,\n  l = 3;\nasync function m({\n  data: m,\n  name: f,\n  description: d\n}, u, h) {\n  let w = null;\n  try {\n    const y = t(u, \"uploads\"),\n      j = t(y, \"info\"),\n      {\n        data: g\n      } = await e(j, {\n        query: {\n          f: \"json\"\n        },\n        responseType: \"json\"\n      });\n    o(h);\n    const q = r(u),\n      z = g.maxUploadFileSize * n,\n      T = q ? p : z,\n      U = q ? Math.min(i, z) : i;\n    if (m.size > T) throw new Error(\"Data too large\");\n    const A = t(y, \"register\"),\n      {\n        data: E\n      } = await e(A, {\n        query: {\n          f: \"json\",\n          itemName: c(f),\n          description: d\n        },\n        responseType: \"json\",\n        method: \"post\"\n      });\n    if (o(h), !E.success) throw new Error(\"Registration failed\");\n    const {\n      itemID: P\n    } = E.item;\n    w = t(y, P);\n    const D = t(w, \"uploadPart\"),\n      I = Math.ceil(m.size / U),\n      M = new Array();\n    for (let e = 0; e < I; ++e) M.push(m.slice(e * U, Math.min((e + 1) * U, m.size)));\n    const v = M.slice().reverse(),\n      x = new Array(),\n      F = s(I, h?.onProgress, \"uploadItem\"),\n      _ = async () => {\n        for (; 0 !== v.length;) {\n          const t = M.length - v.length,\n            r = v.pop(),\n            s = new FormData(),\n            n = F.simulate(t, a(r.size));\n          try {\n            s.append(\"f\", \"json\"), s.append(\"file\", r), s.append(\"partId\", `${t}`);\n            const {\n              data: a\n            } = await e(D, {\n              timeout: 0,\n              body: s,\n              responseType: \"json\",\n              method: \"post\"\n            });\n            if (o(h), !a.success) throw new Error(\"Part upload failed\");\n          } finally {\n            n.remove();\n          }\n        }\n      };\n    for (let e = 0; e < l && 0 !== v.length; ++e) x.push(_());\n    await Promise.all(x);\n    const b = t(w, \"commit\"),\n      {\n        data: C\n      } = await e(b, {\n        query: {\n          f: \"json\",\n          parts: M.map((e, o) => o).join(\",\")\n        },\n        responseType: \"json\",\n        method: \"post\"\n      });\n    if (o(h), !C.success) throw new Error(\"Commit failed\");\n    return C.item;\n  } catch (y) {\n    if (null != w) {\n      const o = t(w, \"delete\");\n      await e(o, {\n        query: {\n          f: \"json\"\n        },\n        responseType: \"json\",\n        method: \"post\"\n      });\n    }\n    throw y;\n  }\n}\nfunction c(e) {\n  return e.replaceAll(\"/\", \"_\").replaceAll(\"\\\\\", \"_\");\n}\nexport { m as uploadItem };","map":{"version":3,"names":["e","throwIfAborted","o","join","t","isHostedAgolService","r","makeProgressManager","s","estimatedTransferTime","a","n","i","p","l","m","data","name","f","description","d","u","h","w","y","j","g","query","responseType","q","z","maxUploadFileSize","T","U","Math","min","size","Error","A","E","itemName","c","method","success","itemID","P","item","D","I","ceil","M","Array","push","slice","v","reverse","x","F","onProgress","_","length","pop","FormData","simulate","append","timeout","body","remove","Promise","all","b","C","parts","map","replaceAll","uploadItem"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/layers/graphics/sources/support/uploads.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from\"../../../../request.js\";import{throwIfAborted as o}from\"../../../../core/promiseUtils.js\";import{join as t}from\"../../../../core/urlUtils.js\";import{isHostedAgolService as r}from\"../../../support/arcgisLayerUrl.js\";import{makeProgressManager as s,estimatedTransferTime as a}from\"../../../../support/progressUtils.js\";const n=1e6,i=20*n,p=2e9,l=3;async function m({data:m,name:f,description:d},u,h){let w=null;try{const y=t(u,\"uploads\"),j=t(y,\"info\"),{data:g}=await e(j,{query:{f:\"json\"},responseType:\"json\"});o(h);const q=r(u),z=g.maxUploadFileSize*n,T=q?p:z,U=q?Math.min(i,z):i;if(m.size>T)throw new Error(\"Data too large\");const A=t(y,\"register\"),{data:E}=await e(A,{query:{f:\"json\",itemName:c(f),description:d},responseType:\"json\",method:\"post\"});if(o(h),!E.success)throw new Error(\"Registration failed\");const{itemID:P}=E.item;w=t(y,P);const D=t(w,\"uploadPart\"),I=Math.ceil(m.size/U),M=new Array;for(let e=0;e<I;++e)M.push(m.slice(e*U,Math.min((e+1)*U,m.size)));const v=M.slice().reverse(),x=new Array,F=s(I,h?.onProgress,\"uploadItem\"),_=async()=>{for(;0!==v.length;){const t=M.length-v.length,r=v.pop(),s=new FormData,n=F.simulate(t,a(r.size));try{s.append(\"f\",\"json\"),s.append(\"file\",r),s.append(\"partId\",`${t}`);const{data:a}=await e(D,{timeout:0,body:s,responseType:\"json\",method:\"post\"});if(o(h),!a.success)throw new Error(\"Part upload failed\")}finally{n.remove()}}};for(let e=0;e<l&&0!==v.length;++e)x.push(_());await Promise.all(x);const b=t(w,\"commit\"),{data:C}=await e(b,{query:{f:\"json\",parts:M.map(((e,o)=>o)).join(\",\")},responseType:\"json\",method:\"post\"});if(o(h),!C.success)throw new Error(\"Commit failed\");return C.item}catch(y){if(null!=w){const o=t(w,\"delete\");await e(o,{query:{f:\"json\"},responseType:\"json\",method:\"post\"})}throw y}}function c(e){return e.replaceAll(\"/\",\"_\").replaceAll(\"\\\\\",\"_\")}export{m as uploadItem};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}