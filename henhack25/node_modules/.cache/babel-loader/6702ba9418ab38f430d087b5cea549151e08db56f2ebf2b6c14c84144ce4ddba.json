{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../../chunks/tslib.es6.js\";\nimport t from \"../../../../../core/Accessor.js\";\nimport { watch as s } from \"../../../../../core/reactiveUtils.js\";\nimport { property as n } from \"../../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../../core/has.js\";\nimport \"../../../../../core/Logger.js\";\nimport \"../../../../../core/RandomLCG.js\";\nimport { subclass as r } from \"../../../../../core/accessorSupport/decorators/subclass.js\";\nconst a = 2500;\nlet o = class extends t {\n  constructor(e) {\n    super(), this._connection = e, this._enabledEventTypes = new Set(), this._updateInfo = {\n      websocket: 0,\n      client: 0\n    }, this._lastTime = performance.now(), this._queuedCommands = [], this.addHandles([s(() => this._strategy?.connectionStatus ?? \"disconnected\", e => {\n      this._layerView.setProperty({\n        propertyName: \"pipelineConnectionStatus\",\n        value: e\n      });\n    }, {\n      initial: !0\n    }), s(() => this._strategy?.errorString || null, e => this._layerView.setProperty({\n      propertyName: \"pipelineErrorString\",\n      value: e\n    }), {\n      initial: !0\n    })]);\n  }\n  destroy() {\n    this._strategy = null, this.removeAllHandles();\n  }\n  get _layerView() {\n    return this._connection.layerView;\n  }\n  set strategy(e) {\n    null == this._strategy && this._resetUpdateInfo(performance.now());\n    const t = \"event-handles\";\n    this.removeHandles(t), null != e && (this.addHandles([e.events.on(\"data-received\", e => this._onFeature(e)), e.events.on(\"message-received\", e => this._onWebSocketMessage(e)), e.events.on(\"features-updated\", e => this._onUpdate(e)), e.events.on(\"tick\", () => this._onTick())], t), this._queuedCommands.forEach(t => t(e)), this._queuedCommands = []), this._strategy = e;\n  }\n  updateCustomParameters(e) {\n    null != e && this._callOrEnqueue(t => t.updateCustomParameters(e));\n  }\n  sendMessageToSocket(e) {\n    this._callOrEnqueue(t => t.sendMessageToSocket(e));\n  }\n  sendMessageToClient(e) {\n    this._callOrEnqueue(t => t.sendMessageToClient(e));\n  }\n  enableEvent(e, t) {\n    t ? this._enabledEventTypes.add(e) : this._enabledEventTypes.delete(e);\n  }\n  disconnect() {\n    this._strategy?.disconnect();\n  }\n  connect() {\n    this._strategy?.connect();\n  }\n  clear() {\n    this._strategy?.clear();\n  }\n  _onWebSocketMessage(e) {\n    this._enabledEventTypes.has(\"message-received\") && this._layerView.emitEvent({\n      name: \"message-received\",\n      event: e\n    });\n  }\n  _onFeature(e) {\n    this._updateInfo.websocket++, this._enabledEventTypes.has(\"data-received\") && this._layerView.emitEvent({\n      name: \"data-received\",\n      event: {\n        attributes: e.attributes,\n        centroid: e.centroid,\n        geometry: e.geometry\n      }\n    });\n  }\n  _onUpdate(e) {\n    this._updateInfo.client += e;\n  }\n  _onTick() {\n    const e = performance.now(),\n      t = e - this._lastTime;\n    if (t > a) {\n      const s = Math.round(this._updateInfo.client / (t / 1e3)),\n        n = Math.round(this._updateInfo.websocket / (t / 1e3));\n      this._resetUpdateInfo(e), this._layerView.emitEvent({\n        name: \"update-rate\",\n        event: {\n          client: s,\n          websocket: n\n        }\n      });\n    }\n  }\n  _resetUpdateInfo(e) {\n    this._lastTime = e, this._updateInfo.client = 0, this._updateInfo.websocket = 0;\n  }\n  _callOrEnqueue(e) {\n    null != this._strategy ? e(this._strategy) : this._queuedCommands.push(e);\n  }\n};\ne([n()], o.prototype, \"_strategy\", void 0), o = e([r(\"esri.views.2d.layers.features.sources.StreamMessenger\")], o);\nexport { o as StreamMessenger };","map":{"version":3,"names":["_","e","t","watch","s","property","n","subclass","r","a","o","constructor","_connection","_enabledEventTypes","Set","_updateInfo","websocket","client","_lastTime","performance","now","_queuedCommands","addHandles","_strategy","connectionStatus","_layerView","setProperty","propertyName","value","initial","errorString","destroy","removeAllHandles","layerView","strategy","_resetUpdateInfo","removeHandles","events","on","_onFeature","_onWebSocketMessage","_onUpdate","_onTick","forEach","updateCustomParameters","_callOrEnqueue","sendMessageToSocket","sendMessageToClient","enableEvent","add","delete","disconnect","connect","clear","has","emitEvent","name","event","attributes","centroid","geometry","Math","round","push","prototype","StreamMessenger"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/2d/layers/features/sources/StreamMessenger.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import t from\"../../../../../core/Accessor.js\";import{watch as s}from\"../../../../../core/reactiveUtils.js\";import{property as n}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/Logger.js\";import\"../../../../../core/RandomLCG.js\";import{subclass as r}from\"../../../../../core/accessorSupport/decorators/subclass.js\";const a=2500;let o=class extends t{constructor(e){super(),this._connection=e,this._enabledEventTypes=new Set,this._updateInfo={websocket:0,client:0},this._lastTime=performance.now(),this._queuedCommands=[],this.addHandles([s((()=>this._strategy?.connectionStatus??\"disconnected\"),(e=>{this._layerView.setProperty({propertyName:\"pipelineConnectionStatus\",value:e})}),{initial:!0}),s((()=>this._strategy?.errorString||null),(e=>this._layerView.setProperty({propertyName:\"pipelineErrorString\",value:e})),{initial:!0})])}destroy(){this._strategy=null,this.removeAllHandles()}get _layerView(){return this._connection.layerView}set strategy(e){null==this._strategy&&this._resetUpdateInfo(performance.now());const t=\"event-handles\";this.removeHandles(t),null!=e&&(this.addHandles([e.events.on(\"data-received\",(e=>this._onFeature(e))),e.events.on(\"message-received\",(e=>this._onWebSocketMessage(e))),e.events.on(\"features-updated\",(e=>this._onUpdate(e))),e.events.on(\"tick\",(()=>this._onTick()))],t),this._queuedCommands.forEach((t=>t(e))),this._queuedCommands=[]),this._strategy=e}updateCustomParameters(e){null!=e&&this._callOrEnqueue((t=>t.updateCustomParameters(e)))}sendMessageToSocket(e){this._callOrEnqueue((t=>t.sendMessageToSocket(e)))}sendMessageToClient(e){this._callOrEnqueue((t=>t.sendMessageToClient(e)))}enableEvent(e,t){t?this._enabledEventTypes.add(e):this._enabledEventTypes.delete(e)}disconnect(){this._strategy?.disconnect()}connect(){this._strategy?.connect()}clear(){this._strategy?.clear()}_onWebSocketMessage(e){this._enabledEventTypes.has(\"message-received\")&&this._layerView.emitEvent({name:\"message-received\",event:e})}_onFeature(e){this._updateInfo.websocket++,this._enabledEventTypes.has(\"data-received\")&&this._layerView.emitEvent({name:\"data-received\",event:{attributes:e.attributes,centroid:e.centroid,geometry:e.geometry}})}_onUpdate(e){this._updateInfo.client+=e}_onTick(){const e=performance.now(),t=e-this._lastTime;if(t>a){const s=Math.round(this._updateInfo.client/(t/1e3)),n=Math.round(this._updateInfo.websocket/(t/1e3));this._resetUpdateInfo(e),this._layerView.emitEvent({name:\"update-rate\",event:{client:s,websocket:n}})}}_resetUpdateInfo(e){this._lastTime=e,this._updateInfo.client=0,this._updateInfo.websocket=0}_callOrEnqueue(e){null!=this._strategy?e(this._strategy):this._queuedCommands.push(e)}};e([n()],o.prototype,\"_strategy\",void 0),o=e([r(\"esri.views.2d.layers.features.sources.StreamMessenger\")],o);export{o as StreamMessenger};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}