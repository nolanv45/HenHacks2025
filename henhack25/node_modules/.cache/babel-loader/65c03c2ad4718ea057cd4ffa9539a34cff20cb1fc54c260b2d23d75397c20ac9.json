{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from \"../../../../request.js\";\nimport { createTask as t } from \"../../../../core/asyncUtils.js\";\nimport s from \"../../../../core/Error.js\";\nimport i from \"../../../../core/Logger.js\";\nimport { isAbortError as r } from \"../../../../core/promiseUtils.js\";\nimport { getJsonType as n } from \"../../../../geometry/support/jsonUtils.js\";\nimport { wgs84 as a, equals as o } from \"../../../../geometry/support/spatialReferenceUtils.js\";\nimport { convertFromGeometry as u, convertToGeometry as l, convertFromFeatures as d, convertToFeature as p, convertFromFeature as c } from \"../../featureConversionUtils.js\";\nimport { executeQueryForSnapping as y } from \"../../data/executeQueryForSnapping.js\";\nimport m from \"../../data/FeatureStore.js\";\nimport { checkProjectionSupport as h, project as f } from \"../../data/projectionSupport.js\";\nimport { QueryEngine as g } from \"../../data/QueryEngine.js\";\nimport { inferLayerProperties as _, createOptimizedFeatures as F, validateGeoJSON as I } from \"./geojson.js\";\nimport { createDrawingInfo as j, createDefaultTemplate as E, createDefaultAttributesFunction as b } from \"../support/clientSideDefaults.js\";\nimport { loadGeometryEngineForSimplify as T, mixAttributes as w, createFeatureEditSuccessResult as q, createFeatureEditErrorResult as x, simplify as S, queryBinsCapabilities as R } from \"../support/sourceUtils.js\";\nimport C from \"../../../support/FieldsIndex.js\";\nimport { kebabDict as O } from \"../../../support/fieldType.js\";\nimport { getFieldDefaultValue as k, getFieldDefaultLength as Q } from \"../../../support/fieldUtils.js\";\nimport { utc as D } from \"../../../../time/timeZoneUtils.js\";\nconst A = {\n  hasAttachments: !1,\n  capabilities: \"query, editing, create, delete, update\",\n  useStandardizedQueries: !0,\n  supportsCoordinatesQuantization: !0,\n  supportsReturningQueryGeometry: !0,\n  advancedQueryCapabilities: {\n    supportsQueryAttachments: !1,\n    supportsQueryAttachmentOrderByFields: !1,\n    supportsQueryBins: !0,\n    supportsQueryWithCacheHint: !0,\n    supportsQueryWithDistance: !0,\n    supportsQueryWithResultType: !0,\n    supportsStatistics: !0,\n    supportsPercentileStatistics: !0,\n    supportsReturningGeometryCentroid: !0,\n    supportsDistinct: !0,\n    supportsReturningQueryExtent: !0,\n    supportsReturningGeometryProperties: !1,\n    supportsHavingClause: !0,\n    supportsOrderBy: !0,\n    supportsPagination: !0,\n    supportsSqlExpression: !0,\n    supportsDisjointSpatialRel: !0\n  },\n  queryBinsCapabilities: R\n};\nclass v {\n  constructor() {\n    this._queryEngine = null, this._snapshotFeatures = async e => {\n      const t = await this._fetch(e);\n      return this._createFeatures(t);\n    };\n  }\n  destroy() {\n    this._queryEngine?.destroy(), this._queryEngine = this._createDefaultAttributes = null;\n  }\n  async load(e) {\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    this._loadOptions = {\n      url: e.url,\n      customParameters: e.customParameters\n    };\n    const i = [],\n      [r] = await Promise.all([e.url ? this._fetch(t?.signal) : null, this._checkProjection(e.spatialReference)]),\n      n = _(r, {\n        geometryType: e.geometryType\n      }),\n      o = e.fields || n.fields || [],\n      u = null != e.hasZ ? e.hasZ : n.hasZ,\n      l = n.geometryType;\n    let d = e.objectIdField || n.objectIdFieldName || \"__OBJECTID\";\n    const p = e.spatialReference || a;\n    let c = e.timeInfo;\n    o === n.fields && n.unknownFields.length > 0 && i.push({\n      name: \"geojson-layer:unknown-field-types\",\n      message: \"Some fields types couldn't be inferred from the features and were dropped\",\n      details: {\n        unknownFields: n.unknownFields\n      }\n    });\n    const y = new C(o);\n    let h = y.get(d);\n    h ? (\"esriFieldTypeString\" !== h.type && (h.type = \"esriFieldTypeOID\"), h.editable = !1, h.nullable = !1, d = h.name) : (h = {\n      alias: d,\n      name: d,\n      type: \"string\" === n.objectIdFieldType ? \"esriFieldTypeString\" : \"esriFieldTypeOID\",\n      editable: !1,\n      nullable: !1\n    }, o.unshift(h));\n    const f = {};\n    for (const a of o) {\n      if (null == a.name && (a.name = a.alias), null == a.alias && (a.alias = a.name), !a.name) throw new s(\"geojson-layer:invalid-field-name\", \"field name is missing\", {\n        field: a\n      });\n      if (!O.jsonValues.includes(a.type)) throw new s(\"geojson-layer:invalid-field-type\", `invalid type for field \"${a.name}\"`, {\n        field: a\n      });\n      if (a.name !== h.name) {\n        const e = k(a);\n        void 0 !== e && (f[a.name] = e);\n      }\n      null == a.length && (a.length = Q(a));\n    }\n    if (c) {\n      if (c.startTimeField) {\n        const e = y.get(c.startTimeField);\n        e ? (c.startTimeField = e.name, e.type = \"esriFieldTypeDate\") : c.startTimeField = null;\n      }\n      if (c.endTimeField) {\n        const e = y.get(c.endTimeField);\n        e ? (c.endTimeField = e.name, e.type = \"esriFieldTypeDate\") : c.endTimeField = null;\n      }\n      if (c.trackIdField) {\n        const e = y.get(c.trackIdField);\n        e ? c.trackIdField = e.name : (c.trackIdField = null, i.push({\n          name: \"geojson-layer:invalid-timeInfo-trackIdField\",\n          message: \"trackIdField is missing\",\n          details: {\n            timeInfo: c\n          }\n        }));\n      }\n      c.startTimeField || c.endTimeField || (i.push({\n        name: \"geojson-layer:invalid-timeInfo\",\n        message: \"startTimeField and endTimeField are missing\",\n        details: {\n          timeInfo: c\n        }\n      }), c = null);\n    }\n    const F = l ? j(l) : void 0,\n      I = y.dateFields.length ? {\n        timeZoneIANA: D\n      } : null,\n      T = {\n        warnings: i,\n        featureErrors: [],\n        layerDefinition: {\n          ...A,\n          drawingInfo: F ?? void 0,\n          templates: E(f),\n          extent: void 0,\n          geometryType: l,\n          objectIdField: d,\n          fields: o,\n          hasZ: !!u,\n          timeInfo: c,\n          dateFieldsTimeReference: I\n        }\n      };\n    this._queryEngine = new g({\n      fieldsIndex: C.fromLayerJSON({\n        fields: o,\n        timeInfo: c,\n        dateFieldsTimeReference: I\n      }),\n      geometryType: l,\n      hasM: !1,\n      hasZ: u,\n      objectIdField: d,\n      spatialReference: p,\n      timeInfo: c,\n      featureStore: new m({\n        geometryType: l,\n        hasM: !1,\n        hasZ: u\n      })\n    });\n    const w = this._queryEngine.fieldsIndex.requiredFields.indexOf(h);\n    w > -1 && this._queryEngine.fieldsIndex.requiredFields.splice(w, 1), this._createDefaultAttributes = b(f, d);\n    const q = await this._createFeatures(r);\n    this._objectIdGenerator = this._createObjectIdGenerator(this._queryEngine, q);\n    const x = this._normalizeFeatures(q, T.featureErrors);\n    this._queryEngine.featureStore.addMany(x);\n    const {\n      fullExtent: S,\n      timeExtent: R\n    } = await this._queryEngine.fetchRecomputedExtents();\n    if (T.layerDefinition.extent = S, R) {\n      const {\n        start: e,\n        end: t\n      } = R;\n      T.layerDefinition.timeInfo.timeExtent = [e, t];\n    }\n    return T;\n  }\n  async applyEdits(e) {\n    const {\n      spatialReference: t,\n      geometryType: s\n    } = this._queryEngine;\n    return await Promise.all([T(t, s), h(e.adds, t), h(e.updates, t)]), await this._waitSnapshotComplete(), this._applyEdits(e);\n  }\n  async queryFeatures() {\n    let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return await this._waitSnapshotComplete(), this._queryEngine.executeQuery(e, t.signal);\n  }\n  async queryFeatureCount() {\n    let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return await this._waitSnapshotComplete(), this._queryEngine.executeQueryForCount(e, t.signal);\n  }\n  async queryObjectIds() {\n    let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return await this._waitSnapshotComplete(), this._queryEngine.executeQueryForIds(e, t.signal);\n  }\n  async queryExtent() {\n    let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return await this._waitSnapshotComplete(), this._queryEngine.executeQueryForExtent(e, t.signal);\n  }\n  async querySnapping(e) {\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return await this._waitSnapshotComplete(), y(this._queryEngine, e, t.signal);\n  }\n  async queryAttributeBins(e) {\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return await this._waitSnapshotComplete(), this._queryEngine.executeAttributeBinsQuery(e, t.signal);\n  }\n  async refresh(e) {\n    this._loadOptions.customParameters = e, this._snapshotTask?.abort(), this._snapshotTask = t(this._snapshotFeatures), this._snapshotTask.promise.then(e => {\n      this._queryEngine.featureStore.clear(), this._objectIdGenerator = this._createObjectIdGenerator(this._queryEngine, e);\n      const t = this._normalizeFeatures(e);\n      t && this._queryEngine.featureStore.addMany(t);\n    }, e => {\n      this._queryEngine.featureStore.clear(), r(e) || i.getLogger(\"esri.layers.GeoJSONLayer\").error(new s(\"geojson-layer:refresh\", \"An error occurred during refresh\", {\n        error: e\n      }));\n    }), await this._waitSnapshotComplete();\n    const {\n      fullExtent: n,\n      timeExtent: a\n    } = await this._queryEngine.fetchRecomputedExtents();\n    return {\n      extent: n,\n      timeExtent: a\n    };\n  }\n  async _createFeatures(e) {\n    if (null == e) return [];\n    const {\n        geometryType: t,\n        hasZ: s,\n        objectIdField: i\n      } = this._queryEngine,\n      r = F(e, {\n        geometryType: t,\n        hasZ: s,\n        objectIdField: i\n      });\n    if (!o(this._queryEngine.spatialReference, a)) for (const n of r) null != n.geometry && (n.geometry = u(f(l(n.geometry, this._queryEngine.geometryType, this._queryEngine.hasZ, !1), a, this._queryEngine.spatialReference)));\n    return r;\n  }\n  async _waitSnapshotComplete() {\n    if (this._snapshotTask && !this._snapshotTask.finished) {\n      try {\n        await this._snapshotTask.promise;\n      } catch {}\n      return this._waitSnapshotComplete();\n    }\n  }\n  async _fetch(t) {\n    const {\n        url: s,\n        customParameters: i\n      } = this._loadOptions,\n      r = (await e(s ?? \"\", {\n        responseType: \"json\",\n        query: {\n          ...i\n        },\n        signal: t\n      })).data;\n    return I(r), r;\n  }\n  _normalizeFeatures(e, t) {\n    const {\n        objectIdField: s,\n        fieldsIndex: i\n      } = this._queryEngine,\n      r = [];\n    for (const n of e) {\n      const e = this._createDefaultAttributes(),\n        a = w(i, e, n.attributes, !0);\n      a ? t?.push(a) : (this._assignObjectId(e, n.attributes, !0), n.attributes = e, n.objectId = e[s], r.push(n));\n    }\n    return r;\n  }\n  async _applyEdits(e) {\n    const {\n        adds: t,\n        updates: s,\n        deletes: i\n      } = e,\n      r = {\n        addResults: [],\n        deleteResults: [],\n        updateResults: [],\n        uidToObjectId: {}\n      };\n    if (t?.length && this._applyAddEdits(r, t), s?.length && this._applyUpdateEdits(r, s), i?.length) {\n      for (const e of i) r.deleteResults.push(q(e));\n      this._queryEngine.featureStore.removeManyById(i);\n    }\n    const {\n      fullExtent: n,\n      timeExtent: a\n    } = await this._queryEngine.fetchRecomputedExtents();\n    return {\n      extent: n,\n      timeExtent: a,\n      featureEditResults: r\n    };\n  }\n  _applyAddEdits(e, t) {\n    const {\n        addResults: s\n      } = e,\n      {\n        geometryType: i,\n        hasM: r,\n        hasZ: a,\n        objectIdField: o,\n        spatialReference: u,\n        featureStore: l,\n        fieldsIndex: p\n      } = this._queryEngine,\n      c = [];\n    for (const d of t) {\n      if (d.geometry && i !== n(d.geometry)) {\n        s.push(x(\"Incorrect geometry type.\"));\n        continue;\n      }\n      const t = this._createDefaultAttributes(),\n        r = w(p, t, d.attributes);\n      if (r) s.push(r);else {\n        if (this._assignObjectId(t, d.attributes), d.attributes = t, null != d.uid) {\n          const t = d.attributes[o];\n          e.uidToObjectId[d.uid] = t;\n        }\n        if (null != d.geometry) {\n          const e = d.geometry.spatialReference ?? u;\n          d.geometry = f(S(d.geometry, e), e, u);\n        }\n        c.push(d), s.push(q(d.attributes[o]));\n      }\n    }\n    l.addMany(d([], c, i, a, r, o));\n  }\n  _applyUpdateEdits(_ref, t) {\n    let {\n      updateResults: e\n    } = _ref;\n    const {\n      geometryType: s,\n      hasM: i,\n      hasZ: r,\n      objectIdField: a,\n      spatialReference: o,\n      featureStore: u,\n      fieldsIndex: l\n    } = this._queryEngine;\n    for (const d of t) {\n      const {\n          attributes: t,\n          geometry: y\n        } = d,\n        m = t?.[a];\n      if (null == m) {\n        e.push(x(`Identifier field ${a} missing`));\n        continue;\n      }\n      if (!u.has(m)) {\n        e.push(x(`Feature with object id ${m} missing`));\n        continue;\n      }\n      const h = p(u.getFeature(m), s, r, i);\n      if (null != y) {\n        if (s !== n(y)) {\n          e.push(x(\"Incorrect geometry type.\"));\n          continue;\n        }\n        const t = y.spatialReference ?? o;\n        h.geometry = f(S(y, t), t, o);\n      }\n      if (t) {\n        const s = w(l, h.attributes, t);\n        if (s) {\n          e.push(s);\n          continue;\n        }\n      }\n      u.add(c(h, s, r, i, a)), e.push(q(m));\n    }\n  }\n  _createObjectIdGenerator(e, t) {\n    const s = e.fieldsIndex.get(e.objectIdField);\n    if (\"esriFieldTypeString\" === s.type) return () => s.name + \"-\" + Date.now().toString(16);\n    let i = Number.NEGATIVE_INFINITY;\n    for (const r of t) r.objectId && (i = Math.max(i, r.objectId));\n    return i = Math.max(0, i) + 1, () => i++;\n  }\n  _assignObjectId(e, t) {\n    let s = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;\n    const i = this._queryEngine.objectIdField;\n    e[i] = s && i in t ? t[i] : this._objectIdGenerator();\n  }\n  async _checkProjection(e) {\n    try {\n      await h(a, e);\n    } catch {\n      throw new s(\"geojson-layer\", \"Projection not supported\");\n    }\n  }\n}\nexport { v as default };","map":{"version":3,"names":["e","createTask","t","s","i","isAbortError","r","getJsonType","n","wgs84","a","equals","o","convertFromGeometry","u","convertToGeometry","l","convertFromFeatures","d","convertToFeature","p","convertFromFeature","c","executeQueryForSnapping","y","m","checkProjectionSupport","h","project","f","QueryEngine","g","inferLayerProperties","_","createOptimizedFeatures","F","validateGeoJSON","I","createDrawingInfo","j","createDefaultTemplate","E","createDefaultAttributesFunction","b","loadGeometryEngineForSimplify","T","mixAttributes","w","createFeatureEditSuccessResult","q","createFeatureEditErrorResult","x","simplify","S","queryBinsCapabilities","R","C","kebabDict","O","getFieldDefaultValue","k","getFieldDefaultLength","Q","utc","D","A","hasAttachments","capabilities","useStandardizedQueries","supportsCoordinatesQuantization","supportsReturningQueryGeometry","advancedQueryCapabilities","supportsQueryAttachments","supportsQueryAttachmentOrderByFields","supportsQueryBins","supportsQueryWithCacheHint","supportsQueryWithDistance","supportsQueryWithResultType","supportsStatistics","supportsPercentileStatistics","supportsReturningGeometryCentroid","supportsDistinct","supportsReturningQueryExtent","supportsReturningGeometryProperties","supportsHavingClause","supportsOrderBy","supportsPagination","supportsSqlExpression","supportsDisjointSpatialRel","v","constructor","_queryEngine","_snapshotFeatures","_fetch","_createFeatures","destroy","_createDefaultAttributes","load","arguments","length","undefined","_loadOptions","url","customParameters","Promise","all","signal","_checkProjection","spatialReference","geometryType","fields","hasZ","objectIdField","objectIdFieldName","timeInfo","unknownFields","push","name","message","details","get","type","editable","nullable","alias","objectIdFieldType","unshift","field","jsonValues","includes","startTimeField","endTimeField","trackIdField","dateFields","timeZoneIANA","warnings","featureErrors","layerDefinition","drawingInfo","templates","extent","dateFieldsTimeReference","fieldsIndex","fromLayerJSON","hasM","featureStore","requiredFields","indexOf","splice","_objectIdGenerator","_createObjectIdGenerator","_normalizeFeatures","addMany","fullExtent","timeExtent","fetchRecomputedExtents","start","end","applyEdits","adds","updates","_waitSnapshotComplete","_applyEdits","queryFeatures","executeQuery","queryFeatureCount","executeQueryForCount","queryObjectIds","executeQueryForIds","queryExtent","executeQueryForExtent","querySnapping","queryAttributeBins","executeAttributeBinsQuery","refresh","_snapshotTask","abort","promise","then","clear","getLogger","error","geometry","finished","responseType","query","data","attributes","_assignObjectId","objectId","deletes","addResults","deleteResults","updateResults","uidToObjectId","_applyAddEdits","_applyUpdateEdits","removeManyById","featureEditResults","uid","_ref","has","getFeature","add","Date","now","toString","Number","NEGATIVE_INFINITY","Math","max","default"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/layers/graphics/sources/geojson/GeoJSONSourceWorker.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from\"../../../../request.js\";import{createTask as t}from\"../../../../core/asyncUtils.js\";import s from\"../../../../core/Error.js\";import i from\"../../../../core/Logger.js\";import{isAbortError as r}from\"../../../../core/promiseUtils.js\";import{getJsonType as n}from\"../../../../geometry/support/jsonUtils.js\";import{wgs84 as a,equals as o}from\"../../../../geometry/support/spatialReferenceUtils.js\";import{convertFromGeometry as u,convertToGeometry as l,convertFromFeatures as d,convertToFeature as p,convertFromFeature as c}from\"../../featureConversionUtils.js\";import{executeQueryForSnapping as y}from\"../../data/executeQueryForSnapping.js\";import m from\"../../data/FeatureStore.js\";import{checkProjectionSupport as h,project as f}from\"../../data/projectionSupport.js\";import{QueryEngine as g}from\"../../data/QueryEngine.js\";import{inferLayerProperties as _,createOptimizedFeatures as F,validateGeoJSON as I}from\"./geojson.js\";import{createDrawingInfo as j,createDefaultTemplate as E,createDefaultAttributesFunction as b}from\"../support/clientSideDefaults.js\";import{loadGeometryEngineForSimplify as T,mixAttributes as w,createFeatureEditSuccessResult as q,createFeatureEditErrorResult as x,simplify as S,queryBinsCapabilities as R}from\"../support/sourceUtils.js\";import C from\"../../../support/FieldsIndex.js\";import{kebabDict as O}from\"../../../support/fieldType.js\";import{getFieldDefaultValue as k,getFieldDefaultLength as Q}from\"../../../support/fieldUtils.js\";import{utc as D}from\"../../../../time/timeZoneUtils.js\";const A={hasAttachments:!1,capabilities:\"query, editing, create, delete, update\",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsQueryAttachmentOrderByFields:!1,supportsQueryBins:!0,supportsQueryWithCacheHint:!0,supportsQueryWithDistance:!0,supportsQueryWithResultType:!0,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0},queryBinsCapabilities:R};class v{constructor(){this._queryEngine=null,this._snapshotFeatures=async e=>{const t=await this._fetch(e);return this._createFeatures(t)}}destroy(){this._queryEngine?.destroy(),this._queryEngine=this._createDefaultAttributes=null}async load(e,t={}){this._loadOptions={url:e.url,customParameters:e.customParameters};const i=[],[r]=await Promise.all([e.url?this._fetch(t?.signal):null,this._checkProjection(e.spatialReference)]),n=_(r,{geometryType:e.geometryType}),o=e.fields||n.fields||[],u=null!=e.hasZ?e.hasZ:n.hasZ,l=n.geometryType;let d=e.objectIdField||n.objectIdFieldName||\"__OBJECTID\";const p=e.spatialReference||a;let c=e.timeInfo;o===n.fields&&n.unknownFields.length>0&&i.push({name:\"geojson-layer:unknown-field-types\",message:\"Some fields types couldn't be inferred from the features and were dropped\",details:{unknownFields:n.unknownFields}});const y=new C(o);let h=y.get(d);h?(\"esriFieldTypeString\"!==h.type&&(h.type=\"esriFieldTypeOID\"),h.editable=!1,h.nullable=!1,d=h.name):(h={alias:d,name:d,type:\"string\"===n.objectIdFieldType?\"esriFieldTypeString\":\"esriFieldTypeOID\",editable:!1,nullable:!1},o.unshift(h));const f={};for(const a of o){if(null==a.name&&(a.name=a.alias),null==a.alias&&(a.alias=a.name),!a.name)throw new s(\"geojson-layer:invalid-field-name\",\"field name is missing\",{field:a});if(!O.jsonValues.includes(a.type))throw new s(\"geojson-layer:invalid-field-type\",`invalid type for field \"${a.name}\"`,{field:a});if(a.name!==h.name){const e=k(a);void 0!==e&&(f[a.name]=e)}null==a.length&&(a.length=Q(a))}if(c){if(c.startTimeField){const e=y.get(c.startTimeField);e?(c.startTimeField=e.name,e.type=\"esriFieldTypeDate\"):c.startTimeField=null}if(c.endTimeField){const e=y.get(c.endTimeField);e?(c.endTimeField=e.name,e.type=\"esriFieldTypeDate\"):c.endTimeField=null}if(c.trackIdField){const e=y.get(c.trackIdField);e?c.trackIdField=e.name:(c.trackIdField=null,i.push({name:\"geojson-layer:invalid-timeInfo-trackIdField\",message:\"trackIdField is missing\",details:{timeInfo:c}}))}c.startTimeField||c.endTimeField||(i.push({name:\"geojson-layer:invalid-timeInfo\",message:\"startTimeField and endTimeField are missing\",details:{timeInfo:c}}),c=null)}const F=l?j(l):void 0,I=y.dateFields.length?{timeZoneIANA:D}:null,T={warnings:i,featureErrors:[],layerDefinition:{...A,drawingInfo:F??void 0,templates:E(f),extent:void 0,geometryType:l,objectIdField:d,fields:o,hasZ:!!u,timeInfo:c,dateFieldsTimeReference:I}};this._queryEngine=new g({fieldsIndex:C.fromLayerJSON({fields:o,timeInfo:c,dateFieldsTimeReference:I}),geometryType:l,hasM:!1,hasZ:u,objectIdField:d,spatialReference:p,timeInfo:c,featureStore:new m({geometryType:l,hasM:!1,hasZ:u})});const w=this._queryEngine.fieldsIndex.requiredFields.indexOf(h);w>-1&&this._queryEngine.fieldsIndex.requiredFields.splice(w,1),this._createDefaultAttributes=b(f,d);const q=await this._createFeatures(r);this._objectIdGenerator=this._createObjectIdGenerator(this._queryEngine,q);const x=this._normalizeFeatures(q,T.featureErrors);this._queryEngine.featureStore.addMany(x);const{fullExtent:S,timeExtent:R}=await this._queryEngine.fetchRecomputedExtents();if(T.layerDefinition.extent=S,R){const{start:e,end:t}=R;T.layerDefinition.timeInfo.timeExtent=[e,t]}return T}async applyEdits(e){const{spatialReference:t,geometryType:s}=this._queryEngine;return await Promise.all([T(t,s),h(e.adds,t),h(e.updates,t)]),await this._waitSnapshotComplete(),this._applyEdits(e)}async queryFeatures(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQuery(e,t.signal)}async queryFeatureCount(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForCount(e,t.signal)}async queryObjectIds(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForIds(e,t.signal)}async queryExtent(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForExtent(e,t.signal)}async querySnapping(e,t={}){return await this._waitSnapshotComplete(),y(this._queryEngine,e,t.signal)}async queryAttributeBins(e,t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeAttributeBinsQuery(e,t.signal)}async refresh(e){this._loadOptions.customParameters=e,this._snapshotTask?.abort(),this._snapshotTask=t(this._snapshotFeatures),this._snapshotTask.promise.then((e=>{this._queryEngine.featureStore.clear(),this._objectIdGenerator=this._createObjectIdGenerator(this._queryEngine,e);const t=this._normalizeFeatures(e);t&&this._queryEngine.featureStore.addMany(t)}),(e=>{this._queryEngine.featureStore.clear(),r(e)||i.getLogger(\"esri.layers.GeoJSONLayer\").error(new s(\"geojson-layer:refresh\",\"An error occurred during refresh\",{error:e}))})),await this._waitSnapshotComplete();const{fullExtent:n,timeExtent:a}=await this._queryEngine.fetchRecomputedExtents();return{extent:n,timeExtent:a}}async _createFeatures(e){if(null==e)return[];const{geometryType:t,hasZ:s,objectIdField:i}=this._queryEngine,r=F(e,{geometryType:t,hasZ:s,objectIdField:i});if(!o(this._queryEngine.spatialReference,a))for(const n of r)null!=n.geometry&&(n.geometry=u(f(l(n.geometry,this._queryEngine.geometryType,this._queryEngine.hasZ,!1),a,this._queryEngine.spatialReference)));return r}async _waitSnapshotComplete(){if(this._snapshotTask&&!this._snapshotTask.finished){try{await this._snapshotTask.promise}catch{}return this._waitSnapshotComplete()}}async _fetch(t){const{url:s,customParameters:i}=this._loadOptions,r=(await e(s??\"\",{responseType:\"json\",query:{...i},signal:t})).data;return I(r),r}_normalizeFeatures(e,t){const{objectIdField:s,fieldsIndex:i}=this._queryEngine,r=[];for(const n of e){const e=this._createDefaultAttributes(),a=w(i,e,n.attributes,!0);a?t?.push(a):(this._assignObjectId(e,n.attributes,!0),n.attributes=e,n.objectId=e[s],r.push(n))}return r}async _applyEdits(e){const{adds:t,updates:s,deletes:i}=e,r={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};if(t?.length&&this._applyAddEdits(r,t),s?.length&&this._applyUpdateEdits(r,s),i?.length){for(const e of i)r.deleteResults.push(q(e));this._queryEngine.featureStore.removeManyById(i)}const{fullExtent:n,timeExtent:a}=await this._queryEngine.fetchRecomputedExtents();return{extent:n,timeExtent:a,featureEditResults:r}}_applyAddEdits(e,t){const{addResults:s}=e,{geometryType:i,hasM:r,hasZ:a,objectIdField:o,spatialReference:u,featureStore:l,fieldsIndex:p}=this._queryEngine,c=[];for(const d of t){if(d.geometry&&i!==n(d.geometry)){s.push(x(\"Incorrect geometry type.\"));continue}const t=this._createDefaultAttributes(),r=w(p,t,d.attributes);if(r)s.push(r);else{if(this._assignObjectId(t,d.attributes),d.attributes=t,null!=d.uid){const t=d.attributes[o];e.uidToObjectId[d.uid]=t}if(null!=d.geometry){const e=d.geometry.spatialReference??u;d.geometry=f(S(d.geometry,e),e,u)}c.push(d),s.push(q(d.attributes[o]))}}l.addMany(d([],c,i,a,r,o))}_applyUpdateEdits({updateResults:e},t){const{geometryType:s,hasM:i,hasZ:r,objectIdField:a,spatialReference:o,featureStore:u,fieldsIndex:l}=this._queryEngine;for(const d of t){const{attributes:t,geometry:y}=d,m=t?.[a];if(null==m){e.push(x(`Identifier field ${a} missing`));continue}if(!u.has(m)){e.push(x(`Feature with object id ${m} missing`));continue}const h=p(u.getFeature(m),s,r,i);if(null!=y){if(s!==n(y)){e.push(x(\"Incorrect geometry type.\"));continue}const t=y.spatialReference??o;h.geometry=f(S(y,t),t,o)}if(t){const s=w(l,h.attributes,t);if(s){e.push(s);continue}}u.add(c(h,s,r,i,a)),e.push(q(m))}}_createObjectIdGenerator(e,t){const s=e.fieldsIndex.get(e.objectIdField);if(\"esriFieldTypeString\"===s.type)return()=>s.name+\"-\"+Date.now().toString(16);let i=Number.NEGATIVE_INFINITY;for(const r of t)r.objectId&&(i=Math.max(i,r.objectId));return i=Math.max(0,i)+1,()=>i++}_assignObjectId(e,t,s=!1){const i=this._queryEngine.objectIdField;e[i]=s&&i in t?t[i]:this._objectIdGenerator()}async _checkProjection(e){try{await h(a,e)}catch{throw new s(\"geojson-layer\",\"Projection not supported\")}}}export{v as default};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}