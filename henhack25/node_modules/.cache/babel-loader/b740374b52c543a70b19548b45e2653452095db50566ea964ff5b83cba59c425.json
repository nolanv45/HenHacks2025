{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../../chunks/tslib.es6.js\";\nimport t from \"../../../../../core/Accessor.js\";\nimport { property as r } from \"../../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../../core/has.js\";\nimport \"../../../../../core/Logger.js\";\nimport \"../../../../../core/RandomLCG.js\";\nimport { subclass as o } from \"../../../../../core/accessorSupport/decorators/subclass.js\";\nimport { create as s } from \"../../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";\nimport { WorkerHandle as n } from \"../../../../../core/workers/WorkerHandle.js\";\nimport { f as i } from \"../../../../../chunks/sphere.js\";\nimport { markAsTarget as a, fromVec3 as d } from \"../../../sketch/normalizedPoint.js\";\nimport { EdgeSnappingCandidate as c } from \"../../candidates/EdgeSnappingCandidate.js\";\nimport { VertexSnappingCandidate as p } from \"../../candidates/VertexSnappingCandidate.js\";\nlet l = class extends t {\n  constructor(e) {\n    super(e), this.availability = 0, this._ids = new Set();\n  }\n  destroy() {\n    this._workerHandle.destroy(), this._workerHandle = null;\n  }\n  initialize() {\n    this._workerHandle = new h(this.schedule, {\n      fetchAllEdgeLocations: (e, t) => this._fetchAllEdgeLocations(e, t)\n    });\n  }\n  async fetchCandidates(e, t) {\n    const r = e.coordinateHelper,\n      {\n        point: o\n      } = e,\n      s = u;\n    this.renderCoordsHelper.toRenderCoords(o, r.spatialReference, s);\n    const n = e.distance,\n      a = \"number\" == typeof n ? n : n.distance,\n      d = await this._workerHandle.invoke({\n        bounds: i(s[0], s[1], s[2], a),\n        returnEdge: e.returnEdge,\n        returnVertex: \"none\" !== e.vertexMode\n      }, t);\n    return d.candidates.sort((e, t) => e.distance - t.distance), d.candidates.map(e => this._convertCandidate(r, e));\n  }\n  async add(e, t) {\n    this._ids.add(e.id), await this._workerHandle.invokeMethod(\"add\", e, t);\n  }\n  async remove(e, t) {\n    this._ids.delete(e.id), await this._workerHandle.invokeMethod(\"remove\", e, t);\n  }\n  _convertCandidate(e, t) {\n    switch (t.type) {\n      case \"edge\":\n        return new c({\n          objectId: t.objectId,\n          targetPoint: a(this._convertRenderCoordinate(e, t.target)),\n          edgeStart: this._convertRenderCoordinate(e, t.start),\n          edgeEnd: this._convertRenderCoordinate(e, t.end),\n          isDraped: !1\n        });\n      case \"vertex\":\n        return new p({\n          objectId: t.objectId,\n          targetPoint: a(this._convertRenderCoordinate(e, t.target)),\n          isDraped: !1\n        });\n    }\n  }\n  _convertRenderCoordinate(_ref, t) {\n    let {\n      spatialReference: e\n    } = _ref;\n    const r = s();\n    return this.renderCoordsHelper.fromRenderCoords(t, r, e), d(r);\n  }\n  async _fetchAllEdgeLocations(e, t) {\n    const r = [],\n      o = [];\n    for (const {\n      id: s,\n      uid: n\n    } of e.components) this._ids.has(s) && r.push((async () => {\n      const e = await this.fetchEdgeLocations(s, t.signal),\n        r = e.locations.buffer;\n      return o.push(r), {\n        id: s,\n        uid: n,\n        objectIds: e.objectIds,\n        locations: r,\n        origin: e.origin,\n        type: e.type\n      };\n    })());\n    return {\n      result: {\n        components: (await Promise.all(r)).filter(_ref2 => {\n          let {\n            id: e\n          } = _ref2;\n          return this._ids.has(e);\n        })\n      },\n      transferList: o\n    };\n  }\n};\ne([r({\n  constructOnly: !0\n})], l.prototype, \"renderCoordsHelper\", void 0), e([r({\n  constructOnly: !0\n})], l.prototype, \"fetchEdgeLocations\", void 0), e([r({\n  constructOnly: !0\n})], l.prototype, \"schedule\", void 0), e([r({\n  readOnly: !0\n})], l.prototype, \"availability\", void 0), l = e([o(\"esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorkerHandle\")], l);\nclass h extends n {\n  constructor(e, t) {\n    super(\"SceneLayerSnappingSourceWorker\", \"fetchCandidates\", {}, e, {\n      strategy: \"dedicated\",\n      client: t\n    });\n  }\n}\nconst u = s();\nexport { l as SceneLayerSnappingSourceWorkerHandle };","map":{"version":3,"names":["_","e","t","property","r","subclass","o","create","s","WorkerHandle","n","f","i","markAsTarget","a","fromVec3","d","EdgeSnappingCandidate","c","VertexSnappingCandidate","p","l","constructor","availability","_ids","Set","destroy","_workerHandle","initialize","h","schedule","fetchAllEdgeLocations","_fetchAllEdgeLocations","fetchCandidates","coordinateHelper","point","u","renderCoordsHelper","toRenderCoords","spatialReference","distance","invoke","bounds","returnEdge","returnVertex","vertexMode","candidates","sort","map","_convertCandidate","add","id","invokeMethod","remove","delete","type","objectId","targetPoint","_convertRenderCoordinate","target","edgeStart","start","edgeEnd","end","isDraped","_ref","fromRenderCoords","uid","components","has","push","fetchEdgeLocations","signal","locations","buffer","objectIds","origin","result","Promise","all","filter","_ref2","transferList","constructOnly","prototype","readOnly","strategy","client","SceneLayerSnappingSourceWorkerHandle"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/interactive/snapping/featureSources/sceneLayerSource/SceneLayerSnappingSourceWorkerHandle.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import t from\"../../../../../core/Accessor.js\";import{property as r}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/Logger.js\";import\"../../../../../core/RandomLCG.js\";import{subclass as o}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{create as s}from\"../../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{WorkerHandle as n}from\"../../../../../core/workers/WorkerHandle.js\";import{f as i}from\"../../../../../chunks/sphere.js\";import{markAsTarget as a,fromVec3 as d}from\"../../../sketch/normalizedPoint.js\";import{EdgeSnappingCandidate as c}from\"../../candidates/EdgeSnappingCandidate.js\";import{VertexSnappingCandidate as p}from\"../../candidates/VertexSnappingCandidate.js\";let l=class extends t{constructor(e){super(e),this.availability=0,this._ids=new Set}destroy(){this._workerHandle.destroy(),this._workerHandle=null}initialize(){this._workerHandle=new h(this.schedule,{fetchAllEdgeLocations:(e,t)=>this._fetchAllEdgeLocations(e,t)})}async fetchCandidates(e,t){const r=e.coordinateHelper,{point:o}=e,s=u;this.renderCoordsHelper.toRenderCoords(o,r.spatialReference,s);const n=e.distance,a=\"number\"==typeof n?n:n.distance,d=await this._workerHandle.invoke({bounds:i(s[0],s[1],s[2],a),returnEdge:e.returnEdge,returnVertex:\"none\"!==e.vertexMode},t);return d.candidates.sort(((e,t)=>e.distance-t.distance)),d.candidates.map((e=>this._convertCandidate(r,e)))}async add(e,t){this._ids.add(e.id),await this._workerHandle.invokeMethod(\"add\",e,t)}async remove(e,t){this._ids.delete(e.id),await this._workerHandle.invokeMethod(\"remove\",e,t)}_convertCandidate(e,t){switch(t.type){case\"edge\":return new c({objectId:t.objectId,targetPoint:a(this._convertRenderCoordinate(e,t.target)),edgeStart:this._convertRenderCoordinate(e,t.start),edgeEnd:this._convertRenderCoordinate(e,t.end),isDraped:!1});case\"vertex\":return new p({objectId:t.objectId,targetPoint:a(this._convertRenderCoordinate(e,t.target)),isDraped:!1})}}_convertRenderCoordinate({spatialReference:e},t){const r=s();return this.renderCoordsHelper.fromRenderCoords(t,r,e),d(r)}async _fetchAllEdgeLocations(e,t){const r=[],o=[];for(const{id:s,uid:n}of e.components)this._ids.has(s)&&r.push((async()=>{const e=await this.fetchEdgeLocations(s,t.signal),r=e.locations.buffer;return o.push(r),{id:s,uid:n,objectIds:e.objectIds,locations:r,origin:e.origin,type:e.type}})());return{result:{components:(await Promise.all(r)).filter((({id:e})=>this._ids.has(e)))},transferList:o}}};e([r({constructOnly:!0})],l.prototype,\"renderCoordsHelper\",void 0),e([r({constructOnly:!0})],l.prototype,\"fetchEdgeLocations\",void 0),e([r({constructOnly:!0})],l.prototype,\"schedule\",void 0),e([r({readOnly:!0})],l.prototype,\"availability\",void 0),l=e([o(\"esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorkerHandle\")],l);class h extends n{constructor(e,t){super(\"SceneLayerSnappingSourceWorker\",\"fetchCandidates\",{},e,{strategy:\"dedicated\",client:t})}}const u=s();export{l as SceneLayerSnappingSourceWorkerHandle};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}