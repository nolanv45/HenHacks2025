{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { throwIfAborted as e } from \"../../../../../../core/promiseUtils.js\";\nimport { toExtent as t } from \"../../../../../../geometry/support/aaBoundingRect.js\";\nimport { executeQueryPBFBuffer as r } from \"../../../../../../rest/query/operations/query.js\";\nimport { Tile as o } from \"../Tile.js\";\nimport { PBFPointFeatureSetView as s } from \"../featureSet/PBFPointFeatureSetView.js\";\nconst i = 8e3,\n  a = 4,\n  n = 4;\nclass c {\n  constructor(e, t, r, o, s) {\n    this.spatialReference = e, this.url = r, this.objectIdField = o, this.capabilities = s;\n    const {\n        supportsMaxRecordCountFactor: n,\n        maxRecordCount: c\n      } = this.capabilities.query,\n      u = n ? a : 1,\n      p = (c ?? i) * u;\n    this._pageSize = Math.min(i, p);\n    const l = t.clone();\n    l.cacheHint = !0, l.resultType = \"tile\", l.outSpatialReference = e, l.returnGeometry = !0, l.returnZ = !0, l.maxRecordCountFactor = u, l.num = this._pageSize, l.outFields = [o], this._baseQuery = l;\n  }\n  async fetch(r, s) {\n    const {\n        spatialReference: i\n      } = this,\n      a = t(r.extent, i),\n      c = this._baseQuery.clone();\n    c.geometry = a;\n    const u = new Array();\n    let p = 0,\n      l = !1,\n      h = 1;\n    for (; !l;) {\n      const t = [];\n      for (let e = 0; e < h; ++e) t.push(this._fetchPage(c, p++, s));\n      const r = await Promise.all(t);\n      e(s);\n      for (const e of r) {\n        const t = 0 !== e.featureCount;\n        l ||= !e.exceededTransferLimit || !t, t && u.push(e);\n      }\n      h = Math.min(h + 1, n);\n    }\n    return new o(r, u);\n  }\n  async _fetchPage(t, o, i) {\n    const a = t.clone();\n    a.start = o * this._pageSize;\n    const n = (await r(this.url, a, {\n      signal: i\n    })).data;\n    return e(i), new s(n);\n  }\n}\nexport { c as Tile3DFetcher };","map":{"version":3,"names":["throwIfAborted","e","toExtent","t","executeQueryPBFBuffer","r","Tile","o","PBFPointFeatureSetView","s","i","a","n","c","constructor","spatialReference","url","objectIdField","capabilities","supportsMaxRecordCountFactor","maxRecordCount","query","u","p","_pageSize","Math","min","l","clone","cacheHint","resultType","outSpatialReference","returnGeometry","returnZ","maxRecordCountFactor","num","outFields","_baseQuery","fetch","extent","geometry","Array","h","push","_fetchPage","Promise","all","featureCount","exceededTransferLimit","start","signal","data","Tile3DFetcher"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/3d/layers/graphics/pipeline/fetching/Tile3DFetcher.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{throwIfAborted as e}from\"../../../../../../core/promiseUtils.js\";import{toExtent as t}from\"../../../../../../geometry/support/aaBoundingRect.js\";import{executeQueryPBFBuffer as r}from\"../../../../../../rest/query/operations/query.js\";import{Tile as o}from\"../Tile.js\";import{PBFPointFeatureSetView as s}from\"../featureSet/PBFPointFeatureSetView.js\";const i=8e3,a=4,n=4;class c{constructor(e,t,r,o,s){this.spatialReference=e,this.url=r,this.objectIdField=o,this.capabilities=s;const{supportsMaxRecordCountFactor:n,maxRecordCount:c}=this.capabilities.query,u=n?a:1,p=(c??i)*u;this._pageSize=Math.min(i,p);const l=t.clone();l.cacheHint=!0,l.resultType=\"tile\",l.outSpatialReference=e,l.returnGeometry=!0,l.returnZ=!0,l.maxRecordCountFactor=u,l.num=this._pageSize,l.outFields=[o],this._baseQuery=l}async fetch(r,s){const{spatialReference:i}=this,a=t(r.extent,i),c=this._baseQuery.clone();c.geometry=a;const u=new Array;let p=0,l=!1,h=1;for(;!l;){const t=[];for(let e=0;e<h;++e)t.push(this._fetchPage(c,p++,s));const r=await Promise.all(t);e(s);for(const e of r){const t=0!==e.featureCount;l||=!e.exceededTransferLimit||!t,t&&u.push(e)}h=Math.min(h+1,n)}return new o(r,u)}async _fetchPage(t,o,i){const a=t.clone();a.start=o*this._pageSize;const n=(await r(this.url,a,{signal:i})).data;return e(i),new s(n)}}export{c as Tile3DFetcher};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}