{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { isAbortError as t } from \"../../../../core/promiseUtils.js\";\nimport { PlacementEngine as e } from \"./Placement.js\";\nimport s from \"./TileParser.js\";\nimport { TileStatus as r } from \"../../tiling/enums.js\";\nclass i {\n  constructor(t, s, i, a) {\n    this.status = r.INITIALIZED, this.placementEngine = new e(), this.tileKey = t, this.refKeys = s, this._workerTileHandler = i, this._styleRepository = a;\n  }\n  release() {\n    this.tileKey = \"\", this.refKeys = null, this.status = r.INITIALIZED, this._workerTileHandler = null;\n  }\n  async parse(e, s) {\n    const i = s?.signal;\n    if (null != i) {\n      const t = () => {\n        i.removeEventListener(\"abort\", t), this.status = r.INVALID;\n      };\n      i.addEventListener(\"abort\", t);\n    }\n    let a;\n    const n = {\n      bucketsWithData: [],\n      emptyBuckets: null\n    };\n    try {\n      a = await this._parse(e, s);\n    } catch (c) {\n      if (t(c)) throw c;\n      return {\n        result: n,\n        transferList: []\n      };\n    }\n    this.status = r.READY;\n    const l = n.bucketsWithData,\n      o = [];\n    for (const t of a) if (t.hasFeatures()) {\n      const e = t.serialize();\n      l.push(e);\n    } else o.push(t.layer.uid);\n    const u = [...l];\n    let h = null;\n    return o.length > 0 && (h = Uint32Array.from(o), u.push(h.buffer)), n.emptyBuckets = h, {\n      result: n,\n      transferList: u\n    };\n  }\n  setObsolete() {\n    this.status = r.INVALID;\n  }\n  getLayers() {\n    return this._workerTileHandler.getLayers();\n  }\n  getWorkerTileHandler() {\n    return this._workerTileHandler;\n  }\n  async _parse(t, e) {\n    const i = t.sourceName2DataAndRefKey;\n    if (0 === Object.keys(i).length) return [];\n    this.status = r.MODIFIED;\n    return new s(i, this, e.client, t.sourceDataMaxLOD, this._styleRepository, t.styleLayerUIDs).parse(e);\n  }\n}\nexport { i as default };","map":{"version":3,"names":["isAbortError","t","PlacementEngine","e","s","TileStatus","r","i","constructor","a","status","INITIALIZED","placementEngine","tileKey","refKeys","_workerTileHandler","_styleRepository","release","parse","signal","removeEventListener","INVALID","addEventListener","n","bucketsWithData","emptyBuckets","_parse","c","result","transferList","READY","l","o","hasFeatures","serialize","push","layer","uid","u","h","length","Uint32Array","from","buffer","setObsolete","getLayers","getWorkerTileHandler","sourceName2DataAndRefKey","Object","keys","MODIFIED","client","sourceDataMaxLOD","styleLayerUIDs","default"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/2d/engine/vectorTiles/WorkerTile.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{isAbortError as t}from\"../../../../core/promiseUtils.js\";import{PlacementEngine as e}from\"./Placement.js\";import s from\"./TileParser.js\";import{TileStatus as r}from\"../../tiling/enums.js\";class i{constructor(t,s,i,a){this.status=r.INITIALIZED,this.placementEngine=new e,this.tileKey=t,this.refKeys=s,this._workerTileHandler=i,this._styleRepository=a}release(){this.tileKey=\"\",this.refKeys=null,this.status=r.INITIALIZED,this._workerTileHandler=null}async parse(e,s){const i=s?.signal;if(null!=i){const t=()=>{i.removeEventListener(\"abort\",t),this.status=r.INVALID};i.addEventListener(\"abort\",t)}let a;const n={bucketsWithData:[],emptyBuckets:null};try{a=await this._parse(e,s)}catch(c){if(t(c))throw c;return{result:n,transferList:[]}}this.status=r.READY;const l=n.bucketsWithData,o=[];for(const t of a)if(t.hasFeatures()){const e=t.serialize();l.push(e)}else o.push(t.layer.uid);const u=[...l];let h=null;return o.length>0&&(h=Uint32Array.from(o),u.push(h.buffer)),n.emptyBuckets=h,{result:n,transferList:u}}setObsolete(){this.status=r.INVALID}getLayers(){return this._workerTileHandler.getLayers()}getWorkerTileHandler(){return this._workerTileHandler}async _parse(t,e){const i=t.sourceName2DataAndRefKey;if(0===Object.keys(i).length)return[];this.status=r.MODIFIED;return new s(i,this,e.client,t.sourceDataMaxLOD,this._styleRepository,t.styleLayerUIDs).parse(e)}}export{i as default};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}