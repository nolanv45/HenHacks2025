{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { nextPowerOfTwo as t } from \"../../../../../core/mathUtils.js\";\nimport { create as e } from \"../../../../../core/libs/gl-matrix-2/factories/mat3f32.js\";\nimport { fromValues as r } from \"../../../../../core/libs/gl-matrix-2/factories/vec4f32.js\";\nimport { vtlTextureBindingUnitSprites as o, vtlHighResCutoff as i } from \"../definitions.js\";\nimport s from \"./WGLBrush.js\";\nimport { BufferObject as a } from \"../../../../webgl/BufferObject.js\";\nimport { TextureSamplingMode as n, CompareFunction as c, PrimitiveType as l, Usage as f } from \"../../../../webgl/enums.js\";\nimport { VertexArrayObject as m } from \"../../../../webgl/VertexArrayObject.js\";\nclass u extends s {\n  constructor() {\n    super(...arguments), this._color = r(1, 0, 0, 1), this._patternMatrix = e(), this._programOptions = {\n      id: !1,\n      pattern: !1\n    };\n  }\n  dispose() {\n    this._vao && (this._vao.dispose(), this._vao = null);\n  }\n  drawMany(e, r) {\n    const {\n      context: s,\n      painter: a,\n      requestRender: f,\n      allowDelayedRender: m\n    } = e;\n    this._loadWGLResources(e);\n    const u = e.displayLevel,\n      p = e.styleLayer,\n      _ = p.backgroundMaterial,\n      d = a.vectorTilesMaterialManager,\n      g = p.getPaintValue(\"background-color\", u),\n      h = p.getPaintValue(\"background-opacity\", u),\n      x = p.getPaintValue(\"background-pattern\", u),\n      M = void 0 !== x,\n      b = 1 | window.devicePixelRatio,\n      v = e.spriteMosaic;\n    let y, w;\n    const j = b > i ? 2 : 1,\n      A = this._programOptions;\n    A.pattern = M;\n    const L = d.getMaterialProgram(s, _, A);\n    if (!m || null == f || L.compiled) {\n      if (s.bindVAO(this._vao), s.useProgram(L), M) {\n        const t = v.getMosaicItemPosition(x, !0);\n        if (null != t) {\n          const {\n            tl: e,\n            br: r,\n            page: i\n          } = t;\n          y = r[0] - e[0], w = r[1] - e[1];\n          const a = v.getPageSize(i);\n          null != a && (v.bind(s, n.LINEAR, i, o), L.setUniform4f(\"u_tlbr\", e[0], e[1], r[0], r[1]), L.setUniform2fv(\"u_mosaicSize\", a), L.setUniform1i(\"u_texture\", o));\n        }\n        L.setUniform1f(\"u_opacity\", h);\n      } else {\n        const t = g[3] * h;\n        this._color[0] = t * g[0], this._color[1] = t * g[1], this._color[2] = t * g[2], this._color[3] = t, L.setUniform4fv(\"u_color\", this._color);\n      }\n      L.setUniform1f(\"u_depth\", p.z || 0);\n      for (const e of r) {\n        if (L.setUniform1f(\"u_coord_range\", e.rangeX), L.setUniformMatrix3fv(\"u_dvsMat3\", e.transforms.displayViewScreenMat3), M) {\n          const r = Math.max(2 ** (Math.round(u) - e.key.level), 1),\n            o = j * e.width * r,\n            i = o / t(y),\n            s = o / t(w);\n          this._patternMatrix[0] = i, this._patternMatrix[4] = s, L.setUniformMatrix3fv(\"u_pattern_matrix\", this._patternMatrix);\n        }\n        s.setStencilFunction(c.EQUAL, 0, 255), s.drawArrays(l.TRIANGLE_STRIP, 0, 4);\n      }\n    } else f();\n  }\n  _loadWGLResources(t) {\n    if (this._vao) return;\n    const {\n        context: e,\n        styleLayer: r\n      } = t,\n      o = r.backgroundMaterial,\n      i = new Int8Array([0, 0, 1, 0, 0, 1, 1, 1]),\n      s = a.createVertex(e, f.STATIC_DRAW, i),\n      n = new m(e, o.getAttributeLocations(), o.getLayoutInfo(), new Map([[\"geometry\", s]]));\n    this._vao = n;\n  }\n}\nexport { u as WGLBrushVTLBackground };","map":{"version":3,"names":["nextPowerOfTwo","t","create","e","fromValues","r","vtlTextureBindingUnitSprites","o","vtlHighResCutoff","i","s","BufferObject","a","TextureSamplingMode","n","CompareFunction","c","PrimitiveType","l","Usage","f","VertexArrayObject","m","u","constructor","arguments","_color","_patternMatrix","_programOptions","id","pattern","dispose","_vao","drawMany","context","painter","requestRender","allowDelayedRender","_loadWGLResources","displayLevel","p","styleLayer","_","backgroundMaterial","d","vectorTilesMaterialManager","g","getPaintValue","h","x","M","b","window","devicePixelRatio","v","spriteMosaic","y","w","j","A","L","getMaterialProgram","compiled","bindVAO","useProgram","getMosaicItemPosition","tl","br","page","getPageSize","bind","LINEAR","setUniform4f","setUniform2fv","setUniform1i","setUniform1f","setUniform4fv","z","rangeX","setUniformMatrix3fv","transforms","displayViewScreenMat3","Math","max","round","key","level","width","setStencilFunction","EQUAL","drawArrays","TRIANGLE_STRIP","Int8Array","createVertex","STATIC_DRAW","getAttributeLocations","getLayoutInfo","Map","WGLBrushVTLBackground"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/2d/engine/webgl/brushes/WGLBrushVTLBackground.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{nextPowerOfTwo as t}from\"../../../../../core/mathUtils.js\";import{create as e}from\"../../../../../core/libs/gl-matrix-2/factories/mat3f32.js\";import{fromValues as r}from\"../../../../../core/libs/gl-matrix-2/factories/vec4f32.js\";import{vtlTextureBindingUnitSprites as o,vtlHighResCutoff as i}from\"../definitions.js\";import s from\"./WGLBrush.js\";import{BufferObject as a}from\"../../../../webgl/BufferObject.js\";import{TextureSamplingMode as n,CompareFunction as c,PrimitiveType as l,Usage as f}from\"../../../../webgl/enums.js\";import{VertexArrayObject as m}from\"../../../../webgl/VertexArrayObject.js\";class u extends s{constructor(){super(...arguments),this._color=r(1,0,0,1),this._patternMatrix=e(),this._programOptions={id:!1,pattern:!1}}dispose(){this._vao&&(this._vao.dispose(),this._vao=null)}drawMany(e,r){const{context:s,painter:a,requestRender:f,allowDelayedRender:m}=e;this._loadWGLResources(e);const u=e.displayLevel,p=e.styleLayer,_=p.backgroundMaterial,d=a.vectorTilesMaterialManager,g=p.getPaintValue(\"background-color\",u),h=p.getPaintValue(\"background-opacity\",u),x=p.getPaintValue(\"background-pattern\",u),M=void 0!==x,b=1|window.devicePixelRatio,v=e.spriteMosaic;let y,w;const j=b>i?2:1,A=this._programOptions;A.pattern=M;const L=d.getMaterialProgram(s,_,A);if(!m||null==f||L.compiled){if(s.bindVAO(this._vao),s.useProgram(L),M){const t=v.getMosaicItemPosition(x,!0);if(null!=t){const{tl:e,br:r,page:i}=t;y=r[0]-e[0],w=r[1]-e[1];const a=v.getPageSize(i);null!=a&&(v.bind(s,n.LINEAR,i,o),L.setUniform4f(\"u_tlbr\",e[0],e[1],r[0],r[1]),L.setUniform2fv(\"u_mosaicSize\",a),L.setUniform1i(\"u_texture\",o))}L.setUniform1f(\"u_opacity\",h)}else{const t=g[3]*h;this._color[0]=t*g[0],this._color[1]=t*g[1],this._color[2]=t*g[2],this._color[3]=t,L.setUniform4fv(\"u_color\",this._color)}L.setUniform1f(\"u_depth\",p.z||0);for(const e of r){if(L.setUniform1f(\"u_coord_range\",e.rangeX),L.setUniformMatrix3fv(\"u_dvsMat3\",e.transforms.displayViewScreenMat3),M){const r=Math.max(2**(Math.round(u)-e.key.level),1),o=j*e.width*r,i=o/t(y),s=o/t(w);this._patternMatrix[0]=i,this._patternMatrix[4]=s,L.setUniformMatrix3fv(\"u_pattern_matrix\",this._patternMatrix)}s.setStencilFunction(c.EQUAL,0,255),s.drawArrays(l.TRIANGLE_STRIP,0,4)}}else f()}_loadWGLResources(t){if(this._vao)return;const{context:e,styleLayer:r}=t,o=r.backgroundMaterial,i=new Int8Array([0,0,1,0,0,1,1,1]),s=a.createVertex(e,f.STATIC_DRAW,i),n=new m(e,o.getAttributeLocations(),o.getLayoutInfo(),new Map([[\"geometry\",s]]));this._vao=n}}export{u as WGLBrushVTLBackground};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}