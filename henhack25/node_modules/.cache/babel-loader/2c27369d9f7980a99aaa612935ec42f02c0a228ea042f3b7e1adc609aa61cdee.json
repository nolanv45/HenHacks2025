{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport \"../../core/has.js\";\nimport t from \"../../core/Logger.js\";\nimport { disposeMaybe as e } from \"../../core/maybe.js\";\nimport { BufferObject as i } from \"./BufferObject.js\";\nimport { webglDebugEnabled as r } from \"./checkWebGLError.js\";\nimport { ResourceType as s, ColorAttachment as n, PixelFormat as h, PixelType as o, DepthStencilAttachment as c, FramebufferTarget as a, TextureType as u, Usage as _, BufferType as f, RenderbufferFormat as l } from \"./enums.js\";\nimport { GLObjectType as T } from \"./GLObjectType.js\";\nimport { Renderbuffer as d } from \"./Renderbuffer.js\";\nimport { Texture as m } from \"./Texture.js\";\nconst p = () => t.getLogger(\"esri.views.webgl.FramebufferObject\");\nclass x {\n  constructor(t, e, i = null) {\n    this._context = t, this._glName = null, this._colorAttachments = new Map(), this._depthStencilBuffer = null, this._depthStencilTexture = null, this._initialized = !1, t.instanceCounter.increment(s.FramebufferObject, this);\n    const r = E(e) ? e : new m(this._context, e);\n    if (this._colorAttachments.set(n.COLOR_ATTACHMENT0, r), this._validateTextureDescriptor(r.descriptor), this._validateColorAttachmentPoint(n.COLOR_ATTACHMENT0), null != i) if (b(i)) this._depthStencilTexture = E(i) ? i : new m(this._context, i), this._validateTextureDescriptor(this._depthStencilTexture.descriptor);else {\n      const t = g(i) ? i : new d(this._context, i);\n      this._depthStencilBuffer = t, this._validateRenderBufferDescriptor(t.descriptor);\n    }\n  }\n  dispose() {\n    if (0 === this._colorAttachments.size && !this._glName) return;\n    const t = this._context.getBoundFramebufferObject();\n    if (this._colorAttachments.forEach((t, e) => this.detachColorTexture(e)?.dispose()), this.detachDepthStencilBuffer()?.dispose(), this.detachDepthStencilTexture()?.dispose(), this._glName) {\n      this._context.gl.deleteFramebuffer(this._glName), this._glName = null;\n    }\n    this._context.bindFramebuffer(t), this._context.instanceCounter.decrement(s.FramebufferObject, this);\n  }\n  get glName() {\n    return this._glName;\n  }\n  get colorTexture() {\n    return this._colorAttachments.get(n.COLOR_ATTACHMENT0);\n  }\n  get depthStencil() {\n    return this._depthStencilTexture || this._depthStencilBuffer;\n  }\n  get depthStencilTexture() {\n    return this._depthStencilTexture;\n  }\n  get width() {\n    const t = this._colorAttachments.get(n.COLOR_ATTACHMENT0);\n    return t?.descriptor?.width ?? 0;\n  }\n  get height() {\n    const t = this._colorAttachments.get(n.COLOR_ATTACHMENT0);\n    return t?.descriptor?.height ?? 0;\n  }\n  get usedMemory() {\n    return [...this._colorAttachments].reduce((t, [e, i]) => t + i.usedMemory, this.depthStencil?.usedMemory ?? 0);\n  }\n  getColorTexture(t) {\n    const e = this._colorAttachments.get(t);\n    return e && E(e) ? e : null;\n  }\n  get colorAttachments() {\n    return [...this._colorAttachments.keys()];\n  }\n  attachColorTexture(t, e = n.COLOR_ATTACHMENT0) {\n    if (!t) return;\n    this._validateColorAttachmentPoint(e);\n    const i = t.descriptor;\n    this._validateTextureDescriptor(i), this.detachColorTexture(e)?.dispose(), this._initialized && (this._context.bindFramebuffer(this), this._framebufferTexture2D(t.glName, e)), this._colorAttachments.set(e, t);\n  }\n  detachColorTexture(t = n.COLOR_ATTACHMENT0) {\n    const e = this._colorAttachments.get(t);\n    if (e) {\n      if (this._initialized) {\n        const e = this._context.getBoundFramebufferObject();\n        this._context.bindFramebuffer(this), this._framebufferTexture2D(null, t), this._context.bindFramebuffer(e);\n      }\n      return this._colorAttachments.delete(t), e;\n    }\n  }\n  setColorTextureTarget(t, e = n.COLOR_ATTACHMENT0) {\n    const i = this._colorAttachments.get(e);\n    i && this._framebufferTexture2D(i.glName, e, t);\n  }\n  attachDepthStencil(t) {\n    if (t) switch (t.type) {\n      case T.Texture:\n        return this._attachDepthStencilTexture(t);\n      case T.RenderBuffer:\n        return this._attachDepthStencilBuffer(t);\n    }\n  }\n  _attachDepthStencilTexture(t) {\n    if (null == t) return;\n    const e = t.descriptor;\n    e.pixelFormat !== h.DEPTH_STENCIL && e.pixelFormat !== h.DEPTH24_STENCIL8 && console.error(\"Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!\"), e.dataType !== o.UNSIGNED_INT_24_8 && console.error(\"Depth/Stencil texture must have data type of UNSIGNED_INT_24_8!\"), this._validateTextureDescriptor(e), this._disposeDepthStencilAttachments(), this._initialized && (this._context.bindFramebuffer(this), this._framebufferTexture2D(t.glName, c)), this._depthStencilTexture?.dispose(), this._depthStencilTexture = t;\n  }\n  detachDepthStencilTexture() {\n    const t = this._depthStencilTexture;\n    if (t && this._initialized) {\n      const t = this._context.getBoundFramebufferObject();\n      this._context.bindFramebuffer(this), this._framebufferTexture2D(null, c), this._context.bindFramebuffer(t);\n    }\n    return this._depthStencilTexture = null, t;\n  }\n  _attachDepthStencilBuffer(t) {\n    if (null == t) return;\n    const e = t.descriptor;\n    if (this._validateRenderBufferDescriptor(e), this._disposeDepthStencilAttachments(), this._initialized) {\n      this._context.bindFramebuffer(this);\n      const i = this._context.gl,\n        r = this._getGLAttachmentPoint(e);\n      i.framebufferRenderbuffer(a.FRAMEBUFFER, r, i.RENDERBUFFER, t.glName);\n    }\n    this._depthStencilBuffer = t;\n  }\n  detachDepthStencilBuffer() {\n    const t = this._depthStencilBuffer;\n    if (t && this._initialized) {\n      const e = this._context.getBoundFramebufferObject();\n      this._context.bindFramebuffer(this);\n      const i = this._context.gl,\n        r = this._getGLAttachmentPoint(t.descriptor);\n      i.framebufferRenderbuffer(a.FRAMEBUFFER, r, i.RENDERBUFFER, null), this._context.bindFramebuffer(e);\n    }\n    return this._depthStencilBuffer = null, t;\n  }\n  copyToTexture(t, e, i, r, s, n, h) {\n    (t < 0 || e < 0 || s < 0 || n < 0) && console.error(\"Offsets cannot be negative!\"), (i <= 0 || r <= 0) && console.error(\"Copy width and height must be greater than zero!\");\n    const o = h.descriptor;\n    h.descriptor.target !== u.TEXTURE_2D && console.error(\"Texture target must be TEXTURE_2D!\"), (null == o?.width || null == o?.height || t + i > this.width || e + r > this.height || s + i > o.width || n + r > o.height) && console.error(\"Bad dimensions, the current input values will attempt to read or copy out of bounds!\");\n    const c = this._context,\n      a = c.bindTexture(h, m.TEXTURE_UNIT_FOR_UPDATES);\n    c.setActiveTexture(m.TEXTURE_UNIT_FOR_UPDATES), c.bindFramebuffer(this), c.gl.copyTexSubImage2D(u.TEXTURE_2D, 0, s, n, t, e, i, r), c.bindTexture(a, m.TEXTURE_UNIT_FOR_UPDATES);\n  }\n  readPixels(t, e, i, r, s, n, h) {\n    (i <= 0 || r <= 0) && console.error(\"Copy width and height must be greater than zero!\"), h || console.error(\"Target memory is not initialized!\"), this._context.bindFramebuffer(this), this._context.gl.readPixels(t, e, i, r, s, n, h);\n  }\n  async readPixelsAsync(t, e, r, s, n, h, o) {\n    const {\n        gl: c\n      } = this._context,\n      a = i.createPixelPack(this._context, _.STREAM_READ, o.byteLength);\n    this._context.bindBuffer(a);\n    const u = this._context.getBoundFramebufferObject();\n    this._context.bindFramebuffer(this), c.readPixels(t, e, r, s, n, h, 0), this._context.unbindBuffer(f.PIXEL_PACK_BUFFER), this._context.bindFramebuffer(u), await a.getSubDataAsync(o), a.dispose();\n  }\n  resize(t, e) {\n    if (this.width === t && this.height === e) return;\n    const i = {\n      width: t,\n      height: e\n    };\n    A(i, this._context.parameters.maxTextureSize), this._colorAttachments.forEach(t => t.resize(i.width, i.height)), this._depthStencilTexture?.resize(i.width, i.height), this._initialized && (A(i, this._context.parameters.maxRenderbufferSize), this._depthStencilBuffer?.resize(i.width, i.height), this._context.getBoundFramebufferObject() === this && this._context.bindFramebuffer(null), this._initialized = !1);\n  }\n  initializeAndBind(t = a.FRAMEBUFFER) {\n    const e = this._context.gl;\n    if (this._initialized) return void e.bindFramebuffer(t, this.glName);\n    this._glName && e.deleteFramebuffer(this._glName);\n    const i = e.createFramebuffer();\n    if (e.bindFramebuffer(t, i), this._colorAttachments.forEach((e, i) => this._framebufferTexture2D(e.glName, i, S(e), t)), this._depthStencilBuffer) {\n      const i = this._getGLAttachmentPoint(this._depthStencilBuffer.descriptor);\n      e.framebufferRenderbuffer(t, i, e.RENDERBUFFER, this._depthStencilBuffer.glName);\n    } else this._depthStencilTexture && this._framebufferTexture2D(this._depthStencilTexture.glName, e.DEPTH_STENCIL_ATTACHMENT, S(this._depthStencilTexture), t);\n    if (r()) {\n      e.checkFramebufferStatus(t) !== e.FRAMEBUFFER_COMPLETE && console.error(\"Framebuffer is incomplete!\");\n    }\n    this._glName = i, this._initialized = !0;\n  }\n  _framebufferTexture2D(t, e = n.COLOR_ATTACHMENT0, i = u.TEXTURE_2D, r = a.FRAMEBUFFER, s = 0) {\n    this._context.gl.framebufferTexture2D(r, e, i, t, s);\n  }\n  _disposeDepthStencilAttachments() {\n    const t = this._context.gl;\n    if (this._depthStencilBuffer) {\n      if (this._initialized) {\n        this._context.bindFramebuffer(this);\n        const e = this._getGLAttachmentPoint(this._depthStencilBuffer.descriptor);\n        t.framebufferRenderbuffer(a.FRAMEBUFFER, e, t.RENDERBUFFER, null);\n      }\n      this._depthStencilBuffer = e(this._depthStencilBuffer);\n    }\n    this._depthStencilTexture && (this._initialized && (this._context.bindFramebuffer(this), this._framebufferTexture2D(null, t.DEPTH_STENCIL_ATTACHMENT)), this._depthStencilTexture = e(this._depthStencilTexture));\n  }\n  _validateTextureDescriptor(t) {\n    t.target !== u.TEXTURE_2D && t.target !== u.TEXTURE_CUBE_MAP && console.error(\"Texture type must be TEXTURE_2D or TEXTURE_CUBE_MAP!\"), A(t, this._context.parameters.maxTextureSize), this._validateBufferDimensions(t);\n  }\n  _validateRenderBufferDescriptor(t) {\n    A(t, this._context.parameters.maxRenderbufferSize), this._validateBufferDimensions(t);\n  }\n  _validateBufferDimensions(t) {\n    t.width <= 0 && (t.width = this.width), t.height <= 0 && (t.height = this.height), this.width > 0 && this.height > 0 && (this.width === t.width && this.height === t.height || console.error(\"Attachment size must match framebuffer size!\"));\n  }\n  _getGLAttachmentPoint(t) {\n    switch (t.internalFormat) {\n      case l.DEPTH_COMPONENT16:\n      case l.DEPTH_COMPONENT24:\n      case l.DEPTH_COMPONENT32F:\n        return this._context.gl.DEPTH_ATTACHMENT;\n      case l.DEPTH24_STENCIL8:\n      case l.DEPTH32F_STENCIL8:\n      case l.DEPTH_STENCIL:\n        return this._context.gl.DEPTH_STENCIL_ATTACHMENT;\n      case l.STENCIL_INDEX8:\n        return this._context.gl.STENCIL_ATTACHMENT;\n    }\n  }\n  _validateColorAttachmentPoint(e) {\n    if (-1 === x._MAX_COLOR_ATTACHMENTS) {\n      const {\n        gl: t\n      } = this._context;\n      x._MAX_COLOR_ATTACHMENTS = t.getParameter(t.MAX_COLOR_ATTACHMENTS);\n    }\n    const i = e - n.COLOR_ATTACHMENT0;\n    i + 1 > x._MAX_COLOR_ATTACHMENTS && t.getLogger(\"esri.views.webgl.FrameBufferObject\").error(\"esri.FrameBufferObject\", `illegal attachment point for color attachment: ${i + 1}. Implementation supports up to ${x._MAX_COLOR_ATTACHMENTS} color attachments`);\n  }\n}\nfunction E(t) {\n  return null != t && \"type\" in t && t.type === T.Texture;\n}\nfunction g(t) {\n  return null != t && \"type\" in t && t.type === T.RenderBuffer;\n}\nfunction b(t) {\n  return E(t) || null != t && \"pixelFormat\" in t;\n}\nfunction A(t, e) {\n  const i = Math.max(t.width, t.height);\n  if (i > e) {\n    p().warn(`Resizing FBO attachment size ${t.width}x${t.height} to device limit ${e}`);\n    const r = e / i;\n    return t.width = Math.round(t.width * r), t.height = Math.round(t.height * r), !1;\n  }\n  return !0;\n}\nfunction S(t) {\n  return t.descriptor.target === u.TEXTURE_CUBE_MAP ? u.TEXTURE_CUBE_MAP_POSITIVE_X : u.TEXTURE_2D;\n}\nx._MAX_COLOR_ATTACHMENTS = -1;\nexport { x as FramebufferObject, A as ensureAttachmentMaxSize };","map":{"version":3,"names":["t","disposeMaybe","e","BufferObject","i","webglDebugEnabled","r","ResourceType","s","ColorAttachment","n","PixelFormat","h","PixelType","o","DepthStencilAttachment","c","FramebufferTarget","a","TextureType","u","Usage","_","BufferType","f","RenderbufferFormat","l","GLObjectType","T","Renderbuffer","d","Texture","m","p","getLogger","x","constructor","_context","_glName","_colorAttachments","Map","_depthStencilBuffer","_depthStencilTexture","_initialized","instanceCounter","increment","FramebufferObject","E","set","COLOR_ATTACHMENT0","_validateTextureDescriptor","descriptor","_validateColorAttachmentPoint","b","g","_validateRenderBufferDescriptor","dispose","size","getBoundFramebufferObject","forEach","detachColorTexture","detachDepthStencilBuffer","detachDepthStencilTexture","gl","deleteFramebuffer","bindFramebuffer","decrement","glName","colorTexture","get","depthStencil","depthStencilTexture","width","height","usedMemory","reduce","getColorTexture","colorAttachments","keys","attachColorTexture","_framebufferTexture2D","delete","setColorTextureTarget","attachDepthStencil","type","_attachDepthStencilTexture","RenderBuffer","_attachDepthStencilBuffer","pixelFormat","DEPTH_STENCIL","DEPTH24_STENCIL8","console","error","dataType","UNSIGNED_INT_24_8","_disposeDepthStencilAttachments","_getGLAttachmentPoint","framebufferRenderbuffer","FRAMEBUFFER","RENDERBUFFER","copyToTexture","target","TEXTURE_2D","bindTexture","TEXTURE_UNIT_FOR_UPDATES","setActiveTexture","copyTexSubImage2D","readPixels","readPixelsAsync","createPixelPack","STREAM_READ","byteLength","bindBuffer","unbindBuffer","PIXEL_PACK_BUFFER","getSubDataAsync","resize","A","parameters","maxTextureSize","maxRenderbufferSize","initializeAndBind","createFramebuffer","S","DEPTH_STENCIL_ATTACHMENT","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","framebufferTexture2D","TEXTURE_CUBE_MAP","_validateBufferDimensions","internalFormat","DEPTH_COMPONENT16","DEPTH_COMPONENT24","DEPTH_COMPONENT32F","DEPTH_ATTACHMENT","DEPTH32F_STENCIL8","STENCIL_INDEX8","STENCIL_ATTACHMENT","_MAX_COLOR_ATTACHMENTS","getParameter","MAX_COLOR_ATTACHMENTS","Math","max","warn","round","TEXTURE_CUBE_MAP_POSITIVE_X","ensureAttachmentMaxSize"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/webgl/FramebufferObject.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport\"../../core/has.js\";import t from\"../../core/Logger.js\";import{disposeMaybe as e}from\"../../core/maybe.js\";import{BufferObject as i}from\"./BufferObject.js\";import{webglDebugEnabled as r}from\"./checkWebGLError.js\";import{ResourceType as s,ColorAttachment as n,PixelFormat as h,PixelType as o,DepthStencilAttachment as c,FramebufferTarget as a,TextureType as u,Usage as _,BufferType as f,RenderbufferFormat as l}from\"./enums.js\";import{GLObjectType as T}from\"./GLObjectType.js\";import{Renderbuffer as d}from\"./Renderbuffer.js\";import{Texture as m}from\"./Texture.js\";const p=()=>t.getLogger(\"esri.views.webgl.FramebufferObject\");class x{constructor(t,e,i=null){this._context=t,this._glName=null,this._colorAttachments=new Map,this._depthStencilBuffer=null,this._depthStencilTexture=null,this._initialized=!1,t.instanceCounter.increment(s.FramebufferObject,this);const r=E(e)?e:new m(this._context,e);if(this._colorAttachments.set(n.COLOR_ATTACHMENT0,r),this._validateTextureDescriptor(r.descriptor),this._validateColorAttachmentPoint(n.COLOR_ATTACHMENT0),null!=i)if(b(i))this._depthStencilTexture=E(i)?i:new m(this._context,i),this._validateTextureDescriptor(this._depthStencilTexture.descriptor);else{const t=g(i)?i:new d(this._context,i);this._depthStencilBuffer=t,this._validateRenderBufferDescriptor(t.descriptor)}}dispose(){if(0===this._colorAttachments.size&&!this._glName)return;const t=this._context.getBoundFramebufferObject();if(this._colorAttachments.forEach(((t,e)=>this.detachColorTexture(e)?.dispose())),this.detachDepthStencilBuffer()?.dispose(),this.detachDepthStencilTexture()?.dispose(),this._glName){this._context.gl.deleteFramebuffer(this._glName),this._glName=null}this._context.bindFramebuffer(t),this._context.instanceCounter.decrement(s.FramebufferObject,this)}get glName(){return this._glName}get colorTexture(){return this._colorAttachments.get(n.COLOR_ATTACHMENT0)}get depthStencil(){return this._depthStencilTexture||this._depthStencilBuffer}get depthStencilTexture(){return this._depthStencilTexture}get width(){const t=this._colorAttachments.get(n.COLOR_ATTACHMENT0);return t?.descriptor?.width??0}get height(){const t=this._colorAttachments.get(n.COLOR_ATTACHMENT0);return t?.descriptor?.height??0}get usedMemory(){return[...this._colorAttachments].reduce(((t,[e,i])=>t+i.usedMemory),this.depthStencil?.usedMemory??0)}getColorTexture(t){const e=this._colorAttachments.get(t);return e&&E(e)?e:null}get colorAttachments(){return[...this._colorAttachments.keys()]}attachColorTexture(t,e=n.COLOR_ATTACHMENT0){if(!t)return;this._validateColorAttachmentPoint(e);const i=t.descriptor;this._validateTextureDescriptor(i),this.detachColorTexture(e)?.dispose(),this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(t.glName,e)),this._colorAttachments.set(e,t)}detachColorTexture(t=n.COLOR_ATTACHMENT0){const e=this._colorAttachments.get(t);if(e){if(this._initialized){const e=this._context.getBoundFramebufferObject();this._context.bindFramebuffer(this),this._framebufferTexture2D(null,t),this._context.bindFramebuffer(e)}return this._colorAttachments.delete(t),e}}setColorTextureTarget(t,e=n.COLOR_ATTACHMENT0){const i=this._colorAttachments.get(e);i&&this._framebufferTexture2D(i.glName,e,t)}attachDepthStencil(t){if(t)switch(t.type){case T.Texture:return this._attachDepthStencilTexture(t);case T.RenderBuffer:return this._attachDepthStencilBuffer(t)}}_attachDepthStencilTexture(t){if(null==t)return;const e=t.descriptor;e.pixelFormat!==h.DEPTH_STENCIL&&e.pixelFormat!==h.DEPTH24_STENCIL8&&console.error(\"Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!\"),e.dataType!==o.UNSIGNED_INT_24_8&&console.error(\"Depth/Stencil texture must have data type of UNSIGNED_INT_24_8!\"),this._validateTextureDescriptor(e),this._disposeDepthStencilAttachments(),this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(t.glName,c)),this._depthStencilTexture?.dispose(),this._depthStencilTexture=t}detachDepthStencilTexture(){const t=this._depthStencilTexture;if(t&&this._initialized){const t=this._context.getBoundFramebufferObject();this._context.bindFramebuffer(this),this._framebufferTexture2D(null,c),this._context.bindFramebuffer(t)}return this._depthStencilTexture=null,t}_attachDepthStencilBuffer(t){if(null==t)return;const e=t.descriptor;if(this._validateRenderBufferDescriptor(e),this._disposeDepthStencilAttachments(),this._initialized){this._context.bindFramebuffer(this);const i=this._context.gl,r=this._getGLAttachmentPoint(e);i.framebufferRenderbuffer(a.FRAMEBUFFER,r,i.RENDERBUFFER,t.glName)}this._depthStencilBuffer=t}detachDepthStencilBuffer(){const t=this._depthStencilBuffer;if(t&&this._initialized){const e=this._context.getBoundFramebufferObject();this._context.bindFramebuffer(this);const i=this._context.gl,r=this._getGLAttachmentPoint(t.descriptor);i.framebufferRenderbuffer(a.FRAMEBUFFER,r,i.RENDERBUFFER,null),this._context.bindFramebuffer(e)}return this._depthStencilBuffer=null,t}copyToTexture(t,e,i,r,s,n,h){(t<0||e<0||s<0||n<0)&&console.error(\"Offsets cannot be negative!\"),(i<=0||r<=0)&&console.error(\"Copy width and height must be greater than zero!\");const o=h.descriptor;h.descriptor.target!==u.TEXTURE_2D&&console.error(\"Texture target must be TEXTURE_2D!\"),(null==o?.width||null==o?.height||t+i>this.width||e+r>this.height||s+i>o.width||n+r>o.height)&&console.error(\"Bad dimensions, the current input values will attempt to read or copy out of bounds!\");const c=this._context,a=c.bindTexture(h,m.TEXTURE_UNIT_FOR_UPDATES);c.setActiveTexture(m.TEXTURE_UNIT_FOR_UPDATES),c.bindFramebuffer(this),c.gl.copyTexSubImage2D(u.TEXTURE_2D,0,s,n,t,e,i,r),c.bindTexture(a,m.TEXTURE_UNIT_FOR_UPDATES)}readPixels(t,e,i,r,s,n,h){(i<=0||r<=0)&&console.error(\"Copy width and height must be greater than zero!\"),h||console.error(\"Target memory is not initialized!\"),this._context.bindFramebuffer(this),this._context.gl.readPixels(t,e,i,r,s,n,h)}async readPixelsAsync(t,e,r,s,n,h,o){const{gl:c}=this._context,a=i.createPixelPack(this._context,_.STREAM_READ,o.byteLength);this._context.bindBuffer(a);const u=this._context.getBoundFramebufferObject();this._context.bindFramebuffer(this),c.readPixels(t,e,r,s,n,h,0),this._context.unbindBuffer(f.PIXEL_PACK_BUFFER),this._context.bindFramebuffer(u),await a.getSubDataAsync(o),a.dispose()}resize(t,e){if(this.width===t&&this.height===e)return;const i={width:t,height:e};A(i,this._context.parameters.maxTextureSize),this._colorAttachments.forEach((t=>t.resize(i.width,i.height))),this._depthStencilTexture?.resize(i.width,i.height),this._initialized&&(A(i,this._context.parameters.maxRenderbufferSize),this._depthStencilBuffer?.resize(i.width,i.height),this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null),this._initialized=!1)}initializeAndBind(t=a.FRAMEBUFFER){const e=this._context.gl;if(this._initialized)return void e.bindFramebuffer(t,this.glName);this._glName&&e.deleteFramebuffer(this._glName);const i=e.createFramebuffer();if(e.bindFramebuffer(t,i),this._colorAttachments.forEach(((e,i)=>this._framebufferTexture2D(e.glName,i,S(e),t))),this._depthStencilBuffer){const i=this._getGLAttachmentPoint(this._depthStencilBuffer.descriptor);e.framebufferRenderbuffer(t,i,e.RENDERBUFFER,this._depthStencilBuffer.glName)}else this._depthStencilTexture&&this._framebufferTexture2D(this._depthStencilTexture.glName,e.DEPTH_STENCIL_ATTACHMENT,S(this._depthStencilTexture),t);if(r()){e.checkFramebufferStatus(t)!==e.FRAMEBUFFER_COMPLETE&&console.error(\"Framebuffer is incomplete!\")}this._glName=i,this._initialized=!0}_framebufferTexture2D(t,e=n.COLOR_ATTACHMENT0,i=u.TEXTURE_2D,r=a.FRAMEBUFFER,s=0){this._context.gl.framebufferTexture2D(r,e,i,t,s)}_disposeDepthStencilAttachments(){const t=this._context.gl;if(this._depthStencilBuffer){if(this._initialized){this._context.bindFramebuffer(this);const e=this._getGLAttachmentPoint(this._depthStencilBuffer.descriptor);t.framebufferRenderbuffer(a.FRAMEBUFFER,e,t.RENDERBUFFER,null)}this._depthStencilBuffer=e(this._depthStencilBuffer)}this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(null,t.DEPTH_STENCIL_ATTACHMENT)),this._depthStencilTexture=e(this._depthStencilTexture))}_validateTextureDescriptor(t){t.target!==u.TEXTURE_2D&&t.target!==u.TEXTURE_CUBE_MAP&&console.error(\"Texture type must be TEXTURE_2D or TEXTURE_CUBE_MAP!\"),A(t,this._context.parameters.maxTextureSize),this._validateBufferDimensions(t)}_validateRenderBufferDescriptor(t){A(t,this._context.parameters.maxRenderbufferSize),this._validateBufferDimensions(t)}_validateBufferDimensions(t){t.width<=0&&(t.width=this.width),t.height<=0&&(t.height=this.height),this.width>0&&this.height>0&&(this.width===t.width&&this.height===t.height||console.error(\"Attachment size must match framebuffer size!\"))}_getGLAttachmentPoint(t){switch(t.internalFormat){case l.DEPTH_COMPONENT16:case l.DEPTH_COMPONENT24:case l.DEPTH_COMPONENT32F:return this._context.gl.DEPTH_ATTACHMENT;case l.DEPTH24_STENCIL8:case l.DEPTH32F_STENCIL8:case l.DEPTH_STENCIL:return this._context.gl.DEPTH_STENCIL_ATTACHMENT;case l.STENCIL_INDEX8:return this._context.gl.STENCIL_ATTACHMENT}}_validateColorAttachmentPoint(e){if(-1===x._MAX_COLOR_ATTACHMENTS){const{gl:t}=this._context;x._MAX_COLOR_ATTACHMENTS=t.getParameter(t.MAX_COLOR_ATTACHMENTS)}const i=e-n.COLOR_ATTACHMENT0;i+1>x._MAX_COLOR_ATTACHMENTS&&t.getLogger(\"esri.views.webgl.FrameBufferObject\").error(\"esri.FrameBufferObject\",`illegal attachment point for color attachment: ${i+1}. Implementation supports up to ${x._MAX_COLOR_ATTACHMENTS} color attachments`)}}function E(t){return null!=t&&\"type\"in t&&t.type===T.Texture}function g(t){return null!=t&&\"type\"in t&&t.type===T.RenderBuffer}function b(t){return E(t)||null!=t&&\"pixelFormat\"in t}function A(t,e){const i=Math.max(t.width,t.height);if(i>e){p().warn(`Resizing FBO attachment size ${t.width}x${t.height} to device limit ${e}`);const r=e/i;return t.width=Math.round(t.width*r),t.height=Math.round(t.height*r),!1}return!0}function S(t){return t.descriptor.target===u.TEXTURE_CUBE_MAP?u.TEXTURE_CUBE_MAP_POSITIVE_X:u.TEXTURE_2D}x._MAX_COLOR_ATTACHMENTS=-1;export{x as FramebufferObject,A as ensureAttachmentMaxSize};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}