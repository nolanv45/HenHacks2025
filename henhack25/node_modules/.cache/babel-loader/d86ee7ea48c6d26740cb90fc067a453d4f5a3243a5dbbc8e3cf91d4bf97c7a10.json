{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport has from \"../../../../../core/has.js\";\nimport { AttributeDataType as t, hittestToleranceMobile as e, hittestToleranceDesktop as s, hittestToleranceSmallSymbol as i, hittestSmallSymbolThreshold as o } from \"../definitions.js\";\nimport { Effect as r } from \"./Effect.js\";\nimport { PixelFormat as n, PixelType as l } from \"../../../../webgl/enums.js\";\nclass c extends r {\n  constructor() {\n    super(...arguments), this.name = this.constructor.name, this.defines = [\"hittest\"];\n  }\n  dispose() {\n    null != this._fbo && this._fbo.dispose();\n  }\n  createOptions(_ref, r) {\n    let {\n      pixelRatio: t\n    } = _ref;\n    if (!r.length) return null;\n    const n = r.shift(),\n      l = n.x,\n      c = n.y;\n    this._outstanding = n;\n    const a = has(\"esri-mobile\");\n    return {\n      type: \"hittest\",\n      distance: (a ? e : s) * t,\n      smallSymbolDistance: (a ? e : i) * t,\n      smallSymbolSizeThreshold: o,\n      position: [l, c]\n    };\n  }\n  bind(e) {\n    const {\n      context: s,\n      attributeView: i\n    } = e;\n    if (!i.size) return;\n    const o = i.getBlock(t.GPGPU);\n    if (null == o) return;\n    const r = o.getFBO(s);\n    s.setViewport(0, 0, i.size, i.size), s.bindFramebuffer(r), s.setColorMask(!0, !0, !0, !0), s.setClearColor(0, 0, 0, 0), s.clear(s.gl.COLOR_BUFFER_BIT | s.gl.DEPTH_BUFFER_BIT);\n  }\n  unbind() {}\n  draw(t) {\n    if (null == this._outstanding) return;\n    const e = this._outstanding;\n    this._outstanding = null, this._resolve(t, e.resolvers);\n  }\n  async _resolve(e, s) {\n    const {\n        context: i,\n        attributeView: o\n      } = e,\n      r = o.getBlock(t.GPGPU);\n    if (null == r) return void s.forEach(t => t.resolve([]));\n    const c = r.getFBO(i),\n      a = new Uint8Array(c.width * c.height * 4);\n    try {\n      await c.readPixelsAsync(0, 0, c.width, c.height, n.RGBA, l.UNSIGNED_BYTE, a);\n    } catch (u) {\n      return void s.forEach(t => t.resolve([]));\n    }\n    const h = [];\n    for (let t = 0; t < a.length; t += 4) {\n      const e = t / 4;\n      a[t] && h.push(e);\n    }\n    s.forEach(t => t.resolve(h));\n  }\n}\nexport { c as HittestEffect };","map":{"version":3,"names":["has","AttributeDataType","t","hittestToleranceMobile","e","hittestToleranceDesktop","s","hittestToleranceSmallSymbol","i","hittestSmallSymbolThreshold","o","Effect","r","PixelFormat","n","PixelType","l","c","constructor","arguments","name","defines","dispose","_fbo","createOptions","_ref","pixelRatio","length","shift","x","y","_outstanding","a","type","distance","smallSymbolDistance","smallSymbolSizeThreshold","position","bind","context","attributeView","size","getBlock","GPGPU","getFBO","setViewport","bindFramebuffer","setColorMask","setClearColor","clear","gl","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","unbind","draw","_resolve","resolvers","forEach","resolve","Uint8Array","width","height","readPixelsAsync","RGBA","UNSIGNED_BYTE","u","h","push","HittestEffect"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/2d/engine/webgl/effects/HittestEffect.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport has from\"../../../../../core/has.js\";import{AttributeDataType as t,hittestToleranceMobile as e,hittestToleranceDesktop as s,hittestToleranceSmallSymbol as i,hittestSmallSymbolThreshold as o}from\"../definitions.js\";import{Effect as r}from\"./Effect.js\";import{PixelFormat as n,PixelType as l}from\"../../../../webgl/enums.js\";class c extends r{constructor(){super(...arguments),this.name=this.constructor.name,this.defines=[\"hittest\"]}dispose(){null!=this._fbo&&this._fbo.dispose()}createOptions({pixelRatio:t},r){if(!r.length)return null;const n=r.shift(),l=n.x,c=n.y;this._outstanding=n;const a=has(\"esri-mobile\");return{type:\"hittest\",distance:(a?e:s)*t,smallSymbolDistance:(a?e:i)*t,smallSymbolSizeThreshold:o,position:[l,c]}}bind(e){const{context:s,attributeView:i}=e;if(!i.size)return;const o=i.getBlock(t.GPGPU);if(null==o)return;const r=o.getFBO(s);s.setViewport(0,0,i.size,i.size),s.bindFramebuffer(r),s.setColorMask(!0,!0,!0,!0),s.setClearColor(0,0,0,0),s.clear(s.gl.COLOR_BUFFER_BIT|s.gl.DEPTH_BUFFER_BIT)}unbind(){}draw(t){if(null==this._outstanding)return;const e=this._outstanding;this._outstanding=null,this._resolve(t,e.resolvers)}async _resolve(e,s){const{context:i,attributeView:o}=e,r=o.getBlock(t.GPGPU);if(null==r)return void s.forEach((t=>t.resolve([])));const c=r.getFBO(i),a=new Uint8Array(c.width*c.height*4);try{await c.readPixelsAsync(0,0,c.width,c.height,n.RGBA,l.UNSIGNED_BYTE,a)}catch(u){return void s.forEach((t=>t.resolve([])))}const h=[];for(let t=0;t<a.length;t+=4){const e=t/4;a[t]&&h.push(e)}s.forEach((t=>t.resolve(h)))}}export{c as HittestEffect};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}