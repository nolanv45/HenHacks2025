{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from \"../../../core/Error.js\";\nimport { WhereClauseCache as i } from \"../../../core/sql/WhereClauseCache.js\";\nimport { kebabDict as r } from \"../../support/fieldType.js\";\nconst s = new i(50, 500),\n  t = \"unsupported-query\",\n  n = \" as \",\n  o = new Set([\"esriFieldTypeOID\", \"esriFieldTypeSmallInteger\", \"esriFieldTypeBigInteger\", \"esriFieldTypeInteger\", \"esriFieldTypeSingle\", \"esriFieldTypeDouble\", \"esriFieldTypeLong\"]),\n  a = new Set([\"esriFieldTypeDate\", \"esriFieldTypeDateOnly\", \"esriFieldTypeTimeOnly\", \"esriFieldTypeTimestampOffset\"]),\n  l = new Set([\"esriFieldTypeString\", \"esriFieldTypeGUID\", \"esriFieldTypeGlobalID\", ...o, ...a]);\nfunction d(i, r) {\n  let n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  const o = c(r, i);\n  if (!o) {\n    const n = s.getError(r, i);\n    throw new e(t, \"invalid SQL expression\", {\n      expression: r,\n      error: n\n    });\n  }\n  const a = n.expressionName || \"expression\";\n  if (n.validateStandardized && !o.isStandardized) throw new e(t, `${a} is not standard`, {\n    expression: r\n  });\n  if (n.validateAggregate && !o.isAggregate) throw new e(t, `${a} does not contain a valid aggregate function`, {\n    expression: r\n  });\n  return o.fieldNames;\n}\nfunction p(e, i, r, s) {\n  if (!r) return !0;\n  const t = \"where clause\";\n  return g(e, i, d(e, r, {\n    validateStandardized: !0,\n    expressionName: t\n  }), {\n    expressionName: t,\n    query: s\n  }), !0;\n}\nfunction f(i, r, s, n, o) {\n  if (!s) return !0;\n  const a = \"having clause\",\n    l = d(i, s, {\n      validateAggregate: !0,\n      expressionName: a\n    });\n  g(i, r, l, {\n    expressionName: a,\n    query: o\n  });\n  const p = c(s, i),\n    f = p?.getExpressions().every(e => {\n      const {\n          aggregateType: r,\n          field: s\n        } = e,\n        t = i.get(s)?.name;\n      return n.some(e => {\n        const {\n            onStatisticField: s,\n            statisticType: n\n          } = e,\n          o = i.get(s)?.name;\n        return o === t && n.toLowerCase().trim() === r;\n      });\n    });\n  if (!f) throw new e(t, \"expressions in having clause should also exist in outStatistics\", {\n    having: s\n  });\n  return !0;\n}\nfunction c(e, i) {\n  return e ? s.get(e, i) : null;\n}\nfunction u(e) {\n  return /\\((.*?)\\)/.test(e) ? e : e.split(n)[0];\n}\nfunction y(e) {\n  return e.split(n)[1];\n}\nfunction g(i, r, s) {\n  let n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  const o = new Map();\n  if (m(o, i, r, n.allowedFieldTypes ?? l, s), o.size) {\n    const i = n.expressionName ?? \"expression\";\n    throw new e(t, `${i} contains invalid or missing fields`, {\n      errors: Array.from(o.values()),\n      query: n.query\n    });\n  }\n}\nfunction m(e, i, r, s, t) {\n  const n = t.includes(\"*\") ? [...r, ...t.filter(e => \"*\" !== e)] : t;\n  for (const a of n) {\n    if (i.get(a)) T(e, i, r, s, a);else try {\n      const t = d(i, u(a), {\n        validateStandardized: !0\n      });\n      for (const n of t) T(e, i, r, s, n);\n    } catch (o) {\n      e.set(a, {\n        type: \"expression-error\",\n        expression: a,\n        error: o\n      });\n    }\n  }\n}\nfunction T(e, i, s, t, n) {\n  const o = i.get(n);\n  o ? s.has(o.name) ? \"all\" !== t && !1 === t?.has(o.type) && e.set(n, {\n    type: \"invalid-type\",\n    fieldName: o.name,\n    fieldType: r.fromJSON(o.type),\n    allowedFieldTypes: Array.from(t, e => r.fromJSON(e))\n  }) : e.set(n, {\n    type: \"missing-field\",\n    fieldName: o.name\n  }) : e.set(n, {\n    type: \"invalid-field\",\n    fieldName: n\n  });\n}\nexport { a as allDateAndTimeFieldTypes, y as getAliasFromFieldName, u as getExpressionFromFieldName, c as getWhereClause, o as numericFieldTypes, g as validateFields, f as validateHaving, p as validateWhere };","map":{"version":3,"names":["e","WhereClauseCache","i","kebabDict","r","s","t","n","o","Set","a","l","d","arguments","length","undefined","c","getError","expression","error","expressionName","validateStandardized","isStandardized","validateAggregate","isAggregate","fieldNames","p","g","query","f","getExpressions","every","aggregateType","field","get","name","some","onStatisticField","statisticType","toLowerCase","trim","having","u","test","split","y","Map","m","allowedFieldTypes","size","errors","Array","from","values","includes","filter","T","set","type","has","fieldName","fieldType","fromJSON","allDateAndTimeFieldTypes","getAliasFromFieldName","getExpressionFromFieldName","getWhereClause","numericFieldTypes","validateFields","validateHaving","validateWhere"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/layers/graphics/data/attributeSupport.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Error.js\";import{WhereClauseCache as i}from\"../../../core/sql/WhereClauseCache.js\";import{kebabDict as r}from\"../../support/fieldType.js\";const s=new i(50,500),t=\"unsupported-query\",n=\" as \",o=new Set([\"esriFieldTypeOID\",\"esriFieldTypeSmallInteger\",\"esriFieldTypeBigInteger\",\"esriFieldTypeInteger\",\"esriFieldTypeSingle\",\"esriFieldTypeDouble\",\"esriFieldTypeLong\"]),a=new Set([\"esriFieldTypeDate\",\"esriFieldTypeDateOnly\",\"esriFieldTypeTimeOnly\",\"esriFieldTypeTimestampOffset\"]),l=new Set([\"esriFieldTypeString\",\"esriFieldTypeGUID\",\"esriFieldTypeGlobalID\",...o,...a]);function d(i,r,n={}){const o=c(r,i);if(!o){const n=s.getError(r,i);throw new e(t,\"invalid SQL expression\",{expression:r,error:n})}const a=n.expressionName||\"expression\";if(n.validateStandardized&&!o.isStandardized)throw new e(t,`${a} is not standard`,{expression:r});if(n.validateAggregate&&!o.isAggregate)throw new e(t,`${a} does not contain a valid aggregate function`,{expression:r});return o.fieldNames}function p(e,i,r,s){if(!r)return!0;const t=\"where clause\";return g(e,i,d(e,r,{validateStandardized:!0,expressionName:t}),{expressionName:t,query:s}),!0}function f(i,r,s,n,o){if(!s)return!0;const a=\"having clause\",l=d(i,s,{validateAggregate:!0,expressionName:a});g(i,r,l,{expressionName:a,query:o});const p=c(s,i),f=p?.getExpressions().every((e=>{const{aggregateType:r,field:s}=e,t=i.get(s)?.name;return n.some((e=>{const{onStatisticField:s,statisticType:n}=e,o=i.get(s)?.name;return o===t&&n.toLowerCase().trim()===r}))}));if(!f)throw new e(t,\"expressions in having clause should also exist in outStatistics\",{having:s});return!0}function c(e,i){return e?s.get(e,i):null}function u(e){return/\\((.*?)\\)/.test(e)?e:e.split(n)[0]}function y(e){return e.split(n)[1]}function g(i,r,s,n={}){const o=new Map;if(m(o,i,r,n.allowedFieldTypes??l,s),o.size){const i=n.expressionName??\"expression\";throw new e(t,`${i} contains invalid or missing fields`,{errors:Array.from(o.values()),query:n.query})}}function m(e,i,r,s,t){const n=t.includes(\"*\")?[...r,...t.filter((e=>\"*\"!==e))]:t;for(const a of n){if(i.get(a))T(e,i,r,s,a);else try{const t=d(i,u(a),{validateStandardized:!0});for(const n of t)T(e,i,r,s,n)}catch(o){e.set(a,{type:\"expression-error\",expression:a,error:o})}}}function T(e,i,s,t,n){const o=i.get(n);o?s.has(o.name)?\"all\"!==t&&!1===t?.has(o.type)&&e.set(n,{type:\"invalid-type\",fieldName:o.name,fieldType:r.fromJSON(o.type),allowedFieldTypes:Array.from(t,(e=>r.fromJSON(e)))}):e.set(n,{type:\"missing-field\",fieldName:o.name}):e.set(n,{type:\"invalid-field\",fieldName:n})}export{a as allDateAndTimeFieldTypes,y as getAliasFromFieldName,u as getExpressionFromFieldName,c as getWhereClause,o as numericFieldTypes,g as validateFields,f as validateHaving,p as validateWhere};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}