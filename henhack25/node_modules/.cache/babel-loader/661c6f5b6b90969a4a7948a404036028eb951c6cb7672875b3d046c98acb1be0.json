{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { ForwardLinearDepth as e } from \"../views/3d/webgl-engine/core/shaderLibrary/ForwardLinearDepth.glsl.js\";\nimport { Offset as r } from \"../views/3d/webgl-engine/core/shaderLibrary/Offset.glsl.js\";\nimport { isColorOrColorEmission as o } from \"../views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js\";\nimport { SliceDraw as i } from \"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";\nimport { Transform as a } from \"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";\nimport { InstancedDoublePrecision as l } from \"../views/3d/webgl-engine/core/shaderLibrary/attributes/InstancedDoublePrecision.glsl.js\";\nimport { NormalAttribute as s, NormalType as n } from \"../views/3d/webgl-engine/core/shaderLibrary/attributes/NormalAttribute.glsl.js\";\nimport { PositionAttribute as t } from \"../views/3d/webgl-engine/core/shaderLibrary/attributes/PositionAttribute.glsl.js\";\nimport { SymbolColor as d } from \"../views/3d/webgl-engine/core/shaderLibrary/attributes/SymbolColor.glsl.js\";\nimport { TextureCoordinateAttribute as c } from \"../views/3d/webgl-engine/core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl.js\";\nimport { VertexColor as m } from \"../views/3d/webgl-engine/core/shaderLibrary/attributes/VertexColor.glsl.js\";\nimport { VertexNormal as g } from \"../views/3d/webgl-engine/core/shaderLibrary/attributes/VertexNormal.glsl.js\";\nimport { VerticalOffset as v } from \"../views/3d/webgl-engine/core/shaderLibrary/attributes/VerticalOffset.glsl.js\";\nimport { DefaultMaterialAuxiliaryPasses as u } from \"../views/3d/webgl-engine/core/shaderLibrary/default/DefaultMaterialAuxiliaryPasses.glsl.js\";\nimport { ComputeNormalTexture as b } from \"../views/3d/webgl-engine/core/shaderLibrary/shading/ComputeNormalTexture.glsl.js\";\nimport { EvaluateAmbientOcclusion as w } from \"../views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateAmbientOcclusion.glsl.js\";\nimport { EvaluateSceneLighting as h, addAmbientBoostFactor as p, addLightingGlobalFactor as f } from \"../views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateSceneLighting.glsl.js\";\nimport { addMainLightIntensity as x } from \"../views/3d/webgl-engine/core/shaderLibrary/shading/MainLighting.glsl.js\";\nimport { Normals as y } from \"../views/3d/webgl-engine/core/shaderLibrary/shading/Normals.glsl.js\";\nimport { PhysicallyBasedRendering as L } from \"../views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRendering.glsl.js\";\nimport { PhysicallyBasedRenderingParameters as C, PBRMode as j } from \"../views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl.js\";\nimport { ReadShadowMapPass as P, ReadShadowMapDraw as O } from \"../views/3d/webgl-engine/core/shaderLibrary/shading/ReadShadowMap.glsl.js\";\nimport { terrainDepthTest as N } from \"../views/3d/webgl-engine/core/shaderLibrary/shading/TerrainDepthTest.glsl.js\";\nimport { colorTextureUV as S, normalTextureUV as T, emissiveTextureUV as A, occlusionTextureUV as V, metallicRoughnessTextureUV as M } from \"../views/3d/webgl-engine/core/shaderLibrary/shading/TextureTransformUV.glsl.js\";\nimport { VisualVariables as $ } from \"../views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl.js\";\nimport { DiscardOrAdjustAlphaPass as D } from \"../views/3d/webgl-engine/core/shaderLibrary/util/DiscardOrAdjustAlpha.glsl.js\";\nimport { MixExternalColor as E } from \"../views/3d/webgl-engine/core/shaderLibrary/util/MixExternalColor.glsl.js\";\nimport { addProjViewLocalOrigin as U, addCameraPosition as B } from \"../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js\";\nimport { Float3PassUniform as I } from \"../views/3d/webgl-engine/core/shaderModules/Float3PassUniform.js\";\nimport { Float4PassUniform as F } from \"../views/3d/webgl-engine/core/shaderModules/Float4PassUniform.js\";\nimport { FloatPassUniform as _ } from \"../views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js\";\nimport { glsl as R, If as z } from \"../views/3d/webgl-engine/core/shaderModules/glsl.js\";\nimport { Texture2DPassUniform as G } from \"../views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js\";\nimport { VertexAttribute as W } from \"../views/3d/webgl-engine/lib/VertexAttribute.js\";\nimport { outputColorHighlightOID as k } from \"../views/3d/webgl-engine/shaders/OutputColorHighlightOID.glsl.js\";\nimport { ShaderBuilder as H } from \"../views/webgl/ShaderBuilder.js\";\nimport { alphaCutoff as q } from \"../webscene/support/AlphaCutoff.js\";\nfunction J(J) {\n  const K = new H(),\n    {\n      vertex: Q,\n      fragment: X,\n      varyings: Y\n    } = K,\n    {\n      output: Z,\n      normalType: ee,\n      offsetBackfaces: re,\n      instancedColor: oe,\n      spherical: ie,\n      receiveShadows: ae,\n      snowCover: le,\n      pbrMode: se,\n      textureAlphaPremultiplied: ne,\n      instancedDoublePrecision: te,\n      hasVertexColors: de,\n      hasVertexTangents: ce,\n      hasColorTexture: me,\n      hasNormalTexture: ge,\n      hasNormalTextureTransform: ve,\n      hasColorTextureTransform: ue\n    } = J;\n  if (U(Q, J), K.include(t), Y.add(\"vpos\", \"vec3\"), K.include($, J), K.include(l, J), K.include(v, J), K.include(S, J), !o(Z)) return K.include(u, J), K;\n  K.include(T, J), K.include(A, J), K.include(V, J), K.include(M, J), B(Q, J), K.include(s, J), K.include(a, J);\n  const be = ee === n.Attribute || ee === n.Compressed;\n  return be && re && K.include(r), K.include(b, J), K.include(g, J), oe && K.attributes.add(W.INSTANCECOLOR, \"vec4\"), Y.add(\"vPositionLocal\", \"vec3\"), K.include(c, J), K.include(e, J), K.include(d, J), K.include(m, J), Q.uniforms.add(new F(\"externalColor\", e => e.externalColor)), Y.add(\"vcolorExt\", \"vec4\"), K.include(N, J), Q.main.add(R`\n    forwardNormalizedVertexColor();\n    vcolorExt = externalColor;\n    ${z(oe, \"vcolorExt *= instanceColor * 0.003921568627451;\")}\n    vcolorExt *= vvColor();\n    vcolorExt *= getSymbolColor();\n    forwardColorMixMode();\n\n    vpos = getVertexInLocalOriginSpace();\n    vPositionLocal = vpos - view[3].xyz;\n    vpos = subtractOrigin(vpos);\n    ${z(be, \"vNormalWorld = dpNormal(vvLocalNormal(normalModel()));\")}\n    vpos = addVerticalOffset(vpos, localOrigin);\n    ${z(ce, \"vTangent = dpTransformVertexTangent(tangent);\")}\n    gl_Position = transformPosition(proj, view, vpos);\n    ${z(be && re, \"gl_Position = offsetBackfacingClipPosition(gl_Position, vpos, vNormalWorld, cameraPosition);\")}\n\n    forwardViewPosDepth((view * vec4(vpos, 1.0)).xyz);\n    forwardLinearDepth();\n    forwardTextureCoordinates();\n    forwardColorUV();\n    forwardNormalUV();\n    forwardEmissiveUV();\n    forwardOcclusionUV();\n    forwardMetallicRoughnessUV();\n\n    if (vcolorExt.a < ${R.float(q)}) {\n      gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n    }\n  `), K.include(h, J), K.include(w, J), K.include(D, J), K.include(te ? P : O, J), K.fragment.include(i, J), K.include(k, J), B(X, J), X.uniforms.add(Q.uniforms.get(\"localOrigin\"), new I(\"ambient\", e => e.ambient), new I(\"diffuse\", e => e.diffuse), new _(\"opacity\", e => e.opacity), new _(\"layerOpacity\", e => e.layerOpacity)), me && X.uniforms.add(new G(\"tex\", e => e.texture)), K.include(C, J), K.include(L, J), X.include(E), K.include(y, J), p(X), f(X), x(X), X.main.add(R`\n    discardBySlice(vpos);\n    discardByTerrainDepth();\n    ${me ? R`\n            vec4 texColor = texture(tex, ${ue ? \"colorUV\" : \"vuv0\"});\n            ${z(ne, \"texColor.rgb /= texColor.a;\")}\n            discardOrAdjustAlpha(texColor);` : R`vec4 texColor = vec4(1.0);`}\n    shadingParams.viewDirection = normalize(vpos - cameraPosition);\n    ${ee === n.ScreenDerivative ? R`vec3 normal = screenDerivativeNormal(vPositionLocal);` : R`shadingParams.normalView = vNormalWorld;\n                vec3 normal = shadingNormal(shadingParams);`}\n    applyPBRFactors();\n    float ssao = evaluateAmbientOcclusionInverse() * getBakedOcclusion();\n\n    vec3 posWorld = vpos + localOrigin;\n\n      float additionalAmbientScale = additionalDirectedAmbientLight(posWorld);\n      float shadow = ${ae ? \"max(lightingGlobalFactor * (1.0 - additionalAmbientScale), readShadowMap(vpos, linearDepth))\" : z(ie, \"lightingGlobalFactor * (1.0 - additionalAmbientScale)\", \"0.0\")};\n\n    vec3 matColor = max(ambient, diffuse);\n    vec3 albedo = mixExternalColor(${z(de, \"vColor.rgb *\")} matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n    float opacity_ = layerOpacity * mixExternalOpacity(${z(de, \"vColor.a * \")} opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n    ${ge ? `mat3 tangentSpace = computeTangentSpace(${ce ? \"normal\" : \"normal, vpos, vuv0\"});\\n            vec3 shadingNormal = computeTextureNormal(tangentSpace, ${ve ? \"normalUV\" : \"vuv0\"});` : \"vec3 shadingNormal = normal;\"}\n    vec3 normalGround = ${ie ? \"normalize(posWorld);\" : \"vec3(0.0, 0.0, 1.0);\"}\n\n    ${z(le, R`\n          float snow = smoothstep(0.5, 0.55, dot(normal, normalGround));\n          albedo = mix(albedo, vec3(1), snow);\n          shadingNormal = mix(shadingNormal, normal, snow);\n          ssao = mix(ssao, 1.0, snow);`)}\n\n    vec3 additionalLight = ssao * mainLightIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n\n    ${se === j.Normal || se === j.Schematic ? R`\n            float additionalAmbientIrradiance = additionalAmbientIrradianceFactor * mainLightIntensity[2];\n            ${z(le, R`mrr = mix(mrr, vec3(0.0, 1.0, 0.04), snow);`)}\n            vec4 emission = ${le ? \"mix(getEmissions(), vec4(0.0), snow)\" : \"getEmissions()\"};\n            vec3 shadedColor = evaluateSceneLightingPBR(shadingNormal, albedo, shadow, 1.0 - ssao, additionalLight, shadingParams.viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);` : R`vec3 shadedColor = evaluateSceneLighting(shadingNormal, albedo, shadow, 1.0 - ssao, additionalLight);`}\n    vec4 finalColor = vec4(shadedColor, opacity_);\n    outputColorHighlightOID(finalColor, vpos);\n  `), K;\n}\nconst K = Object.freeze(Object.defineProperty({\n  __proto__: null,\n  build: J\n}, Symbol.toStringTag, {\n  value: \"Module\"\n}));\nexport { K as D, J as b };","map":{"version":3,"names":["ForwardLinearDepth","e","Offset","r","isColorOrColorEmission","o","SliceDraw","i","Transform","a","InstancedDoublePrecision","l","NormalAttribute","s","NormalType","n","PositionAttribute","t","SymbolColor","d","TextureCoordinateAttribute","c","VertexColor","m","VertexNormal","g","VerticalOffset","v","DefaultMaterialAuxiliaryPasses","u","ComputeNormalTexture","b","EvaluateAmbientOcclusion","w","EvaluateSceneLighting","h","addAmbientBoostFactor","p","addLightingGlobalFactor","f","addMainLightIntensity","x","Normals","y","PhysicallyBasedRendering","L","PhysicallyBasedRenderingParameters","C","PBRMode","j","ReadShadowMapPass","P","ReadShadowMapDraw","O","terrainDepthTest","N","colorTextureUV","S","normalTextureUV","T","emissiveTextureUV","A","occlusionTextureUV","V","metallicRoughnessTextureUV","M","VisualVariables","$","DiscardOrAdjustAlphaPass","D","MixExternalColor","E","addProjViewLocalOrigin","U","addCameraPosition","B","Float3PassUniform","I","Float4PassUniform","F","FloatPassUniform","_","glsl","R","If","z","Texture2DPassUniform","G","VertexAttribute","W","outputColorHighlightOID","k","ShaderBuilder","H","alphaCutoff","q","J","K","vertex","Q","fragment","X","varyings","Y","output","Z","normalType","ee","offsetBackfaces","re","instancedColor","oe","spherical","ie","receiveShadows","ae","snowCover","le","pbrMode","se","textureAlphaPremultiplied","ne","instancedDoublePrecision","te","hasVertexColors","de","hasVertexTangents","ce","hasColorTexture","me","hasNormalTexture","ge","hasNormalTextureTransform","ve","hasColorTextureTransform","ue","include","add","be","Attribute","Compressed","attributes","INSTANCECOLOR","uniforms","externalColor","main","float","get","ambient","diffuse","opacity","layerOpacity","texture","ScreenDerivative","Normal","Schematic","Object","freeze","defineProperty","__proto__","build","Symbol","toStringTag","value"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/chunks/DefaultMaterial.glsl.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{ForwardLinearDepth as e}from\"../views/3d/webgl-engine/core/shaderLibrary/ForwardLinearDepth.glsl.js\";import{Offset as r}from\"../views/3d/webgl-engine/core/shaderLibrary/Offset.glsl.js\";import{isColorOrColorEmission as o}from\"../views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js\";import{SliceDraw as i}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as a}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{InstancedDoublePrecision as l}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/InstancedDoublePrecision.glsl.js\";import{NormalAttribute as s,NormalType as n}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/NormalAttribute.glsl.js\";import{PositionAttribute as t}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/PositionAttribute.glsl.js\";import{SymbolColor as d}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/SymbolColor.glsl.js\";import{TextureCoordinateAttribute as c}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl.js\";import{VertexColor as m}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/VertexColor.glsl.js\";import{VertexNormal as g}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/VertexNormal.glsl.js\";import{VerticalOffset as v}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/VerticalOffset.glsl.js\";import{DefaultMaterialAuxiliaryPasses as u}from\"../views/3d/webgl-engine/core/shaderLibrary/default/DefaultMaterialAuxiliaryPasses.glsl.js\";import{ComputeNormalTexture as b}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/ComputeNormalTexture.glsl.js\";import{EvaluateAmbientOcclusion as w}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateAmbientOcclusion.glsl.js\";import{EvaluateSceneLighting as h,addAmbientBoostFactor as p,addLightingGlobalFactor as f}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateSceneLighting.glsl.js\";import{addMainLightIntensity as x}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MainLighting.glsl.js\";import{Normals as y}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/Normals.glsl.js\";import{PhysicallyBasedRendering as L}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRendering.glsl.js\";import{PhysicallyBasedRenderingParameters as C,PBRMode as j}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl.js\";import{ReadShadowMapPass as P,ReadShadowMapDraw as O}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/ReadShadowMap.glsl.js\";import{terrainDepthTest as N}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/TerrainDepthTest.glsl.js\";import{colorTextureUV as S,normalTextureUV as T,emissiveTextureUV as A,occlusionTextureUV as V,metallicRoughnessTextureUV as M}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/TextureTransformUV.glsl.js\";import{VisualVariables as $}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl.js\";import{DiscardOrAdjustAlphaPass as D}from\"../views/3d/webgl-engine/core/shaderLibrary/util/DiscardOrAdjustAlpha.glsl.js\";import{MixExternalColor as E}from\"../views/3d/webgl-engine/core/shaderLibrary/util/MixExternalColor.glsl.js\";import{addProjViewLocalOrigin as U,addCameraPosition as B}from\"../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js\";import{Float3PassUniform as I}from\"../views/3d/webgl-engine/core/shaderModules/Float3PassUniform.js\";import{Float4PassUniform as F}from\"../views/3d/webgl-engine/core/shaderModules/Float4PassUniform.js\";import{FloatPassUniform as _}from\"../views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js\";import{glsl as R,If as z}from\"../views/3d/webgl-engine/core/shaderModules/glsl.js\";import{Texture2DPassUniform as G}from\"../views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js\";import{VertexAttribute as W}from\"../views/3d/webgl-engine/lib/VertexAttribute.js\";import{outputColorHighlightOID as k}from\"../views/3d/webgl-engine/shaders/OutputColorHighlightOID.glsl.js\";import{ShaderBuilder as H}from\"../views/webgl/ShaderBuilder.js\";import{alphaCutoff as q}from\"../webscene/support/AlphaCutoff.js\";function J(J){const K=new H,{vertex:Q,fragment:X,varyings:Y}=K,{output:Z,normalType:ee,offsetBackfaces:re,instancedColor:oe,spherical:ie,receiveShadows:ae,snowCover:le,pbrMode:se,textureAlphaPremultiplied:ne,instancedDoublePrecision:te,hasVertexColors:de,hasVertexTangents:ce,hasColorTexture:me,hasNormalTexture:ge,hasNormalTextureTransform:ve,hasColorTextureTransform:ue}=J;if(U(Q,J),K.include(t),Y.add(\"vpos\",\"vec3\"),K.include($,J),K.include(l,J),K.include(v,J),K.include(S,J),!o(Z))return K.include(u,J),K;K.include(T,J),K.include(A,J),K.include(V,J),K.include(M,J),B(Q,J),K.include(s,J),K.include(a,J);const be=ee===n.Attribute||ee===n.Compressed;return be&&re&&K.include(r),K.include(b,J),K.include(g,J),oe&&K.attributes.add(W.INSTANCECOLOR,\"vec4\"),Y.add(\"vPositionLocal\",\"vec3\"),K.include(c,J),K.include(e,J),K.include(d,J),K.include(m,J),Q.uniforms.add(new F(\"externalColor\",(e=>e.externalColor))),Y.add(\"vcolorExt\",\"vec4\"),K.include(N,J),Q.main.add(R`\n    forwardNormalizedVertexColor();\n    vcolorExt = externalColor;\n    ${z(oe,\"vcolorExt *= instanceColor * 0.003921568627451;\")}\n    vcolorExt *= vvColor();\n    vcolorExt *= getSymbolColor();\n    forwardColorMixMode();\n\n    vpos = getVertexInLocalOriginSpace();\n    vPositionLocal = vpos - view[3].xyz;\n    vpos = subtractOrigin(vpos);\n    ${z(be,\"vNormalWorld = dpNormal(vvLocalNormal(normalModel()));\")}\n    vpos = addVerticalOffset(vpos, localOrigin);\n    ${z(ce,\"vTangent = dpTransformVertexTangent(tangent);\")}\n    gl_Position = transformPosition(proj, view, vpos);\n    ${z(be&&re,\"gl_Position = offsetBackfacingClipPosition(gl_Position, vpos, vNormalWorld, cameraPosition);\")}\n\n    forwardViewPosDepth((view * vec4(vpos, 1.0)).xyz);\n    forwardLinearDepth();\n    forwardTextureCoordinates();\n    forwardColorUV();\n    forwardNormalUV();\n    forwardEmissiveUV();\n    forwardOcclusionUV();\n    forwardMetallicRoughnessUV();\n\n    if (vcolorExt.a < ${R.float(q)}) {\n      gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n    }\n  `),K.include(h,J),K.include(w,J),K.include(D,J),K.include(te?P:O,J),K.fragment.include(i,J),K.include(k,J),B(X,J),X.uniforms.add(Q.uniforms.get(\"localOrigin\"),new I(\"ambient\",(e=>e.ambient)),new I(\"diffuse\",(e=>e.diffuse)),new _(\"opacity\",(e=>e.opacity)),new _(\"layerOpacity\",(e=>e.layerOpacity))),me&&X.uniforms.add(new G(\"tex\",(e=>e.texture))),K.include(C,J),K.include(L,J),X.include(E),K.include(y,J),p(X),f(X),x(X),X.main.add(R`\n    discardBySlice(vpos);\n    discardByTerrainDepth();\n    ${me?R`\n            vec4 texColor = texture(tex, ${ue?\"colorUV\":\"vuv0\"});\n            ${z(ne,\"texColor.rgb /= texColor.a;\")}\n            discardOrAdjustAlpha(texColor);`:R`vec4 texColor = vec4(1.0);`}\n    shadingParams.viewDirection = normalize(vpos - cameraPosition);\n    ${ee===n.ScreenDerivative?R`vec3 normal = screenDerivativeNormal(vPositionLocal);`:R`shadingParams.normalView = vNormalWorld;\n                vec3 normal = shadingNormal(shadingParams);`}\n    applyPBRFactors();\n    float ssao = evaluateAmbientOcclusionInverse() * getBakedOcclusion();\n\n    vec3 posWorld = vpos + localOrigin;\n\n      float additionalAmbientScale = additionalDirectedAmbientLight(posWorld);\n      float shadow = ${ae?\"max(lightingGlobalFactor * (1.0 - additionalAmbientScale), readShadowMap(vpos, linearDepth))\":z(ie,\"lightingGlobalFactor * (1.0 - additionalAmbientScale)\",\"0.0\")};\n\n    vec3 matColor = max(ambient, diffuse);\n    vec3 albedo = mixExternalColor(${z(de,\"vColor.rgb *\")} matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n    float opacity_ = layerOpacity * mixExternalOpacity(${z(de,\"vColor.a * \")} opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n    ${ge?`mat3 tangentSpace = computeTangentSpace(${ce?\"normal\":\"normal, vpos, vuv0\"});\\n            vec3 shadingNormal = computeTextureNormal(tangentSpace, ${ve?\"normalUV\":\"vuv0\"});`:\"vec3 shadingNormal = normal;\"}\n    vec3 normalGround = ${ie?\"normalize(posWorld);\":\"vec3(0.0, 0.0, 1.0);\"}\n\n    ${z(le,R`\n          float snow = smoothstep(0.5, 0.55, dot(normal, normalGround));\n          albedo = mix(albedo, vec3(1), snow);\n          shadingNormal = mix(shadingNormal, normal, snow);\n          ssao = mix(ssao, 1.0, snow);`)}\n\n    vec3 additionalLight = ssao * mainLightIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n\n    ${se===j.Normal||se===j.Schematic?R`\n            float additionalAmbientIrradiance = additionalAmbientIrradianceFactor * mainLightIntensity[2];\n            ${z(le,R`mrr = mix(mrr, vec3(0.0, 1.0, 0.04), snow);`)}\n            vec4 emission = ${le?\"mix(getEmissions(), vec4(0.0), snow)\":\"getEmissions()\"};\n            vec3 shadedColor = evaluateSceneLightingPBR(shadingNormal, albedo, shadow, 1.0 - ssao, additionalLight, shadingParams.viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);`:R`vec3 shadedColor = evaluateSceneLighting(shadingNormal, albedo, shadow, 1.0 - ssao, additionalLight);`}\n    vec4 finalColor = vec4(shadedColor, opacity_);\n    outputColorHighlightOID(finalColor, vpos);\n  `),K}const K=Object.freeze(Object.defineProperty({__proto__:null,build:J},Symbol.toStringTag,{value:\"Module\"}));export{K as D,J as b};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}