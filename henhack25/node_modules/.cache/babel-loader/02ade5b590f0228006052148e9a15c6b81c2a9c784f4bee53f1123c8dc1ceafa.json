{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../../chunks/tslib.es6.js\";\nimport { property as s } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/Logger.js\";\nimport \"../../../core/RandomLCG.js\";\nimport { subclass as e } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { isIntegerPixelType as o } from \"../rasterFormats/pixelRangeUtils.js\";\nimport r from \"./BaseRasterFunction.js\";\nimport { lookupPixels as u } from \"./pixelUtils.js\";\nimport i from \"./StretchFunctionArguments.js\";\nimport { getStretchCutoff as n, createStretchLUT as p, stretch as a, computeGammaCorrection as m } from \"./stretchUtils.js\";\nlet c = class extends r {\n  constructor() {\n    super(...arguments), this.functionName = \"Stretch\", this.functionArguments = null, this.rasterArgumentNames = [\"raster\"], this.lookup = null, this.cutOffs = null;\n  }\n  _bindSourceRasters() {\n    this.lookup = null, this.cutOffs = null;\n    const t = this.sourceRasterInfos[0],\n      {\n        pixelType: s\n      } = t,\n      {\n        functionArguments: e\n      } = this,\n      {\n        dynamicRangeAdjustment: r,\n        gamma: u,\n        useGamma: i\n      } = e;\n    if (!r && [\"u8\", \"u16\", \"s8\", \"s16\"].includes(s)) {\n      const r = n(e.toJSON(), {\n          rasterInfo: t\n        }),\n        a = o(this.outputPixelType) ? \"round\" : \"float\";\n      this.lookup = p({\n        pixelType: s,\n        ...r,\n        gamma: i ? u : null,\n        rounding: a\n      }), this.cutOffs = r;\n    } else r || (this.cutOffs = n(e.toJSON(), {\n      rasterInfo: t\n    }));\n    this.outputPixelType = this._getOutputPixelType(s);\n    const a = t.clone();\n    a.pixelType = this.outputPixelType, this._removeStatsHistColormapVAT(a), \"u8\" === this.outputPixelType && (a.keyProperties.DataType = \"processed\");\n    const {\n      outputMin: m = 0,\n      outputMax: c = 255\n    } = this.functionArguments;\n    a.statistics = [];\n    for (let o = 0; o < a.bandCount; o++) a.statistics[o] = {\n      min: m,\n      max: c\n    };\n    this.rasterInfo = a;\n    return {\n      success: !0,\n      supportsGPU: !r\n    };\n  }\n  _processPixels(t) {\n    const s = t.pixelBlocks?.[0];\n    if (null == s) return s;\n    const {\n      lookup: e\n    } = this;\n    if (e) return u(s, {\n      ...e,\n      outputPixelType: this.rasterInfo.pixelType\n    });\n    const {\n        functionArguments: o\n      } = this,\n      r = this.cutOffs || n(o.toJSON(), {\n        rasterInfo: this.sourceRasterInfos[0],\n        pixelBlock: s\n      }),\n      i = o.useGamma ? o.gamma : null;\n    return a(s, {\n      ...r,\n      gamma: i,\n      outputPixelType: this.outputPixelType\n    });\n  }\n  _getWebGLParameters() {\n    const {\n        outputMin: t = 0,\n        outputMax: s = 255,\n        gamma: e,\n        useGamma: r\n      } = this.functionArguments,\n      u = this.rasterInfo.bandCount >= 2 ? 3 : 1,\n      i = r && e?.length ? m(u, e) : [1, 1, 1],\n      {\n        minCutOff: n,\n        maxCutOff: p\n      } = this.cutOffs ?? {\n        minCutOff: [0, 0, 0],\n        maxCutOff: [255, 255, 255]\n      };\n    1 === n.length && (n[1] = n[2] = n[0], p[1] = p[2] = p[0]);\n    const a = p.map((e, o) => (s - t) / (p[o] - n[o])),\n      c = o(this.outputPixelType),\n      f = r && e ? [e[0], e[1] ?? e[0], e[2] ?? e[0]] : [1, 1, 1],\n      l = r ? [i[0], i[1] ?? i[0], i[2] ?? i[0]] : [1, 1, 1];\n    return {\n      bandCount: u,\n      minOutput: t,\n      maxOutput: s,\n      minCutOff: n,\n      maxCutOff: p,\n      factor: a,\n      useGamma: r,\n      gamma: f,\n      gammaCorrection: l,\n      stretchType: this.functionArguments.stretchType,\n      isOutputRounded: c,\n      type: \"stretch\"\n    };\n  }\n};\nt([s({\n  json: {\n    write: !0,\n    name: \"rasterFunction\"\n  }\n})], c.prototype, \"functionName\", void 0), t([s({\n  type: i,\n  json: {\n    write: !0,\n    name: \"rasterFunctionArguments\"\n  }\n})], c.prototype, \"functionArguments\", void 0), t([s()], c.prototype, \"rasterArgumentNames\", void 0), t([s({\n  json: {\n    write: !0\n  }\n})], c.prototype, \"lookup\", void 0), t([s({\n  json: {\n    write: !0\n  }\n})], c.prototype, \"cutOffs\", void 0), c = t([e(\"esri.layers.support.rasterFunctions.StretchFunction\")], c);\nconst f = c;\nexport { f as default };","map":{"version":3,"names":["_","t","property","s","subclass","e","isIntegerPixelType","o","r","lookupPixels","u","i","getStretchCutoff","n","createStretchLUT","p","stretch","a","computeGammaCorrection","m","c","constructor","arguments","functionName","functionArguments","rasterArgumentNames","lookup","cutOffs","_bindSourceRasters","sourceRasterInfos","pixelType","dynamicRangeAdjustment","gamma","useGamma","includes","toJSON","rasterInfo","outputPixelType","rounding","_getOutputPixelType","clone","_removeStatsHistColormapVAT","keyProperties","DataType","outputMin","outputMax","statistics","bandCount","min","max","success","supportsGPU","_processPixels","pixelBlocks","pixelBlock","_getWebGLParameters","length","minCutOff","maxCutOff","map","f","l","minOutput","maxOutput","factor","gammaCorrection","stretchType","isOutputRounded","type","json","write","name","prototype","default"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/layers/support/rasterFunctions/StretchFunction.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{subclass as e}from\"../../../core/accessorSupport/decorators/subclass.js\";import{isIntegerPixelType as o}from\"../rasterFormats/pixelRangeUtils.js\";import r from\"./BaseRasterFunction.js\";import{lookupPixels as u}from\"./pixelUtils.js\";import i from\"./StretchFunctionArguments.js\";import{getStretchCutoff as n,createStretchLUT as p,stretch as a,computeGammaCorrection as m}from\"./stretchUtils.js\";let c=class extends r{constructor(){super(...arguments),this.functionName=\"Stretch\",this.functionArguments=null,this.rasterArgumentNames=[\"raster\"],this.lookup=null,this.cutOffs=null}_bindSourceRasters(){this.lookup=null,this.cutOffs=null;const t=this.sourceRasterInfos[0],{pixelType:s}=t,{functionArguments:e}=this,{dynamicRangeAdjustment:r,gamma:u,useGamma:i}=e;if(!r&&[\"u8\",\"u16\",\"s8\",\"s16\"].includes(s)){const r=n(e.toJSON(),{rasterInfo:t}),a=o(this.outputPixelType)?\"round\":\"float\";this.lookup=p({pixelType:s,...r,gamma:i?u:null,rounding:a}),this.cutOffs=r}else r||(this.cutOffs=n(e.toJSON(),{rasterInfo:t}));this.outputPixelType=this._getOutputPixelType(s);const a=t.clone();a.pixelType=this.outputPixelType,this._removeStatsHistColormapVAT(a),\"u8\"===this.outputPixelType&&(a.keyProperties.DataType=\"processed\");const{outputMin:m=0,outputMax:c=255}=this.functionArguments;a.statistics=[];for(let o=0;o<a.bandCount;o++)a.statistics[o]={min:m,max:c};this.rasterInfo=a;return{success:!0,supportsGPU:!r}}_processPixels(t){const s=t.pixelBlocks?.[0];if(null==s)return s;const{lookup:e}=this;if(e)return u(s,{...e,outputPixelType:this.rasterInfo.pixelType});const{functionArguments:o}=this,r=this.cutOffs||n(o.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:s}),i=o.useGamma?o.gamma:null;return a(s,{...r,gamma:i,outputPixelType:this.outputPixelType})}_getWebGLParameters(){const{outputMin:t=0,outputMax:s=255,gamma:e,useGamma:r}=this.functionArguments,u=this.rasterInfo.bandCount>=2?3:1,i=r&&e?.length?m(u,e):[1,1,1],{minCutOff:n,maxCutOff:p}=this.cutOffs??{minCutOff:[0,0,0],maxCutOff:[255,255,255]};1===n.length&&(n[1]=n[2]=n[0],p[1]=p[2]=p[0]);const a=p.map(((e,o)=>(s-t)/(p[o]-n[o]))),c=o(this.outputPixelType),f=r&&e?[e[0],e[1]??e[0],e[2]??e[0]]:[1,1,1],l=r?[i[0],i[1]??i[0],i[2]??i[0]]:[1,1,1];return{bandCount:u,minOutput:t,maxOutput:s,minCutOff:n,maxCutOff:p,factor:a,useGamma:r,gamma:f,gammaCorrection:l,stretchType:this.functionArguments.stretchType,isOutputRounded:c,type:\"stretch\"}}};t([s({json:{write:!0,name:\"rasterFunction\"}})],c.prototype,\"functionName\",void 0),t([s({type:i,json:{write:!0,name:\"rasterFunctionArguments\"}})],c.prototype,\"functionArguments\",void 0),t([s()],c.prototype,\"rasterArgumentNames\",void 0),t([s({json:{write:!0}})],c.prototype,\"lookup\",void 0),t([s({json:{write:!0}})],c.prototype,\"cutOffs\",void 0),c=t([e(\"esri.layers.support.rasterFunctions.StretchFunction\")],c);const f=c;export{f as default};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}