{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { getContinuousIndexArray as e } from \"../../../../../../geometry/support/Indices.js\";\nimport { createHudMaterial as r } from \"./FeaturePipelineRenderManager.js\";\nimport { RenderGeometryBufferWriter as t } from \"./RenderGeometryBufferWriter.js\";\nimport { BoundingInfo as n } from \"../../../../webgl-engine/lib/BoundingInfo.js\";\nimport { VertexAttribute as a } from \"../../../../webgl-engine/lib/VertexAttribute.js\";\nimport { DefaultMaterial as s } from \"../../../../webgl-engine/materials/DefaultMaterial.js\";\nclass o {\n  constructor(e) {\n    this._context = e, this._commands = [], this._transferables = new Set();\n  }\n  createMaterial(e) {\n    const n = this._context,\n      a = n.generateId(\"material\");\n    switch (e) {\n      case \"default\":\n        {\n          const e = new s({}, {\n              spherical: this._context.globalViewingMode,\n              doublePrecisionRequiresObfuscation: !0\n            }),\n            r = new t(e);\n          n.registerRenderGeometryBufferWriter(a, r);\n        }\n        break;\n      case \"hud\":\n        {\n          const e = r(null, this._context.globalViewingMode)[0],\n            s = new t(e);\n          n.registerRenderGeometryBufferWriter(a, s);\n        }\n    }\n    return this._commands.push({\n      id: \"create-material\",\n      type: e,\n      materialId: a\n    }), a;\n  }\n  createDirectRenderer(e) {\n    const r = this._context.generateId(\"material-renderer\");\n    return this._commands.push({\n      id: \"create-direct-renderer\",\n      materialRendererId: r,\n      materialId: e\n    }), r;\n  }\n  addDirectRendererGeometry(e, r, t) {\n    const n = r.materialId,\n      a = this._context.getRenderGeometryBufferWriter(n);\n    if (null == a) throw new Error(`no bufferwriter found for material ${n}`);\n    const s = a.createBuffer(r, t);\n    this._transferables.add(s.data), this._commands.push({\n      id: \"add-direct-renderer-geometry\",\n      renderGeometryId: e,\n      materialId: n,\n      renderGeometryBuffer: s,\n      localOrigin: t\n    });\n  }\n  removeDirectRendererGeometry(e) {\n    this._commands.push({\n      id: \"remove-direct-renderer-geometry\",\n      renderGeometryId: e\n    });\n  }\n  createLodRenderer(r) {\n    const t = this._context.generateId(\"lod-renderer\"),\n      s = {\n        levels: r.levels.map(r => ({\n          components: r.components.map(r => {\n            const t = r.attributes.get(a.POSITION);\n            if (!t || 0 === t.indices.length) throw new Error(\"positions attribute expected\");\n            const s = 3,\n              o = e(t.indices.length / s),\n              d = new n(o, s, t),\n              i = this._context.getRenderGeometryBufferWriter(r.materialId);\n            if (null == i) throw new Error(\"writer not found\");\n            const c = i.createBuffer(r, null);\n            this._transferables.add(c.data);\n            return {\n              materialId: r.materialId,\n              renderGeometryBuffer: c,\n              boundingInfo: {\n                bbMax: d.bbMax,\n                bbMin: d.bbMin\n              }\n            };\n          }),\n          minScreenSpaceRadius: r.minScreenSpaceRadius\n        }))\n      };\n    return this._commands.push({\n      id: \"create-lod-renderer\",\n      lodRendererId: t,\n      lodRenderGeometry: s\n    }), t;\n  }\n  addLodInstances(e, r) {\n    this._commands.push({\n      id: \"add-lod-instances\",\n      lodRendererId: e,\n      data: r\n    }), this._transferables.add(r.featureIds.buffer), this._transferables.add(r.globalTransforms.buffer), this._transferables.add(r.localTransforms.buffer);\n  }\n  removeLodInstances(e, r) {\n    this._commands.push({\n      id: \"remove-lod-instances\",\n      lodRendererId: e,\n      featureIds: r\n    }), this._transferables.add(r.buffer);\n  }\n  append(e) {\n    if (e._context !== this._context) throw new Error(\"Cannot append encoders from different contexts\");\n    const {\n      _commands: r,\n      _transferables: t\n    } = this;\n    for (const n of e._commands) r.push(n);\n    for (const n of e._transferables) t.add(n);\n  }\n  async dispatch() {\n    const e = this._commands,\n      r = Array.from(this._transferables);\n    this._clearCommandBuffer(), await this._context.dispatchRenderCommands(e, r);\n  }\n  _clearCommandBuffer() {\n    this._commands = [], this._transferables.clear();\n  }\n}\nexport { o as RenderCommandEncoder };","map":{"version":3,"names":["getContinuousIndexArray","e","createHudMaterial","r","RenderGeometryBufferWriter","t","BoundingInfo","n","VertexAttribute","a","DefaultMaterial","s","o","constructor","_context","_commands","_transferables","Set","createMaterial","generateId","spherical","globalViewingMode","doublePrecisionRequiresObfuscation","registerRenderGeometryBufferWriter","push","id","type","materialId","createDirectRenderer","materialRendererId","addDirectRendererGeometry","getRenderGeometryBufferWriter","Error","createBuffer","add","data","renderGeometryId","renderGeometryBuffer","localOrigin","removeDirectRendererGeometry","createLodRenderer","levels","map","components","attributes","get","POSITION","indices","length","d","i","c","boundingInfo","bbMax","bbMin","minScreenSpaceRadius","lodRendererId","lodRenderGeometry","addLodInstances","featureIds","buffer","globalTransforms","localTransforms","removeLodInstances","append","dispatch","Array","from","_clearCommandBuffer","dispatchRenderCommands","clear","RenderCommandEncoder"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/3d/layers/graphics/pipeline/rendering/RenderCommandEncoder.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{getContinuousIndexArray as e}from\"../../../../../../geometry/support/Indices.js\";import{createHudMaterial as r}from\"./FeaturePipelineRenderManager.js\";import{RenderGeometryBufferWriter as t}from\"./RenderGeometryBufferWriter.js\";import{BoundingInfo as n}from\"../../../../webgl-engine/lib/BoundingInfo.js\";import{VertexAttribute as a}from\"../../../../webgl-engine/lib/VertexAttribute.js\";import{DefaultMaterial as s}from\"../../../../webgl-engine/materials/DefaultMaterial.js\";class o{constructor(e){this._context=e,this._commands=[],this._transferables=new Set}createMaterial(e){const n=this._context,a=n.generateId(\"material\");switch(e){case\"default\":{const e=new s({},{spherical:this._context.globalViewingMode,doublePrecisionRequiresObfuscation:!0}),r=new t(e);n.registerRenderGeometryBufferWriter(a,r)}break;case\"hud\":{const e=r(null,this._context.globalViewingMode)[0],s=new t(e);n.registerRenderGeometryBufferWriter(a,s)}}return this._commands.push({id:\"create-material\",type:e,materialId:a}),a}createDirectRenderer(e){const r=this._context.generateId(\"material-renderer\");return this._commands.push({id:\"create-direct-renderer\",materialRendererId:r,materialId:e}),r}addDirectRendererGeometry(e,r,t){const n=r.materialId,a=this._context.getRenderGeometryBufferWriter(n);if(null==a)throw new Error(`no bufferwriter found for material ${n}`);const s=a.createBuffer(r,t);this._transferables.add(s.data),this._commands.push({id:\"add-direct-renderer-geometry\",renderGeometryId:e,materialId:n,renderGeometryBuffer:s,localOrigin:t})}removeDirectRendererGeometry(e){this._commands.push({id:\"remove-direct-renderer-geometry\",renderGeometryId:e})}createLodRenderer(r){const t=this._context.generateId(\"lod-renderer\"),s={levels:r.levels.map((r=>({components:r.components.map((r=>{const t=r.attributes.get(a.POSITION);if(!t||0===t.indices.length)throw new Error(\"positions attribute expected\");const s=3,o=e(t.indices.length/s),d=new n(o,s,t),i=this._context.getRenderGeometryBufferWriter(r.materialId);if(null==i)throw new Error(\"writer not found\");const c=i.createBuffer(r,null);this._transferables.add(c.data);return{materialId:r.materialId,renderGeometryBuffer:c,boundingInfo:{bbMax:d.bbMax,bbMin:d.bbMin}}})),minScreenSpaceRadius:r.minScreenSpaceRadius})))};return this._commands.push({id:\"create-lod-renderer\",lodRendererId:t,lodRenderGeometry:s}),t}addLodInstances(e,r){this._commands.push({id:\"add-lod-instances\",lodRendererId:e,data:r}),this._transferables.add(r.featureIds.buffer),this._transferables.add(r.globalTransforms.buffer),this._transferables.add(r.localTransforms.buffer)}removeLodInstances(e,r){this._commands.push({id:\"remove-lod-instances\",lodRendererId:e,featureIds:r}),this._transferables.add(r.buffer)}append(e){if(e._context!==this._context)throw new Error(\"Cannot append encoders from different contexts\");const{_commands:r,_transferables:t}=this;for(const n of e._commands)r.push(n);for(const n of e._transferables)t.add(n)}async dispatch(){const e=this._commands,r=Array.from(this._transferables);this._clearCommandBuffer(),await this._context.dispatchRenderCommands(e,r)}_clearCommandBuffer(){this._commands=[],this._transferables.clear()}}export{o as RenderCommandEncoder};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}