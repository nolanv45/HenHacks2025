{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../../chunks/tslib.es6.js\";\nimport { property as e } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/Logger.js\";\nimport \"../../../core/RandomLCG.js\";\nimport { subclass as o } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { convolutionKernel as s } from \"../rasterFunctionConstants.js\";\nimport { getPixelValueRange as n } from \"../rasterFormats/pixelRangeUtils.js\";\nimport r from \"./BaseRasterFunction.js\";\nimport i from \"./ConvolutionFunctionArguments.js\";\nimport { convolute as u } from \"./convolutionUtils.js\";\nconst c = 25;\nlet l = class extends r {\n  constructor() {\n    super(...arguments), this.functionName = \"Convolution\", this.rasterArgumentNames = [\"raster\"];\n  }\n  get _normalizedKernel() {\n    const {\n        kernel: t,\n        convolutionType: e\n      } = this.functionArguments,\n      o = t.reduce((t, e) => t + e);\n    return -1 === e || 0 === o || 1 === o ? t : t.map(t => t / o);\n  }\n  _bindSourceRasters() {\n    const {\n      convolutionType: t,\n      rows: e,\n      cols: o,\n      kernel: n\n    } = this.functionArguments;\n    if (!Object.values(s).includes(t)) return {\n      success: !1,\n      supportsGPU: !1,\n      error: `convolution-function: the specified kernel type is not supported ${t}`\n    };\n    if (t !== s.none && e * o !== n.length) return {\n      success: !1,\n      supportsGPU: !1,\n      error: \"convolution-function: the specified rows and cols do not match the length of the kernel\"\n    };\n    const r = this.sourceRasterInfos[0];\n    this.outputPixelType = this._getOutputPixelType(r.pixelType);\n    const i = r.clone();\n    i.pixelType = this.outputPixelType;\n    const u = [s.none, s.sharpen, s.sharpen2, s.sharpening3x3, s.sharpening5x5];\n    (-1 === t || \"u8\" !== this.outputPixelType && !u.includes(t)) && (i.statistics = null, i.histograms = null), i.colormap = null, i.attributeTable = null, this.rasterInfo = i;\n    return {\n      success: !0,\n      supportsGPU: n.length <= c\n    };\n  }\n  _processPixels(t) {\n    const e = t.pixelBlocks?.[0];\n    if (null == e || this.functionArguments.convolutionType === s.none) return e;\n    const {\n        rows: o,\n        cols: n\n      } = this.functionArguments,\n      {\n        _normalizedKernel: r\n      } = this;\n    return u(e, {\n      kernel: r,\n      rows: o,\n      cols: n,\n      outputPixelType: this.outputPixelType\n    });\n  }\n  _getWebGLParameters() {\n    const t = new Float32Array(c);\n    return t.set(this._normalizedKernel), {\n      kernelRows: this.functionArguments.rows,\n      kernelCols: this.functionArguments.cols,\n      kernel: t,\n      clampRange: n(this.outputPixelType)\n    };\n  }\n};\nt([e({\n  json: {\n    write: !0,\n    name: \"rasterFunction\"\n  }\n})], l.prototype, \"functionName\", void 0), t([e({\n  type: i,\n  json: {\n    write: !0,\n    name: \"rasterFunctionArguments\"\n  }\n})], l.prototype, \"functionArguments\", void 0), t([e()], l.prototype, \"rasterArgumentNames\", void 0), t([e()], l.prototype, \"_normalizedKernel\", null), l = t([o(\"esri.layers.support.rasterFunctions.ConvolutionFunction\")], l);\nconst p = l;\nexport { p as default };","map":{"version":3,"names":["_","t","property","e","subclass","o","convolutionKernel","s","getPixelValueRange","n","r","i","convolute","u","c","l","constructor","arguments","functionName","rasterArgumentNames","_normalizedKernel","kernel","convolutionType","functionArguments","reduce","map","_bindSourceRasters","rows","cols","Object","values","includes","success","supportsGPU","error","none","length","sourceRasterInfos","outputPixelType","_getOutputPixelType","pixelType","clone","sharpen","sharpen2","sharpening3x3","sharpening5x5","statistics","histograms","colormap","attributeTable","rasterInfo","_processPixels","pixelBlocks","_getWebGLParameters","Float32Array","set","kernelRows","kernelCols","clampRange","json","write","name","prototype","type","p","default"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/layers/support/rasterFunctions/ConvolutionFunction.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import{property as e}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import{convolutionKernel as s}from\"../rasterFunctionConstants.js\";import{getPixelValueRange as n}from\"../rasterFormats/pixelRangeUtils.js\";import r from\"./BaseRasterFunction.js\";import i from\"./ConvolutionFunctionArguments.js\";import{convolute as u}from\"./convolutionUtils.js\";const c=25;let l=class extends r{constructor(){super(...arguments),this.functionName=\"Convolution\",this.rasterArgumentNames=[\"raster\"]}get _normalizedKernel(){const{kernel:t,convolutionType:e}=this.functionArguments,o=t.reduce(((t,e)=>t+e));return-1===e||0===o||1===o?t:t.map((t=>t/o))}_bindSourceRasters(){const{convolutionType:t,rows:e,cols:o,kernel:n}=this.functionArguments;if(!Object.values(s).includes(t))return{success:!1,supportsGPU:!1,error:`convolution-function: the specified kernel type is not supported ${t}`};if(t!==s.none&&e*o!==n.length)return{success:!1,supportsGPU:!1,error:\"convolution-function: the specified rows and cols do not match the length of the kernel\"};const r=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(r.pixelType);const i=r.clone();i.pixelType=this.outputPixelType;const u=[s.none,s.sharpen,s.sharpen2,s.sharpening3x3,s.sharpening5x5];(-1===t||\"u8\"!==this.outputPixelType&&!u.includes(t))&&(i.statistics=null,i.histograms=null),i.colormap=null,i.attributeTable=null,this.rasterInfo=i;return{success:!0,supportsGPU:n.length<=c}}_processPixels(t){const e=t.pixelBlocks?.[0];if(null==e||this.functionArguments.convolutionType===s.none)return e;const{rows:o,cols:n}=this.functionArguments,{_normalizedKernel:r}=this;return u(e,{kernel:r,rows:o,cols:n,outputPixelType:this.outputPixelType})}_getWebGLParameters(){const t=new Float32Array(c);return t.set(this._normalizedKernel),{kernelRows:this.functionArguments.rows,kernelCols:this.functionArguments.cols,kernel:t,clampRange:n(this.outputPixelType)}}};t([e({json:{write:!0,name:\"rasterFunction\"}})],l.prototype,\"functionName\",void 0),t([e({type:i,json:{write:!0,name:\"rasterFunctionArguments\"}})],l.prototype,\"functionArguments\",void 0),t([e()],l.prototype,\"rasterArgumentNames\",void 0),t([e()],l.prototype,\"_normalizedKernel\",null),l=t([o(\"esri.layers.support.rasterFunctions.ConvolutionFunction\")],l);const p=l;export{p as default};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}