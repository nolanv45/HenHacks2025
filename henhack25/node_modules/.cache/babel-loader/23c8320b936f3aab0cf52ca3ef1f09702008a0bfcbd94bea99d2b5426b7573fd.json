{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../chunks/tslib.es6.js\";\nimport { fetchAndConvertSerializedKnowledgeIdMap as t, serializeInclusionDefinitionToIdCollectionsMapPbf as i } from \"../applications/KnowledgeStudio/resourceSerializationUtils.js\";\nimport o from \"../core/Collection.js\";\nimport s from \"../core/Error.js\";\nimport a from \"../core/Logger.js\";\nimport { getOrCreateMapValue as r } from \"../core/MapUtils.js\";\nimport { MultiOriginJSONMixin as n } from \"../core/MultiOriginJSONSupport.js\";\nimport { throwIfAbortError as p } from \"../core/promiseUtils.js\";\nimport { watch as l, sync as d } from \"../core/reactiveUtils.js\";\nimport { isAbsolute as h, join as y } from \"../core/urlUtils.js\";\nimport { generateUUID as c } from \"../core/uuid.js\";\nimport { property as m } from \"../core/accessorSupport/decorators/property.js\";\nimport \"../core/has.js\";\nimport \"../core/RandomLCG.js\";\nimport { reader as u } from \"../core/accessorSupport/decorators/reader.js\";\nimport { subclass as f } from \"../core/accessorSupport/decorators/subclass.js\";\nimport { writer as g } from \"../core/accessorSupport/decorators/writer.js\";\nimport { OriginId as w, idToName as b, nameToId as M } from \"../core/accessorSupport/PropertyOrigin.js\";\nimport T from \"./Layer.js\";\nimport { KnowledgeGraphLayerDataManager as S } from \"./knowledgeGraph/KnowledgeGraphLayerDataManager.js\";\nimport _ from \"./knowledgeGraph/KnowledgeGraphSublayer.js\";\nimport { initializeLayersFromClientData as L } from \"./knowledgeGraph/layerUtils.js\";\nimport { ArcGISService as D } from \"./mixins/ArcGISService.js\";\nimport { BlendLayer as j } from \"./mixins/BlendLayer.js\";\nimport { CustomParametersMixin as v } from \"./mixins/CustomParametersMixin.js\";\nimport { OperationalLayer as k } from \"./mixins/OperationalLayer.js\";\nimport { PortalLayer as A } from \"./mixins/PortalLayer.js\";\nimport { RefreshableLayer as G } from \"./mixins/RefreshableLayer.js\";\nimport { ScaleRangeLayer as E } from \"./mixins/ScaleRangeLayer.js\";\nimport { url as C } from \"./support/commonProperties.js\";\nimport { fetchKnowledgeGraph as I } from \"../rest/knowledgeGraphService.js\";\nimport { f as N, t as R } from \"../chunks/persistableUrlUtils.js\";\nlet U = class extends j(E(G(D(k(A(n(v(T)))))))) {\n  constructor(e) {\n    super(e), this._graphTypeLookup = new Map(), this._namedTypesModified = !1, this.dataManager = null, this.definitionSetMap = null, this.knowledgeGraph = null, this.layers = new (o.ofType(_))(), this.memberEntityTypes = null, this.memberRelationshipTypes = null, this.operationalLayerType = \"KnowledgeGraphLayer\", this.sublayerIdsCache = new Map(), this.tables = new (o.ofType(_))(), this.type = \"knowledge-graph\", this.url = null, this.addHandles(l(() => this.layers.concat(this.tables), (e, t) => this._handleSublayersChange(e, t), d));\n  }\n  load(e) {\n    return this.addResolvingPromise(this._doLoad(e)), Promise.resolve(this);\n  }\n  async _doLoad(e) {\n    try {\n      await this.loadFromPortal({\n        supportedTypes: [\"Knowledge Graph Layer\"]\n      }, e);\n    } catch (t) {\n      p(t);\n    }\n    await this._fetchMetadata(), await this._initializeLayerProperties(), this.loadLayerAssumingLocalCache(), this._layersLoadedFromAuthoritativeItem() || (await L(this));\n  }\n  async _fetchMetadata() {\n    if (!this.url) throw new s(\"knowledge-graph:missing-url\", \"KnowledgeGraphLayer must be created with a url\");\n    const e = await I(this.url);\n    this.knowledgeGraph = e, this._forEachGraphType(e => {\n      e.name && this._graphTypeLookup.set(e.name, e);\n    });\n  }\n  async _initializeLayerProperties() {\n    this.originIdOf(\"inclusionModeDefinition\") === w.USER ? this._validateInclusionModeDefinition() : await this._initializeInclusionModeDefinition(), this._setMemberTypes(), this.dataManager = new S({\n      knowledgeGraph: this.knowledgeGraph,\n      inclusionModeDefinition: this.inclusionModeDefinition\n    });\n  }\n  async _initializeInclusionModeDefinition() {\n    const e = this.definitionSetMap ? await t(this.definitionSetMap, !0) : {\n      generateAllSublayers: !0,\n      namedTypeDefinitions: new Map()\n    };\n    [...this.layers.toArray(), ...this.tables.toArray()].forEach(t => {\n      const i = this._graphTypeLookup.get(t.graphTypeName);\n      i && !e.namedTypeDefinitions.has(i.name) && e.namedTypeDefinitions.set(i.name, {\n        useAllData: !0\n      });\n    }), this.setAtOrigin(\"inclusionModeDefinition\", e, b(this.originIdOf(\"definitionSetMap\")));\n  }\n  _validateInclusionModeDefinition() {\n    const {\n      inclusionModeDefinition: e\n    } = this;\n    if (!e) return;\n    const {\n      namedTypeDefinitions: t\n    } = e;\n    if (t?.size > 0) t.forEach((e, i) => {\n      const o = this._graphTypeLookup.get(i);\n      if (!o) return a.getLogger(this).warn(`A named type, ${i}, was in the inclusion list that wasn't in the data model and will be removed`), void t.delete(i);\n      \"relationship\" !== o.type && \"entity\" !== o.type && (a.getLogger(this).warn(`A named type, ${i}, was in the inclusion list that wasn't properly modeled and will be removed`), t.delete(i));\n    });else if (!e.generateAllSublayers) throw new s(\"knowledge-graph:composite-layer-constructor\", \"If an explicit inclusion definition is defined, at least one namedTypeDefinition must also be defined\");\n  }\n  _setMemberTypes() {\n    let e = [],\n      t = [];\n    const {\n        inclusionModeDefinition: i\n      } = this,\n      o = i?.namedTypeDefinitions;\n    !i || i.generateAllSublayers ? (e = this.knowledgeGraph.dataModel?.entityTypes ?? [], t = this.knowledgeGraph.dataModel?.relationshipTypes ?? []) : o && o.size > 0 && o.forEach((i, o) => {\n      const s = this._graphTypeLookup.get(o);\n      switch (s?.type) {\n        case \"relationship\":\n          t.push(s);\n          break;\n        case \"entity\":\n          e.push(s);\n      }\n    }), this.memberEntityTypes = e, this.memberRelationshipTypes = t;\n  }\n  _forEachGraphType(e) {\n    [...(this.knowledgeGraph.dataModel?.entityTypes ?? []), ...(this.knowledgeGraph.dataModel?.relationshipTypes ?? [])].forEach(t => {\n      e(t);\n    });\n  }\n  _refreshNamedTypes() {\n    this._namedTypesModified = !0;\n    for (const e of this.layers) e.emit(\"refresh\", {\n      dataChanged: !0\n    });\n    for (const e of this.tables) e.emit(\"refresh\", {\n      dataChanged: !0\n    });\n  }\n  async _handleNewRecords(e) {\n    const t = [];\n    this.dataManager.addToLayer(e);\n    for (const i of e) this.sublayerIdsCache.has(i.typeName) || (this.sublayerIdsCache.set(i.typeName, new Set()), t.push(i.typeName)), this.sublayerIdsCache.get(i.typeName).add(i.id);\n    for (const i of t) {\n      const e = this._graphTypeLookup.get(i);\n      e && (this._addSublayer(e), \"entity\" === e.type ? this.dataManager.entityTypeNames.add(i) : this.dataManager.relationshipTypeNames.add(i), this.dataManager.sublayerCaches.set(i, new Map()));\n    }\n    await L(this, t), this._refreshNamedTypes();\n  }\n  _createSublayers(e, t, i) {\n    e.forEach(e => {\n      const o = this._createSublayer(e);\n      i(o) && t.push(o), this._updateSublayerCaches(e);\n    });\n  }\n  _addSublayer(e) {\n    const t = this._createSublayer(e);\n    return t.geometryType ? this.layers.push(t) : this.tables.push(t), t;\n  }\n  _createSublayer(e) {\n    return new _({\n      objectType: e,\n      parentCompositeLayer: this,\n      graphType: e.type\n    });\n  }\n  _updateSublayers(e, t) {\n    t.forEach(t => {\n      t.parentCompositeLayer = this;\n      const i = e.find(e => e.type === t.graphType && e.name === t.graphTypeName);\n      i && (t.objectType = i, this._updateSublayerCaches(i));\n    });\n  }\n  _updateSublayerCaches(e) {\n    const t = this.dataManager.sublayerCaches;\n    t.has(e.name) || t.set(e.name, new Map());\n  }\n  _saveUrlAsNewResource(e, t, i, o) {\n    e[t] = \"<pending>\", i.pendingOperations.push(x(this.inclusionModeDefinition).then(s => {\n      const a = P(o);\n      e[t] = a.itemRelativeUrl, i.toAdd.push({\n        resource: a,\n        content: {\n          type: \"blob\",\n          blob: s\n        },\n        compress: !1,\n        finish: e => {\n          this.definitionSetMap = e.url;\n        }\n      });\n    }));\n  }\n  _displaysAllRecords(e) {\n    for (const [, {\n      useAllData: t\n    }] of e.namedTypeDefinitions) if (!t) return !1;\n    return !0;\n  }\n  _handleSublayersChange(e, t) {\n    t && (t.forEach(e => {\n      e.parent = null;\n    }), this.removeHandles(\"sublayers-owner\")), e && (e.forEach(e => {\n      e.parent = this;\n    }), this.addHandles([e.on(\"after-add\", ({\n      item: e\n    }) => {\n      e.parent = this;\n    }), e.on(\"after-remove\", ({\n      item: e\n    }) => {\n      e.parent = null;\n    })], \"sublayers-owner\"));\n  }\n  _layersLoadedFromAuthoritativeItem() {\n    const e = this.originIdOf(\"layers\");\n    return e >= w.PORTAL_ITEM && e < w.USER;\n  }\n  readDefinitionSetMap(e, t, i) {\n    return N(e, i);\n  }\n  writeDefinitionSetMap(e, t, i, o) {\n    const s = o?.portalItem,\n      a = o?.resources,\n      r = M(o?.origin);\n    if (!s || !a || null == r) return void (e && (t[i] = R(e, o)));\n    const {\n      inclusionModeDefinition: n\n    } = this;\n    if (!n || this._displaysAllRecords(n)) return void (this.definitionSetMap = null);\n    const p = this.originIdOf(\"inclusionModeDefinition\");\n    if (p === w.USER || this._namedTypesModified || r < p) this._saveUrlAsNewResource(t, i, a, s);else if (r === p && e) {\n      const r = R(e, o);\n      h(r) ? this._saveUrlAsNewResource(t, i, a, s) : t[i] = r;\n    }\n  }\n  set inclusionModeDefinition(e) {\n    \"loaded\" !== this.loadStatus && \"failed\" !== this.loadStatus ? this._set(\"inclusionModeDefinition\", e) : a.getLogger(this).error(\"#inclusionModeDefinition\", \"inclusionModeDefinition cannot be changed after the layer is loaded.\");\n  }\n  loadLayerAssumingLocalCache() {\n    const e = [...this.memberEntityTypes, ...this.memberRelationshipTypes];\n    this.originIdOf(\"layers\") === w.DEFAULTS ? this._createSublayers(e, this.layers, e => !!e.geometryType) : this._updateSublayers(e, this.layers), this.originIdOf(\"tables\") === w.DEFAULTS ? this._createSublayers(e, this.tables, e => !e.geometryType) : this._updateSublayers(e, this.tables), this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.forEach((e, t) => {\n      const i = r(this.sublayerIdsCache, t, () => new Set());\n      e.members?.forEach(e => {\n        i.add(e.id);\n      });\n    });\n  }\n  async addRecords(e) {\n    await this.load(), await this._handleNewRecords(e);\n  }\n  async removeRecords(e) {\n    await this.load();\n    const t = [];\n    for (const i of e) !1 === this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.get(i.typeName)?.useAllData && this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.get(i.typeName)?.members?.has(i.id) && t.push(i);\n    this.dataManager.removeFromLayer(t);\n    for (const i of t) this.sublayerIdsCache.get(i.typeName)?.delete(i.id);\n    return this._refreshNamedTypes(), t;\n  }\n};\ne([m()], U.prototype, \"dataManager\", void 0), e([m({\n  json: {\n    write: {\n      ignoreOrigin: !0,\n      writerEnsuresNonNull: !0\n    }\n  }\n})], U.prototype, \"definitionSetMap\", void 0), e([u(\"definitionSetMap\")], U.prototype, \"readDefinitionSetMap\", null), e([g(\"definitionSetMap\")], U.prototype, \"writeDefinitionSetMap\", null), e([m()], U.prototype, \"inclusionModeDefinition\", null), e([m()], U.prototype, \"knowledgeGraph\", void 0), e([m({\n  type: o.ofType(_),\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], U.prototype, \"layers\", void 0), e([m()], U.prototype, \"memberEntityTypes\", void 0), e([m()], U.prototype, \"memberRelationshipTypes\", void 0), e([m({\n  type: [\"KnowledgeGraphLayer\"]\n})], U.prototype, \"operationalLayerType\", void 0), e([m()], U.prototype, \"sublayerIdsCache\", void 0), e([m({\n  type: o.ofType(_),\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], U.prototype, \"tables\", void 0), e([m({\n  json: {\n    read: !1\n  }\n})], U.prototype, \"type\", void 0), e([m(C)], U.prototype, \"url\", void 0), U = e([f(\"esri.layers.KnowledgeGraphLayer\")], U);\nconst O = U;\nasync function x(e) {\n  const t = await i(e);\n  return new Blob([t], {\n    type: \"application/x-protobuf\"\n  });\n}\nfunction P(e) {\n  const t = `definitionSetMap-${c()}.dat`,\n    i = y(\"knowledgeGraphLayer\", t);\n  return e.resourceFromPath(i);\n}\nexport { O as default };","map":{"version":3,"names":["_","e","fetchAndConvertSerializedKnowledgeIdMap","t","serializeInclusionDefinitionToIdCollectionsMapPbf","i","o","s","a","getOrCreateMapValue","r","MultiOriginJSONMixin","n","throwIfAbortError","p","watch","l","sync","d","isAbsolute","h","join","y","generateUUID","c","property","m","reader","u","subclass","f","writer","g","OriginId","w","idToName","b","nameToId","M","T","KnowledgeGraphLayerDataManager","S","initializeLayersFromClientData","L","ArcGISService","D","BlendLayer","j","CustomParametersMixin","v","OperationalLayer","k","PortalLayer","A","RefreshableLayer","G","ScaleRangeLayer","E","url","C","fetchKnowledgeGraph","I","N","R","U","constructor","_graphTypeLookup","Map","_namedTypesModified","dataManager","definitionSetMap","knowledgeGraph","layers","ofType","memberEntityTypes","memberRelationshipTypes","operationalLayerType","sublayerIdsCache","tables","type","addHandles","concat","_handleSublayersChange","load","addResolvingPromise","_doLoad","Promise","resolve","loadFromPortal","supportedTypes","_fetchMetadata","_initializeLayerProperties","loadLayerAssumingLocalCache","_layersLoadedFromAuthoritativeItem","_forEachGraphType","name","set","originIdOf","USER","_validateInclusionModeDefinition","_initializeInclusionModeDefinition","_setMemberTypes","inclusionModeDefinition","generateAllSublayers","namedTypeDefinitions","toArray","forEach","get","graphTypeName","has","useAllData","setAtOrigin","size","getLogger","warn","delete","dataModel","entityTypes","relationshipTypes","push","_refreshNamedTypes","emit","dataChanged","_handleNewRecords","addToLayer","typeName","Set","add","id","_addSublayer","entityTypeNames","relationshipTypeNames","sublayerCaches","_createSublayers","_createSublayer","_updateSublayerCaches","geometryType","objectType","parentCompositeLayer","graphType","_updateSublayers","find","_saveUrlAsNewResource","pendingOperations","x","then","P","itemRelativeUrl","toAdd","resource","content","blob","compress","finish","_displaysAllRecords","parent","removeHandles","on","item","PORTAL_ITEM","readDefinitionSetMap","writeDefinitionSetMap","portalItem","resources","origin","loadStatus","_set","error","DEFAULTS","members","addRecords","removeRecords","removeFromLayer","prototype","json","write","ignoreOrigin","writerEnsuresNonNull","read","O","Blob","resourceFromPath","default"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/layers/KnowledgeGraphLayer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import{fetchAndConvertSerializedKnowledgeIdMap as t,serializeInclusionDefinitionToIdCollectionsMapPbf as i}from\"../applications/KnowledgeStudio/resourceSerializationUtils.js\";import o from\"../core/Collection.js\";import s from\"../core/Error.js\";import a from\"../core/Logger.js\";import{getOrCreateMapValue as r}from\"../core/MapUtils.js\";import{MultiOriginJSONMixin as n}from\"../core/MultiOriginJSONSupport.js\";import{throwIfAbortError as p}from\"../core/promiseUtils.js\";import{watch as l,sync as d}from\"../core/reactiveUtils.js\";import{isAbsolute as h,join as y}from\"../core/urlUtils.js\";import{generateUUID as c}from\"../core/uuid.js\";import{property as m}from\"../core/accessorSupport/decorators/property.js\";import\"../core/has.js\";import\"../core/RandomLCG.js\";import{reader as u}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as f}from\"../core/accessorSupport/decorators/subclass.js\";import{writer as g}from\"../core/accessorSupport/decorators/writer.js\";import{OriginId as w,idToName as b,nameToId as M}from\"../core/accessorSupport/PropertyOrigin.js\";import T from\"./Layer.js\";import{KnowledgeGraphLayerDataManager as S}from\"./knowledgeGraph/KnowledgeGraphLayerDataManager.js\";import _ from\"./knowledgeGraph/KnowledgeGraphSublayer.js\";import{initializeLayersFromClientData as L}from\"./knowledgeGraph/layerUtils.js\";import{ArcGISService as D}from\"./mixins/ArcGISService.js\";import{BlendLayer as j}from\"./mixins/BlendLayer.js\";import{CustomParametersMixin as v}from\"./mixins/CustomParametersMixin.js\";import{OperationalLayer as k}from\"./mixins/OperationalLayer.js\";import{PortalLayer as A}from\"./mixins/PortalLayer.js\";import{RefreshableLayer as G}from\"./mixins/RefreshableLayer.js\";import{ScaleRangeLayer as E}from\"./mixins/ScaleRangeLayer.js\";import{url as C}from\"./support/commonProperties.js\";import{fetchKnowledgeGraph as I}from\"../rest/knowledgeGraphService.js\";import{f as N,t as R}from\"../chunks/persistableUrlUtils.js\";let U=class extends(j(E(G(D(k(A(n(v(T))))))))){constructor(e){super(e),this._graphTypeLookup=new Map,this._namedTypesModified=!1,this.dataManager=null,this.definitionSetMap=null,this.knowledgeGraph=null,this.layers=new(o.ofType(_)),this.memberEntityTypes=null,this.memberRelationshipTypes=null,this.operationalLayerType=\"KnowledgeGraphLayer\",this.sublayerIdsCache=new Map,this.tables=new(o.ofType(_)),this.type=\"knowledge-graph\",this.url=null,this.addHandles(l((()=>this.layers.concat(this.tables)),((e,t)=>this._handleSublayersChange(e,t)),d))}load(e){return this.addResolvingPromise(this._doLoad(e)),Promise.resolve(this)}async _doLoad(e){try{await this.loadFromPortal({supportedTypes:[\"Knowledge Graph Layer\"]},e)}catch(t){p(t)}await this._fetchMetadata(),await this._initializeLayerProperties(),this.loadLayerAssumingLocalCache(),this._layersLoadedFromAuthoritativeItem()||await L(this)}async _fetchMetadata(){if(!this.url)throw new s(\"knowledge-graph:missing-url\",\"KnowledgeGraphLayer must be created with a url\");const e=await I(this.url);this.knowledgeGraph=e,this._forEachGraphType((e=>{e.name&&this._graphTypeLookup.set(e.name,e)}))}async _initializeLayerProperties(){this.originIdOf(\"inclusionModeDefinition\")===w.USER?this._validateInclusionModeDefinition():await this._initializeInclusionModeDefinition(),this._setMemberTypes(),this.dataManager=new S({knowledgeGraph:this.knowledgeGraph,inclusionModeDefinition:this.inclusionModeDefinition})}async _initializeInclusionModeDefinition(){const e=this.definitionSetMap?await t(this.definitionSetMap,!0):{generateAllSublayers:!0,namedTypeDefinitions:new Map};[...this.layers.toArray(),...this.tables.toArray()].forEach((t=>{const i=this._graphTypeLookup.get(t.graphTypeName);i&&!e.namedTypeDefinitions.has(i.name)&&e.namedTypeDefinitions.set(i.name,{useAllData:!0})})),this.setAtOrigin(\"inclusionModeDefinition\",e,b(this.originIdOf(\"definitionSetMap\")))}_validateInclusionModeDefinition(){const{inclusionModeDefinition:e}=this;if(!e)return;const{namedTypeDefinitions:t}=e;if(t?.size>0)t.forEach(((e,i)=>{const o=this._graphTypeLookup.get(i);if(!o)return a.getLogger(this).warn(`A named type, ${i}, was in the inclusion list that wasn't in the data model and will be removed`),void t.delete(i);\"relationship\"!==o.type&&\"entity\"!==o.type&&(a.getLogger(this).warn(`A named type, ${i}, was in the inclusion list that wasn't properly modeled and will be removed`),t.delete(i))}));else if(!e.generateAllSublayers)throw new s(\"knowledge-graph:composite-layer-constructor\",\"If an explicit inclusion definition is defined, at least one namedTypeDefinition must also be defined\")}_setMemberTypes(){let e=[],t=[];const{inclusionModeDefinition:i}=this,o=i?.namedTypeDefinitions;!i||i.generateAllSublayers?(e=this.knowledgeGraph.dataModel?.entityTypes??[],t=this.knowledgeGraph.dataModel?.relationshipTypes??[]):o&&o.size>0&&o.forEach(((i,o)=>{const s=this._graphTypeLookup.get(o);switch(s?.type){case\"relationship\":t.push(s);break;case\"entity\":e.push(s)}})),this.memberEntityTypes=e,this.memberRelationshipTypes=t}_forEachGraphType(e){[...this.knowledgeGraph.dataModel?.entityTypes??[],...this.knowledgeGraph.dataModel?.relationshipTypes??[]].forEach((t=>{e(t)}))}_refreshNamedTypes(){this._namedTypesModified=!0;for(const e of this.layers)e.emit(\"refresh\",{dataChanged:!0});for(const e of this.tables)e.emit(\"refresh\",{dataChanged:!0})}async _handleNewRecords(e){const t=[];this.dataManager.addToLayer(e);for(const i of e)this.sublayerIdsCache.has(i.typeName)||(this.sublayerIdsCache.set(i.typeName,new Set),t.push(i.typeName)),this.sublayerIdsCache.get(i.typeName).add(i.id);for(const i of t){const e=this._graphTypeLookup.get(i);e&&(this._addSublayer(e),\"entity\"===e.type?this.dataManager.entityTypeNames.add(i):this.dataManager.relationshipTypeNames.add(i),this.dataManager.sublayerCaches.set(i,new Map))}await L(this,t),this._refreshNamedTypes()}_createSublayers(e,t,i){e.forEach((e=>{const o=this._createSublayer(e);i(o)&&t.push(o),this._updateSublayerCaches(e)}))}_addSublayer(e){const t=this._createSublayer(e);return t.geometryType?this.layers.push(t):this.tables.push(t),t}_createSublayer(e){return new _({objectType:e,parentCompositeLayer:this,graphType:e.type})}_updateSublayers(e,t){t.forEach((t=>{t.parentCompositeLayer=this;const i=e.find((e=>e.type===t.graphType&&e.name===t.graphTypeName));i&&(t.objectType=i,this._updateSublayerCaches(i))}))}_updateSublayerCaches(e){const t=this.dataManager.sublayerCaches;t.has(e.name)||t.set(e.name,new Map)}_saveUrlAsNewResource(e,t,i,o){e[t]=\"<pending>\",i.pendingOperations.push(x(this.inclusionModeDefinition).then((s=>{const a=P(o);e[t]=a.itemRelativeUrl,i.toAdd.push({resource:a,content:{type:\"blob\",blob:s},compress:!1,finish:e=>{this.definitionSetMap=e.url}})})))}_displaysAllRecords(e){for(const[,{useAllData:t}]of e.namedTypeDefinitions)if(!t)return!1;return!0}_handleSublayersChange(e,t){t&&(t.forEach((e=>{e.parent=null})),this.removeHandles(\"sublayers-owner\")),e&&(e.forEach((e=>{e.parent=this})),this.addHandles([e.on(\"after-add\",(({item:e})=>{e.parent=this})),e.on(\"after-remove\",(({item:e})=>{e.parent=null}))],\"sublayers-owner\"))}_layersLoadedFromAuthoritativeItem(){const e=this.originIdOf(\"layers\");return e>=w.PORTAL_ITEM&&e<w.USER}readDefinitionSetMap(e,t,i){return N(e,i)}writeDefinitionSetMap(e,t,i,o){const s=o?.portalItem,a=o?.resources,r=M(o?.origin);if(!s||!a||null==r)return void(e&&(t[i]=R(e,o)));const{inclusionModeDefinition:n}=this;if(!n||this._displaysAllRecords(n))return void(this.definitionSetMap=null);const p=this.originIdOf(\"inclusionModeDefinition\");if(p===w.USER||this._namedTypesModified||r<p)this._saveUrlAsNewResource(t,i,a,s);else if(r===p&&e){const r=R(e,o);h(r)?this._saveUrlAsNewResource(t,i,a,s):t[i]=r}}set inclusionModeDefinition(e){\"loaded\"!==this.loadStatus&&\"failed\"!==this.loadStatus?this._set(\"inclusionModeDefinition\",e):a.getLogger(this).error(\"#inclusionModeDefinition\",\"inclusionModeDefinition cannot be changed after the layer is loaded.\")}loadLayerAssumingLocalCache(){const e=[...this.memberEntityTypes,...this.memberRelationshipTypes];this.originIdOf(\"layers\")===w.DEFAULTS?this._createSublayers(e,this.layers,(e=>!!e.geometryType)):this._updateSublayers(e,this.layers),this.originIdOf(\"tables\")===w.DEFAULTS?this._createSublayers(e,this.tables,(e=>!e.geometryType)):this._updateSublayers(e,this.tables),this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.forEach(((e,t)=>{const i=r(this.sublayerIdsCache,t,(()=>new Set));e.members?.forEach((e=>{i.add(e.id)}))}))}async addRecords(e){await this.load(),await this._handleNewRecords(e)}async removeRecords(e){await this.load();const t=[];for(const i of e)!1===this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.get(i.typeName)?.useAllData&&this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.get(i.typeName)?.members?.has(i.id)&&t.push(i);this.dataManager.removeFromLayer(t);for(const i of t)this.sublayerIdsCache.get(i.typeName)?.delete(i.id);return this._refreshNamedTypes(),t}};e([m()],U.prototype,\"dataManager\",void 0),e([m({json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],U.prototype,\"definitionSetMap\",void 0),e([u(\"definitionSetMap\")],U.prototype,\"readDefinitionSetMap\",null),e([g(\"definitionSetMap\")],U.prototype,\"writeDefinitionSetMap\",null),e([m()],U.prototype,\"inclusionModeDefinition\",null),e([m()],U.prototype,\"knowledgeGraph\",void 0),e([m({type:o.ofType(_),json:{write:{ignoreOrigin:!0}}})],U.prototype,\"layers\",void 0),e([m()],U.prototype,\"memberEntityTypes\",void 0),e([m()],U.prototype,\"memberRelationshipTypes\",void 0),e([m({type:[\"KnowledgeGraphLayer\"]})],U.prototype,\"operationalLayerType\",void 0),e([m()],U.prototype,\"sublayerIdsCache\",void 0),e([m({type:o.ofType(_),json:{write:{ignoreOrigin:!0}}})],U.prototype,\"tables\",void 0),e([m({json:{read:!1}})],U.prototype,\"type\",void 0),e([m(C)],U.prototype,\"url\",void 0),U=e([f(\"esri.layers.KnowledgeGraphLayer\")],U);const O=U;async function x(e){const t=await i(e);return new Blob([t],{type:\"application/x-protobuf\"})}function P(e){const t=`definitionSetMap-${c()}.dat`,i=y(\"knowledgeGraphLayer\",t);return e.resourceFromPath(i)}export{O as default};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}