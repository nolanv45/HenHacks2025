{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from \"../Error.js\";\nimport t from \"../Logger.js\";\nimport { removeMaybe as o } from \"../maybe.js\";\nimport { onAbortOrThrow as s, isPromiseLike as r, isAbortError as n } from \"../promiseUtils.js\";\nimport { staticWorkerMessages as a } from \"./staticWorkerMessages.js\";\nimport { newJobId as i, receiveMessage as l, toInvokeError as d, postMessage as c, MessageType as h } from \"./utils.js\";\nimport { createWorker as p } from \"./workerFactory.js\";\nconst {\n  ABORT: b,\n  INVOKE: m,\n  OPEN: _,\n  OPENED: g,\n  RESPONSE: u\n} = h;\nclass j {\n  static async create(e) {\n    const t = await p();\n    return new j(t, e);\n  }\n  constructor(e, o) {\n    this._outJobs = new Map(), this._inJobs = new Map(), this.worker = e, this.id = o, e.addEventListener(\"message\", this._onMessage.bind(this)), e.addEventListener(\"error\", e => {\n      e.preventDefault(), t.getLogger(\"esri.core.workers.WorkerOwner\").error(e);\n    });\n  }\n  terminate() {\n    this.worker.terminate();\n  }\n  async open(e) {\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const {\n        signal: o\n      } = t,\n      r = i();\n    return new Promise((t, n) => {\n      const a = {\n        resolve: t,\n        reject: n,\n        abortHandle: s(o, () => {\n          this._outJobs.delete(r), this._post({\n            type: b,\n            jobId: r\n          });\n        })\n      };\n      this._outJobs.set(r, a), this._post({\n        type: _,\n        jobId: r,\n        modulePath: e\n      });\n    });\n  }\n  _onMessage(e) {\n    const t = l(e);\n    if (t) switch (t.type) {\n      case g:\n        this._onOpenedMessage(t);\n        break;\n      case u:\n        this._onResponseMessage(t);\n        break;\n      case b:\n        this._onAbortMessage(t);\n        break;\n      case m:\n        this._onInvokeMessage(t);\n    }\n  }\n  _onAbortMessage(e) {\n    const t = this._inJobs,\n      o = e.jobId,\n      s = t.get(o);\n    s && (s.controller && s.controller.abort(), t.delete(o));\n  }\n  _onInvokeMessage(e) {\n    const {\n        methodName: t,\n        jobId: o,\n        data: s,\n        abortable: i\n      } = e,\n      l = i ? new AbortController() : null,\n      c = this._inJobs,\n      h = a[t];\n    let p;\n    try {\n      if (\"function\" != typeof h) throw new TypeError(`${t} is not a function`);\n      p = h.call(null, s, {\n        signal: l ? l.signal : null\n      });\n    } catch (b) {\n      return void this._post({\n        type: u,\n        jobId: o,\n        error: d(b)\n      });\n    }\n    r(p) ? (c.set(o, {\n      controller: l,\n      promise: p\n    }), p.then(e => {\n      c.has(o) && (c.delete(o), this._post({\n        type: u,\n        jobId: o\n      }, e));\n    }, e => {\n      c.has(o) && (c.delete(o), e || (e = {\n        message: \"Error encountered at method\" + t\n      }), n(e) || this._post({\n        type: u,\n        jobId: o,\n        error: d(e || {\n          message: `Error encountered at method ${t}`\n        })\n      }));\n    })) : this._post({\n      type: u,\n      jobId: o\n    }, p);\n  }\n  _onOpenedMessage(e) {\n    const {\n        jobId: t,\n        data: s\n      } = e,\n      r = this._outJobs.get(t);\n    r && (this._outJobs.delete(t), o(r.abortHandle), r.resolve(s));\n  }\n  _onResponseMessage(t) {\n    const {\n        jobId: s,\n        error: r,\n        data: n\n      } = t,\n      a = this._outJobs.get(s);\n    a && (this._outJobs.delete(s), o(a.abortHandle), r ? a.reject(e.fromJSON(JSON.parse(r))) : a.resolve(n));\n  }\n  _post(e, t, o) {\n    return c(this.worker, e, t, o);\n  }\n}\nexport { j as default };","map":{"version":3,"names":["e","t","removeMaybe","o","onAbortOrThrow","s","isPromiseLike","r","isAbortError","n","staticWorkerMessages","a","newJobId","i","receiveMessage","l","toInvokeError","d","postMessage","c","MessageType","h","createWorker","p","ABORT","b","INVOKE","m","OPEN","_","OPENED","g","RESPONSE","u","j","create","constructor","_outJobs","Map","_inJobs","worker","id","addEventListener","_onMessage","bind","preventDefault","getLogger","error","terminate","open","arguments","length","undefined","signal","Promise","resolve","reject","abortHandle","delete","_post","type","jobId","set","modulePath","_onOpenedMessage","_onResponseMessage","_onAbortMessage","_onInvokeMessage","get","controller","abort","methodName","data","abortable","AbortController","TypeError","call","promise","then","has","message","fromJSON","JSON","parse","default"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/core/workers/WorkerOwner.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from\"../Error.js\";import t from\"../Logger.js\";import{removeMaybe as o}from\"../maybe.js\";import{onAbortOrThrow as s,isPromiseLike as r,isAbortError as n}from\"../promiseUtils.js\";import{staticWorkerMessages as a}from\"./staticWorkerMessages.js\";import{newJobId as i,receiveMessage as l,toInvokeError as d,postMessage as c,MessageType as h}from\"./utils.js\";import{createWorker as p}from\"./workerFactory.js\";const{ABORT:b,INVOKE:m,OPEN:_,OPENED:g,RESPONSE:u}=h;class j{static async create(e){const t=await p();return new j(t,e)}constructor(e,o){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=o,e.addEventListener(\"message\",this._onMessage.bind(this)),e.addEventListener(\"error\",(e=>{e.preventDefault(),t.getLogger(\"esri.core.workers.WorkerOwner\").error(e)}))}terminate(){this.worker.terminate()}async open(e,t={}){const{signal:o}=t,r=i();return new Promise(((t,n)=>{const a={resolve:t,reject:n,abortHandle:s(o,(()=>{this._outJobs.delete(r),this._post({type:b,jobId:r})}))};this._outJobs.set(r,a),this._post({type:_,jobId:r,modulePath:e})}))}_onMessage(e){const t=l(e);if(t)switch(t.type){case g:this._onOpenedMessage(t);break;case u:this._onResponseMessage(t);break;case b:this._onAbortMessage(t);break;case m:this._onInvokeMessage(t)}}_onAbortMessage(e){const t=this._inJobs,o=e.jobId,s=t.get(o);s&&(s.controller&&s.controller.abort(),t.delete(o))}_onInvokeMessage(e){const{methodName:t,jobId:o,data:s,abortable:i}=e,l=i?new AbortController:null,c=this._inJobs,h=a[t];let p;try{if(\"function\"!=typeof h)throw new TypeError(`${t} is not a function`);p=h.call(null,s,{signal:l?l.signal:null})}catch(b){return void this._post({type:u,jobId:o,error:d(b)})}r(p)?(c.set(o,{controller:l,promise:p}),p.then((e=>{c.has(o)&&(c.delete(o),this._post({type:u,jobId:o},e))}),(e=>{c.has(o)&&(c.delete(o),e||(e={message:\"Error encountered at method\"+t}),n(e)||this._post({type:u,jobId:o,error:d(e||{message:`Error encountered at method ${t}`})}))}))):this._post({type:u,jobId:o},p)}_onOpenedMessage(e){const{jobId:t,data:s}=e,r=this._outJobs.get(t);r&&(this._outJobs.delete(t),o(r.abortHandle),r.resolve(s))}_onResponseMessage(t){const{jobId:s,error:r,data:n}=t,a=this._outJobs.get(s);a&&(this._outJobs.delete(s),o(a.abortHandle),r?a.reject(e.fromJSON(JSON.parse(r))):a.resolve(n))}_post(e,t,o){return c(this.worker,e,t,o)}}export{j as default};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}