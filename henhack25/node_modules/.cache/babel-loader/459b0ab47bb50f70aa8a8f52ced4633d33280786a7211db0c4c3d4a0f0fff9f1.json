{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from \"../../core/Collection.js\";\nimport { sync as r } from \"../../core/reactiveUtils.js\";\nimport { autorun as t } from \"../../core/accessorSupport/trackingUtils.js\";\nconst n = new e(),\n  o = new WeakMap();\nfunction f(e) {\n  i(e) && n.push(new WeakRef(e));\n}\nfunction s(e) {\n  const r = n.find(r => r.deref() === e);\n  r && n.remove(r);\n}\nfunction i(e) {\n  return null != e && \"object\" == typeof e && \"refreshInterval\" in e && \"refresh\" in e;\n}\nfunction c(e, r) {\n  return Number.isFinite(e) && Number.isFinite(r) ? r <= 0 ? e : c(r, e % r) : 0;\n}\nlet l = 0,\n  a = 0;\nfunction u() {\n  const e = Date.now();\n  let r = !1;\n  for (const t of n) {\n    const n = t.deref();\n    if (n) {\n      if (n.refreshInterval) {\n        e - (o.get(n) ?? 0) + 5 >= 6e4 * n.refreshInterval && (o.set(n, e), n.refresh(e));\n      }\n    } else r = !0;\n  }\n  if (r) for (let t = n.length - 1; t >= 0; t--) {\n    n.at(t).deref() || n.removeAt(t);\n  }\n}\nt(() => {\n  const e = Date.now();\n  let r = 0;\n  for (const t of n) {\n    const n = t.deref();\n    n && (r = c(Math.round(6e4 * n.refreshInterval), r), n.refreshInterval ? o.get(n) || o.set(n, e) : o.delete(n));\n  }\n  if (r !== a) {\n    if (a = r, clearInterval(l), 0 === a) return void (l = 0);\n    l = setInterval(u, a);\n  }\n}, r);\nconst h = {\n  get hasRefreshTimer() {\n    return l > 0;\n  },\n  get tickInterval() {\n    return a;\n  },\n  forceRefresh() {\n    u();\n  },\n  hasLayer: e => i(e) && n.some(r => r.deref() === e),\n  clear() {\n    for (const e of n) {\n      const r = e.deref();\n      r && o.delete(r);\n    }\n    n.removeAll();\n  }\n};\nexport { f as registerLayer, h as test, s as unregisterLayer };","map":{"version":3,"names":["e","sync","r","autorun","t","n","o","WeakMap","f","i","push","WeakRef","s","find","deref","remove","c","Number","isFinite","l","a","u","Date","now","refreshInterval","get","set","refresh","length","at","removeAt","Math","round","delete","clearInterval","setInterval","h","hasRefreshTimer","tickInterval","forceRefresh","hasLayer","some","clear","removeAll","registerLayer","test","unregisterLayer"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/layers/mixins/refresh.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Collection.js\";import{sync as r}from\"../../core/reactiveUtils.js\";import{autorun as t}from\"../../core/accessorSupport/trackingUtils.js\";const n=new e,o=new WeakMap;function f(e){i(e)&&n.push(new WeakRef(e))}function s(e){const r=n.find((r=>r.deref()===e));r&&n.remove(r)}function i(e){return null!=e&&\"object\"==typeof e&&\"refreshInterval\"in e&&\"refresh\"in e}function c(e,r){return Number.isFinite(e)&&Number.isFinite(r)?r<=0?e:c(r,e%r):0}let l=0,a=0;function u(){const e=Date.now();let r=!1;for(const t of n){const n=t.deref();if(n){if(n.refreshInterval){e-(o.get(n)??0)+5>=6e4*n.refreshInterval&&(o.set(n,e),n.refresh(e))}}else r=!0}if(r)for(let t=n.length-1;t>=0;t--){n.at(t).deref()||n.removeAt(t)}}t((()=>{const e=Date.now();let r=0;for(const t of n){const n=t.deref();n&&(r=c(Math.round(6e4*n.refreshInterval),r),n.refreshInterval?o.get(n)||o.set(n,e):o.delete(n))}if(r!==a){if(a=r,clearInterval(l),0===a)return void(l=0);l=setInterval(u,a)}}),r);const h={get hasRefreshTimer(){return l>0},get tickInterval(){return a},forceRefresh(){u()},hasLayer:e=>i(e)&&n.some((r=>r.deref()===e)),clear(){for(const e of n){const r=e.deref();r&&o.delete(r)}n.removeAll()}};export{f as registerLayer,h as test,s as unregisterLayer};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}