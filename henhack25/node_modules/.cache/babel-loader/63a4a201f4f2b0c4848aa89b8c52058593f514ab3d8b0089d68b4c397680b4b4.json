{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from \"../../../../config.js\";\nimport t from \"../../../../request.js\";\nimport { bidiText as i } from \"../../../../core/BidiText.js\";\nimport s from \"../../../../core/Error.js\";\nimport { getFullyQualifiedFontName as r } from \"../../../../core/fontUtils.js\";\nimport has from \"../../../../core/has.js\";\nimport a from \"../../../../core/Logger.js\";\nimport { throwIfAborted as n, isAbortError as o } from \"../../../../core/promiseUtils.js\";\nimport { QueueProcessor as c } from \"../../../../core/QueueProcessor.js\";\nimport { pt2px as h } from \"../../../../core/screenUtils.js\";\nimport { numericHash as l } from \"../../../../core/string.js\";\nimport u from \"../../../../symbols/cim/CIMResourceManager.js\";\nimport { CIMSymbolHelper as p } from \"../../../../symbols/cim/CIMSymbolHelper.js\";\nimport m from \"../../../../symbols/cim/Rasterizer.js\";\nimport { normalizeDashTemplate as d } from \"../../../../symbols/cim/utils.js\";\nimport { svgSdfTextureInnerSize as g, textureBindingSpriteAtlas as f, textureBindingGlyphAtlas as y } from \"./definitions.js\";\nimport { MosaicType as M } from \"./enums.js\";\nimport _ from \"./GlyphMosaic.js\";\nimport I from \"./GlyphSource.js\";\nimport w from \"./Rect.js\";\nimport S from \"./SDFConverter.js\";\nimport z from \"./SpriteMosaic.js\";\nimport { charCodes as R, discardUrlIfHasUrlHash as T, getCIMMarkerPlacementHash as C, isSVGImage as P } from \"./Utils.js\";\nimport { AnimatableTextureResource as x } from \"./animatedFormats/AnimatableTextureResource.js\";\nimport { AnimationStore as b } from \"./animations/store/AnimationStore.js\";\nimport { TextureSamplingMode as j } from \"../../../webgl/enums.js\";\nconst $ = \"arial-unicode-ms-regular\",\n  v = () => a.getLogger(\"esri.views.MapView\"),\n  k = (e, t, i) => v().error(new s(e, t, i)),\n  A = function (e) {\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n    return v().warnOnce(e, t);\n  };\nclass F {\n  static fromMosaic(e, t) {\n    return new F(e, t.page, t.sdf, t.samplingMode);\n  }\n  constructor(e, t, i, s) {\n    this.mosaicType = e, this.page = t, this.sdf = i, this.samplingMode = s;\n  }\n}\nclass G {\n  constructor(i) {\n    this._requestRender = i, this._resourceManager = new u(), this._invalidFontsMap = new Map(), this._sdfConverter = new S(g), this._bindingInfos = new Array(), this._hashToBindingIndex = new Map(), this._ongoingRasterizations = new Map(), this._imageRequestQueue = new c({\n      concurrency: 10,\n      process: async (e, i) => {\n        n(i);\n        try {\n          return await t(e, {\n            responseType: \"image\",\n            signal: i\n          });\n        } catch (r) {\n          if (!o(r)) throw new s(\"mapview-invalid-resource\", `Could not fetch requested resource at ${e}`, r);\n          throw r;\n        }\n      }\n    }), this.animationStore = new b(), this._spriteMosaic = new z(2048, 2048, 500), this._glyphSource = new I(`${e.fontsUrl}/{fontstack}/{range}.pbf`), this._glyphMosaic = new _(1024, 1024, this._glyphSource), this._rasterizer = new m(this.resourceManager);\n  }\n  dispose() {\n    this._spriteMosaic.dispose(), this._glyphMosaic.dispose(), this._rasterizer.dispose(), this._sdfConverter.dispose(), this._spriteMosaic = null, this._glyphMosaic = null, this._sdfConverter = null, this._hashToBindingIndex.clear(), this._hashToBindingIndex = null, this._bindingInfos = null, this._ongoingRasterizations.clear(), this._ongoingRasterizations = null, this._imageRequestQueue.clear(), this._imageRequestQueue = null, this._resourceManager.destroy(), this.animationStore.destroy();\n  }\n  get sprites() {\n    return this._spriteMosaic;\n  }\n  get glyphs() {\n    return this._glyphMosaic;\n  }\n  get resourceManager() {\n    return this._resourceManager;\n  }\n  async rasterizeItem(e, t) {\n    if (null == e) return k(\"mapview-null-resource\", \"Unable to rasterize null resource\"), null;\n    if (\"animation-info\" === e.type) {\n      const {\n          resource: t\n        } = e,\n        i = this.animationStore.add(t),\n        {\n          location: s\n        } = i;\n      return {\n        rect: new w(s.column, s.row, t.length, 1),\n        page: s.page,\n        type: \"sprite\",\n        width: t.length,\n        height: 1,\n        rasterizationScale: 1,\n        sdfPaddingRatio: .5,\n        samplingMode: \"Linear\",\n        sdfDecodeCoeff: 1,\n        simplePattern: !1\n      };\n    }\n    if (\"cim-rasterization-info\" !== e.type) return k(\"mapview-unexpected-resource\", \"Unable to rasterize resource\"), null;\n    const {\n      resource: i\n    } = e;\n    if (\"text\" === i.type) {\n      const e = await this._rasterizeText(i, t);\n      for (const t of e.glyphs) this._setTextureBinding(M.GLYPH, t);\n      return e;\n    }\n    const s = await this._rasterizeSprite(i, t);\n    return s && this._setTextureBinding(M.SPRITE, s), s;\n  }\n  getMosaicInfo(e, t) {\n    let i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;\n    const s = this._getTextureBindingInfo(e, t, i);\n    return s ? {\n      size: s.size,\n      texture: {\n        texture: s.texture,\n        unit: \"sprite\" === s.type ? f : y\n      }\n    } : (k(\"mapview-invalid-resource\", `Unable to find resource for ${t}`), {\n      size: [0, 0],\n      texture: {\n        texture: null,\n        unit: 0\n      }\n    });\n  }\n  _getTextureBindingInfo(e, t, i) {\n    const s = this._bindingInfos[t - 1],\n      r = s.page,\n      a = \"Nearest\" === s.samplingMode ? j.NEAREST : i ? j.LINEAR_MIPMAP_LINEAR : j.LINEAR;\n    switch (s.mosaicType) {\n      case M.SPRITE:\n        {\n          const t = [this.sprites.getWidth(r), this.sprites.getHeight(r)],\n            i = this._spriteMosaic.getTexture(e, r);\n          return i.setSamplingMode(a), {\n            type: \"sprite\",\n            texture: i,\n            size: t\n          };\n        }\n      case M.GLYPH:\n        {\n          const t = [this.glyphs.width, this.glyphs.height],\n            i = this._glyphMosaic.getTexture(e, r);\n          return this._glyphMosaic.bind(e, a, r, y), i.setSamplingMode(a), {\n            type: \"glyph\",\n            texture: i,\n            size: t\n          };\n        }\n      default:\n        return k(\"mapview-texture-manager\", `Cannot handle unknown type ${s.mosaicType}`), null;\n    }\n  }\n  _hashMosaic(e, t) {\n    return 1 | e << 1 | (t.sdf ? 1 : 0) << 2 | (\"Nearest\" === t.samplingMode ? 1 : 0) << 3 | t.page << 4;\n  }\n  _setTextureBinding(e, t) {\n    const i = this._hashMosaic(e, t);\n    if (!this._hashToBindingIndex.has(i)) {\n      const s = F.fromMosaic(e, t),\n        r = this._bindingInfos.length + 1;\n      this._hashToBindingIndex.set(i, r), this._bindingInfos.push(s);\n    }\n    t.textureBinding = this._hashToBindingIndex.get(i);\n  }\n  async _rasterizeText(e, t) {\n    const {\n        font: s,\n        textString: a\n      } = e,\n      n = r(s),\n      o = this._invalidFontsMap.has(n),\n      [c, h] = i(a),\n      l = R(c);\n    try {\n      const e = o ? $ : n;\n      has(\"esri-2d-stabilize-glyphs\") && (await this._glyphMosaic.preloadASCIIGlyphCache(e));\n      return {\n        type: \"glyphs\",\n        glyphs: await this._glyphMosaic.getGlyphItems(e, l, t),\n        isRightToLeft: h\n      };\n    } catch (u) {\n      A(`Font ${n} is not available on the web, using \"Arial Unicode MS Regular\"`), this._invalidFontsMap.set(n, !0);\n      return {\n        type: \"glyphs\",\n        glyphs: await this._glyphMosaic.getGlyphItems($, l, t),\n        isRightToLeft: h\n      };\n    }\n  }\n  _hashSpriteResource(e) {\n    switch (e.type) {\n      case \"path\":\n        return `path:${e.path}.${e.asFill ? 1 : 0}`;\n      case \"CIMPictureMarker\":\n        return `${e.type}:${e.url}:${e.size}:${C(e.markerPlacement)}`;\n      case \"CIMPictureFill\":\n        return `${e.type}:${e.url}:${e.height}`;\n      case \"CIMPictureStroke\":\n        return `${e.type}:${e.url}:${e.width}`;\n      case \"dash\":\n        return `dash:${e.capStyle}.${d(e.dashTemplate).join(\"\")}`;\n      case \"sdf\":\n        return `sdf:${JSON.stringify(e.geom)}.${e.asFill ? 1 : 0}`;\n      case \"fill-style\":\n        return `fill_style:${e.style}`;\n      case \"animated\":\n        return JSON.stringify(T(e));\n      case \"CIMGradientFill\":\n      case \"CIMGradientStroke\":\n        return `gradient:${JSON.stringify(e.colorRamp)}.${e.gradientType}.${e.interval}`;\n      case \"CIMHatchFill\":\n      case \"CIMVectorMarker\":\n        return JSON.stringify(e);\n    }\n  }\n  async _rasterizeSprite(e, t) {\n    if (!e) return null;\n    const i = l(this._hashSpriteResource(e));\n    if (this._spriteMosaic.has(i)) return this._spriteMosaic.getSpriteItem(i);\n    if (\"url\" in e && e.url || \"CIMPictureFill\" === e.type || \"CIMPictureStroke\" === e.type || \"CIMPictureMarker\" === e.type || \"CIMVectorMarker\" === e.type) {\n      const t = [];\n      p.fetchResources({\n        type: \"CIMPointSymbol\",\n        symbolLayers: [e]\n      }, this._resourceManager, t), t.length > 0 && (await Promise.all(t));\n    }\n    switch (e.type) {\n      case \"CIMPictureMarker\":\n        return \"CIMMarkerPlacementInsidePolygon\" === e.markerPlacement?.type ? this._rasterizeJSONResource(i, e) : this._handleAsyncResource(i, e, t);\n      case \"animated\":\n      case \"CIMPictureFill\":\n      case \"CIMPictureStroke\":\n      case \"path\":\n        return this._handleAsyncResource(i, e, t);\n      case \"CIMGradientFill\":\n      case \"CIMGradientStroke\":\n      case \"CIMHatchFill\":\n      case \"CIMVectorMarker\":\n      case \"dash\":\n      case \"fill-style\":\n      case \"sdf\":\n        return this._rasterizeJSONResource(i, e);\n    }\n  }\n  _rasterizeJSONResource(e, t) {\n    const i = this._rasterizer.rasterizeJSONResource(t);\n    if (i) {\n      const {\n        size: s,\n        image: r,\n        sdf: a,\n        simplePattern: n,\n        rasterizationScale: o,\n        samplingMode: c,\n        sdfPaddingRatio: h,\n        sdfDecodeCoeff: l\n      } = i;\n      return this._addItemToMosaic(e, s, {\n        type: \"static\",\n        data: r\n      }, N(t), a, n, o, c, h, l);\n    }\n    return null;\n  }\n  async _handleAsyncResource(e, t, i) {\n    if (this._ongoingRasterizations.has(e)) return this._ongoingRasterizations.get(e);\n    let s;\n    return s = \"path\" === t.type ? this._handleSVG(t, e, i) : this._handleImage(t, e, i), this._ongoingRasterizations.set(e, s), s.finally(() => this._ongoingRasterizations.delete(e)), s;\n  }\n  async _handleSVG(e, t, i) {\n    const s = [g, g],\n      {\n        asFill: r\n      } = e,\n      a = await this._sdfConverter.draw(e.path, r, i);\n    return this._addItemToMosaic(t, s, {\n      type: \"static\",\n      data: new Uint32Array(a.buffer)\n    }, !1, !0, !0);\n  }\n  async _handleGIFOrPNG(e, t, i) {\n    const s = e.url,\n      r = this.resourceManager.getResource(s);\n    if (null == r) return null;\n    const {\n      width: a,\n      height: n\n    } = r;\n    if (r instanceof HTMLImageElement) {\n      if (\"animated\" === e.type) return k(\"mapview-unexpected-resource\", \"Attempt to configure animations for a non-animated image.\"), null;\n      const i = \"colorSubstitutions\" in e ? e.colorSubstitutions : void 0,\n        {\n          size: s,\n          sdf: o,\n          image: c\n        } = this._rasterizer.rasterizeImageResource(a, n, r, i);\n      return this._addItemToMosaic(t, s, {\n        type: \"static\",\n        data: c\n      }, N(e), o, !1);\n    }\n    let o, c, h;\n    \"animated\" === e.type ? (o = !1, c = {\n      type: \"CIMAnimatedSymbolProperties\",\n      playAnimation: e.playAnimation,\n      reverseAnimation: e.reverseAnimation,\n      randomizeStartTime: e.randomizeStartTime,\n      randomizeStartSeed: e.randomizeStartSeed,\n      startTimeOffset: e.startTimeOffset,\n      duration: e.duration,\n      repeatType: e.repeatType,\n      repeatDelay: e.repeatDelay\n    }, h = e.startGroup || 0) : (o = N(e), c = {\n      type: \"CIMAnimatedSymbolProperties\"\n    }, h = 0);\n    const l = new x(r, this._requestRender, c, h);\n    return this._addItemToMosaic(t, [l.width, l.height], {\n      type: \"animated\",\n      data: l\n    }, o, !1, !1);\n  }\n  async _handleImage(e, t, i) {\n    const r = e.url;\n    if (L(r) || E(r)) return this._handleGIFOrPNG(e, t, i);\n    if (\"animated\" === e.type) return k(\"mapview-unexpected-resource\", \"Attempt to configure animations for a non-animated image.\"), null;\n    try {\n      let s;\n      const a = this.resourceManager.getResource(r);\n      if (null != a && a instanceof HTMLImageElement) s = a;else {\n        const {\n          data: e\n        } = await this._imageRequestQueue.push(r, {\n          ...i\n        });\n        s = e;\n      }\n      if (P(r)) if (\"width\" in e && \"height\" in e) s.width = h(e.width), s.height = h(e.height);else if (\"cim\" in e) {\n        const t = e;\n        s.width = h(t.width ?? t.scaleX * t.size), s.height = h(t.size);\n      }\n      if (!s.width || !s.height) return null;\n      const n = s.width,\n        o = s.height,\n        c = \"colorSubstitutions\" in e ? e.colorSubstitutions : void 0,\n        {\n          size: l,\n          sdf: u,\n          image: p\n        } = this._rasterizer.rasterizeImageResource(n, o, s, c);\n      return this._addItemToMosaic(t, l, {\n        type: \"static\",\n        data: p\n      }, N(e), u, !1);\n    } catch (k) {\n      if (!o(k)) throw new s(\"mapview-invalid-resource\", `Could not fetch requested resource at ${r}. ${k.message}`);\n      throw k;\n    }\n  }\n  _addItemToMosaic(e, t, i, s, r, a, n, o, c, h) {\n    return this._spriteMosaic.addSpriteItem(e, t, i, s, r, a, n, o, c, h);\n  }\n}\nfunction N(e) {\n  switch (e.type) {\n    case \"CIMVectorMarker\":\n    case \"CIMPictureMarker\":\n      return U(e);\n    default:\n      return !0;\n  }\n}\nconst B = e => null != e && e.startsWith(\"data:image/gif\"),\n  L = e => e && (e.includes(\".gif\") || B(e)),\n  O = e => null != e && e.startsWith(\"data:image/png\"),\n  E = e => e && (e.includes(\".png\") || O(e)),\n  U = e => e && \"markerPlacement\" in e && e.markerPlacement && \"CIMMarkerPlacementInsidePolygon\" === e.markerPlacement.type;\nexport { G as default };","map":{"version":3,"names":["e","t","bidiText","i","s","getFullyQualifiedFontName","r","has","a","throwIfAborted","n","isAbortError","o","QueueProcessor","c","pt2px","h","numericHash","l","u","CIMSymbolHelper","p","m","normalizeDashTemplate","d","svgSdfTextureInnerSize","g","textureBindingSpriteAtlas","f","textureBindingGlyphAtlas","y","MosaicType","M","_","I","w","S","z","charCodes","R","discardUrlIfHasUrlHash","T","getCIMMarkerPlacementHash","C","isSVGImage","P","AnimatableTextureResource","x","AnimationStore","b","TextureSamplingMode","j","$","v","getLogger","k","error","A","arguments","length","undefined","warnOnce","F","fromMosaic","page","sdf","samplingMode","constructor","mosaicType","G","_requestRender","_resourceManager","_invalidFontsMap","Map","_sdfConverter","_bindingInfos","Array","_hashToBindingIndex","_ongoingRasterizations","_imageRequestQueue","concurrency","process","responseType","signal","animationStore","_spriteMosaic","_glyphSource","fontsUrl","_glyphMosaic","_rasterizer","resourceManager","dispose","clear","destroy","sprites","glyphs","rasterizeItem","type","resource","add","location","rect","column","row","width","height","rasterizationScale","sdfPaddingRatio","sdfDecodeCoeff","simplePattern","_rasterizeText","_setTextureBinding","GLYPH","_rasterizeSprite","SPRITE","getMosaicInfo","_getTextureBindingInfo","size","texture","unit","NEAREST","LINEAR_MIPMAP_LINEAR","LINEAR","getWidth","getHeight","getTexture","setSamplingMode","bind","_hashMosaic","set","push","textureBinding","get","font","textString","preloadASCIIGlyphCache","getGlyphItems","isRightToLeft","_hashSpriteResource","path","asFill","url","markerPlacement","capStyle","dashTemplate","join","JSON","stringify","geom","style","colorRamp","gradientType","interval","getSpriteItem","fetchResources","symbolLayers","Promise","all","_rasterizeJSONResource","_handleAsyncResource","rasterizeJSONResource","image","_addItemToMosaic","data","N","_handleSVG","_handleImage","finally","delete","draw","Uint32Array","buffer","_handleGIFOrPNG","getResource","HTMLImageElement","colorSubstitutions","rasterizeImageResource","playAnimation","reverseAnimation","randomizeStartTime","randomizeStartSeed","startTimeOffset","duration","repeatType","repeatDelay","startGroup","L","E","scaleX","message","addSpriteItem","U","B","startsWith","includes","O","default"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/2d/engine/webgl/TextureManager.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from\"../../../../config.js\";import t from\"../../../../request.js\";import{bidiText as i}from\"../../../../core/BidiText.js\";import s from\"../../../../core/Error.js\";import{getFullyQualifiedFontName as r}from\"../../../../core/fontUtils.js\";import has from\"../../../../core/has.js\";import a from\"../../../../core/Logger.js\";import{throwIfAborted as n,isAbortError as o}from\"../../../../core/promiseUtils.js\";import{QueueProcessor as c}from\"../../../../core/QueueProcessor.js\";import{pt2px as h}from\"../../../../core/screenUtils.js\";import{numericHash as l}from\"../../../../core/string.js\";import u from\"../../../../symbols/cim/CIMResourceManager.js\";import{CIMSymbolHelper as p}from\"../../../../symbols/cim/CIMSymbolHelper.js\";import m from\"../../../../symbols/cim/Rasterizer.js\";import{normalizeDashTemplate as d}from\"../../../../symbols/cim/utils.js\";import{svgSdfTextureInnerSize as g,textureBindingSpriteAtlas as f,textureBindingGlyphAtlas as y}from\"./definitions.js\";import{MosaicType as M}from\"./enums.js\";import _ from\"./GlyphMosaic.js\";import I from\"./GlyphSource.js\";import w from\"./Rect.js\";import S from\"./SDFConverter.js\";import z from\"./SpriteMosaic.js\";import{charCodes as R,discardUrlIfHasUrlHash as T,getCIMMarkerPlacementHash as C,isSVGImage as P}from\"./Utils.js\";import{AnimatableTextureResource as x}from\"./animatedFormats/AnimatableTextureResource.js\";import{AnimationStore as b}from\"./animations/store/AnimationStore.js\";import{TextureSamplingMode as j}from\"../../../webgl/enums.js\";const $=\"arial-unicode-ms-regular\",v=()=>a.getLogger(\"esri.views.MapView\"),k=(e,t,i)=>v().error(new s(e,t,i)),A=(e,t=\"\")=>v().warnOnce(e,t);class F{static fromMosaic(e,t){return new F(e,t.page,t.sdf,t.samplingMode)}constructor(e,t,i,s){this.mosaicType=e,this.page=t,this.sdf=i,this.samplingMode=s}}class G{constructor(i){this._requestRender=i,this._resourceManager=new u,this._invalidFontsMap=new Map,this._sdfConverter=new S(g),this._bindingInfos=new Array,this._hashToBindingIndex=new Map,this._ongoingRasterizations=new Map,this._imageRequestQueue=new c({concurrency:10,process:async(e,i)=>{n(i);try{return await t(e,{responseType:\"image\",signal:i})}catch(r){if(!o(r))throw new s(\"mapview-invalid-resource\",`Could not fetch requested resource at ${e}`,r);throw r}}}),this.animationStore=new b,this._spriteMosaic=new z(2048,2048,500),this._glyphSource=new I(`${e.fontsUrl}/{fontstack}/{range}.pbf`),this._glyphMosaic=new _(1024,1024,this._glyphSource),this._rasterizer=new m(this.resourceManager)}dispose(){this._spriteMosaic.dispose(),this._glyphMosaic.dispose(),this._rasterizer.dispose(),this._sdfConverter.dispose(),this._spriteMosaic=null,this._glyphMosaic=null,this._sdfConverter=null,this._hashToBindingIndex.clear(),this._hashToBindingIndex=null,this._bindingInfos=null,this._ongoingRasterizations.clear(),this._ongoingRasterizations=null,this._imageRequestQueue.clear(),this._imageRequestQueue=null,this._resourceManager.destroy(),this.animationStore.destroy()}get sprites(){return this._spriteMosaic}get glyphs(){return this._glyphMosaic}get resourceManager(){return this._resourceManager}async rasterizeItem(e,t){if(null==e)return k(\"mapview-null-resource\",\"Unable to rasterize null resource\"),null;if(\"animation-info\"===e.type){const{resource:t}=e,i=this.animationStore.add(t),{location:s}=i;return{rect:new w(s.column,s.row,t.length,1),page:s.page,type:\"sprite\",width:t.length,height:1,rasterizationScale:1,sdfPaddingRatio:.5,samplingMode:\"Linear\",sdfDecodeCoeff:1,simplePattern:!1}}if(\"cim-rasterization-info\"!==e.type)return k(\"mapview-unexpected-resource\",\"Unable to rasterize resource\"),null;const{resource:i}=e;if(\"text\"===i.type){const e=await this._rasterizeText(i,t);for(const t of e.glyphs)this._setTextureBinding(M.GLYPH,t);return e}const s=await this._rasterizeSprite(i,t);return s&&this._setTextureBinding(M.SPRITE,s),s}getMosaicInfo(e,t,i=!1){const s=this._getTextureBindingInfo(e,t,i);return s?{size:s.size,texture:{texture:s.texture,unit:\"sprite\"===s.type?f:y}}:(k(\"mapview-invalid-resource\",`Unable to find resource for ${t}`),{size:[0,0],texture:{texture:null,unit:0}})}_getTextureBindingInfo(e,t,i){const s=this._bindingInfos[t-1],r=s.page,a=\"Nearest\"===s.samplingMode?j.NEAREST:i?j.LINEAR_MIPMAP_LINEAR:j.LINEAR;switch(s.mosaicType){case M.SPRITE:{const t=[this.sprites.getWidth(r),this.sprites.getHeight(r)],i=this._spriteMosaic.getTexture(e,r);return i.setSamplingMode(a),{type:\"sprite\",texture:i,size:t}}case M.GLYPH:{const t=[this.glyphs.width,this.glyphs.height],i=this._glyphMosaic.getTexture(e,r);return this._glyphMosaic.bind(e,a,r,y),i.setSamplingMode(a),{type:\"glyph\",texture:i,size:t}}default:return k(\"mapview-texture-manager\",`Cannot handle unknown type ${s.mosaicType}`),null}}_hashMosaic(e,t){return 1|e<<1|(t.sdf?1:0)<<2|(\"Nearest\"===t.samplingMode?1:0)<<3|t.page<<4}_setTextureBinding(e,t){const i=this._hashMosaic(e,t);if(!this._hashToBindingIndex.has(i)){const s=F.fromMosaic(e,t),r=this._bindingInfos.length+1;this._hashToBindingIndex.set(i,r),this._bindingInfos.push(s)}t.textureBinding=this._hashToBindingIndex.get(i)}async _rasterizeText(e,t){const{font:s,textString:a}=e,n=r(s),o=this._invalidFontsMap.has(n),[c,h]=i(a),l=R(c);try{const e=o?$:n;has(\"esri-2d-stabilize-glyphs\")&&await this._glyphMosaic.preloadASCIIGlyphCache(e);return{type:\"glyphs\",glyphs:await this._glyphMosaic.getGlyphItems(e,l,t),isRightToLeft:h}}catch(u){A(`Font ${n} is not available on the web, using \"Arial Unicode MS Regular\"`),this._invalidFontsMap.set(n,!0);return{type:\"glyphs\",glyphs:await this._glyphMosaic.getGlyphItems($,l,t),isRightToLeft:h}}}_hashSpriteResource(e){switch(e.type){case\"path\":return`path:${e.path}.${e.asFill?1:0}`;case\"CIMPictureMarker\":return`${e.type}:${e.url}:${e.size}:${C(e.markerPlacement)}`;case\"CIMPictureFill\":return`${e.type}:${e.url}:${e.height}`;case\"CIMPictureStroke\":return`${e.type}:${e.url}:${e.width}`;case\"dash\":return`dash:${e.capStyle}.${d(e.dashTemplate).join(\"\")}`;case\"sdf\":return`sdf:${JSON.stringify(e.geom)}.${e.asFill?1:0}`;case\"fill-style\":return`fill_style:${e.style}`;case\"animated\":return JSON.stringify(T(e));case\"CIMGradientFill\":case\"CIMGradientStroke\":return`gradient:${JSON.stringify(e.colorRamp)}.${e.gradientType}.${e.interval}`;case\"CIMHatchFill\":case\"CIMVectorMarker\":return JSON.stringify(e)}}async _rasterizeSprite(e,t){if(!e)return null;const i=l(this._hashSpriteResource(e));if(this._spriteMosaic.has(i))return this._spriteMosaic.getSpriteItem(i);if(\"url\"in e&&e.url||\"CIMPictureFill\"===e.type||\"CIMPictureStroke\"===e.type||\"CIMPictureMarker\"===e.type||\"CIMVectorMarker\"===e.type){const t=[];p.fetchResources({type:\"CIMPointSymbol\",symbolLayers:[e]},this._resourceManager,t),t.length>0&&await Promise.all(t)}switch(e.type){case\"CIMPictureMarker\":return\"CIMMarkerPlacementInsidePolygon\"===e.markerPlacement?.type?this._rasterizeJSONResource(i,e):this._handleAsyncResource(i,e,t);case\"animated\":case\"CIMPictureFill\":case\"CIMPictureStroke\":case\"path\":return this._handleAsyncResource(i,e,t);case\"CIMGradientFill\":case\"CIMGradientStroke\":case\"CIMHatchFill\":case\"CIMVectorMarker\":case\"dash\":case\"fill-style\":case\"sdf\":return this._rasterizeJSONResource(i,e)}}_rasterizeJSONResource(e,t){const i=this._rasterizer.rasterizeJSONResource(t);if(i){const{size:s,image:r,sdf:a,simplePattern:n,rasterizationScale:o,samplingMode:c,sdfPaddingRatio:h,sdfDecodeCoeff:l}=i;return this._addItemToMosaic(e,s,{type:\"static\",data:r},N(t),a,n,o,c,h,l)}return null}async _handleAsyncResource(e,t,i){if(this._ongoingRasterizations.has(e))return this._ongoingRasterizations.get(e);let s;return s=\"path\"===t.type?this._handleSVG(t,e,i):this._handleImage(t,e,i),this._ongoingRasterizations.set(e,s),s.finally((()=>this._ongoingRasterizations.delete(e))),s}async _handleSVG(e,t,i){const s=[g,g],{asFill:r}=e,a=await this._sdfConverter.draw(e.path,r,i);return this._addItemToMosaic(t,s,{type:\"static\",data:new Uint32Array(a.buffer)},!1,!0,!0)}async _handleGIFOrPNG(e,t,i){const s=e.url,r=this.resourceManager.getResource(s);if(null==r)return null;const{width:a,height:n}=r;if(r instanceof HTMLImageElement){if(\"animated\"===e.type)return k(\"mapview-unexpected-resource\",\"Attempt to configure animations for a non-animated image.\"),null;const i=\"colorSubstitutions\"in e?e.colorSubstitutions:void 0,{size:s,sdf:o,image:c}=this._rasterizer.rasterizeImageResource(a,n,r,i);return this._addItemToMosaic(t,s,{type:\"static\",data:c},N(e),o,!1)}let o,c,h;\"animated\"===e.type?(o=!1,c={type:\"CIMAnimatedSymbolProperties\",playAnimation:e.playAnimation,reverseAnimation:e.reverseAnimation,randomizeStartTime:e.randomizeStartTime,randomizeStartSeed:e.randomizeStartSeed,startTimeOffset:e.startTimeOffset,duration:e.duration,repeatType:e.repeatType,repeatDelay:e.repeatDelay},h=e.startGroup||0):(o=N(e),c={type:\"CIMAnimatedSymbolProperties\"},h=0);const l=new x(r,this._requestRender,c,h);return this._addItemToMosaic(t,[l.width,l.height],{type:\"animated\",data:l},o,!1,!1)}async _handleImage(e,t,i){const r=e.url;if(L(r)||E(r))return this._handleGIFOrPNG(e,t,i);if(\"animated\"===e.type)return k(\"mapview-unexpected-resource\",\"Attempt to configure animations for a non-animated image.\"),null;try{let s;const a=this.resourceManager.getResource(r);if(null!=a&&a instanceof HTMLImageElement)s=a;else{const{data:e}=await this._imageRequestQueue.push(r,{...i});s=e}if(P(r))if(\"width\"in e&&\"height\"in e)s.width=h(e.width),s.height=h(e.height);else if(\"cim\"in e){const t=e;s.width=h(t.width??t.scaleX*t.size),s.height=h(t.size)}if(!s.width||!s.height)return null;const n=s.width,o=s.height,c=\"colorSubstitutions\"in e?e.colorSubstitutions:void 0,{size:l,sdf:u,image:p}=this._rasterizer.rasterizeImageResource(n,o,s,c);return this._addItemToMosaic(t,l,{type:\"static\",data:p},N(e),u,!1)}catch(k){if(!o(k))throw new s(\"mapview-invalid-resource\",`Could not fetch requested resource at ${r}. ${k.message}`);throw k}}_addItemToMosaic(e,t,i,s,r,a,n,o,c,h){return this._spriteMosaic.addSpriteItem(e,t,i,s,r,a,n,o,c,h)}}function N(e){switch(e.type){case\"CIMVectorMarker\":case\"CIMPictureMarker\":return U(e);default:return!0}}const B=e=>null!=e&&e.startsWith(\"data:image/gif\"),L=e=>e&&(e.includes(\".gif\")||B(e)),O=e=>null!=e&&e.startsWith(\"data:image/png\"),E=e=>e&&(e.includes(\".png\")||O(e)),U=e=>e&&\"markerPlacement\"in e&&e.markerPlacement&&\"CIMMarkerPlacementInsidePolygon\"===e.markerPlacement.type;export{G as default};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}