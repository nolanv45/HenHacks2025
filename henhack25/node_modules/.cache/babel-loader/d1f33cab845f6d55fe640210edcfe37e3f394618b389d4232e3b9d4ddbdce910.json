{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { clamp as e } from \"../../../../../../../core/mathUtils.js\";\nimport { disposeMaybe as t } from \"../../../../../../../core/maybe.js\";\nimport { isSVG as i } from \"../../../../../../../core/urlUtils.js\";\nimport { simplePipelineState as r } from \"../../utils.js\";\nimport { Technique as s } from \"../Technique.js\";\nimport { TechniqueType as o } from \"../TechniqueType.js\";\nimport { MagnifierShader as a } from \"../shaders/MagnifierShader.js\";\nimport { PixelFormat as n, TextureWrapMode as u, TextureSamplingMode as h } from \"../../../../../../webgl/enums.js\";\nimport { Texture as p } from \"../../../../../../webgl/Texture.js\";\nimport { TextureDescriptor as c } from \"../../../../../../webgl/TextureDescriptor.js\";\nclass l extends s {\n  constructor() {\n    super(...arguments), this.type = o.Magnifier, this._resourcePixelRatio = 1, this._position = [0, 0, 0, 0], this.shaders = {\n      magnifier: new a()\n    };\n  }\n  updateResources(t, i, r, s) {\n    t.pixelRatio !== this._resourcePixelRatio && this._destroyResources(), this._readbackTexture || this._initializeResources(t, i, r, s);\n    const {\n        context: o,\n        pixelRatio: a\n      } = t,\n      {\n        factor: n,\n        offset: u,\n        position: h\n      } = s,\n      {\n        size: p\n      } = t.state,\n      c = s.size * a,\n      l = 1 / n,\n      m = Math.ceil(l * c);\n    this._readbackTexture.resize(m, m);\n    const x = a * p[0],\n      d = a * p[1],\n      _ = .5 * m,\n      T = .5 * m,\n      f = e(a * h.x, _, x - _ - 1),\n      g = e(d - a * h.y, T, d - T - 1),\n      R = f - _,\n      w = g - T,\n      b = this._readbackTexture;\n    o.bindTexture(b, 0), o.gl.copyTexImage2D(b.descriptor.target, 0, b.descriptor.pixelFormat, R, w, m, m, 0);\n    const y = (f + u.x * a) / x * 2 - 1,\n      M = (g - u.y * a) / d * 2 - 1,\n      k = c / x * 2,\n      j = c / d * 2;\n    this._position[0] = y, this._position[1] = M, this._position[2] = k, this._position[3] = j;\n  }\n  render(e, t) {\n    const {\n      context: i,\n      painter: s\n    } = e;\n    s.setPipelineState(r);\n    const o = {\n      readbackTexture: {\n        texture: this._readbackTexture,\n        unit: 0\n      },\n      maskTexture: {\n        texture: this._maskTexture,\n        unit: 7\n      },\n      overlayTexture: {\n        texture: this._overlayTexture,\n        unit: 6\n      },\n      drawPos: this._position,\n      ...t\n    };\n    s.submitDrawMesh(i, {\n      shader: this.shaders.magnifier,\n      uniforms: {\n        config: o\n      },\n      defines: null,\n      optionalAttributes: null,\n      useComputeBuffer: !1\n    }, s.quadMesh);\n  }\n  shutdown() {\n    this._destroyResources();\n  }\n  _initializeResources(e, t, r, s) {\n    const o = e.context;\n    this._resourcePixelRatio = e.pixelRatio;\n    const a = Math.ceil(s.size * e.pixelRatio);\n    r.width = a, r.height = a;\n    const l = new c();\n    l.internalFormat = n.RGBA, l.wrapMode = u.CLAMP_TO_EDGE, l.samplingMode = h.NEAREST, l.flipped = !0, l.preMultiplyAlpha = !i(r.src) || !e.context.driverTest.svgPremultipliesAlpha.result, this._overlayTexture = new p(o, l, r), t.width = a, t.height = a, l.pixelFormat = l.internalFormat = n.ALPHA, this._maskTexture = new p(o, l, t);\n    const m = 1 / s.factor;\n    l.pixelFormat = l.internalFormat = n.RGBA, l.width = l.height = Math.ceil(m * a), l.samplingMode = h.LINEAR, l.flipped = !1, this._readbackTexture = new p(o, l);\n  }\n  _destroyResources() {\n    t(this._maskTexture), t(this._overlayTexture), t(this._readbackTexture);\n  }\n}\nexport { l as MagnifierTechnique };","map":{"version":3,"names":["clamp","e","disposeMaybe","t","isSVG","i","simplePipelineState","r","Technique","s","TechniqueType","o","MagnifierShader","a","PixelFormat","n","TextureWrapMode","u","TextureSamplingMode","h","Texture","p","TextureDescriptor","c","l","constructor","arguments","type","Magnifier","_resourcePixelRatio","_position","shaders","magnifier","updateResources","pixelRatio","_destroyResources","_readbackTexture","_initializeResources","context","factor","offset","position","size","state","m","Math","ceil","resize","x","d","_","T","f","g","y","R","w","b","bindTexture","gl","copyTexImage2D","descriptor","target","pixelFormat","M","k","j","render","painter","setPipelineState","readbackTexture","texture","unit","maskTexture","_maskTexture","overlayTexture","_overlayTexture","drawPos","submitDrawMesh","shader","uniforms","config","defines","optionalAttributes","useComputeBuffer","quadMesh","shutdown","width","height","internalFormat","RGBA","wrapMode","CLAMP_TO_EDGE","samplingMode","NEAREST","flipped","preMultiplyAlpha","src","driverTest","svgPremultipliesAlpha","result","ALPHA","LINEAR","MagnifierTechnique"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/magnifier/MagnifierTechnique.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{clamp as e}from\"../../../../../../../core/mathUtils.js\";import{disposeMaybe as t}from\"../../../../../../../core/maybe.js\";import{isSVG as i}from\"../../../../../../../core/urlUtils.js\";import{simplePipelineState as r}from\"../../utils.js\";import{Technique as s}from\"../Technique.js\";import{TechniqueType as o}from\"../TechniqueType.js\";import{MagnifierShader as a}from\"../shaders/MagnifierShader.js\";import{PixelFormat as n,TextureWrapMode as u,TextureSamplingMode as h}from\"../../../../../../webgl/enums.js\";import{Texture as p}from\"../../../../../../webgl/Texture.js\";import{TextureDescriptor as c}from\"../../../../../../webgl/TextureDescriptor.js\";class l extends s{constructor(){super(...arguments),this.type=o.Magnifier,this._resourcePixelRatio=1,this._position=[0,0,0,0],this.shaders={magnifier:new a}}updateResources(t,i,r,s){t.pixelRatio!==this._resourcePixelRatio&&this._destroyResources(),this._readbackTexture||this._initializeResources(t,i,r,s);const{context:o,pixelRatio:a}=t,{factor:n,offset:u,position:h}=s,{size:p}=t.state,c=s.size*a,l=1/n,m=Math.ceil(l*c);this._readbackTexture.resize(m,m);const x=a*p[0],d=a*p[1],_=.5*m,T=.5*m,f=e(a*h.x,_,x-_-1),g=e(d-a*h.y,T,d-T-1),R=f-_,w=g-T,b=this._readbackTexture;o.bindTexture(b,0),o.gl.copyTexImage2D(b.descriptor.target,0,b.descriptor.pixelFormat,R,w,m,m,0);const y=(f+u.x*a)/x*2-1,M=(g-u.y*a)/d*2-1,k=c/x*2,j=c/d*2;this._position[0]=y,this._position[1]=M,this._position[2]=k,this._position[3]=j}render(e,t){const{context:i,painter:s}=e;s.setPipelineState(r);const o={readbackTexture:{texture:this._readbackTexture,unit:0},maskTexture:{texture:this._maskTexture,unit:7},overlayTexture:{texture:this._overlayTexture,unit:6},drawPos:this._position,...t};s.submitDrawMesh(i,{shader:this.shaders.magnifier,uniforms:{config:o},defines:null,optionalAttributes:null,useComputeBuffer:!1},s.quadMesh)}shutdown(){this._destroyResources()}_initializeResources(e,t,r,s){const o=e.context;this._resourcePixelRatio=e.pixelRatio;const a=Math.ceil(s.size*e.pixelRatio);r.width=a,r.height=a;const l=new c;l.internalFormat=n.RGBA,l.wrapMode=u.CLAMP_TO_EDGE,l.samplingMode=h.NEAREST,l.flipped=!0,l.preMultiplyAlpha=!i(r.src)||!e.context.driverTest.svgPremultipliesAlpha.result,this._overlayTexture=new p(o,l,r),t.width=a,t.height=a,l.pixelFormat=l.internalFormat=n.ALPHA,this._maskTexture=new p(o,l,t);const m=1/s.factor;l.pixelFormat=l.internalFormat=n.RGBA,l.width=l.height=Math.ceil(m*a),l.samplingMode=h.LINEAR,l.flipped=!1,this._readbackTexture=new p(o,l)}_destroyResources(){t(this._maskTexture),t(this._overlayTexture),t(this._readbackTexture)}}export{l as MagnifierTechnique};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}