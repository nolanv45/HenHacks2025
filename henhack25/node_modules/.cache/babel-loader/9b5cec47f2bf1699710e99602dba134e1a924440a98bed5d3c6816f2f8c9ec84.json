{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from \"../../core/Error.js\";\nimport r from \"../../core/Logger.js\";\nimport { parseWhereClause as t } from \"../../core/sql.js\";\nimport { formatDate as n, convertDateFormatToIntlOptions as o } from \"../../intl/date.js\";\nimport { formatNumber as a } from \"../../intl/number.js\";\nimport { getDomainRange as i } from \"./domainUtils.js\";\nimport { isIntegerField as l, isNumericField as s, isStringField as u, isDateField as c } from \"./fieldUtils.js\";\nimport { getLabelExpression as f, getSingleFieldArcadeExpression as m } from \"./labelUtils.js\";\nimport { getFieldNameFromSimpleExpression as p } from \"../../support/arcadeExpressionUtils.js\";\nimport { createLabelExpression as d } from \"../../support/arcadeOnDemand.js\";\nconst g = () => r.getLogger(\"esri.layers.support.labelFormatUtils\"),\n  w = {\n    type: \"simple\",\n    evaluate: () => null\n  },\n  v = {\n    getAttribute: (e, r) => e.field(r)\n  };\nasync function y(r, n, o) {\n  if (!r || !r.symbol || !n) return w;\n  const a = r.where,\n    i = f(r);\n  let c;\n  if (\"arcade\" === i.type) {\n    const r = p(i.expression),\n      t = n.get(r);\n    if (t && (l(t) || s(t) || u(t))) c = {\n      type: \"simple\",\n      evaluate(e) {\n        const r = \"attributes\" in e ? e.attributes?.[t.name] : e.field(t.name);\n        return null == r ? \"\" : r.toString();\n      }\n    };else {\n      const r = await d(i.expression, o, n);\n      if (null == r) return w;\n      c = {\n        type: \"arcade\",\n        evaluate(t, n) {\n          try {\n            const e = \"attributes\" in t ? r.repurposeFeature(t) : t;\n            e.contextTimeZone = n ?? null;\n            const o = r.evaluate({\n              $view: {\n                timeZone: n\n              },\n              $feature: e\n            }, r.services);\n            if (null != o) return o.toString();\n          } catch (o) {\n            g().error(new e(\"arcade-expression-error\", \"Encountered an error when evaluating label expression for feature\", {\n              error: o,\n              feature: t,\n              expression: i\n            }));\n          }\n          return null;\n        },\n        needsHydrationToEvaluate: () => null == m(i.expression)\n      };\n    }\n  } else c = {\n    type: \"simple\",\n    evaluate: e => i.expression.replaceAll(/{[^}]*}/g, r => {\n      const t = r.slice(1, -1),\n        o = n.get(t);\n      if (!o) return r;\n      let a = null;\n      return a = \"attributes\" in e ? e?.attributes?.[o.name] : e.field(o.name), null == a ? \"\" : b(a, o);\n    })\n  };\n  if (a) {\n    let r;\n    try {\n      r = await t(a, n);\n    } catch (y) {\n      return g().error(new e(\"bad-where-clause\", \"Encountered an error when evaluating where clause, ignoring\", {\n        where: a,\n        error: y\n      })), w;\n    }\n    const o = c.evaluate;\n    c.evaluate = (t, n) => {\n      const i = \"attributes\" in t ? void 0 : v;\n      try {\n        if (r.testFeature(t, i)) return o(t, n);\n      } catch (y) {\n        g().error(new e(\"bad-where-clause\", \"Encountered an error when evaluating where clause for feature\", {\n          where: a,\n          feature: t,\n          error: y\n        }));\n      }\n      return null;\n    };\n  }\n  return c;\n}\nfunction b(e, r) {\n  if (null == e) return \"\";\n  const t = r.domain;\n  if (t) if (\"codedValue\" === t.type || \"coded-value\" === t.type) {\n    const r = e;\n    for (const e of t.codedValues) if (e.code === r) return e.name;\n  } else if (\"range\" === t.type) {\n    const {\n        max: n,\n        min: o\n      } = i(r),\n      a = +e;\n    if (null != o && null != n && o <= a && a <= n) return t.name;\n  }\n  let l = e;\n  return c(r) ? l = n(l, o(\"short-date\")) : s(r) && (l = a(+l)), l || \"\";\n}\nexport { y as createLabelFunction, b as formatField };","map":{"version":3,"names":["e","r","parseWhereClause","t","formatDate","n","convertDateFormatToIntlOptions","o","formatNumber","a","getDomainRange","i","isIntegerField","l","isNumericField","s","isStringField","u","isDateField","c","getLabelExpression","f","getSingleFieldArcadeExpression","m","getFieldNameFromSimpleExpression","p","createLabelExpression","d","g","getLogger","w","type","evaluate","v","getAttribute","field","y","symbol","where","expression","get","attributes","name","toString","repurposeFeature","contextTimeZone","$view","timeZone","$feature","services","error","feature","needsHydrationToEvaluate","replaceAll","slice","b","testFeature","domain","codedValues","code","max","min","createLabelFunction","formatField"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/layers/support/labelFormatUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import r from\"../../core/Logger.js\";import{parseWhereClause as t}from\"../../core/sql.js\";import{formatDate as n,convertDateFormatToIntlOptions as o}from\"../../intl/date.js\";import{formatNumber as a}from\"../../intl/number.js\";import{getDomainRange as i}from\"./domainUtils.js\";import{isIntegerField as l,isNumericField as s,isStringField as u,isDateField as c}from\"./fieldUtils.js\";import{getLabelExpression as f,getSingleFieldArcadeExpression as m}from\"./labelUtils.js\";import{getFieldNameFromSimpleExpression as p}from\"../../support/arcadeExpressionUtils.js\";import{createLabelExpression as d}from\"../../support/arcadeOnDemand.js\";const g=()=>r.getLogger(\"esri.layers.support.labelFormatUtils\"),w={type:\"simple\",evaluate:()=>null},v={getAttribute:(e,r)=>e.field(r)};async function y(r,n,o){if(!r||!r.symbol||!n)return w;const a=r.where,i=f(r);let c;if(\"arcade\"===i.type){const r=p(i.expression),t=n.get(r);if(t&&(l(t)||s(t)||u(t)))c={type:\"simple\",evaluate(e){const r=\"attributes\"in e?e.attributes?.[t.name]:e.field(t.name);return null==r?\"\":r.toString()}};else{const r=await d(i.expression,o,n);if(null==r)return w;c={type:\"arcade\",evaluate(t,n){try{const e=\"attributes\"in t?r.repurposeFeature(t):t;e.contextTimeZone=n??null;const o=r.evaluate({$view:{timeZone:n},$feature:e},r.services);if(null!=o)return o.toString()}catch(o){g().error(new e(\"arcade-expression-error\",\"Encountered an error when evaluating label expression for feature\",{error:o,feature:t,expression:i}))}return null},needsHydrationToEvaluate:()=>null==m(i.expression)}}}else c={type:\"simple\",evaluate:e=>i.expression.replaceAll(/{[^}]*}/g,(r=>{const t=r.slice(1,-1),o=n.get(t);if(!o)return r;let a=null;return a=\"attributes\"in e?e?.attributes?.[o.name]:e.field(o.name),null==a?\"\":b(a,o)}))};if(a){let r;try{r=await t(a,n)}catch(y){return g().error(new e(\"bad-where-clause\",\"Encountered an error when evaluating where clause, ignoring\",{where:a,error:y})),w}const o=c.evaluate;c.evaluate=(t,n)=>{const i=\"attributes\"in t?void 0:v;try{if(r.testFeature(t,i))return o(t,n)}catch(y){g().error(new e(\"bad-where-clause\",\"Encountered an error when evaluating where clause for feature\",{where:a,feature:t,error:y}))}return null}}return c}function b(e,r){if(null==e)return\"\";const t=r.domain;if(t)if(\"codedValue\"===t.type||\"coded-value\"===t.type){const r=e;for(const e of t.codedValues)if(e.code===r)return e.name}else if(\"range\"===t.type){const{max:n,min:o}=i(r),a=+e;if(null!=o&&null!=n&&o<=a&&a<=n)return t.name}let l=e;return c(r)?l=n(l,o(\"short-date\")):s(r)&&(l=a(+l)),l||\"\"}export{y as createLabelFunction,b as formatField};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}