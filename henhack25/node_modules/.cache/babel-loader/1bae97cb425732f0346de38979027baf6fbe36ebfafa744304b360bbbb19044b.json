{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from \"../../../../Color.js\";\nimport \"../../../../core/has.js\";\nimport { deg2rad as t } from \"../../../../core/mathUtils.js\";\nimport { releaseMaybe as r } from \"../../../../core/maybe.js\";\nimport { isPromiseLike as o } from \"../../../../core/promiseUtils.js\";\nimport { normalFromMat4 as a, fromMat4 as n } from \"../../../../core/libs/gl-matrix-2/math/mat3.js\";\nimport { create as s } from \"../../../../core/libs/gl-matrix-2/factories/mat3f64.js\";\nimport { fromTranslation as i, multiply as l, invert as c, getTranslation as u } from \"../../../../core/libs/gl-matrix-2/math/mat4.js\";\nimport { create as m, IDENTITY as f, clone as p } from \"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";\nimport { ONES as h } from \"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";\nimport { i as d, g, h as x, t as _, q as T, n as b, b as y, f as v, d as w, e as M } from \"../../../../chunks/vec32.js\";\nimport { ZEROS as R, ONES as j, create as P } from \"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";\nimport { ONES as C } from \"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";\nimport { canProjectWithoutEngine as A } from \"../../../../geometry/projection.js\";\nimport { computeTranslationToOriginAndRotation as E } from \"../../../../geometry/projection/computeTranslationToOriginAndRotation.js\";\nimport { projectBuffer as O } from \"../../../../geometry/projection/projectBuffer.js\";\nimport { projectVectorToPoint as N } from \"../../../../geometry/projection/projectVectorToPoint.js\";\nimport { create as I, fromBuffer as S, intersectsClippingArea as U } from \"../../../../geometry/support/aaBoundingBox.js\";\nimport { newFloatArray as B } from \"../../../../geometry/support/FloatArray.js\";\nimport { getZeroIndexArray as F, getContinuousIndexArray as D } from \"../../../../geometry/support/Indices.js\";\nimport G from \"../../../../geometry/support/MeshComponent.js\";\nimport V from \"../../../../geometry/support/MeshMaterialMetallicRoughness.js\";\nimport L from \"../../../../geometry/support/MeshTextureTransform.js\";\nimport { isRelativeVertexSpace as $, isAbsoluteVertexSpace as H } from \"../../../../geometry/support/meshVertexSpaceUtils.js\";\nimport { equals as q, isPlateCarree as k } from \"../../../../geometry/support/spatialReferenceUtils.js\";\nimport { t as z } from \"../../../../chunks/vec3.js\";\nimport { transformNormal as W, transformVectorENUPlateCarree as Y, VectorType as J, transformVectorWMPlateCarree as K, projectNormalToPCPF as Q, transformTangent as X, projectTangentToPCPF as Z } from \"../../../../geometry/support/meshUtils/projection.js\";\nimport { projectMeshVertexPositions as ee } from \"../../../../geometry/support/meshUtils/projectMeshVertexPositions.js\";\nimport { makeDehydratedPoint as te } from \"../../../../layers/graphics/dehydratedPoint.js\";\nimport { MeshTransformUpdateAction as re } from \"../../../../layers/graphics/sources/interfaces.js\";\nimport { ViewingMode as oe } from \"../../../ViewingMode.js\";\nimport { isEncodedMeshTexture as ae } from \"../../glTF/internal/resourceUtils.js\";\nimport { getTransformMatrix as ne } from \"../../glTF/internal/TextureTransformUtils.js\";\nimport { perObjectElevationAligner as se } from \"./ElevationAligners.js\";\nimport { needsElevationUpdates3D as ie, evaluateElevationInfoAtPoint as le } from \"./elevationAlignmentUtils.js\";\nimport { Graphics3DMeshObject3DGraphicLayer as ce } from \"./Graphics3DMeshObject3DGraphicLayer.js\";\nimport { Object3DEdgeState as ue } from \"./Graphics3DObject3DGraphicLayer.js\";\nimport { Graphics3DSymbolLayer as me } from \"./Graphics3DSymbolLayer.js\";\nimport { MaterialInfoCache as fe, MeshFastUpdateProcessor as pe } from \"./MeshFastUpdateProcessor.js\";\nimport { createMaterial as he } from \"../support/edgeUtils.js\";\nimport { parseColorMixMode as de, encodeSymbolColor as ge } from \"../support/symbolColorUtils.js\";\nimport { debugFlags as xe } from \"../../support/debugFlags.js\";\nimport { Attribute as _e } from \"../../webgl-engine/lib/Attribute.js\";\nimport { AlphaDiscardMode as Te, CullFaceOptions as be } from \"../../webgl-engine/lib/basicInterfaces.js\";\nimport { ContentObjectType as ye } from \"../../webgl-engine/lib/ContentObjectType.js\";\nimport { Geometry as ve } from \"../../webgl-engine/lib/Geometry.js\";\nimport { Object3D as we } from \"../../webgl-engine/lib/Object3D.js\";\nimport { Texture as Me } from \"../../webgl-engine/lib/Texture.js\";\nimport { VertexAttribute as Re } from \"../../webgl-engine/lib/VertexAttribute.js\";\nimport { DefaultMaterial as je } from \"../../webgl-engine/materials/DefaultMaterial.js\";\nimport { NativeLineMaterial as Pe } from \"../../webgl-engine/materials/NativeLineMaterial.js\";\nimport { useSchematicPBR as Ce, advancedMRRFactors as Ae, schematicMRRFactors as Ee } from \"../../webgl-engine/materials/pbrUtils.js\";\nimport { TextureWrapMode as Oe } from \"../../../webgl/enums.js\";\nconst Ne = [\"mesh\"];\nclass Ie extends me {\n  constructor(e, t, r, o) {\n    super(e, t, r, o), this._materialInfoCache = new fe(), this._fastUpdateProcessor = new pe(), this._textures = new Map(), this.ensureDrapedStatus(!1);\n  }\n  async doLoad() {\n    xe.DRAW_MESH_GEOMETRY_NORMALS && (this._debugVertexNormalMaterial = new Pe({\n      color: [1, 0, 1, 1]\n    }), this._debugTangentNormalMaterial = new Pe({\n      color: [1, .5, 0, 1]\n    }), this._debugFaceNormalMaterial = new Pe({\n      color: [0, 1, 1, 1]\n    }));\n  }\n  destroy() {\n    super.destroy(), this._textures.forEach(e => e.unload()), this._context.stage.removeMany(this._materialInfoCache.materials), this._context.stage.removeMany(Array.from(this._textures.values())), this._materialInfoCache.clear(), this._textures.clear(), this._fastUpdateProcessor.destroy(this._context.stage);\n  }\n  get materials() {\n    return this._materialInfoCache.materials;\n  }\n  createGraphics3DGraphic(e) {\n    const t = e.graphic;\n    if (!this._validateGeometry(t.geometry, Ne, \"fill on mesh-3d\")) return null;\n    const r = this.setGraphicElevationContext(t),\n      o = e.renderingInfo;\n    return this._createAs3DShape(t, o, r, t.uid);\n  }\n  onRemoveGraphic(e) {\n    this._fastUpdateProcessor.onRemoveGraphic(e, this._materialInfoCache, this._context);\n  }\n  layerOpacityChanged(e, t) {\n    const r = this._getLayerOpacity();\n    this._updateMaterialParameters(e => {\n      e.material.setParameters({\n        layerOpacity: r\n      });\n      const t = e.material.parameters;\n      this._setMaterialTransparentParameter(t, e), e.material.setParameters({\n        transparent: t.transparent\n      });\n    }), e.forEach(e => t(e)?.layerOpacityChanged(r, this._context.isAsync));\n  }\n  layerElevationInfoChanged(e, t) {\n    return this.updateGraphics3DGraphicElevationInfo(e, t, ie);\n  }\n  slicePlaneEnabledChanged(e, t) {\n    return this._updateMaterialParameters(({\n      material: e\n    }) => {\n      e.setParameters({\n        hasSlicePlane: this._context.slicePlaneEnabled\n      });\n    }), e.forEach(e => t(e)?.slicePlaneEnabledChanged(this._context.slicePlaneEnabled, this._context.isAsync)), !0;\n  }\n  physicalBasedRenderingChanged() {\n    const e = this._usePBR();\n    return this._updateMaterialParameters(({\n      material: t\n    }) => t.setParameters({\n      usePBR: e\n    })), !0;\n  }\n  updateTransform(e, t, r, o) {\n    if (!e.fastTransformUpdatesAllowed) return !1;\n    const a = e.fastTransformUpdatesEnabled;\n    switch (o) {\n      case re.EnableFastUpdates:\n        if (a) return !0;\n        break;\n      case re.DisableFastUpdates:\n        if (!a) return !0;\n        break;\n      default:\n        if (!a) return !!this.updateTransform(e, t, r, re.EnableFastUpdates) && (e.autoDisableFastTransformUpdates(() => this.updateTransform(e, t, r, re.DisableFastUpdates)), !0);\n    }\n    const n = this._context.renderCoordsHelper.spatialReference,\n      s = at,\n      {\n        origin: i,\n        transform: l\n      } = r;\n    if (!E(t, d(Ze, i.x, i.y, i.z ?? 0), s, n)) return !1;\n    switch (o) {\n      case re.EnableFastUpdates:\n        this._fastUpdateProcessor.enable(e, this._materialInfoCache, this._context);\n        break;\n      case re.DisableFastUpdates:\n        this._fastUpdateProcessor.disable(e, this._materialInfoCache, this._context);\n        break;\n      case re.UpdateFastLocalOrigin:\n        e.updateFastLocalOrigin(s, l, this._context.localOriginFactory);\n    }\n    const {\n      elevationContext: c\n    } = e;\n    c.centerPointInElevationSR = this._getCenterPointInElevationSR(s);\n    const {\n        elevationProvider: u,\n        renderCoordsHelper: m\n      } = this._context,\n      f = (e, t) => le(e, u, c, m, t);\n    return e.alignedSampledElevation = se(e, c, u.spatialReference, f, m, s), e.updateTransform(s, l, this._context.isAsync), e.updateAutoDisableFastTransformUpdates(() => this.updateTransform(e, t, r, re.DisableFastUpdates)), !0;\n  }\n  _requiresSymbolVertexColors() {\n    return this._drivenProperties.color || this._drivenProperties.opacity;\n  }\n  _materialPropertiesDefault(e, t) {\n    const r = this._requiresSymbolVertexColors(),\n      o = !!e.vertexAttributes.color,\n      a = !!e.vertexAttributes.tangent;\n    return {\n      hasSymbolVertexColors: r,\n      hasVertexColors: o,\n      hasVertexTangents: a,\n      uid: `vc:${o},vt:${a},vct${t},svc:${r}`\n    };\n  }\n  _materialProperties(e, t, r) {\n    const o = this._materialPropertiesDefault(e, r);\n    if (!t.material) return o;\n    const {\n        color: a,\n        colorTexture: n,\n        colorTextureTransform: s,\n        normalTexture: i,\n        normalTextureTransform: l,\n        doubleSided: c,\n        alphaCutoff: u,\n        alphaMode: m\n      } = t.material,\n      f = Ye(a),\n      p = Ye(n),\n      h = Je(s),\n      d = Ye(i),\n      g = Je(l);\n    if (o.color = a, o.colorTexture = n, o.normalTexture = i, o.uid = `${o.uid},cmuid:${f},ctmuid:${p},cttuid:${h},ntmuid:${d},nttuid:${g},ds:${c},ac:${u},am:${m}`, t.material instanceof V) {\n      const {\n          metallic: e,\n          roughness: r,\n          metallicRoughnessTexture: a,\n          metallicRoughnessTextureTransform: n,\n          emissiveColor: i,\n          emissiveTexture: c,\n          emissiveTextureTransform: u,\n          occlusionTexture: m,\n          occlusionTextureTransform: f\n        } = t.material,\n        p = Ye(a),\n        h = Je(n),\n        d = Ye(i),\n        g = Ye(c),\n        x = Je(u),\n        _ = Ye(m),\n        T = Je(f);\n      o.metallic = e, o.roughness = r, o.metallicRoughnessTexture = a, o.emissiveColor = i, o.emissiveTexture = c, o.occlusionTexture = m, o.colorTextureTransform = $e(s), o.normalTextureTransform = $e(l), o.emissiveTextureTransform = $e(u), o.occlusionTextureTransform = $e(f), o.metallicRoughnessTextureTransform = $e(n), o.uid = `${o.uid},mrm:${e},mrr:${r},mrt:${p},mrtt:${h},emuid:${d},etmuid:${g},ett:${x},otmuid:${_},ott:${T}`;\n    }\n    return o;\n  }\n  _getInternalTexture(e, t = Te.Opaque) {\n    const a = We(e);\n    if (!a) return null;\n    const n = `${e.contentHash}/${t}`;\n    let s = this._textures.get(n);\n    if (s) {\n      const e = this._context.stage.renderView.textures;\n      let t = null;\n      const a = e.acquire(s.id);\n      return null == a || o(a) || (s.events.on(\"unloaded\", () => t = r(t)), t = a), s;\n    }\n    let i = null;\n    const l = this._context.stage.renderView.renderingContext.parameters.maxMaxAnisotropy,\n      c = {\n        wrap: He(e.wrap),\n        noUnpackFlip: !0,\n        maxAnisotropy: l,\n        mipmap: l > 1\n      };\n    return ae(a) ? (i = a.data, c.preMultiplyAlpha = !1, c.encoding = a.encoding) : (i = a, c.preMultiplyAlpha = t !== Te.Opaque, c.downsampleUncompressed = this._context.graphicsCoreOwner.view.qualitySettings.graphics3D.uncompressedTextureDownsamplingEnabled), s = new Me(i, c), this._textures.set(n, s), s.load(this._context.stage.renderView.renderingContext), this._context.stage.add(s), s.events.on(\"unloaded\", () => {\n      this._textures.delete(n);\n    }), s;\n  }\n  _setInternalMaterialTextureParameters(t, r) {\n    if (null != t.colorTexture) {\n      const e = this._getInternalTexture(t.colorTexture, r.textureAlphaMode);\n      e ? (r.textureId = e.id, r.textureAlphaPremultiplied = !!e.parameters.preMultiplyAlpha) : r.textureId = void 0;\n    }\n    t.normalTexture && (r.normalTextureId = this._getInternalTexture(t.normalTexture)?.id), t.emissiveColor && (r.emissiveFactor = e.toUnitRGB(t.emissiveColor)), t.emissiveTexture && (r.emissiveTextureId = this._getInternalTexture(t.emissiveTexture)?.id), t.occlusionTexture && (r.occlusionTextureId = this._getInternalTexture(t.occlusionTexture)?.id), t.metallicRoughnessTexture && (r.metallicRoughnessTextureId = this._getInternalTexture(t.metallicRoughnessTexture)?.id);\n  }\n  _setInternalMaterialParameters(e, t) {\n    null != e.color && ze(e.color, t), this._setInternalMaterialTextureParameters(e, t), t.colorTextureTransformMatrix = ne(e.colorTextureTransform), t.normalTextureTransformMatrix = ne(e.normalTextureTransform);\n    const r = null != e.normalTextureTransform?.scale ? e.normalTextureTransform?.scale : h;\n    t.scale = [r[0], r[1]], t.occlusionTextureTransformMatrix = ne(e.occlusionTextureTransform), t.emissiveTextureTransformMatrix = ne(e.emissiveTextureTransform), t.metallicRoughnessTextureTransformMatrix = ne(e.metallicRoughnessTextureTransform);\n  }\n  _setExternalMaterialParameters(t, r = this.symbolLayer?.material?.color) {\n    const o = this._drivenProperties.color;\n    let a = this.symbolLayer.material?.colorMixMode ?? null;\n    if (o) t.externalColor = C;else {\n      const o = r ?? null;\n      o ? t.externalColor = e.toUnitRGBA(o) : (a = null, t.externalColor = C);\n    }\n    a && (t.colorMixMode = a), t.castShadows = !!this.symbolLayer.castShadows;\n  }\n  _getOrCreateMaterial(t, r) {\n    const o = r.material?.color,\n      a = r.material?.colorTexture,\n      n = r.material?.alphaMode,\n      s = \"blend\" === n,\n      i = !(\"opaque\" === n) && (ke(t) || null != o && o.a < 1 || a?.transparent || s),\n      l = this._materialProperties(t, r, i),\n      c = this._materialInfoCache.byUid(l.uid);\n    if (c) return this._setInternalMaterialTextureParameters(l, c.material.parameters), c.material;\n    const u = {\n        uid: l.uid,\n        material: null,\n        isComponentTransparent: i,\n        alphaMode: r.material ? r.material.alphaMode : \"opaque\"\n      },\n      m = Ce({\n        normalTexture: l.normalTexture,\n        metallicRoughnessTexture: l.metallicRoughnessTexture,\n        metallicFactor: l.metallic,\n        roughnessFactor: l.roughness,\n        emissiveTexture: l.emissiveTexture,\n        emissiveFactor: e.toUnitRGB(l.emissiveColor),\n        occlusionTexture: l.occlusionTexture\n      }),\n      f = {\n        usePBR: this._usePBR(),\n        isSchematic: m,\n        hasVertexColors: l.hasVertexColors,\n        hasSymbolColors: l.hasSymbolVertexColors,\n        hasVertexTangents: l.hasVertexTangents,\n        ambient: R,\n        diffuse: j,\n        opacity: 1,\n        doubleSided: !0,\n        doubleSidedType: \"winding-order\",\n        cullFace: be.None,\n        layerOpacity: this._getLayerOpacity(),\n        hasSlicePlane: this._context.slicePlaneEnabled\n      };\n    f.mrrFactors = m ? Ee : [l.metallic, l.roughness, Ae[2]], r.material && (f.doubleSided = r.material.doubleSided, f.cullFace = r.material.doubleSided ? be.None : be.Back, f.textureAlphaCutoff = r.material.alphaCutoff), this._setExternalMaterialParameters(f), this._setMaterialTransparentParameter(f, u), this._setInternalMaterialParameters(l, f);\n    const p = new je(f, this._context);\n    return u.material = p, this._materialInfoCache.set(l.uid, u), this._context.stage.add(p), p;\n  }\n  prepareSymbolLayerPatch(e) {\n    if (\"partial\" !== e.diff.type) return;\n    const t = e.diff.diff;\n    this._preparePatchColor(e, t);\n  }\n  _preparePatchColor(e, t) {\n    if (!t.material || \"partial\" !== t.material.type) return;\n    const r = t.material.diff;\n    if (!r.color || \"complete\" !== r.color.type || null == r.color.newValue || null == r.color.oldValue) return;\n    const o = r.color.newValue;\n    delete r.color, e.symbolLayerStatePatches.push(() => {\n      this._updateMaterialParameters(e => {\n        const t = e.material.parameters;\n        this._setExternalMaterialParameters(t, o), this._setMaterialTransparentParameter(t, e), e.material.setParameters({\n          externalColor: t.externalColor,\n          transparent: t.transparent\n        });\n      });\n    });\n  }\n  _usePBR() {\n    return this._context.physicalBasedRenderingEnabled;\n  }\n  _setMaterialTransparentParameter(e, t) {\n    e.transparent = this.needsDrivenTransparentPass || t.isComponentTransparent || e.layerOpacity < 1 || e.opacity < 1 || e.externalColor && e.externalColor[3] < 1, \"auto\" === t.alphaMode ? e.textureAlphaMode = e.transparent ? Te.MaskBlend : Te.Opaque : e.textureAlphaMode = \"opaque\" === t.alphaMode ? Te.Opaque : \"mask\" === t.alphaMode ? Te.Mask : Te.Blend;\n  }\n  _createFaceDebugNormals(e, t) {\n    const r = t.length,\n      o = e.spatialReference.isGeographic ? 20015077 / 180 : 1,\n      n = .1 * Math.max(e.extent.width * o, e.extent.height * o, e.extent.zmax - e.extent.zmin),\n      i = [],\n      l = [],\n      c = t[0].transformation,\n      u = a(s(), c);\n    for (let a = 0; a < r; a++) {\n      const e = t[a].attributes.get(Re.POSITION);\n      if (!e) continue;\n      const r = e.data,\n        o = e.indices;\n      for (let t = 0; t < o.length; t += 3) Le(r, o, t, rt), Ve(r, o, t, Ze, et, tt), g(Ze, Ze, et), g(Ze, Ze, tt), x(Ze, Ze, 1 / 3), _(Ze, Ze, c), i.push(...Ze), T(rt, rt, u), b(rt, rt), y(Ze, Ze, rt, n), i.push(...Ze), l.push(l.length), l.push(l.length);\n    }\n    return i.length ? new ve(this._debugFaceNormalMaterial, [[Re.POSITION, new _e(i, l, 3, !0)]], null, ye.Line) : null;\n  }\n  _createPerVertexDebugVectors(e, t, r, o, i) {\n    const l = t.length,\n      c = e.spatialReference.isGeographic ? 20015077 / 180 : 1,\n      u = .1 * i * Math.max(e.extent.width * c, e.extent.height * c, e.extent.zmax - e.extent.zmin),\n      m = [],\n      f = [],\n      p = t[0].transformation,\n      h = a(s(), p);\n    r === Re.TANGENT && n(h, p);\n    for (let a = 0; a < l; a++) {\n      const e = t[a],\n        o = e.attributes.get(Re.POSITION),\n        n = e.attributes.get(r);\n      if (!o || !n) continue;\n      const s = o.data,\n        i = o.indices,\n        l = n.data,\n        c = n.indices;\n      for (let t = 0; t < i.length; t++) {\n        const e = 3 * i[t],\n          r = c[t] * n.stride;\n        d(Ze, s[e + 0], s[e + 1], s[e + 2]), _(Ze, Ze, p), m.push(...Ze), d(et, l[r + 0], l[r + 1], l[r + 2]), T(et, et, h), b(et, et), y(Ze, Ze, et, u), m.push(...Ze), f.push(f.length), f.push(f.length);\n      }\n    }\n    return m.length ? new ve(o, [[Re.POSITION, new _e(m, f, 3, !0)]], null, ye.Line) : null;\n  }\n  _createAs3DShape(e, t, r, o) {\n    const a = e.geometry;\n    if (\"mesh\" !== a.type) return null;\n    const n = this._createGeometryInfo(a, t, o);\n    if (null == n) return null;\n    const {\n      geometries: s,\n      objectTransformation: i\n    } = n;\n    if (xe.DRAW_MESH_GEOMETRY_NORMALS) {\n      const e = this._createPerVertexDebugVectors(a, s, Re.NORMAL, this._debugVertexNormalMaterial, 1),\n        t = this._createPerVertexDebugVectors(a, s, Re.TANGENT, this._debugTangentNormalMaterial, .5),\n        r = this._createFaceDebugNormals(a, s);\n      e && s.push(e), t && s.push(t), r && s.push(r);\n    }\n    const l = new we({\n      geometries: s,\n      layerUid: this._context.layer.uid,\n      graphicUid: o,\n      isElevationSource: !0\n    });\n    l.transformation = i;\n    const c = he(this.symbolLayer, {\n        opacity: this._getLayerOpacity()\n      }),\n      u = c ? new ue(s[0].material, c, this._context.slicePlaneEnabled) : null,\n      m = new ce(this, l, s, null, null, se, r, u);\n    this._fastUpdateProcessor.onAddGraphic(), m.needsElevationUpdates = ie(r.mode), m.useObjectOriginAsAttachmentOrigin = !0, m.fastTransformUpdatesAllowed = this._fastTransformUpdatesAllowed(a), r.centerPointInElevationSR = this._getCenterPointInElevationSR(l.transformation);\n    const {\n        elevationProvider: f,\n        renderCoordsHelper: p\n      } = this._context,\n      h = (e, t) => le(e, f, r, p, t);\n    return m.alignedSampledElevation = se(m, r, f.spatialReference, h, p), m;\n  }\n  _fastTransformUpdatesAllowed(e) {\n    const {\n      vertexSpace: t,\n      spatialReference: r\n    } = e;\n    if (!$(t)) return !1;\n    const {\n        type: o\n      } = t,\n      {\n        view: a\n      } = this._context.graphicsCoreOwner,\n      {\n        viewingMode: n\n      } = a.state,\n      s = a.spatialReference;\n    return n === oe.Global && \"local\" === o || n === oe.Local && q(s, r) && \"georeferenced\" === o && !r.isGeographic;\n  }\n  _getCenterPointInElevationSR(e) {\n    const t = te(0, 0, 0, this._context.elevationProvider.spatialReference ?? null);\n    return N([e[12], e[13], e[14]], this._context.renderCoordsHelper.spatialReference, t), t;\n  }\n  _passthroughReprojectionInfo(e) {\n    return e.reprojection === it.NONE && !!e.objectTransformation;\n  }\n  _createPositionBuffer(e, t) {\n    const r = e.vertexAttributes.position;\n    let o,\n      a = r;\n    if (t.reprojection === it.NONE) return {\n      position: a,\n      georeferencedPositionBuffer: o\n    };\n    const n = t.reprojection === it.RENDER ? t.transformBeforeProject : null;\n    n && (a = z(new Float64Array(a.length), a, n));\n    const {\n      normal: s,\n      tangent: i\n    } = e.vertexAttributes;\n    this._passthroughReprojectionInfo(t) || !s && !i || (o = a);\n    const l = a === r || a === o ? new Float64Array(a.length) : a;\n    return O(a, e.spatialReference, 0, l, this._context.renderCoordsHelper.spatialReference, 0), {\n      position: l,\n      georeferencedPositionBuffer: o\n    };\n  }\n  _createNormalBuffer(e, t, r, o) {\n    const a = e.vertexAttributes.normal;\n    if (null == a) return null;\n    let n = a;\n    const s = o.reprojection === it.RENDER ? o.transformBeforeProject : null;\n    s && (n = W(n, new Float32Array(n.length), s));\n    const i = this._context.graphicsCoreOwner.view.viewingMode;\n    if (o.reprojection === it.NONE) return n;\n    if (\"local\" === i) {\n      if (!k(this._context.renderCoordsHelper.spatialReference)) return n;\n      if (null == r) return null;\n      if (e.spatialReference.isGeographic) {\n        const e = n === a ? new Float32Array(n.length) : n;\n        return Y(n, J.NORMAL, r, e);\n      }\n      if (e.spatialReference.isWebMercator) {\n        const e = n === a ? new Float32Array(n.length) : n;\n        return K(n, J.NORMAL, r, e);\n      }\n      return n;\n    }\n    if (null == r) return null;\n    const l = n === a ? new Float32Array(n.length) : n,\n      c = this._context.renderCoordsHelper.spatialReference;\n    return Q(n, r, e.spatialReference, t, c, l);\n  }\n  _createTangentBuffer(e, t, r, o) {\n    const a = e.vertexAttributes.tangent;\n    if (null == a) return null;\n    let n = a;\n    const s = o.reprojection === it.RENDER ? o.transformBeforeProject : null;\n    s && (n = X(n, new Float32Array(n.length), s));\n    const i = this._context.graphicsCoreOwner.view.viewingMode;\n    if (o.reprojection === it.NONE) return n;\n    if (\"local\" === i) {\n      if (!k(this._context.renderCoordsHelper.spatialReference)) return n;\n      if (null == r) return null;\n      if (e.spatialReference.isGeographic) {\n        const e = n === a ? new Float32Array(n.length) : n;\n        return Y(n, J.TANGENT, r, e);\n      }\n      if (e.spatialReference.isWebMercator) {\n        const e = n === a ? new Float32Array(n.length) : n;\n        return K(n, J.TANGENT, r, e);\n      }\n      return n;\n    }\n    if (null == r) return null;\n    const l = n === a ? new Float32Array(n.length) : n,\n      c = this._context.renderCoordsHelper.spatialReference;\n    return Z(n, r, e.spatialReference, t, c, l);\n  }\n  _createSymbolColorBuffer(e) {\n    if (this._requiresSymbolVertexColors()) {\n      const t = this._getVertexOpacityAndColor(e),\n        r = de(this.symbolLayer?.material?.colorMixMode),\n        o = new Uint8Array(4);\n      return ge(t, r, o), o;\n    }\n    return null;\n  }\n  _createBuffers(e, t) {\n    const r = e.vertexAttributes && e.vertexAttributes.position;\n    if (!r) return this.logger.warn(\"Mesh geometry must contain position vertex attributes\"), null;\n    const o = e.vertexAttributes.normal,\n      a = e.vertexAttributes.uv,\n      n = e.vertexAttributes.tangent;\n    if (o && o.length !== r.length) return this.logger.warn(\"Mesh normal vertex buffer must contain the same number of elements as the position buffer\"), null;\n    if (n && n.length / 4 != r.length / 3) return this.logger.warn(\"Mesh tangent vertex buffer must contain the same number of elements as the position buffer\"), null;\n    if (a && a.length / 2 != r.length / 3) return this.logger.warn(\"Mesh uv vertex buffer must contain the same number of elements as the position buffer\"), null;\n    const s = this._computeReprojectionInfo(e),\n      {\n        position: i,\n        georeferencedPositionBuffer: l\n      } = this._createPositionBuffer(e, s),\n      c = Ke(e),\n      u = this._createSymbolColorBuffer(t),\n      f = this._createNormalBuffer(e, i, l, s),\n      p = this._createTangentBuffer(e, i, l, s),\n      h = a,\n      {\n        transformation: d,\n        position: g,\n        normal: x,\n        tangent: _\n      } = this._passthroughReprojectionInfo(s) ? {\n        transformation: s.objectTransformation,\n        position: i,\n        normal: f,\n        tangent: p\n      } : this._transformOriginLocal(e, i, f, p);\n    return {\n      positionBuffer: g,\n      normalBuffer: x,\n      tangentBuffer: _,\n      uvBuffer: h,\n      colorBuffer: c,\n      symbolColorBuffer: u,\n      objectTransformation: d,\n      geometryTransformation: s.reprojection === it.NONE && s.geometryTransformation ? s.geometryTransformation : m()\n    };\n  }\n  _computeReprojectionInfo(e) {\n    const {\n        vertexSpace: t\n      } = e,\n      r = \"georeferenced\" === t.type ? q(this._context.renderCoordsHelper.spatialReference, e.spatialReference) ? it.NONE : it.RENDER : it.NONE;\n    if (H(t)) return {\n      reprojection: r\n    };\n    const o = t.origin,\n      a = m(),\n      n = e.transform?.localMatrix ?? f;\n    if (r === it.NONE) {\n      E(e.spatialReference, o, a, this._context.renderCoordsHelper.spatialReference);\n      return {\n        reprojection: r,\n        objectTransformation: a,\n        geometryTransformation: p(n)\n      };\n    }\n    const s = i(m(), o);\n    return l(s, s, n), {\n      reprojection: r,\n      transformBeforeProject: s\n    };\n  }\n  _transformOriginLocal(e, t, r, o) {\n    const a = this._context.renderCoordsHelper.spatialReference,\n      n = e.origin;\n    Xe[0] = n.x, Xe[1] = n.y, Xe[2] = n.z ?? 0;\n    const s = m();\n    E(e.spatialReference, Xe, s, a), c(ot, s);\n    const {\n        position: i,\n        normal: l,\n        tangent: u\n      } = e.vertexAttributes,\n      f = t === i ? new Float64Array(t.length) : t;\n    z(f, t, ot);\n    const p = r ? r === l ? new Float32Array(r.length) : r : null,\n      h = o ? o === u ? new Float32Array(o.length) : o : null;\n    return r && p && W(r, p, ot), o && h && X(o, h, ot), {\n      transformation: s,\n      position: f,\n      normal: p,\n      tangent: h\n    };\n  }\n  _validateFaces(e, t) {\n    const r = e.vertexAttributes.position.length / 3,\n      o = t.faces;\n    if (o) {\n      let e = -1;\n      for (let t = 0; t < o.length; t++) {\n        const r = o[t];\n        r > e && (e = r);\n      }\n      if (r <= e) return this.logger.warn(`Vertex index ${e} is out of bounds of the mesh position buffer`), !1;\n    } else if (r % 3 != 0) return this.logger.warn(\"Mesh position buffer length must be a multiple of 9 if no component faces are defined (3 values per vertex * 3 vertices per triangle)\"), !1;\n    return !0;\n  }\n  _isOutsideClippingArea(e) {\n    if (!this._context.clippingExtent) return !1;\n    const t = e.vertexAttributes?.position;\n    if (!t) return !1;\n    const r = this._context.elevationProvider.spatialReference,\n      o = ee(e, r ?? e.spatialReference);\n    return !!o && (S(o, nt), !U(nt, this._context.clippingExtent));\n  }\n  _createGeometryInfo(e, t, r) {\n    if (!A(e.spatialReference, this._context.renderCoordsHelper.spatialReference)) return this.logger.warn(\"Geometry spatial reference is not compatible with the view\"), null;\n    if (!this._validateVertexSpace(e)) return null;\n    if (this._isOutsideClippingArea(e)) return null;\n    const o = this._createBuffers(e, t);\n    if (null == o) return null;\n    const {\n        positionBuffer: a,\n        uvBuffer: n,\n        colorBuffer: s,\n        symbolColorBuffer: i,\n        normalBuffer: l,\n        tangentBuffer: c,\n        objectTransformation: m,\n        geometryTransformation: f\n      } = o,\n      p = e.components ?? st,\n      h = new Array();\n    let d = !1;\n    const g = u(Ze, m),\n      x = this._context.localOriginFactory.getOrigin(g);\n    for (const u of p) {\n      if (!this._validateFaces(e, u)) return null;\n      const t = Ue(e, u);\n      if (0 === t.length) continue;\n      const o = Be(a, l, u, t);\n      o.didFlipNormals && (d = !0);\n      const m = [[Re.POSITION, new _e(a, t, 3, !0)], [Re.NORMAL, new _e(o.normals, o.indices, 3, !0)]];\n      s && m.push([Re.COLOR, new _e(s, t, 4, !0)]), i && m.push([Re.SYMBOLCOLOR, new _e(i, F(t.length), 4, !0)]), n && m.push([Re.UV0, new _e(n, t, 2, !0)]), c && m.push([Re.TANGENT, new _e(c, t, 4, !0)]);\n      const p = this._context.stage.renderView.getObjectAndLayerIdColor({\n          graphicUid: r,\n          layerUid: this._context.layer.uid\n        }),\n        g = this._getOrCreateMaterial(e, u),\n        _ = new ve(g, m, null, ye.Mesh, p);\n      _.transformation = f, _.localOrigin = x, h.push(_);\n    }\n    return d && this.logger.warn(\"Normals have been automatically flipped to be consistent with the counter clock wise face winding order. It is better to generate mesh geometries that have consistent normals.\"), {\n      geometries: h,\n      objectTransformation: m\n    };\n  }\n  _updateMaterialParameters(e) {\n    this._materialInfoCache.forEachMaterialInfo(e), this._fastUpdateProcessor.forEachMaterialInfo(e), this._fastUpdateProcessor.forEachClonedMaterial((e, t) => {\n      t.setParameters(e.parameters);\n    });\n  }\n  _validateVertexSpace(e) {\n    const {\n        _context: {\n          graphicsCoreOwner: {\n            view: {\n              state: {\n                viewingMode: t\n              }\n            }\n          }\n        }\n      } = this,\n      {\n        vertexSpace: r\n      } = e;\n    return t !== oe.Local || \"local\" !== r.type || (this.logger.warn(\"Displaying a mesh with a local vertex space in a view in local viewing mode is not supported.\"), !1);\n  }\n  test() {\n    return {\n      ...super.test(),\n      materials: this._materialInfoCache.materials\n    };\n  }\n}\nclass Se {\n  constructor(e, t, r) {\n    this.normals = e, this.indices = t, this.didFlipNormals = r;\n  }\n}\nfunction Ue(e, t) {\n  return t.faces ?? D(e.vertexAttributes.position.length / 3);\n}\nfunction Be(e, t, r, o) {\n  switch (r.shading || \"flat\") {\n    default:\n    case \"source\":\n      return De(e, t, r, o);\n    case \"flat\":\n      return Fe(e, o);\n    case \"smooth\":\n      return Ge(e, o);\n  }\n}\nfunction Fe(e, t) {\n  const r = B(t.length),\n    o = new Array(3 * t.length);\n  for (let a = 0; a < t.length; a += 3) {\n    const n = Le(e, t, a, rt);\n    for (let e = 0; e < 3; e++) r[a + e] = n[e], o[a + e] = a / 3;\n  }\n  return new Se(r, o, !1);\n}\nfunction De(e, t, r, o) {\n  if (null == t) return Fe(e, o);\n  let a = !1;\n  if (!r.trustSourceNormals) for (let n = 0; n < o.length; n += 3) {\n    Le(e, o, n, rt);\n    for (let e = 0; e < 3; e++) {\n      const r = 3 * o[n + e];\n      Ze[0] = t[r], Ze[1] = t[r + 1], Ze[2] = t[r + 2], v(rt, Ze) < 0 && (t[r] = -t[r], t[r + 1] = -t[r + 1], t[r + 2] = -t[r + 2], a = !0);\n    }\n  }\n  return new Se(t, o, a);\n}\nfunction Ge(e, t) {\n  const r = {};\n  for (let n = 0; n < t.length; n += 3) {\n    const o = Le(e, t, n, rt);\n    for (let e = 0; e < 3; e++) {\n      const a = t[n + e];\n      let s = r[a];\n      s || (s = {\n        normal: P(),\n        count: 0\n      }, r[a] = s), g(s.normal, s.normal, o), s.count++;\n    }\n  }\n  const o = B(3 * t.length),\n    a = new Array(3 * t.length);\n  for (let n = 0; n < t.length; n++) {\n    const e = r[t[n]];\n    1 !== e.count && (b(e.normal, e.normal), e.count = 1);\n    for (let t = 0; t < 3; t++) o[3 * n + t] = e.normal[t];\n    a[n] = n;\n  }\n  return new Se(o, a, !1);\n}\nfunction Ve(e, t, r, o, a, n) {\n  const s = 3 * t[r],\n    i = 3 * t[r + 1],\n    l = 3 * t[r + 2];\n  o[0] = e[s], o[1] = e[s + 1], o[2] = e[s + 2], a[0] = e[i], a[1] = e[i + 1], a[2] = e[i + 2], n[0] = e[l], n[1] = e[l + 1], n[2] = e[l + 2];\n}\nfunction Le(e, t, r, o) {\n  return Ve(e, t, r, Ze, et, tt), w(et, et, Ze), w(tt, tt, Ze), M(Ze, et, tt), b(o, Ze), o;\n}\nfunction $e(e) {\n  if (!e) return null;\n  const {\n    scale: r,\n    offset: o,\n    rotation: a\n  } = e;\n  return {\n    scale: r,\n    offset: o,\n    rotation: t(a)\n  };\n}\nfunction He(e = \"repeat\") {\n  if (\"string\" == typeof e) {\n    const t = qe(e);\n    return {\n      s: t,\n      t\n    };\n  }\n  return {\n    s: qe(e.horizontal),\n    t: qe(e.vertical)\n  };\n}\nfunction qe(e) {\n  switch (e) {\n    case \"clamp\":\n      return Oe.CLAMP_TO_EDGE;\n    case \"mirror\":\n      return Oe.MIRRORED_REPEAT;\n    default:\n      return Oe.REPEAT;\n  }\n}\nfunction ke(e) {\n  const t = e.vertexAttributes.color;\n  if (null == t) return !1;\n  for (let r = 3; r < t.length; r += 4) if (255 !== t[r]) return !0;\n  return !1;\n}\nfunction ze(t, r) {\n  r.diffuse = e.toUnitRGB(t), r.opacity = t.a;\n}\nfunction We(e) {\n  return e.data ?? e.url;\n}\nfunction Ye(t) {\n  return null == t ? \"-\" : t instanceof e ? t.toHex() : t.contentHash;\n}\nfunction Je(e) {\n  const {\n    offset: t,\n    scale: r,\n    rotation: o\n  } = e ?? Qe;\n  return `${t[0]},${t[1]},${o},${r[0]},${r[1]}`;\n}\nfunction Ke(e) {\n  return e.vertexAttributes.color;\n}\nconst Qe = new L(),\n  Xe = P(),\n  Ze = P(),\n  et = P(),\n  tt = P(),\n  rt = P(),\n  ot = m(),\n  at = m(),\n  nt = I(),\n  st = [new G()];\nvar it;\n!function (e) {\n  e[e.NONE = 0] = \"NONE\", e[e.RENDER = 1] = \"RENDER\";\n}(it || (it = {}));\nexport { Ie as Graphics3DMeshFillSymbolLayer };","map":{"version":3,"names":["e","deg2rad","t","releaseMaybe","r","isPromiseLike","o","normalFromMat4","a","fromMat4","n","create","s","fromTranslation","i","multiply","l","invert","c","getTranslation","u","m","IDENTITY","f","clone","p","ONES","h","d","g","x","_","q","T","b","y","v","w","M","ZEROS","R","j","P","C","canProjectWithoutEngine","A","computeTranslationToOriginAndRotation","E","projectBuffer","O","projectVectorToPoint","N","I","fromBuffer","S","intersectsClippingArea","U","newFloatArray","B","getZeroIndexArray","F","getContinuousIndexArray","D","G","V","L","isRelativeVertexSpace","$","isAbsoluteVertexSpace","H","equals","isPlateCarree","k","z","transformNormal","W","transformVectorENUPlateCarree","Y","VectorType","J","transformVectorWMPlateCarree","K","projectNormalToPCPF","Q","transformTangent","X","projectTangentToPCPF","Z","projectMeshVertexPositions","ee","makeDehydratedPoint","te","MeshTransformUpdateAction","re","ViewingMode","oe","isEncodedMeshTexture","ae","getTransformMatrix","ne","perObjectElevationAligner","se","needsElevationUpdates3D","ie","evaluateElevationInfoAtPoint","le","Graphics3DMeshObject3DGraphicLayer","ce","Object3DEdgeState","ue","Graphics3DSymbolLayer","me","MaterialInfoCache","fe","MeshFastUpdateProcessor","pe","createMaterial","he","parseColorMixMode","de","encodeSymbolColor","ge","debugFlags","xe","Attribute","_e","AlphaDiscardMode","Te","CullFaceOptions","be","ContentObjectType","ye","Geometry","ve","Object3D","we","Texture","Me","VertexAttribute","Re","DefaultMaterial","je","NativeLineMaterial","Pe","useSchematicPBR","Ce","advancedMRRFactors","Ae","schematicMRRFactors","Ee","TextureWrapMode","Oe","Ne","Ie","constructor","_materialInfoCache","_fastUpdateProcessor","_textures","Map","ensureDrapedStatus","doLoad","DRAW_MESH_GEOMETRY_NORMALS","_debugVertexNormalMaterial","color","_debugTangentNormalMaterial","_debugFaceNormalMaterial","destroy","forEach","unload","_context","stage","removeMany","materials","Array","from","values","clear","createGraphics3DGraphic","graphic","_validateGeometry","geometry","setGraphicElevationContext","renderingInfo","_createAs3DShape","uid","onRemoveGraphic","layerOpacityChanged","_getLayerOpacity","_updateMaterialParameters","material","setParameters","layerOpacity","parameters","_setMaterialTransparentParameter","transparent","isAsync","layerElevationInfoChanged","updateGraphics3DGraphicElevationInfo","slicePlaneEnabledChanged","hasSlicePlane","slicePlaneEnabled","physicalBasedRenderingChanged","_usePBR","usePBR","updateTransform","fastTransformUpdatesAllowed","fastTransformUpdatesEnabled","EnableFastUpdates","DisableFastUpdates","autoDisableFastTransformUpdates","renderCoordsHelper","spatialReference","at","origin","transform","Ze","enable","disable","UpdateFastLocalOrigin","updateFastLocalOrigin","localOriginFactory","elevationContext","centerPointInElevationSR","_getCenterPointInElevationSR","elevationProvider","alignedSampledElevation","updateAutoDisableFastTransformUpdates","_requiresSymbolVertexColors","_drivenProperties","opacity","_materialPropertiesDefault","vertexAttributes","tangent","hasSymbolVertexColors","hasVertexColors","hasVertexTangents","_materialProperties","colorTexture","colorTextureTransform","normalTexture","normalTextureTransform","doubleSided","alphaCutoff","alphaMode","Ye","Je","metallic","roughness","metallicRoughnessTexture","metallicRoughnessTextureTransform","emissiveColor","emissiveTexture","emissiveTextureTransform","occlusionTexture","occlusionTextureTransform","$e","_getInternalTexture","Opaque","We","contentHash","get","renderView","textures","acquire","id","events","on","renderingContext","maxMaxAnisotropy","wrap","He","noUnpackFlip","maxAnisotropy","mipmap","data","preMultiplyAlpha","encoding","downsampleUncompressed","graphicsCoreOwner","view","qualitySettings","graphics3D","uncompressedTextureDownsamplingEnabled","set","load","add","delete","_setInternalMaterialTextureParameters","textureAlphaMode","textureId","textureAlphaPremultiplied","normalTextureId","emissiveFactor","toUnitRGB","emissiveTextureId","occlusionTextureId","metallicRoughnessTextureId","_setInternalMaterialParameters","ze","colorTextureTransformMatrix","normalTextureTransformMatrix","scale","occlusionTextureTransformMatrix","emissiveTextureTransformMatrix","metallicRoughnessTextureTransformMatrix","_setExternalMaterialParameters","symbolLayer","colorMixMode","externalColor","toUnitRGBA","castShadows","_getOrCreateMaterial","ke","byUid","isComponentTransparent","metallicFactor","roughnessFactor","isSchematic","hasSymbolColors","ambient","diffuse","doubleSidedType","cullFace","None","mrrFactors","Back","textureAlphaCutoff","prepareSymbolLayerPatch","diff","type","_preparePatchColor","newValue","oldValue","symbolLayerStatePatches","push","physicalBasedRenderingEnabled","needsDrivenTransparentPass","MaskBlend","Mask","Blend","_createFaceDebugNormals","length","isGeographic","Math","max","extent","width","height","zmax","zmin","transformation","attributes","POSITION","indices","Le","rt","Ve","et","tt","Line","_createPerVertexDebugVectors","TANGENT","stride","_createGeometryInfo","geometries","objectTransformation","NORMAL","layerUid","layer","graphicUid","isElevationSource","onAddGraphic","needsElevationUpdates","mode","useObjectOriginAsAttachmentOrigin","_fastTransformUpdatesAllowed","vertexSpace","viewingMode","state","Global","Local","_passthroughReprojectionInfo","reprojection","it","NONE","_createPositionBuffer","position","georeferencedPositionBuffer","RENDER","transformBeforeProject","Float64Array","normal","_createNormalBuffer","Float32Array","isWebMercator","_createTangentBuffer","_createSymbolColorBuffer","_getVertexOpacityAndColor","Uint8Array","_createBuffers","logger","warn","uv","_computeReprojectionInfo","Ke","_transformOriginLocal","positionBuffer","normalBuffer","tangentBuffer","uvBuffer","colorBuffer","symbolColorBuffer","geometryTransformation","localMatrix","Xe","ot","_validateFaces","faces","_isOutsideClippingArea","clippingExtent","nt","_validateVertexSpace","components","st","getOrigin","Ue","Be","didFlipNormals","normals","COLOR","SYMBOLCOLOR","UV0","getObjectAndLayerIdColor","Mesh","localOrigin","forEachMaterialInfo","forEachClonedMaterial","test","Se","shading","De","Fe","Ge","trustSourceNormals","count","offset","rotation","qe","horizontal","vertical","CLAMP_TO_EDGE","MIRRORED_REPEAT","REPEAT","url","toHex","Qe","Graphics3DMeshFillSymbolLayer"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DMeshFillSymbolLayer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from\"../../../../Color.js\";import\"../../../../core/has.js\";import{deg2rad as t}from\"../../../../core/mathUtils.js\";import{releaseMaybe as r}from\"../../../../core/maybe.js\";import{isPromiseLike as o}from\"../../../../core/promiseUtils.js\";import{normalFromMat4 as a,fromMat4 as n}from\"../../../../core/libs/gl-matrix-2/math/mat3.js\";import{create as s}from\"../../../../core/libs/gl-matrix-2/factories/mat3f64.js\";import{fromTranslation as i,multiply as l,invert as c,getTranslation as u}from\"../../../../core/libs/gl-matrix-2/math/mat4.js\";import{create as m,IDENTITY as f,clone as p}from\"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{ONES as h}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{i as d,g,h as x,t as _,q as T,n as b,b as y,f as v,d as w,e as M}from\"../../../../chunks/vec32.js\";import{ZEROS as R,ONES as j,create as P}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{ONES as C}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{canProjectWithoutEngine as A}from\"../../../../geometry/projection.js\";import{computeTranslationToOriginAndRotation as E}from\"../../../../geometry/projection/computeTranslationToOriginAndRotation.js\";import{projectBuffer as O}from\"../../../../geometry/projection/projectBuffer.js\";import{projectVectorToPoint as N}from\"../../../../geometry/projection/projectVectorToPoint.js\";import{create as I,fromBuffer as S,intersectsClippingArea as U}from\"../../../../geometry/support/aaBoundingBox.js\";import{newFloatArray as B}from\"../../../../geometry/support/FloatArray.js\";import{getZeroIndexArray as F,getContinuousIndexArray as D}from\"../../../../geometry/support/Indices.js\";import G from\"../../../../geometry/support/MeshComponent.js\";import V from\"../../../../geometry/support/MeshMaterialMetallicRoughness.js\";import L from\"../../../../geometry/support/MeshTextureTransform.js\";import{isRelativeVertexSpace as $,isAbsoluteVertexSpace as H}from\"../../../../geometry/support/meshVertexSpaceUtils.js\";import{equals as q,isPlateCarree as k}from\"../../../../geometry/support/spatialReferenceUtils.js\";import{t as z}from\"../../../../chunks/vec3.js\";import{transformNormal as W,transformVectorENUPlateCarree as Y,VectorType as J,transformVectorWMPlateCarree as K,projectNormalToPCPF as Q,transformTangent as X,projectTangentToPCPF as Z}from\"../../../../geometry/support/meshUtils/projection.js\";import{projectMeshVertexPositions as ee}from\"../../../../geometry/support/meshUtils/projectMeshVertexPositions.js\";import{makeDehydratedPoint as te}from\"../../../../layers/graphics/dehydratedPoint.js\";import{MeshTransformUpdateAction as re}from\"../../../../layers/graphics/sources/interfaces.js\";import{ViewingMode as oe}from\"../../../ViewingMode.js\";import{isEncodedMeshTexture as ae}from\"../../glTF/internal/resourceUtils.js\";import{getTransformMatrix as ne}from\"../../glTF/internal/TextureTransformUtils.js\";import{perObjectElevationAligner as se}from\"./ElevationAligners.js\";import{needsElevationUpdates3D as ie,evaluateElevationInfoAtPoint as le}from\"./elevationAlignmentUtils.js\";import{Graphics3DMeshObject3DGraphicLayer as ce}from\"./Graphics3DMeshObject3DGraphicLayer.js\";import{Object3DEdgeState as ue}from\"./Graphics3DObject3DGraphicLayer.js\";import{Graphics3DSymbolLayer as me}from\"./Graphics3DSymbolLayer.js\";import{MaterialInfoCache as fe,MeshFastUpdateProcessor as pe}from\"./MeshFastUpdateProcessor.js\";import{createMaterial as he}from\"../support/edgeUtils.js\";import{parseColorMixMode as de,encodeSymbolColor as ge}from\"../support/symbolColorUtils.js\";import{debugFlags as xe}from\"../../support/debugFlags.js\";import{Attribute as _e}from\"../../webgl-engine/lib/Attribute.js\";import{AlphaDiscardMode as Te,CullFaceOptions as be}from\"../../webgl-engine/lib/basicInterfaces.js\";import{ContentObjectType as ye}from\"../../webgl-engine/lib/ContentObjectType.js\";import{Geometry as ve}from\"../../webgl-engine/lib/Geometry.js\";import{Object3D as we}from\"../../webgl-engine/lib/Object3D.js\";import{Texture as Me}from\"../../webgl-engine/lib/Texture.js\";import{VertexAttribute as Re}from\"../../webgl-engine/lib/VertexAttribute.js\";import{DefaultMaterial as je}from\"../../webgl-engine/materials/DefaultMaterial.js\";import{NativeLineMaterial as Pe}from\"../../webgl-engine/materials/NativeLineMaterial.js\";import{useSchematicPBR as Ce,advancedMRRFactors as Ae,schematicMRRFactors as Ee}from\"../../webgl-engine/materials/pbrUtils.js\";import{TextureWrapMode as Oe}from\"../../../webgl/enums.js\";const Ne=[\"mesh\"];class Ie extends me{constructor(e,t,r,o){super(e,t,r,o),this._materialInfoCache=new fe,this._fastUpdateProcessor=new pe,this._textures=new Map,this.ensureDrapedStatus(!1)}async doLoad(){xe.DRAW_MESH_GEOMETRY_NORMALS&&(this._debugVertexNormalMaterial=new Pe({color:[1,0,1,1]}),this._debugTangentNormalMaterial=new Pe({color:[1,.5,0,1]}),this._debugFaceNormalMaterial=new Pe({color:[0,1,1,1]}))}destroy(){super.destroy(),this._textures.forEach((e=>e.unload())),this._context.stage.removeMany(this._materialInfoCache.materials),this._context.stage.removeMany(Array.from(this._textures.values())),this._materialInfoCache.clear(),this._textures.clear(),this._fastUpdateProcessor.destroy(this._context.stage)}get materials(){return this._materialInfoCache.materials}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,Ne,\"fill on mesh-3d\"))return null;const r=this.setGraphicElevationContext(t),o=e.renderingInfo;return this._createAs3DShape(t,o,r,t.uid)}onRemoveGraphic(e){this._fastUpdateProcessor.onRemoveGraphic(e,this._materialInfoCache,this._context)}layerOpacityChanged(e,t){const r=this._getLayerOpacity();this._updateMaterialParameters((e=>{e.material.setParameters({layerOpacity:r});const t=e.material.parameters;this._setMaterialTransparentParameter(t,e),e.material.setParameters({transparent:t.transparent})})),e.forEach((e=>t(e)?.layerOpacityChanged(r,this._context.isAsync)))}layerElevationInfoChanged(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,ie)}slicePlaneEnabledChanged(e,t){return this._updateMaterialParameters((({material:e})=>{e.setParameters({hasSlicePlane:this._context.slicePlaneEnabled})})),e.forEach((e=>t(e)?.slicePlaneEnabledChanged(this._context.slicePlaneEnabled,this._context.isAsync))),!0}physicalBasedRenderingChanged(){const e=this._usePBR();return this._updateMaterialParameters((({material:t})=>t.setParameters({usePBR:e}))),!0}updateTransform(e,t,r,o){if(!e.fastTransformUpdatesAllowed)return!1;const a=e.fastTransformUpdatesEnabled;switch(o){case re.EnableFastUpdates:if(a)return!0;break;case re.DisableFastUpdates:if(!a)return!0;break;default:if(!a)return!!this.updateTransform(e,t,r,re.EnableFastUpdates)&&(e.autoDisableFastTransformUpdates((()=>this.updateTransform(e,t,r,re.DisableFastUpdates))),!0)}const n=this._context.renderCoordsHelper.spatialReference,s=at,{origin:i,transform:l}=r;if(!E(t,d(Ze,i.x,i.y,i.z??0),s,n))return!1;switch(o){case re.EnableFastUpdates:this._fastUpdateProcessor.enable(e,this._materialInfoCache,this._context);break;case re.DisableFastUpdates:this._fastUpdateProcessor.disable(e,this._materialInfoCache,this._context);break;case re.UpdateFastLocalOrigin:e.updateFastLocalOrigin(s,l,this._context.localOriginFactory)}const{elevationContext:c}=e;c.centerPointInElevationSR=this._getCenterPointInElevationSR(s);const{elevationProvider:u,renderCoordsHelper:m}=this._context,f=(e,t)=>le(e,u,c,m,t);return e.alignedSampledElevation=se(e,c,u.spatialReference,f,m,s),e.updateTransform(s,l,this._context.isAsync),e.updateAutoDisableFastTransformUpdates((()=>this.updateTransform(e,t,r,re.DisableFastUpdates))),!0}_requiresSymbolVertexColors(){return this._drivenProperties.color||this._drivenProperties.opacity}_materialPropertiesDefault(e,t){const r=this._requiresSymbolVertexColors(),o=!!e.vertexAttributes.color,a=!!e.vertexAttributes.tangent;return{hasSymbolVertexColors:r,hasVertexColors:o,hasVertexTangents:a,uid:`vc:${o},vt:${a},vct${t},svc:${r}`}}_materialProperties(e,t,r){const o=this._materialPropertiesDefault(e,r);if(!t.material)return o;const{color:a,colorTexture:n,colorTextureTransform:s,normalTexture:i,normalTextureTransform:l,doubleSided:c,alphaCutoff:u,alphaMode:m}=t.material,f=Ye(a),p=Ye(n),h=Je(s),d=Ye(i),g=Je(l);if(o.color=a,o.colorTexture=n,o.normalTexture=i,o.uid=`${o.uid},cmuid:${f},ctmuid:${p},cttuid:${h},ntmuid:${d},nttuid:${g},ds:${c},ac:${u},am:${m}`,t.material instanceof V){const{metallic:e,roughness:r,metallicRoughnessTexture:a,metallicRoughnessTextureTransform:n,emissiveColor:i,emissiveTexture:c,emissiveTextureTransform:u,occlusionTexture:m,occlusionTextureTransform:f}=t.material,p=Ye(a),h=Je(n),d=Ye(i),g=Ye(c),x=Je(u),_=Ye(m),T=Je(f);o.metallic=e,o.roughness=r,o.metallicRoughnessTexture=a,o.emissiveColor=i,o.emissiveTexture=c,o.occlusionTexture=m,o.colorTextureTransform=$e(s),o.normalTextureTransform=$e(l),o.emissiveTextureTransform=$e(u),o.occlusionTextureTransform=$e(f),o.metallicRoughnessTextureTransform=$e(n),o.uid=`${o.uid},mrm:${e},mrr:${r},mrt:${p},mrtt:${h},emuid:${d},etmuid:${g},ett:${x},otmuid:${_},ott:${T}`}return o}_getInternalTexture(e,t=Te.Opaque){const a=We(e);if(!a)return null;const n=`${e.contentHash}/${t}`;let s=this._textures.get(n);if(s){const e=this._context.stage.renderView.textures;let t=null;const a=e.acquire(s.id);return null==a||o(a)||(s.events.on(\"unloaded\",(()=>t=r(t))),t=a),s}let i=null;const l=this._context.stage.renderView.renderingContext.parameters.maxMaxAnisotropy,c={wrap:He(e.wrap),noUnpackFlip:!0,maxAnisotropy:l,mipmap:l>1};return ae(a)?(i=a.data,c.preMultiplyAlpha=!1,c.encoding=a.encoding):(i=a,c.preMultiplyAlpha=t!==Te.Opaque,c.downsampleUncompressed=this._context.graphicsCoreOwner.view.qualitySettings.graphics3D.uncompressedTextureDownsamplingEnabled),s=new Me(i,c),this._textures.set(n,s),s.load(this._context.stage.renderView.renderingContext),this._context.stage.add(s),s.events.on(\"unloaded\",(()=>{this._textures.delete(n)})),s}_setInternalMaterialTextureParameters(t,r){if(null!=t.colorTexture){const e=this._getInternalTexture(t.colorTexture,r.textureAlphaMode);e?(r.textureId=e.id,r.textureAlphaPremultiplied=!!e.parameters.preMultiplyAlpha):r.textureId=void 0}t.normalTexture&&(r.normalTextureId=this._getInternalTexture(t.normalTexture)?.id),t.emissiveColor&&(r.emissiveFactor=e.toUnitRGB(t.emissiveColor)),t.emissiveTexture&&(r.emissiveTextureId=this._getInternalTexture(t.emissiveTexture)?.id),t.occlusionTexture&&(r.occlusionTextureId=this._getInternalTexture(t.occlusionTexture)?.id),t.metallicRoughnessTexture&&(r.metallicRoughnessTextureId=this._getInternalTexture(t.metallicRoughnessTexture)?.id)}_setInternalMaterialParameters(e,t){null!=e.color&&ze(e.color,t),this._setInternalMaterialTextureParameters(e,t),t.colorTextureTransformMatrix=ne(e.colorTextureTransform),t.normalTextureTransformMatrix=ne(e.normalTextureTransform);const r=null!=e.normalTextureTransform?.scale?e.normalTextureTransform?.scale:h;t.scale=[r[0],r[1]],t.occlusionTextureTransformMatrix=ne(e.occlusionTextureTransform),t.emissiveTextureTransformMatrix=ne(e.emissiveTextureTransform),t.metallicRoughnessTextureTransformMatrix=ne(e.metallicRoughnessTextureTransform)}_setExternalMaterialParameters(t,r=this.symbolLayer?.material?.color){const o=this._drivenProperties.color;let a=this.symbolLayer.material?.colorMixMode??null;if(o)t.externalColor=C;else{const o=r??null;o?t.externalColor=e.toUnitRGBA(o):(a=null,t.externalColor=C)}a&&(t.colorMixMode=a),t.castShadows=!!this.symbolLayer.castShadows}_getOrCreateMaterial(t,r){const o=r.material?.color,a=r.material?.colorTexture,n=r.material?.alphaMode,s=\"blend\"===n,i=!(\"opaque\"===n)&&(ke(t)||null!=o&&o.a<1||a?.transparent||s),l=this._materialProperties(t,r,i),c=this._materialInfoCache.byUid(l.uid);if(c)return this._setInternalMaterialTextureParameters(l,c.material.parameters),c.material;const u={uid:l.uid,material:null,isComponentTransparent:i,alphaMode:r.material?r.material.alphaMode:\"opaque\"},m=Ce({normalTexture:l.normalTexture,metallicRoughnessTexture:l.metallicRoughnessTexture,metallicFactor:l.metallic,roughnessFactor:l.roughness,emissiveTexture:l.emissiveTexture,emissiveFactor:e.toUnitRGB(l.emissiveColor),occlusionTexture:l.occlusionTexture}),f={usePBR:this._usePBR(),isSchematic:m,hasVertexColors:l.hasVertexColors,hasSymbolColors:l.hasSymbolVertexColors,hasVertexTangents:l.hasVertexTangents,ambient:R,diffuse:j,opacity:1,doubleSided:!0,doubleSidedType:\"winding-order\",cullFace:be.None,layerOpacity:this._getLayerOpacity(),hasSlicePlane:this._context.slicePlaneEnabled};f.mrrFactors=m?Ee:[l.metallic,l.roughness,Ae[2]],r.material&&(f.doubleSided=r.material.doubleSided,f.cullFace=r.material.doubleSided?be.None:be.Back,f.textureAlphaCutoff=r.material.alphaCutoff),this._setExternalMaterialParameters(f),this._setMaterialTransparentParameter(f,u),this._setInternalMaterialParameters(l,f);const p=new je(f,this._context);return u.material=p,this._materialInfoCache.set(l.uid,u),this._context.stage.add(p),p}prepareSymbolLayerPatch(e){if(\"partial\"!==e.diff.type)return;const t=e.diff.diff;this._preparePatchColor(e,t)}_preparePatchColor(e,t){if(!t.material||\"partial\"!==t.material.type)return;const r=t.material.diff;if(!r.color||\"complete\"!==r.color.type||null==r.color.newValue||null==r.color.oldValue)return;const o=r.color.newValue;delete r.color,e.symbolLayerStatePatches.push((()=>{this._updateMaterialParameters((e=>{const t=e.material.parameters;this._setExternalMaterialParameters(t,o),this._setMaterialTransparentParameter(t,e),e.material.setParameters({externalColor:t.externalColor,transparent:t.transparent})}))}))}_usePBR(){return this._context.physicalBasedRenderingEnabled}_setMaterialTransparentParameter(e,t){e.transparent=this.needsDrivenTransparentPass||t.isComponentTransparent||e.layerOpacity<1||e.opacity<1||e.externalColor&&e.externalColor[3]<1,\"auto\"===t.alphaMode?e.textureAlphaMode=e.transparent?Te.MaskBlend:Te.Opaque:e.textureAlphaMode=\"opaque\"===t.alphaMode?Te.Opaque:\"mask\"===t.alphaMode?Te.Mask:Te.Blend}_createFaceDebugNormals(e,t){const r=t.length,o=e.spatialReference.isGeographic?20015077/180:1,n=.1*Math.max(e.extent.width*o,e.extent.height*o,e.extent.zmax-e.extent.zmin),i=[],l=[],c=t[0].transformation,u=a(s(),c);for(let a=0;a<r;a++){const e=t[a].attributes.get(Re.POSITION);if(!e)continue;const r=e.data,o=e.indices;for(let t=0;t<o.length;t+=3)Le(r,o,t,rt),Ve(r,o,t,Ze,et,tt),g(Ze,Ze,et),g(Ze,Ze,tt),x(Ze,Ze,1/3),_(Ze,Ze,c),i.push(...Ze),T(rt,rt,u),b(rt,rt),y(Ze,Ze,rt,n),i.push(...Ze),l.push(l.length),l.push(l.length)}return i.length?new ve(this._debugFaceNormalMaterial,[[Re.POSITION,new _e(i,l,3,!0)]],null,ye.Line):null}_createPerVertexDebugVectors(e,t,r,o,i){const l=t.length,c=e.spatialReference.isGeographic?20015077/180:1,u=.1*i*Math.max(e.extent.width*c,e.extent.height*c,e.extent.zmax-e.extent.zmin),m=[],f=[],p=t[0].transformation,h=a(s(),p);r===Re.TANGENT&&n(h,p);for(let a=0;a<l;a++){const e=t[a],o=e.attributes.get(Re.POSITION),n=e.attributes.get(r);if(!o||!n)continue;const s=o.data,i=o.indices,l=n.data,c=n.indices;for(let t=0;t<i.length;t++){const e=3*i[t],r=c[t]*n.stride;d(Ze,s[e+0],s[e+1],s[e+2]),_(Ze,Ze,p),m.push(...Ze),d(et,l[r+0],l[r+1],l[r+2]),T(et,et,h),b(et,et),y(Ze,Ze,et,u),m.push(...Ze),f.push(f.length),f.push(f.length)}}return m.length?new ve(o,[[Re.POSITION,new _e(m,f,3,!0)]],null,ye.Line):null}_createAs3DShape(e,t,r,o){const a=e.geometry;if(\"mesh\"!==a.type)return null;const n=this._createGeometryInfo(a,t,o);if(null==n)return null;const{geometries:s,objectTransformation:i}=n;if(xe.DRAW_MESH_GEOMETRY_NORMALS){const e=this._createPerVertexDebugVectors(a,s,Re.NORMAL,this._debugVertexNormalMaterial,1),t=this._createPerVertexDebugVectors(a,s,Re.TANGENT,this._debugTangentNormalMaterial,.5),r=this._createFaceDebugNormals(a,s);e&&s.push(e),t&&s.push(t),r&&s.push(r)}const l=new we({geometries:s,layerUid:this._context.layer.uid,graphicUid:o,isElevationSource:!0});l.transformation=i;const c=he(this.symbolLayer,{opacity:this._getLayerOpacity()}),u=c?new ue(s[0].material,c,this._context.slicePlaneEnabled):null,m=new ce(this,l,s,null,null,se,r,u);this._fastUpdateProcessor.onAddGraphic(),m.needsElevationUpdates=ie(r.mode),m.useObjectOriginAsAttachmentOrigin=!0,m.fastTransformUpdatesAllowed=this._fastTransformUpdatesAllowed(a),r.centerPointInElevationSR=this._getCenterPointInElevationSR(l.transformation);const{elevationProvider:f,renderCoordsHelper:p}=this._context,h=(e,t)=>le(e,f,r,p,t);return m.alignedSampledElevation=se(m,r,f.spatialReference,h,p),m}_fastTransformUpdatesAllowed(e){const{vertexSpace:t,spatialReference:r}=e;if(!$(t))return!1;const{type:o}=t,{view:a}=this._context.graphicsCoreOwner,{viewingMode:n}=a.state,s=a.spatialReference;return n===oe.Global&&\"local\"===o||n===oe.Local&&q(s,r)&&\"georeferenced\"===o&&!r.isGeographic}_getCenterPointInElevationSR(e){const t=te(0,0,0,this._context.elevationProvider.spatialReference??null);return N([e[12],e[13],e[14]],this._context.renderCoordsHelper.spatialReference,t),t}_passthroughReprojectionInfo(e){return e.reprojection===it.NONE&&!!e.objectTransformation}_createPositionBuffer(e,t){const r=e.vertexAttributes.position;let o,a=r;if(t.reprojection===it.NONE)return{position:a,georeferencedPositionBuffer:o};const n=t.reprojection===it.RENDER?t.transformBeforeProject:null;n&&(a=z(new Float64Array(a.length),a,n));const{normal:s,tangent:i}=e.vertexAttributes;this._passthroughReprojectionInfo(t)||!s&&!i||(o=a);const l=a===r||a===o?new Float64Array(a.length):a;return O(a,e.spatialReference,0,l,this._context.renderCoordsHelper.spatialReference,0),{position:l,georeferencedPositionBuffer:o}}_createNormalBuffer(e,t,r,o){const a=e.vertexAttributes.normal;if(null==a)return null;let n=a;const s=o.reprojection===it.RENDER?o.transformBeforeProject:null;s&&(n=W(n,new Float32Array(n.length),s));const i=this._context.graphicsCoreOwner.view.viewingMode;if(o.reprojection===it.NONE)return n;if(\"local\"===i){if(!k(this._context.renderCoordsHelper.spatialReference))return n;if(null==r)return null;if(e.spatialReference.isGeographic){const e=n===a?new Float32Array(n.length):n;return Y(n,J.NORMAL,r,e)}if(e.spatialReference.isWebMercator){const e=n===a?new Float32Array(n.length):n;return K(n,J.NORMAL,r,e)}return n}if(null==r)return null;const l=n===a?new Float32Array(n.length):n,c=this._context.renderCoordsHelper.spatialReference;return Q(n,r,e.spatialReference,t,c,l)}_createTangentBuffer(e,t,r,o){const a=e.vertexAttributes.tangent;if(null==a)return null;let n=a;const s=o.reprojection===it.RENDER?o.transformBeforeProject:null;s&&(n=X(n,new Float32Array(n.length),s));const i=this._context.graphicsCoreOwner.view.viewingMode;if(o.reprojection===it.NONE)return n;if(\"local\"===i){if(!k(this._context.renderCoordsHelper.spatialReference))return n;if(null==r)return null;if(e.spatialReference.isGeographic){const e=n===a?new Float32Array(n.length):n;return Y(n,J.TANGENT,r,e)}if(e.spatialReference.isWebMercator){const e=n===a?new Float32Array(n.length):n;return K(n,J.TANGENT,r,e)}return n}if(null==r)return null;const l=n===a?new Float32Array(n.length):n,c=this._context.renderCoordsHelper.spatialReference;return Z(n,r,e.spatialReference,t,c,l)}_createSymbolColorBuffer(e){if(this._requiresSymbolVertexColors()){const t=this._getVertexOpacityAndColor(e),r=de(this.symbolLayer?.material?.colorMixMode),o=new Uint8Array(4);return ge(t,r,o),o}return null}_createBuffers(e,t){const r=e.vertexAttributes&&e.vertexAttributes.position;if(!r)return this.logger.warn(\"Mesh geometry must contain position vertex attributes\"),null;const o=e.vertexAttributes.normal,a=e.vertexAttributes.uv,n=e.vertexAttributes.tangent;if(o&&o.length!==r.length)return this.logger.warn(\"Mesh normal vertex buffer must contain the same number of elements as the position buffer\"),null;if(n&&n.length/4!=r.length/3)return this.logger.warn(\"Mesh tangent vertex buffer must contain the same number of elements as the position buffer\"),null;if(a&&a.length/2!=r.length/3)return this.logger.warn(\"Mesh uv vertex buffer must contain the same number of elements as the position buffer\"),null;const s=this._computeReprojectionInfo(e),{position:i,georeferencedPositionBuffer:l}=this._createPositionBuffer(e,s),c=Ke(e),u=this._createSymbolColorBuffer(t),f=this._createNormalBuffer(e,i,l,s),p=this._createTangentBuffer(e,i,l,s),h=a,{transformation:d,position:g,normal:x,tangent:_}=this._passthroughReprojectionInfo(s)?{transformation:s.objectTransformation,position:i,normal:f,tangent:p}:this._transformOriginLocal(e,i,f,p);return{positionBuffer:g,normalBuffer:x,tangentBuffer:_,uvBuffer:h,colorBuffer:c,symbolColorBuffer:u,objectTransformation:d,geometryTransformation:s.reprojection===it.NONE&&s.geometryTransformation?s.geometryTransformation:m()}}_computeReprojectionInfo(e){const{vertexSpace:t}=e,r=\"georeferenced\"===t.type?q(this._context.renderCoordsHelper.spatialReference,e.spatialReference)?it.NONE:it.RENDER:it.NONE;if(H(t))return{reprojection:r};const o=t.origin,a=m(),n=e.transform?.localMatrix??f;if(r===it.NONE){E(e.spatialReference,o,a,this._context.renderCoordsHelper.spatialReference);return{reprojection:r,objectTransformation:a,geometryTransformation:p(n)}}const s=i(m(),o);return l(s,s,n),{reprojection:r,transformBeforeProject:s}}_transformOriginLocal(e,t,r,o){const a=this._context.renderCoordsHelper.spatialReference,n=e.origin;Xe[0]=n.x,Xe[1]=n.y,Xe[2]=n.z??0;const s=m();E(e.spatialReference,Xe,s,a),c(ot,s);const{position:i,normal:l,tangent:u}=e.vertexAttributes,f=t===i?new Float64Array(t.length):t;z(f,t,ot);const p=r?r===l?new Float32Array(r.length):r:null,h=o?o===u?new Float32Array(o.length):o:null;return r&&p&&W(r,p,ot),o&&h&&X(o,h,ot),{transformation:s,position:f,normal:p,tangent:h}}_validateFaces(e,t){const r=e.vertexAttributes.position.length/3,o=t.faces;if(o){let e=-1;for(let t=0;t<o.length;t++){const r=o[t];r>e&&(e=r)}if(r<=e)return this.logger.warn(`Vertex index ${e} is out of bounds of the mesh position buffer`),!1}else if(r%3!=0)return this.logger.warn(\"Mesh position buffer length must be a multiple of 9 if no component faces are defined (3 values per vertex * 3 vertices per triangle)\"),!1;return!0}_isOutsideClippingArea(e){if(!this._context.clippingExtent)return!1;const t=e.vertexAttributes?.position;if(!t)return!1;const r=this._context.elevationProvider.spatialReference,o=ee(e,r??e.spatialReference);return!!o&&(S(o,nt),!U(nt,this._context.clippingExtent))}_createGeometryInfo(e,t,r){if(!A(e.spatialReference,this._context.renderCoordsHelper.spatialReference))return this.logger.warn(\"Geometry spatial reference is not compatible with the view\"),null;if(!this._validateVertexSpace(e))return null;if(this._isOutsideClippingArea(e))return null;const o=this._createBuffers(e,t);if(null==o)return null;const{positionBuffer:a,uvBuffer:n,colorBuffer:s,symbolColorBuffer:i,normalBuffer:l,tangentBuffer:c,objectTransformation:m,geometryTransformation:f}=o,p=e.components??st,h=new Array;let d=!1;const g=u(Ze,m),x=this._context.localOriginFactory.getOrigin(g);for(const u of p){if(!this._validateFaces(e,u))return null;const t=Ue(e,u);if(0===t.length)continue;const o=Be(a,l,u,t);o.didFlipNormals&&(d=!0);const m=[[Re.POSITION,new _e(a,t,3,!0)],[Re.NORMAL,new _e(o.normals,o.indices,3,!0)]];s&&m.push([Re.COLOR,new _e(s,t,4,!0)]),i&&m.push([Re.SYMBOLCOLOR,new _e(i,F(t.length),4,!0)]),n&&m.push([Re.UV0,new _e(n,t,2,!0)]),c&&m.push([Re.TANGENT,new _e(c,t,4,!0)]);const p=this._context.stage.renderView.getObjectAndLayerIdColor({graphicUid:r,layerUid:this._context.layer.uid}),g=this._getOrCreateMaterial(e,u),_=new ve(g,m,null,ye.Mesh,p);_.transformation=f,_.localOrigin=x,h.push(_)}return d&&this.logger.warn(\"Normals have been automatically flipped to be consistent with the counter clock wise face winding order. It is better to generate mesh geometries that have consistent normals.\"),{geometries:h,objectTransformation:m}}_updateMaterialParameters(e){this._materialInfoCache.forEachMaterialInfo(e),this._fastUpdateProcessor.forEachMaterialInfo(e),this._fastUpdateProcessor.forEachClonedMaterial(((e,t)=>{t.setParameters(e.parameters)}))}_validateVertexSpace(e){const{_context:{graphicsCoreOwner:{view:{state:{viewingMode:t}}}}}=this,{vertexSpace:r}=e;return t!==oe.Local||\"local\"!==r.type||(this.logger.warn(\"Displaying a mesh with a local vertex space in a view in local viewing mode is not supported.\"),!1)}test(){return{...super.test(),materials:this._materialInfoCache.materials}}}class Se{constructor(e,t,r){this.normals=e,this.indices=t,this.didFlipNormals=r}}function Ue(e,t){return t.faces??D(e.vertexAttributes.position.length/3)}function Be(e,t,r,o){switch(r.shading||\"flat\"){default:case\"source\":return De(e,t,r,o);case\"flat\":return Fe(e,o);case\"smooth\":return Ge(e,o)}}function Fe(e,t){const r=B(t.length),o=new Array(3*t.length);for(let a=0;a<t.length;a+=3){const n=Le(e,t,a,rt);for(let e=0;e<3;e++)r[a+e]=n[e],o[a+e]=a/3}return new Se(r,o,!1)}function De(e,t,r,o){if(null==t)return Fe(e,o);let a=!1;if(!r.trustSourceNormals)for(let n=0;n<o.length;n+=3){Le(e,o,n,rt);for(let e=0;e<3;e++){const r=3*o[n+e];Ze[0]=t[r],Ze[1]=t[r+1],Ze[2]=t[r+2],v(rt,Ze)<0&&(t[r]=-t[r],t[r+1]=-t[r+1],t[r+2]=-t[r+2],a=!0)}}return new Se(t,o,a)}function Ge(e,t){const r={};for(let n=0;n<t.length;n+=3){const o=Le(e,t,n,rt);for(let e=0;e<3;e++){const a=t[n+e];let s=r[a];s||(s={normal:P(),count:0},r[a]=s),g(s.normal,s.normal,o),s.count++}}const o=B(3*t.length),a=new Array(3*t.length);for(let n=0;n<t.length;n++){const e=r[t[n]];1!==e.count&&(b(e.normal,e.normal),e.count=1);for(let t=0;t<3;t++)o[3*n+t]=e.normal[t];a[n]=n}return new Se(o,a,!1)}function Ve(e,t,r,o,a,n){const s=3*t[r],i=3*t[r+1],l=3*t[r+2];o[0]=e[s],o[1]=e[s+1],o[2]=e[s+2],a[0]=e[i],a[1]=e[i+1],a[2]=e[i+2],n[0]=e[l],n[1]=e[l+1],n[2]=e[l+2]}function Le(e,t,r,o){return Ve(e,t,r,Ze,et,tt),w(et,et,Ze),w(tt,tt,Ze),M(Ze,et,tt),b(o,Ze),o}function $e(e){if(!e)return null;const{scale:r,offset:o,rotation:a}=e;return{scale:r,offset:o,rotation:t(a)}}function He(e=\"repeat\"){if(\"string\"==typeof e){const t=qe(e);return{s:t,t}}return{s:qe(e.horizontal),t:qe(e.vertical)}}function qe(e){switch(e){case\"clamp\":return Oe.CLAMP_TO_EDGE;case\"mirror\":return Oe.MIRRORED_REPEAT;default:return Oe.REPEAT}}function ke(e){const t=e.vertexAttributes.color;if(null==t)return!1;for(let r=3;r<t.length;r+=4)if(255!==t[r])return!0;return!1}function ze(t,r){r.diffuse=e.toUnitRGB(t),r.opacity=t.a}function We(e){return e.data??e.url}function Ye(t){return null==t?\"-\":t instanceof e?t.toHex():t.contentHash}function Je(e){const{offset:t,scale:r,rotation:o}=e??Qe;return`${t[0]},${t[1]},${o},${r[0]},${r[1]}`}function Ke(e){return e.vertexAttributes.color}const Qe=new L,Xe=P(),Ze=P(),et=P(),tt=P(),rt=P(),ot=m(),at=m(),nt=I(),st=[new G];var it;!function(e){e[e.NONE=0]=\"NONE\",e[e.RENDER=1]=\"RENDER\"}(it||(it={}));export{Ie as Graphics3DMeshFillSymbolLayer};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}