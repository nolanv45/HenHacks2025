{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { TranslateAnchor as e } from \"../../vectorTiles/style/StyleDefinition.js\";\nimport { vtlTextureBindingUnitSprites as t } from \"../definitions.js\";\nimport i from \"./WGLBrush.js\";\nimport { TextureSamplingMode as n, CompareFunction as a, PrimitiveType as r, DataType as o } from \"../../../../webgl/enums.js\";\nclass s extends i {\n  constructor() {\n    super(...arguments), this._programOptions = {\n      id: !1,\n      pattern: !1,\n      sdf: !1\n    };\n  }\n  dispose() {}\n  drawMany(i, s) {\n    const {\n      context: l,\n      displayLevel: f,\n      state: u,\n      painter: c,\n      pixelRatio: d,\n      spriteMosaic: m,\n      styleLayerUID: p,\n      requestRender: g,\n      allowDelayedRender: y\n    } = i;\n    if (!s.some(e => e.layerData.get(p)?.lineIndexCount ?? !1)) return;\n    const M = i.styleLayer,\n      E = M.lineMaterial,\n      _ = c.vectorTilesMaterialManager,\n      v = M.getPaintValue(\"line-translate\", f),\n      U = M.getPaintValue(\"line-translate-anchor\", f),\n      I = M.getPaintProperty(\"line-pattern\"),\n      P = void 0 !== I,\n      x = P && I.isDataDriven;\n    let D, S;\n    if (P && !x) {\n      const e = I.getValue(f);\n      D = m.getMosaicItemPosition(e);\n    }\n    let L = !1;\n    if (!P) {\n      const e = M.getPaintProperty(\"line-dasharray\");\n      if (S = void 0 !== e, L = S && e.isDataDriven, S && !L) {\n        const t = e.getValue(f),\n          i = M.getDashKey(t, M.getLayoutValue(\"line-cap\", f));\n        D = m.getMosaicItemPosition(i);\n      }\n    }\n    const N = 1 / d,\n      R = this._programOptions;\n    R.pattern = P, R.sdf = S;\n    const T = _.getMaterialProgram(l, E, R);\n    if (y && null != g && !T.compiled) return void g();\n    if (l.useProgram(T), T.setUniformMatrix3fv(\"u_displayViewMat3\", u.displayViewMat3), T.setUniformMatrix3fv(\"u_displayMat3\", U === e.VIEWPORT ? u.displayMat3 : u.displayViewMat3), T.setUniform2fv(\"u_lineTranslation\", v), T.setUniform1f(\"u_depth\", M.z), T.setUniform1f(\"u_antialiasing\", N), D && null != D) {\n      const {\n          page: e\n        } = D,\n        i = m.getPageSize(e);\n      null != i && (m.bind(l, n.LINEAR, e, t), T.setUniform2fv(\"u_mosaicSize\", i), T.setUniform1i(\"u_texture\", t));\n    }\n    let V = -1;\n    for (const e of s) {\n      if (!e.layerData.has(p)) continue;\n      e.key.level !== V && (V = e.key.level, E.setDataUniforms(T, f, M, V, m));\n      const i = 2 ** (f - V) / d;\n      T.setUniform1f(\"u_zoomFactor\", i);\n      const s = e.layerData.get(p);\n      if (!s.lineIndexCount) continue;\n      s.prepareForRendering(l);\n      const u = s.vao;\n      if (null != u) {\n        if (l.bindVAO(u), T.setUniformMatrix3fv(\"u_dvsMat3\", e.transforms.displayViewScreenMat3), l.setStencilFunction(a.EQUAL, e.stencilRef, 255), x || L) {\n          const e = s.patternMap;\n          if (!e) continue;\n          for (const [i, a] of e) {\n            const e = m.getPageSize(i);\n            null != e && (m.bind(l, n.LINEAR, i, t), T.setUniform2fv(\"u_mosaicSize\", e), T.setUniform1i(\"u_texture\", t), l.drawElements(r.TRIANGLES, a[1], o.UNSIGNED_INT, Uint32Array.BYTES_PER_ELEMENT * a[0]));\n          }\n        } else l.drawElements(r.TRIANGLES, s.lineIndexCount, o.UNSIGNED_INT, Uint32Array.BYTES_PER_ELEMENT * s.lineIndexStart);\n        e.triangleCount += s.lineIndexCount / 3;\n      }\n    }\n  }\n}\nexport { s as WGLBrushVTLLine };","map":{"version":3,"names":["TranslateAnchor","e","vtlTextureBindingUnitSprites","t","i","TextureSamplingMode","n","CompareFunction","a","PrimitiveType","r","DataType","o","s","constructor","arguments","_programOptions","id","pattern","sdf","dispose","drawMany","context","l","displayLevel","f","state","u","painter","c","pixelRatio","d","spriteMosaic","m","styleLayerUID","p","requestRender","g","allowDelayedRender","y","some","layerData","get","lineIndexCount","M","styleLayer","E","lineMaterial","_","vectorTilesMaterialManager","v","getPaintValue","U","I","getPaintProperty","P","x","isDataDriven","D","S","getValue","getMosaicItemPosition","L","getDashKey","getLayoutValue","N","R","T","getMaterialProgram","compiled","useProgram","setUniformMatrix3fv","displayViewMat3","VIEWPORT","displayMat3","setUniform2fv","setUniform1f","z","page","getPageSize","bind","LINEAR","setUniform1i","V","has","key","level","setDataUniforms","prepareForRendering","vao","bindVAO","transforms","displayViewScreenMat3","setStencilFunction","EQUAL","stencilRef","patternMap","drawElements","TRIANGLES","UNSIGNED_INT","Uint32Array","BYTES_PER_ELEMENT","lineIndexStart","triangleCount","WGLBrushVTLLine"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/2d/engine/webgl/brushes/WGLBrushVTLLine.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{TranslateAnchor as e}from\"../../vectorTiles/style/StyleDefinition.js\";import{vtlTextureBindingUnitSprites as t}from\"../definitions.js\";import i from\"./WGLBrush.js\";import{TextureSamplingMode as n,CompareFunction as a,PrimitiveType as r,DataType as o}from\"../../../../webgl/enums.js\";class s extends i{constructor(){super(...arguments),this._programOptions={id:!1,pattern:!1,sdf:!1}}dispose(){}drawMany(i,s){const{context:l,displayLevel:f,state:u,painter:c,pixelRatio:d,spriteMosaic:m,styleLayerUID:p,requestRender:g,allowDelayedRender:y}=i;if(!s.some((e=>e.layerData.get(p)?.lineIndexCount??!1)))return;const M=i.styleLayer,E=M.lineMaterial,_=c.vectorTilesMaterialManager,v=M.getPaintValue(\"line-translate\",f),U=M.getPaintValue(\"line-translate-anchor\",f),I=M.getPaintProperty(\"line-pattern\"),P=void 0!==I,x=P&&I.isDataDriven;let D,S;if(P&&!x){const e=I.getValue(f);D=m.getMosaicItemPosition(e)}let L=!1;if(!P){const e=M.getPaintProperty(\"line-dasharray\");if(S=void 0!==e,L=S&&e.isDataDriven,S&&!L){const t=e.getValue(f),i=M.getDashKey(t,M.getLayoutValue(\"line-cap\",f));D=m.getMosaicItemPosition(i)}}const N=1/d,R=this._programOptions;R.pattern=P,R.sdf=S;const T=_.getMaterialProgram(l,E,R);if(y&&null!=g&&!T.compiled)return void g();if(l.useProgram(T),T.setUniformMatrix3fv(\"u_displayViewMat3\",u.displayViewMat3),T.setUniformMatrix3fv(\"u_displayMat3\",U===e.VIEWPORT?u.displayMat3:u.displayViewMat3),T.setUniform2fv(\"u_lineTranslation\",v),T.setUniform1f(\"u_depth\",M.z),T.setUniform1f(\"u_antialiasing\",N),D&&null!=D){const{page:e}=D,i=m.getPageSize(e);null!=i&&(m.bind(l,n.LINEAR,e,t),T.setUniform2fv(\"u_mosaicSize\",i),T.setUniform1i(\"u_texture\",t))}let V=-1;for(const e of s){if(!e.layerData.has(p))continue;e.key.level!==V&&(V=e.key.level,E.setDataUniforms(T,f,M,V,m));const i=2**(f-V)/d;T.setUniform1f(\"u_zoomFactor\",i);const s=e.layerData.get(p);if(!s.lineIndexCount)continue;s.prepareForRendering(l);const u=s.vao;if(null!=u){if(l.bindVAO(u),T.setUniformMatrix3fv(\"u_dvsMat3\",e.transforms.displayViewScreenMat3),l.setStencilFunction(a.EQUAL,e.stencilRef,255),x||L){const e=s.patternMap;if(!e)continue;for(const[i,a]of e){const e=m.getPageSize(i);null!=e&&(m.bind(l,n.LINEAR,i,t),T.setUniform2fv(\"u_mosaicSize\",e),T.setUniform1i(\"u_texture\",t),l.drawElements(r.TRIANGLES,a[1],o.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*a[0]))}}else l.drawElements(r.TRIANGLES,s.lineIndexCount,o.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*s.lineIndexStart);e.triangleCount+=s.lineIndexCount/3}}}}export{s as WGLBrushVTLLine};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}