{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../chunks/tslib.es6.js\";\nimport { serializationUtilsModuleWrapper as t } from \"../applications/KnowledgeStudio/resourceSerializationUtils.js\";\nimport a from \"../core/Collection.js\";\nimport i from \"../core/Error.js\";\nimport n from \"../core/Logger.js\";\nimport { getOrCreateMapValue as o } from \"../core/MapUtils.js\";\nimport { MultiOriginJSONMixin as r } from \"../core/MultiOriginJSONSupport.js\";\nimport { throwIfAborted as s, isAbortError as l, createAbortError as h } from \"../core/promiseUtils.js\";\nimport { watch as d, sync as p } from \"../core/reactiveUtils.js\";\nimport { property as c } from \"../core/accessorSupport/decorators/property.js\";\nimport \"../core/has.js\";\nimport \"../core/RandomLCG.js\";\nimport { subclass as u } from \"../core/accessorSupport/decorators/subclass.js\";\nimport { OriginId as y, idToName as g } from \"../core/accessorSupport/PropertyOrigin.js\";\nimport m from \"../geometry/Extent.js\";\nimport f from \"../geometry/Point.js\";\nimport L from \"../geometry/Polyline.js\";\nimport b from \"./Layer.js\";\nimport { convertFromGeometry as w } from \"./graphics/featureConversionUtils.js\";\nimport { systemOidFieldName as M, systemOriginIdFieldName as k, systemDestinationIdFieldName as C, systemLayoutGeometryFieldName as T, systemAggregationCountFieldName as N } from \"./knowledgeGraph/constants.js\";\nimport { IdealEdgeLengthTypeOptions as v } from \"./knowledgeGraph/IdealEdgeLengthTypeOptions.js\";\nimport { KnowledgeGraphLayerDataManager as D } from \"./knowledgeGraph/KnowledgeGraphLayerDataManager.js\";\nimport x from \"./knowledgeGraph/KnowledgeGraphSublayer.js\";\nimport { initializeLayersFromClientData as I } from \"./knowledgeGraph/layerUtils.js\";\nimport E from \"./knowledgeGraph/SessionMemoryStorage.js\";\nimport { convertLayoutTypeToWebSupportedFormat as S, getRelationshipEndNodeIds as _ } from \"./knowledgeGraph/supportUtils.js\";\nimport { BlendLayer as R } from \"./mixins/BlendLayer.js\";\nimport { OperationalLayer as A } from \"./mixins/OperationalLayer.js\";\nimport { ScaleRangeLayer as j } from \"./mixins/ScaleRangeLayer.js\";\nimport { url as G } from \"./support/commonProperties.js\";\nimport { LCChronologicalLayout as z, LCSimpleLayout as P, LCSmartTreeLayout as O, LCRadialTreeLayout as F, LCHierarchicalLayout as U, LCCommunityLayout as B, LCForceDirectedLayout as Q, NodeFlag as W, load as $, CallStatus as H, LinkType as K } from \"../libs/linkchartlayout/LinkChartLayout.js\";\nimport { fetchKnowledgeGraph as V } from \"../rest/knowledgeGraphService.js\";\nlet q = class extends A(R(j(r(b)))) {\n  constructor(e) {\n    if (super(e), this.url = null, this.dataPreloadedInLocalCache = !1, this.initializationLinkChartConfig = null, this.membershipModified = !0, this._currentLinkChartConfig = {\n      layoutMode: \"organic-standard\"\n    }, this._graphTypeLookup = new Map(), this.dataManager = null, this.knowledgeGraph = null, this.layers = new (a.ofType(x))(), this.entityLinkChartDiagramLookup = new Map(), this.relationshipLinkChartDiagramLookup = new Map(), this.linkChartExtent = new m({\n      xmin: -1e-7,\n      ymin: -1e-7,\n      xmax: 1e-7,\n      ymax: 1e-7\n    }), this.memberEntityTypes = null, this.memberRelationshipTypes = null, this.operationalLayerType = \"LinkChartLayer\", this.sublayerIdsCache = new Map(), this.tables = new (a.ofType(x))(), this.type = \"link-chart\", this.chronologicalAuxiliaryGraphics = null, this._originalInclusionList = e?.initializationInclusionModeDefinition, e?.dataPreloadedInLocalCache && !e?.initializationInclusionModeDefinition) throw new i(\"knowledge-graph:linkchart-layer-constructor\", \"If creating a link chart composite layer and configured that data is already loaded in the cache, you must specify an inclusion list so the Composite Layer knows what records belong to it\");\n    this.addHandles(d(() => this.layers.concat(this.tables), (e, t) => this._handleSublayersChange(e, t), p));\n  }\n  normalizeCtorArgs(e) {\n    if (!e) return {};\n    const {\n      url: t,\n      title: a,\n      dataPreloadedInLocalCache: i,\n      initializationLinkChartConfig: n\n    } = e;\n    return {\n      url: t,\n      title: a,\n      dataPreloadedInLocalCache: i,\n      initializationLinkChartConfig: n\n    };\n  }\n  _initializeLayerProperties(e) {\n    if (!this.title && this.url) {\n      const e = this.url.split(\"/\");\n      this.title = e[e.length - 2];\n    }\n    const t = new Set();\n    let a = [],\n      o = [];\n    if (e.inclusionModeDefinition && (!e.inclusionModeDefinition.namedTypeDefinitions || e.inclusionModeDefinition.namedTypeDefinitions.size < 1)) throw new i(\"knowledge-graph:composite-layer-constructor\", \"If an explicit inclusion definition is defined, at least one namedTypeDefinition must also be defined\");\n    e.inclusionModeDefinition?.generateAllSublayers ? (a = e.knowledgeGraph.dataModel.entityTypes ?? [], o = e.knowledgeGraph.dataModel.relationshipTypes ?? []) : e.inclusionModeDefinition?.namedTypeDefinitions && e.inclusionModeDefinition?.namedTypeDefinitions.size > 0 ? e.inclusionModeDefinition?.namedTypeDefinitions.forEach((i, r) => {\n      const s = this._graphTypeLookup.get(r);\n      if (!s) return n.getLogger(this).warn(`A named type, ${r}, was in the inclusion list that wasn't in the data model and will be removed`), void e.inclusionModeDefinition?.namedTypeDefinitions.delete(r);\n      \"relationship\" === s.type ? t.has(r) || (t.add(r), o.push(s)) : \"entity\" === s.type ? t.has(r) || (t.add(r), a.push(s)) : (n.getLogger(this).warn(`A named type, ${r}, was in the inclusion list that wasn't properly modeled and will be removed`), e.inclusionModeDefinition?.namedTypeDefinitions.delete(r));\n    }) : (a = e.knowledgeGraph.dataModel.entityTypes ?? [], o = e.knowledgeGraph.dataModel.relationshipTypes ?? []);\n    const r = new D({\n      knowledgeGraph: e.knowledgeGraph,\n      inclusionModeDefinition: e.inclusionModeDefinition\n    });\n    this.knowledgeGraph = e.knowledgeGraph, this.memberEntityTypes = a, this.memberRelationshipTypes = o, this.dataManager = r;\n  }\n  load(e) {\n    const a = async () => {\n      const e = [],\n        t = [];\n      this.loadLayerAssumingLocalCache(), this._layersLoadedFromAuthoritativeItem() || (await I(this)), this.dataManager.inclusionModeDefinition && (this.dataManager.inclusionModeDefinition.generateAllSublayers = !1), this.dataManager.inclusionModeDefinition?.namedTypeDefinitions.forEach(e => {\n        e.useAllData = !1;\n      }), await this._initializeDiagram(), this.layers.forEach(a => {\n        t.push(a.refreshCachedQueryEngine()), e.push(new Promise(e => {\n          a.on(\"layerview-create\", () => {\n            e(null);\n          });\n        }));\n      }), this.tables.forEach(e => {\n        t.push(e.refreshCachedQueryEngine());\n      }), await Promise.all(t);\n    };\n    return this.addResolvingPromise(new Promise(i => {\n      V(this.url).then(async n => {\n        n.dataModel.entityTypes?.forEach(e => {\n          e.name && this._graphTypeLookup.set(e.name, e);\n        }), n.dataModel.relationshipTypes?.forEach(e => {\n          e.name && this._graphTypeLookup.set(e.name, e);\n        });\n        const r = this.linkChart?.linkChartProperties;\n        if (r?.originIdOf(\"entitiesUrl\") === y.LINK_CHART && (this.membershipModified = !1, this._originalInclusionList = await t.fetchAndConvertSerializedLinkChart({\n          entitiesUrl: r?.entitiesUrl,\n          relationshipsUrl: r?.relationshipsUrl\n        }), this._alignLayersDataModelAndInclusionDefinition(n.dataModel), this.initializationLinkChartConfig = {\n          layoutSettings: r?.layoutSettings ?? void 0,\n          layoutMode: S(r.layoutType)\n        }), this._initializeLayerProperties({\n          knowledgeGraph: n,\n          inclusionModeDefinition: this._originalInclusionList\n        }), this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.size || (this.dataManager.inclusionModeDefinition = {\n          generateAllSublayers: !1,\n          namedTypeDefinitions: new Map()\n        }, this.dataManager.knowledgeGraph.dataModel.entityTypes?.forEach(e => {\n          e.name && this.dataManager.inclusionModeDefinition?.namedTypeDefinitions.set(e.name, {\n            useAllData: !0\n          });\n        }), this.dataManager.knowledgeGraph.dataModel.relationshipTypes?.forEach(e => {\n          e.name && this.dataManager.inclusionModeDefinition?.namedTypeDefinitions.set(e.name, {\n            useAllData: !0\n          });\n        })), this.dataPreloadedInLocalCache) {\n          const e = E.getInstance();\n          for (const [t, a] of this.dataManager.inclusionModeDefinition?.namedTypeDefinitions ?? []) for (const i of a.members?.values() ?? []) {\n            const a = e.readFromStoreById(`${t}__${i.id}`);\n            if (a) {\n              o(this.dataManager.sublayerCaches, t, () => new Map()).set(i.id, a);\n            }\n          }\n          await a();\n        } else {\n          const t = \"geographic-organic-standard\" === this.initializationLinkChartConfig?.layoutMode;\n          this.addResolvingPromise(this.dataManager.refreshCacheContent(void 0, !1, t, !0).then(async () => {\n            s(e), await a();\n          }));\n        }\n        i(null);\n      });\n    })), Promise.resolve(this);\n  }\n  set initializationInclusionModeDefinition(e) {\n    \"loaded\" !== this.loadStatus && \"failed\" !== this.loadStatus ? this._set(\"initializationInclusionModeDefinition\", e) : n.getLogger(this).error(\"#initializationInclusionModeDefinition\", \"initializationInclusionModeDefinition cannot be changed after the layer is loaded.\");\n  }\n  get linkChart() {\n    return this.parent;\n  }\n  async addRecords(e, t) {\n    let a = [];\n    t?.cascadeAddRelationshipEndNodes && this.dataManager.knowledgeGraph.dataModel && (a = await _(e, this.dataManager.knowledgeGraph));\n    const i = e.concat(a).filter(e => !this.sublayerIdsCache.get(e.typeName)?.has(e.id));\n    i.length > 0 && (this.membershipModified = !0), await this._handleNewRecords(i, t);\n  }\n  async removeRecords(e) {\n    let {\n      cascadeRemoveRelationships: t = !0,\n      recalculateLayout: a = !1,\n      overrideMembershipCheck: i = !1\n    } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n      cascadeRemoveRelationships: !0,\n      recalculateLayout: !1,\n      overrideMembershipCheck: !1\n    };\n    let n = [];\n    for (const r of e) (i || !1 === this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.get(r.typeName)?.useAllData && this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.get(r.typeName)?.members?.has(r.id)) && n.push(r);\n    if (t) {\n      const e = new Set(),\n        t = [];\n      for (const a of n) if (this.dataManager.nodeConnectionsLookup.has(a.id)) for (const t of this.dataManager.nodeConnectionsLookup.get(a.id)) e.add(t);\n      for (const a of e) if (this.dataManager.memberIdTypeLookup.has(a)) for (const e of this.dataManager.memberIdTypeLookup.get(a)) this.dataManager.relationshipTypeNames.has(e) && t.push({\n        id: a,\n        typeName: e\n      });\n      n = n.concat(t);\n    }\n    this.dataManager.removeFromLayer(n);\n    for (const r of n) this.sublayerIdsCache.get(r.typeName)?.delete(r.id), this.dataManager.relationshipTypeNames.has(r.typeName) ? this.relationshipLinkChartDiagramLookup.delete(r.id) : this.entityLinkChartDiagramLookup.delete(r.id);\n    a && (await this._calculateLayoutWithSublayerTimeInfo(this._currentLinkChartConfig.layoutMode, {\n      layoutSettings: this._currentLinkChartConfig.layoutSettings\n    })), n.length > 0 && (this.membershipModified = !0);\n    const o = [];\n    return this.layers.forEach(e => {\n      o.push(e.refreshCachedQueryEngine());\n    }), await Promise.all(o), this._refreshNamedTypes(), n;\n  }\n  async expand(e, t) {\n    let a = [];\n    try {\n      const i = await this.dataManager.getConnectedRecordIds(e, t?.relationshipTypeNames, t);\n      a = i.filter(e => !this.sublayerIdsCache.get(e.typeName)?.has(e.id)), await this._handleNewRecords(i, t), i.length > 0 && (this.membershipModified = !0), s(t?.signal);\n    } catch (i) {\n      throw l(i) && a.length > 0 && this.removeRecords(a, {\n        overrideMembershipCheck: !0\n      }), i;\n    }\n    return {\n      records: a\n    };\n  }\n  loadLayerAssumingLocalCache() {\n    const e = [...this.memberRelationshipTypes, ...this.memberEntityTypes];\n    this.originIdOf(\"layers\") === y.DEFAULTS ? this._createSublayers(e, this.layers, e => !!e.geometryType) : this._updateSublayers(e, this.layers), this.originIdOf(\"tables\") === y.DEFAULTS ? this._createSublayers(e, this.tables, e => !e.geometryType) : this._updateSublayers(e, this.tables), this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.forEach((e, t) => {\n      const a = o(this.sublayerIdsCache, t, () => new Set());\n      e.members?.forEach(_ref => {\n        let {\n          id: e,\n          linkChartLocation: i\n        } = _ref;\n        if (a.add(e), i) {\n          const a = \"coords\" in i && \"lengths\" in i ? i : w(i);\n          this.dataManager.relationshipTypeNames.has(t) ? this.relationshipLinkChartDiagramLookup.set(e, a) : this.entityLinkChartDiagramLookup.set(e, a);\n        }\n      });\n    });\n  }\n  async calculateLinkChartLayout() {\n    let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"organic-standard\";\n    let t = arguments.length > 1 ? arguments[1] : undefined;\n    const a = [],\n      r = [],\n      l = [];\n    this.dataManager.sublayerCaches.forEach((e, t) => {\n      this.dataManager.entityTypeNames.has(t) ? e.forEach(e => {\n        a.push({\n          typeName: t,\n          feature: e\n        });\n      }) : this.dataManager.relationshipTypeNames.has(t) && e.forEach(e => {\n        r.push({\n          typeName: t,\n          feature: e\n        });\n      });\n    }), this.entityLinkChartDiagramLookup = new Map(), this.relationshipLinkChartDiagramLookup = new Map();\n    const d = new Map(),\n      p = new Map(),\n      c = new Map(),\n      u = new Map(),\n      y = new Uint8Array(a.length),\n      g = new Float64Array(a.length),\n      b = new Float64Array(a.length),\n      v = new Float64Array(a.length),\n      D = new Float64Array(a.length),\n      x = new Uint32Array(r.length),\n      I = new Uint32Array(r.length),\n      E = new Float64Array(r.length),\n      S = new Float64Array(r.length),\n      _ = [],\n      R = \"organic-standard\",\n      A = new m({\n        xmin: -1e-7,\n        ymin: -1e-7,\n        xmax: 1e-7,\n        ymax: 1e-7\n      });\n    let j,\n      G = \"organic-standard\",\n      V = 0,\n      q = 0;\n    const J = z.apply;\n    switch (G = \"geographic-organic-standard\" === e ? R : e, G) {\n      case \"organic-standard\":\n        j = Q.apply;\n        break;\n      case \"organic-community\":\n        j = B.apply;\n        break;\n      case \"hierarchical-bottom-to-top\":\n        j = U.apply;\n        break;\n      case \"radial-root-centric\":\n        j = F.apply;\n        break;\n      case \"tree-left-to-right\":\n        j = O.apply;\n        break;\n      default:\n        j = P.apply;\n    }\n    let X = !1;\n    a.forEach(_ref2 => {\n      let {\n        typeName: a,\n        feature: i\n      } = _ref2;\n      if (\"chronological-mono-timeline\" !== e && \"chronological-multi-timeline\" !== e && t?.lockedNodeLocations?.has(i.attributes[M])) {\n        \"geographic-organic-standard\" === e && this.dataManager.geographicLookup.has(a) ? y[V] = W.IsGeographic : y[V] = W.None;\n        const n = t.lockedNodeLocations.get(i.attributes[M]);\n        g[V] = n.x, b[V] = n.y;\n      } else if (\"geographic-organic-standard\" === e && this.dataManager.geographicLookup.has(a)) {\n        y[V] = W.IsGeographic;\n        let e = null;\n        const t = i.attributes[this.dataManager.geographicLookup.get(a).name],\n          n = this.dataManager.geographicLookup.get(a)?.geometryType;\n        switch (n) {\n          case \"esriGeometryPoint\":\n            g[V] = t?.x, b[V] = t?.y;\n            break;\n          case \"esriGeometryPolygon\":\n            e = t?.centroid, null != e?.x && null != e?.y ? (g[V] = e.x, b[V] = e.y) : y[V] = W.IsMovable;\n            break;\n          case \"esriGeometryPolyline\":\n          case \"esriGeometryMultipoint\":\n            e = t?.extent?.center, null != e?.x && null != e?.y ? (g[V] = e.x, b[V] = e.y) : y[V] = W.IsMovable;\n            break;\n          default:\n            y[V] = W.IsMovable;\n        }\n        (null == g[V] || null == b[V] || Number.isNaN(g[V]) || Number.isNaN(b[V])) && (y[V] = W.IsMovable, g[V] = 0, b[V] = 0);\n      } else if (\"chronological-mono-timeline\" === e || \"chronological-multi-timeline\" === e) {\n        !X && t?.lockedNodeLocations?.has(i.attributes[M]) && (X = !0);\n        const e = t?.timeInfoByTypeName?.get(a),\n          n = e?.startField,\n          o = n && e?.startField ? i.attributes[n] : null;\n        v[V] = o ? new Date(o).getTime() : NaN;\n        const r = e?.endField,\n          s = r && e?.endField ? i.attributes[r] : null;\n        D[V] = s ? new Date(s).getTime() : NaN, g[V] = 0, b[V] = 0, y[V] = W.IsMovable;\n      } else y[V] = W.IsMovable, g[V] = 0, b[V] = 0;\n      u.set(i.attributes[M], V), _[V] = {\n        feature: i,\n        typeName: a\n      }, V++;\n    }), X && n.getLogger(this).warn(\"Locked node locations are not supported for chronological layout at this time.  Requested node locations were ignored\");\n    let Y = !1;\n    const Z = new Map();\n    r.forEach(a => {\n      const i = a.feature.attributes[k],\n        n = a.feature.attributes[C],\n        o = u.get(i),\n        r = u.get(n),\n        s = t?.timeInfoByTypeName?.get(a.typeName),\n        h = t?.timeInfoByTypeName ? s?.startField : null,\n        d = h ? a.feature.attributes[h] : null,\n        p = s?.endField,\n        c = p ? a.feature.attributes[p] : null;\n      if (void 0 !== o && void 0 !== r) {\n        let t = i + \"-\" + n;\n        \"chronological-mono-timeline\" !== e && \"chronological-multi-timeline\" !== e || (t = t + \"-\" + d + \"-\" + c);\n        const s = Z.get(t),\n          h = s?.has(a.typeName);\n        h || (x[q] = o, I[q] = r, \"chronological-mono-timeline\" !== e && \"chronological-multi-timeline\" !== e || (E[q] = d ? new Date(d).getTime() : NaN, S[q] = c ? new Date(c).getTime() : NaN), void 0 === s ? Z.set(t, new Map([[a.typeName, q]])) : s.set(a.typeName, q), q++), l.push(a);\n      } else Y = !0, this.relationshipLinkChartDiagramLookup.set(i, null);\n    }), Y && n.getLogger(this).warn(\"A relationship is a member of this layer that has either origin or destination entity nodes that are not members. The diagram geometry will be set to null\");\n    const ee = this._validateOrganicLayoutSettings(e, t?.layoutSettings?.organicLayoutSettings),\n      te = this._convertValidatedOrganicSettingsToCalculationSettings(ee);\n    await $();\n    let ae = H.Error,\n      ie = null;\n    if (\"chronological-mono-timeline\" === e || \"chronological-multi-timeline\" === e) {\n      let a;\n      ({\n        status: ae,\n        links: ie,\n        graphics: a\n      } = J(() => t?.signal?.aborted ?? !1, y, g, b, v, D, x.subarray(0, q), I.subarray(0, q), E.subarray(0, q), S.subarray(0, q), \"chronological-multi-timeline\" === e, t?.layoutSettings?.chronologicalLayoutSettings)), ae === H.Success && (this.chronologicalAuxiliaryGraphics = a);\n    } else ({\n      status: ae,\n      links: ie\n    } = j(() => t?.signal?.aborted ?? !1, y, g, b, x.subarray(0, q), I.subarray(0, q), te.computationBudgetTime, te.idealEdgeLengthMultiplier, te.repulsionRadiusMultiplier));\n    if (s(t?.signal), ae === H.Error) throw new i(\"knowledge-graph:layout-failed\", \"Attempting to arrange the records in the specified layout failed\");\n    if (ae === H.Canceled) throw h();\n    for (let i = 0; i < _.length; i++) {\n      if (b[i] > 84.9999 ? b[i] = 84.9999 : b[i] < -84.9999 && (b[i] = -84.9999), g[i] > 179.9999 ? g[i] = 179.9999 : g[i] < -179.9999 && (g[i] = -179.9999), _[i].feature.attributes[T] = new f(g[i], b[i]), d.has(_[i].typeName)) {\n        const e = d.get(_[i].typeName);\n        e?.set(_[i].feature.attributes[M], _[i].feature);\n      } else {\n        const e = new Map();\n        e.set(_[i].feature.attributes[M], _[i].feature), d.set(_[i].typeName, e);\n      }\n      c.set(_[i].feature.attributes[M], _[i].feature);\n      const e = w(_[i].feature.attributes[T]);\n      this.entityLinkChartDiagramLookup.set(_[i].feature.attributes[M], _[i].feature.attributes[T] ? e : null);\n      const t = o(this.dataManager.inclusionModeDefinition.namedTypeDefinitions, _[i].typeName, () => ({\n        useAllData: !1,\n        members: new Map()\n      }));\n      o(t.members, _[i].feature.attributes[M], () => ({\n        id: _[i].feature.attributes[M],\n        linkChartLocation: void 0\n      })).linkChartLocation = _[i].feature.attributes[T], _[i].feature.attributes[T].x < A.xmin && (A.xmin = _[i].feature.attributes[T].x), _[i].feature.attributes[T].x > A.xmax && (A.xmax = _[i].feature.attributes[T].x), _[i].feature.attributes[T].y < A.ymin && (A.ymin = _[i].feature.attributes[T].y), _[i].feature.attributes[T].y > A.ymax && (A.ymax = _[i].feature.attributes[T].y);\n    }\n    if (this.linkChartExtent.xmin = A.xmin, this.linkChartExtent.xmax = A.xmax, this.linkChartExtent.ymin = A.ymin, this.linkChartExtent.ymax = A.ymax, !ie) throw new i(\"knowledge-graph:layout-failed\", \"Attempting to retrieve link geometry from diagram engine failed\");\n    const ne = new Map(),\n      oe = new Map(),\n      re = new Map(),\n      se = new Set();\n    for (let i = 0; i < l.length; i++) {\n      const a = [],\n        r = l[i],\n        s = r.feature.attributes[k],\n        h = r.feature.attributes[C];\n      let d = s + \"-\" + h;\n      if (\"chronological-mono-timeline\" === e || \"chronological-multi-timeline\" === e) {\n        const e = t?.timeInfoByTypeName?.get(r.typeName),\n          a = t?.timeInfoByTypeName ? e?.startField : null,\n          i = a ? r.feature.attributes[a] : null,\n          n = e?.endField;\n        d += \"-\" + i + \"-\" + (n ? r.feature.attributes[n] : null);\n      }\n      const y = Z.get(d).get(r.typeName),\n        g = 0 === y ? 0 : ie?.vertexEndIndex[y - 1];\n      if (!se.has(y)) {\n        if (se.add(y), ie.types[y] === K.Recursive) {\n          const e = [ie.vertices[2 * g], ie.vertices[2 * g + 1]],\n            t = [ie.vertices[2 * (g + 1)], ie.vertices[2 * (g + 1) + 1]],\n            i = [.5 * (e[0] + t[0]), .5 * (e[1] + t[1])],\n            n = [i[0] - e[0], i[1] - e[1]],\n            o = [i[0] + n[1], i[1] - n[0]],\n            r = [i[0] - n[1], i[1] + n[0]];\n          a.push(e), a.push(o), a.push(t), a.push(r), a.push(e);\n        } else {\n          if (ie.types[y] !== K.Regular) {\n            n.getLogger(this).warn(\"A relationship generated an unsupported link geometry type.  It will not be rendered\");\n            continue;\n          }\n          for (let e = g; e < ie.vertexEndIndex[y]; e++) a.push([ie.vertices[2 * e], ie.vertices[2 * e + 1]]);\n        }\n        if (\"chronological-mono-timeline\" !== e && \"chronological-multi-timeline\" !== e) {\n          const e = _[u.get(s)]?.feature.attributes[T],\n            t = _[u.get(h)]?.feature.attributes[T];\n          a[0][0] === e.x && a[0][1] === e.y || (a[0] = [e.x, e.y]), a[a.length - 1][0] === t.x && a[a.length - 1][1] === t.y || (a[a.length - 1] = [t.x, t.y]);\n        }\n        for (let e = 1; e < a.length - 1; e++) a[e][1] > 85.5 ? a[e][1] = 85.5 : a[e][1] < -85.5 && (a[e][1] = -85.5), a[e][0] > 179.9999 ? a[e][0] = 179.9999 : a[e][0] < -179.9999 && (a[e][0] = -179.9999);\n        ne.has(d) ? ne.get(d).push(a) : ne.set(d, [a]);\n      }\n      const m = ne.get(d);\n      oe.has(d) || (oe.set(d, new Map()), re.set(d, new Map()));\n      const f = oe.get(d),\n        b = re.get(d);\n      f.has(r.typeName) || (f.set(r.typeName, m.shift()), b.set(r.typeName, 0));\n      const N = f.get(r.typeName);\n      b.set(r.typeName, b.get(r.typeName) + 1);\n      const v = new L({\n        paths: [N]\n      });\n      if (r.feature.attributes[T] = v, p.has(r.typeName)) {\n        const e = p.get(r.typeName);\n        e?.set(r.feature.attributes[M], r.feature);\n      } else {\n        const e = new Map();\n        e.set(r.feature.attributes[M], r.feature), p.set(r.typeName, e);\n      }\n      c.set(r.feature.attributes[M], r.feature);\n      const D = w(r.feature.attributes[T]);\n      this.relationshipLinkChartDiagramLookup.set(r.feature.attributes[M], r.feature.attributes[T] ? D : null);\n      const x = o(this.dataManager.inclusionModeDefinition.namedTypeDefinitions, r.typeName, () => ({\n        useAllData: !1,\n        members: new Map()\n      }));\n      o(x.members, r.feature.attributes[M], () => ({\n        id: r.feature.attributes[M],\n        linkChartLocation: void 0\n      })).linkChartLocation = D;\n    }\n    for (const i of l) i.feature.attributes[N] = re.get(i.feature.attributes[k] + \"-\" + i.feature.attributes[C])?.get(i.typeName) ?? null;\n    return this._currentLinkChartConfig = {\n      layoutMode: e,\n      layoutSettings: t?.layoutSettings?.clone()\n    }, {\n      nodes: d,\n      links: p,\n      idMap: c\n    };\n  }\n  async applyNewLinkChartLayout() {\n    let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"organic-standard\";\n    let t = arguments.length > 1 ? arguments[1] : undefined;\n    const a = [];\n    await this._calculateLayoutWithSublayerTimeInfo(e, t), this.layers.forEach(e => {\n      a.push(e.refreshCachedQueryEngine());\n    }), this.membershipModified = !0, await Promise.all(a), this._refreshNamedTypes();\n  }\n  getCurrentNodeLocations() {\n    const e = new Map();\n    for (const [t, a] of this.dataManager.inclusionModeDefinition?.namedTypeDefinitions.entries() ?? []) this.dataManager.relationshipTypeNames.has(t) || a?.members?.forEach(t => {\n      const a = t.linkChartLocation;\n      let i;\n      const n = t.id;\n      a && (i = \"x\" in a ? {\n        x: a.x,\n        y: a.y\n      } : {\n        x: a.coords[0],\n        y: a.coords[1]\n      }, e.set(n, new f({\n        x: i.x,\n        y: i.y\n      })));\n    });\n    return e;\n  }\n  async refreshLinkChartCache(e) {\n    await this.dataManager.refreshCacheContent(e);\n    const t = [];\n    this.layers.forEach(e => {\n      t.push(e.refreshCachedQueryEngine());\n    }), await Promise.all(t), this._refreshNamedTypes();\n  }\n  async connectBetweenEntities(e, t) {\n    if (!e.length) return {\n      records: []\n    };\n    let a = [];\n    try {\n      let i = [];\n      for (const e of this.dataManager.relationshipTypeNames) {\n        const t = this.sublayerIdsCache.get(e);\n        t && (i = i.concat(Array.from(t.keys())));\n      }\n      a = await this.dataManager.getRelationshipsBetweenNodes(e, i, t), await this._handleNewRecords(a, t), s(t);\n    } catch (i) {\n      throw l(i) && this.removeRecords(a), i;\n    }\n    return {\n      records: a\n    };\n  }\n  async connectFromEntities(e, t) {\n    if (!e.length) return {\n      records: []\n    };\n    let a = [];\n    try {\n      let i = [];\n      for (const e of this.dataManager.relationshipTypeNames) {\n        const t = this.sublayerIdsCache.get(e);\n        t && (i = i.concat(Array.from(t.keys())));\n      }\n      let n = [];\n      for (const e of this.dataManager.entityTypeNames) {\n        const t = this.sublayerIdsCache.get(e);\n        t && (n = n.concat(Array.from(t)));\n      }\n      a = await this.dataManager.getRelationshipsFromNodes(e, n, i, t), await this._handleNewRecords(a, t), a.length > 0 && (this.membershipModified = !0), s(t);\n    } catch (i) {\n      throw l(i) && this.removeRecords(a), i;\n    }\n    return {\n      records: a\n    };\n  }\n  getCurrentLayout() {\n    return this._currentLinkChartConfig.layoutMode;\n  }\n  async _calculateLayoutWithSublayerTimeInfo() {\n    let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"organic-standard\";\n    let t = arguments.length > 1 ? arguments[1] : undefined;\n    const a = new Map();\n    this.layers.forEach(e => {\n      a.set(e.objectType.name, e.timeInfo);\n    }), await this.calculateLinkChartLayout(e, {\n      timeInfoByTypeName: a,\n      ...t\n    }), this.linkChart?.handleChronologicalOverlay();\n  }\n  async _handleNewRecords(e, t) {\n    const a = [];\n    this.dataManager.addToLayer(e);\n    for (const n of e) this.sublayerIdsCache.has(n.typeName) || (this.sublayerIdsCache.set(n.typeName, new Set()), a.push(n.typeName)), this.sublayerIdsCache.get(n.typeName).add(n.id);\n    for (const n of a) {\n      const e = this._graphTypeLookup.get(n);\n      if (e) {\n        const t = this._createSublayer(e);\n        \"entity\" === e.type ? this.dataManager.entityTypeNames.add(n) : this.dataManager.relationshipTypeNames.add(n), t.geometryType ? this.layers.push(t) : this.tables.push(t), this.dataManager.sublayerCaches.set(n, new Map());\n      }\n    }\n    await I(this, a, t), await this.dataManager.refreshCacheContent(e.map(e => e.id), void 0, void 0, void 0, t);\n    const i = {\n      layoutSettings: this._currentLinkChartConfig.layoutSettings,\n      lockedNodeLocations: new Map()\n    };\n    for (const [n, o] of this.entityLinkChartDiagramLookup.entries()) o && i.lockedNodeLocations.set(n, new f(o.coords[0], o.coords[1]));\n    await this.applyNewLinkChartLayout(this._currentLinkChartConfig.layoutMode, i);\n  }\n  _createSublayers(e, t, a) {\n    e.forEach(e => {\n      const i = this._createSublayer(e);\n      a(i) && t.push(i), this._updateSublayerCaches(e);\n    });\n  }\n  _updateSublayers(e, t) {\n    t.forEach(t => {\n      t.parentCompositeLayer = this;\n      const a = e.find(e => e.type === t.graphType && e.name === t.graphTypeName);\n      a && (t.objectType = a, t.read({\n        title: a.name\n      }, {\n        origin: \"service\"\n      }), this._updateSublayerCaches(a));\n    });\n  }\n  _updateSublayerCaches(e) {\n    const t = this.dataManager.sublayerCaches;\n    t.has(e.name) || t.set(e.name, new Map());\n  }\n  _layersLoadedFromAuthoritativeItem() {\n    const e = this.originIdOf(\"layers\");\n    return e >= y.PORTAL_ITEM && e < y.USER;\n  }\n  async _initializeDiagram() {\n    this.initializationLinkChartConfig ? this.initializationLinkChartConfig.doNotRecalculateLayout ? (this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.forEach((e, t) => {\n      e?.members?.forEach(e => {\n        const a = e.linkChartLocation;\n        let i;\n        const n = e.id;\n        if (!a) return;\n        i = \"x\" in a ? {\n          x: a.x,\n          y: a.y\n        } : {\n          x: a.coords[0],\n          y: a.coords[1]\n        };\n        const o = w(i);\n        this.dataManager.relationshipTypeNames.has(t) ? this.relationshipLinkChartDiagramLookup.set(n, o) : this.entityLinkChartDiagramLookup.set(n, o), this.linkChartExtent.xmin > i.x && (this.linkChartExtent.xmin = i.x), this.linkChartExtent.xmax < i.x && (this.linkChartExtent.xmax = i.x), this.linkChartExtent.ymin > i.y && (this.linkChartExtent.ymin = i.y), this.linkChartExtent.ymax < i.y && (this.linkChartExtent.ymax = i.y);\n      });\n    }), this.memberRelationshipTypes.forEach(e => {\n      e.name && this.dataManager.sublayerCaches.get(e.name)?.forEach(e => {\n        const t = this.relationshipLinkChartDiagramLookup.get(e.attributes[k]),\n          a = this.relationshipLinkChartDiagramLookup.get(e.attributes[C]);\n        if (t && a) {\n          const i = w(new L({\n            paths: [[[t.coords[0], t.coords[1]], [a.coords[0], a.coords[1]]]]\n          }));\n          this.relationshipLinkChartDiagramLookup.set(e.attributes[M], i);\n        } else this.relationshipLinkChartDiagramLookup.set(e.attributes[M], null);\n      });\n    })) : await this._calculateLayoutWithSublayerTimeInfo(this.initializationLinkChartConfig.layoutMode, {\n      lockedNodeLocations: this.getCurrentNodeLocations(),\n      ...(this.initializationLinkChartConfig || {})\n    }) : await this._calculateLayoutWithSublayerTimeInfo(\"organic-standard\", {\n      lockedNodeLocations: this.getCurrentNodeLocations()\n    });\n  }\n  _refreshNamedTypes() {\n    for (const e of this.layers) e.emit(\"refresh\", {\n      dataChanged: !0\n    });\n    for (const e of this.tables) e.emit(\"refresh\", {\n      dataChanged: !0\n    });\n  }\n  _validateOrganicLayoutSettings(e, t) {\n    const a = e => \"number\" == typeof e && !isNaN(e),\n      i = e => a(e) && e >= 1,\n      o = e => a(e) && e >= 1,\n      r = e => Object.values(v).includes(e),\n      s = e => a(e) && e >= 0,\n      l = {};\n    if (!new Set([\"organic-standard\", \"organic-community\", \"geographic-organic-standard\", \"chronological-multi-timeline\", \"chronological-mono-timeline\"]).has(e) || !t) return l;\n    const {\n      computationBudgetTime: h,\n      autoRepulsionRadius: d,\n      repulsionRadiusMultiplier: p,\n      absoluteIdealEdgeLength: c,\n      multiplicativeIdealEdgeLength: u,\n      idealEdgeLengthType: y\n    } = t;\n    return o(h) ? l.computationBudgetTime = h : h && n.getLogger(this).warn(\"Invalid layout computationBudgetTime setting, will revert to default setting\"), l.autoRepulsionRadius = d, !d && i(p) ? l.repulsionRadiusMultiplier = p : d || (l.autoRepulsionRadius = !0, n.getLogger(this).warn(\"Invalid layout repulsionRadiusMultiplier setting, will revert to default setting\")), \"geographic-organic-standard\" === e && (r(y) ? l.idealEdgeLengthType = y : void 0 !== y && n.getLogger(this).warn('Invalid layout idealEdgeLengthType setting, will revert to \"multiplier\" setting'), \"absolute-value\" === y && s(c) ? l.absoluteIdealEdgeLength = c : \"absolute-value\" === y && void 0 !== c ? n.getLogger(this).warn(\"Invalid layout idealEdgeLength setting, will revert to default setting\") : \"multiplier\" === y && s(u) ? l.multiplicativeIdealEdgeLength = u : \"multiplier\" === y && void 0 !== u && n.getLogger(this).warn(\"Invalid layout idealEdgeLength setting, will revert to default setting\")), l;\n  }\n  _convertValidatedOrganicSettingsToCalculationSettings(e) {\n    let t = e.idealEdgeLengthType === v.ABSOLUTE ? e.absoluteIdealEdgeLength : e.multiplicativeIdealEdgeLength;\n    return e.idealEdgeLengthType === v.ABSOLUTE && (void 0 === t ? t = -1 : t *= -1), {\n      computationBudgetTime: e.computationBudgetTime ?? void 0,\n      repulsionRadiusMultiplier: e.repulsionRadiusMultiplier && !e.autoRepulsionRadius ? e.repulsionRadiusMultiplier : void 0,\n      idealEdgeLengthMultiplier: t\n    };\n  }\n  _createSublayer(e) {\n    return new x({\n      objectType: e,\n      parentCompositeLayer: this,\n      graphType: e.type\n    });\n  }\n  _handleSublayersChange(e, t) {\n    t && (t.forEach(e => {\n      e.parent = null;\n    }), this.removeHandles(\"sublayers-owner\")), e && (e.forEach(e => {\n      e.parent = this;\n    }), this.addHandles([e.on(\"after-add\", _ref3 => {\n      let {\n        item: e\n      } = _ref3;\n      e.parent = this;\n    }), e.on(\"after-remove\", _ref4 => {\n      let {\n        item: e\n      } = _ref4;\n      e.parent = null;\n    })], \"sublayers-owner\"));\n  }\n  _alignLayersDataModelAndInclusionDefinition(e) {\n    const t = new Set((e.entityTypes ?? []).map(e => e.name).concat((e.relationshipTypes ?? []).map(e => e.name))),\n      i = new Set((e.entityTypes ?? []).map(e => e.name)),\n      o = new Set((e.relationshipTypes ?? []).map(e => e.name));\n    if (this.layers) {\n      for (const a of this.layers) !a.graphType && t.has(a.graphTypeName) && (a.graphType = i.has(a.graphTypeName) ? \"entity\" : \"relationship\");\n      const e = this.layers.filter(e => t.has(e.graphTypeName) && (\"entity\" === e.graphType ? i.has(e.graphTypeName) : o.has(e.graphTypeName)));\n      this.setAtOrigin(\"layers\", e, g(this.originIdOf(\"layers\")));\n    } else this.layers = new a();\n    if (this.layers && this._originalInclusionList) {\n      const e = new Set(this._originalInclusionList.namedTypeDefinitions.keys()),\n        t = this.tables?.map(e => e.graphTypeName) ?? [],\n        a = this.layers.map(e => e.graphTypeName).concat(t);\n      for (const n of a) e.has(n) || this._originalInclusionList.namedTypeDefinitions.set(n, {\n        useAllData: !1,\n        members: new Map()\n      });\n      const i = [];\n      for (const o of this._originalInclusionList.namedTypeDefinitions.keys()) a.includes(o) || (n.getLogger(this).warn(`A named type, ${o}, was in the serialized feature collection but did not have a sublayer config in the item, so will be removed`), i.push(o));\n      for (const n of i) this._originalInclusionList.namedTypeDefinitions.delete(n);\n    }\n  }\n};\ne([c(G)], q.prototype, \"url\", void 0), e([c()], q.prototype, \"dataPreloadedInLocalCache\", void 0), e([c()], q.prototype, \"initializationLinkChartConfig\", void 0), e([c()], q.prototype, \"membershipModified\", void 0), e([c()], q.prototype, \"dataManager\", void 0), e([c()], q.prototype, \"initializationInclusionModeDefinition\", null), e([c()], q.prototype, \"knowledgeGraph\", void 0), e([c({\n  type: a.ofType(x),\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], q.prototype, \"layers\", void 0), e([c({\n  readOnly: !0\n})], q.prototype, \"linkChart\", null), e([c()], q.prototype, \"entityLinkChartDiagramLookup\", void 0), e([c()], q.prototype, \"relationshipLinkChartDiagramLookup\", void 0), e([c()], q.prototype, \"linkChartExtent\", void 0), e([c()], q.prototype, \"memberEntityTypes\", void 0), e([c()], q.prototype, \"memberRelationshipTypes\", void 0), e([c({\n  type: [\"LinkChartLayer\"]\n})], q.prototype, \"operationalLayerType\", void 0), e([c()], q.prototype, \"sublayerIdsCache\", void 0), e([c({\n  type: a.ofType(x),\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], q.prototype, \"tables\", void 0), e([c({\n  json: {\n    read: !1\n  }\n})], q.prototype, \"type\", void 0), e([c({\n  json: {\n    read: !1\n  }\n})], q.prototype, \"chronologicalAuxiliaryGraphics\", void 0), q = e([u(\"esri.layers.LinkChartLayer\")], q);\nconst J = q;\nexport { J as default };","map":{"version":3,"names":["_","e","serializationUtilsModuleWrapper","t","a","i","n","getOrCreateMapValue","o","MultiOriginJSONMixin","r","throwIfAborted","s","isAbortError","l","createAbortError","h","watch","d","sync","p","property","c","subclass","u","OriginId","y","idToName","g","m","f","L","b","convertFromGeometry","w","systemOidFieldName","M","systemOriginIdFieldName","k","systemDestinationIdFieldName","C","systemLayoutGeometryFieldName","T","systemAggregationCountFieldName","N","IdealEdgeLengthTypeOptions","v","KnowledgeGraphLayerDataManager","D","x","initializeLayersFromClientData","I","E","convertLayoutTypeToWebSupportedFormat","S","getRelationshipEndNodeIds","BlendLayer","R","OperationalLayer","A","ScaleRangeLayer","j","url","G","LCChronologicalLayout","z","LCSimpleLayout","P","LCSmartTreeLayout","O","LCRadialTreeLayout","F","LCHierarchicalLayout","U","LCCommunityLayout","B","LCForceDirectedLayout","Q","NodeFlag","W","load","$","CallStatus","H","LinkType","K","fetchKnowledgeGraph","V","q","constructor","dataPreloadedInLocalCache","initializationLinkChartConfig","membershipModified","_currentLinkChartConfig","layoutMode","_graphTypeLookup","Map","dataManager","knowledgeGraph","layers","ofType","entityLinkChartDiagramLookup","relationshipLinkChartDiagramLookup","linkChartExtent","xmin","ymin","xmax","ymax","memberEntityTypes","memberRelationshipTypes","operationalLayerType","sublayerIdsCache","tables","type","chronologicalAuxiliaryGraphics","_originalInclusionList","initializationInclusionModeDefinition","addHandles","concat","_handleSublayersChange","normalizeCtorArgs","title","_initializeLayerProperties","split","length","Set","inclusionModeDefinition","namedTypeDefinitions","size","generateAllSublayers","dataModel","entityTypes","relationshipTypes","forEach","get","getLogger","warn","delete","has","add","push","loadLayerAssumingLocalCache","_layersLoadedFromAuthoritativeItem","useAllData","_initializeDiagram","refreshCachedQueryEngine","Promise","on","all","addResolvingPromise","then","name","set","linkChart","linkChartProperties","originIdOf","LINK_CHART","fetchAndConvertSerializedLinkChart","entitiesUrl","relationshipsUrl","_alignLayersDataModelAndInclusionDefinition","layoutSettings","layoutType","getInstance","members","values","readFromStoreById","id","sublayerCaches","refreshCacheContent","resolve","loadStatus","_set","error","parent","addRecords","cascadeAddRelationshipEndNodes","filter","typeName","_handleNewRecords","removeRecords","cascadeRemoveRelationships","recalculateLayout","overrideMembershipCheck","arguments","undefined","nodeConnectionsLookup","memberIdTypeLookup","relationshipTypeNames","removeFromLayer","_calculateLayoutWithSublayerTimeInfo","_refreshNamedTypes","expand","getConnectedRecordIds","signal","records","DEFAULTS","_createSublayers","geometryType","_updateSublayers","_ref","linkChartLocation","calculateLinkChartLayout","entityTypeNames","feature","Uint8Array","Float64Array","Uint32Array","J","apply","X","_ref2","lockedNodeLocations","attributes","geographicLookup","IsGeographic","None","centroid","IsMovable","extent","center","Number","isNaN","timeInfoByTypeName","startField","Date","getTime","NaN","endField","Y","Z","ee","_validateOrganicLayoutSettings","organicLayoutSettings","te","_convertValidatedOrganicSettingsToCalculationSettings","ae","Error","ie","status","links","graphics","aborted","subarray","chronologicalLayoutSettings","Success","computationBudgetTime","idealEdgeLengthMultiplier","repulsionRadiusMultiplier","Canceled","ne","oe","re","se","vertexEndIndex","types","Recursive","vertices","Regular","shift","paths","clone","nodes","idMap","applyNewLinkChartLayout","getCurrentNodeLocations","entries","coords","refreshLinkChartCache","connectBetweenEntities","Array","from","keys","getRelationshipsBetweenNodes","connectFromEntities","getRelationshipsFromNodes","getCurrentLayout","objectType","timeInfo","handleChronologicalOverlay","addToLayer","_createSublayer","map","_updateSublayerCaches","parentCompositeLayer","find","graphType","graphTypeName","read","origin","PORTAL_ITEM","USER","doNotRecalculateLayout","emit","dataChanged","Object","includes","autoRepulsionRadius","absoluteIdealEdgeLength","multiplicativeIdealEdgeLength","idealEdgeLengthType","ABSOLUTE","removeHandles","_ref3","item","_ref4","setAtOrigin","prototype","json","write","ignoreOrigin","readOnly","default"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/layers/LinkChartLayer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import{serializationUtilsModuleWrapper as t}from\"../applications/KnowledgeStudio/resourceSerializationUtils.js\";import a from\"../core/Collection.js\";import i from\"../core/Error.js\";import n from\"../core/Logger.js\";import{getOrCreateMapValue as o}from\"../core/MapUtils.js\";import{MultiOriginJSONMixin as r}from\"../core/MultiOriginJSONSupport.js\";import{throwIfAborted as s,isAbortError as l,createAbortError as h}from\"../core/promiseUtils.js\";import{watch as d,sync as p}from\"../core/reactiveUtils.js\";import{property as c}from\"../core/accessorSupport/decorators/property.js\";import\"../core/has.js\";import\"../core/RandomLCG.js\";import{subclass as u}from\"../core/accessorSupport/decorators/subclass.js\";import{OriginId as y,idToName as g}from\"../core/accessorSupport/PropertyOrigin.js\";import m from\"../geometry/Extent.js\";import f from\"../geometry/Point.js\";import L from\"../geometry/Polyline.js\";import b from\"./Layer.js\";import{convertFromGeometry as w}from\"./graphics/featureConversionUtils.js\";import{systemOidFieldName as M,systemOriginIdFieldName as k,systemDestinationIdFieldName as C,systemLayoutGeometryFieldName as T,systemAggregationCountFieldName as N}from\"./knowledgeGraph/constants.js\";import{IdealEdgeLengthTypeOptions as v}from\"./knowledgeGraph/IdealEdgeLengthTypeOptions.js\";import{KnowledgeGraphLayerDataManager as D}from\"./knowledgeGraph/KnowledgeGraphLayerDataManager.js\";import x from\"./knowledgeGraph/KnowledgeGraphSublayer.js\";import{initializeLayersFromClientData as I}from\"./knowledgeGraph/layerUtils.js\";import E from\"./knowledgeGraph/SessionMemoryStorage.js\";import{convertLayoutTypeToWebSupportedFormat as S,getRelationshipEndNodeIds as _}from\"./knowledgeGraph/supportUtils.js\";import{BlendLayer as R}from\"./mixins/BlendLayer.js\";import{OperationalLayer as A}from\"./mixins/OperationalLayer.js\";import{ScaleRangeLayer as j}from\"./mixins/ScaleRangeLayer.js\";import{url as G}from\"./support/commonProperties.js\";import{LCChronologicalLayout as z,LCSimpleLayout as P,LCSmartTreeLayout as O,LCRadialTreeLayout as F,LCHierarchicalLayout as U,LCCommunityLayout as B,LCForceDirectedLayout as Q,NodeFlag as W,load as $,CallStatus as H,LinkType as K}from\"../libs/linkchartlayout/LinkChartLayout.js\";import{fetchKnowledgeGraph as V}from\"../rest/knowledgeGraphService.js\";let q=class extends(A(R(j(r(b))))){constructor(e){if(super(e),this.url=null,this.dataPreloadedInLocalCache=!1,this.initializationLinkChartConfig=null,this.membershipModified=!0,this._currentLinkChartConfig={layoutMode:\"organic-standard\"},this._graphTypeLookup=new Map,this.dataManager=null,this.knowledgeGraph=null,this.layers=new(a.ofType(x)),this.entityLinkChartDiagramLookup=new Map,this.relationshipLinkChartDiagramLookup=new Map,this.linkChartExtent=new m({xmin:-1e-7,ymin:-1e-7,xmax:1e-7,ymax:1e-7}),this.memberEntityTypes=null,this.memberRelationshipTypes=null,this.operationalLayerType=\"LinkChartLayer\",this.sublayerIdsCache=new Map,this.tables=new(a.ofType(x)),this.type=\"link-chart\",this.chronologicalAuxiliaryGraphics=null,this._originalInclusionList=e?.initializationInclusionModeDefinition,e?.dataPreloadedInLocalCache&&!e?.initializationInclusionModeDefinition)throw new i(\"knowledge-graph:linkchart-layer-constructor\",\"If creating a link chart composite layer and configured that data is already loaded in the cache, you must specify an inclusion list so the Composite Layer knows what records belong to it\");this.addHandles(d((()=>this.layers.concat(this.tables)),((e,t)=>this._handleSublayersChange(e,t)),p))}normalizeCtorArgs(e){if(!e)return{};const{url:t,title:a,dataPreloadedInLocalCache:i,initializationLinkChartConfig:n}=e;return{url:t,title:a,dataPreloadedInLocalCache:i,initializationLinkChartConfig:n}}_initializeLayerProperties(e){if(!this.title&&this.url){const e=this.url.split(\"/\");this.title=e[e.length-2]}const t=new Set;let a=[],o=[];if(e.inclusionModeDefinition&&(!e.inclusionModeDefinition.namedTypeDefinitions||e.inclusionModeDefinition.namedTypeDefinitions.size<1))throw new i(\"knowledge-graph:composite-layer-constructor\",\"If an explicit inclusion definition is defined, at least one namedTypeDefinition must also be defined\");e.inclusionModeDefinition?.generateAllSublayers?(a=e.knowledgeGraph.dataModel.entityTypes??[],o=e.knowledgeGraph.dataModel.relationshipTypes??[]):e.inclusionModeDefinition?.namedTypeDefinitions&&e.inclusionModeDefinition?.namedTypeDefinitions.size>0?e.inclusionModeDefinition?.namedTypeDefinitions.forEach(((i,r)=>{const s=this._graphTypeLookup.get(r);if(!s)return n.getLogger(this).warn(`A named type, ${r}, was in the inclusion list that wasn't in the data model and will be removed`),void e.inclusionModeDefinition?.namedTypeDefinitions.delete(r);\"relationship\"===s.type?t.has(r)||(t.add(r),o.push(s)):\"entity\"===s.type?t.has(r)||(t.add(r),a.push(s)):(n.getLogger(this).warn(`A named type, ${r}, was in the inclusion list that wasn't properly modeled and will be removed`),e.inclusionModeDefinition?.namedTypeDefinitions.delete(r))})):(a=e.knowledgeGraph.dataModel.entityTypes??[],o=e.knowledgeGraph.dataModel.relationshipTypes??[]);const r=new D({knowledgeGraph:e.knowledgeGraph,inclusionModeDefinition:e.inclusionModeDefinition});this.knowledgeGraph=e.knowledgeGraph,this.memberEntityTypes=a,this.memberRelationshipTypes=o,this.dataManager=r}load(e){const a=async()=>{const e=[],t=[];this.loadLayerAssumingLocalCache(),this._layersLoadedFromAuthoritativeItem()||await I(this),this.dataManager.inclusionModeDefinition&&(this.dataManager.inclusionModeDefinition.generateAllSublayers=!1),this.dataManager.inclusionModeDefinition?.namedTypeDefinitions.forEach((e=>{e.useAllData=!1})),await this._initializeDiagram(),this.layers.forEach((a=>{t.push(a.refreshCachedQueryEngine()),e.push(new Promise((e=>{a.on(\"layerview-create\",(()=>{e(null)}))})))})),this.tables.forEach((e=>{t.push(e.refreshCachedQueryEngine())})),await Promise.all(t)};return this.addResolvingPromise(new Promise((i=>{V(this.url).then((async n=>{n.dataModel.entityTypes?.forEach((e=>{e.name&&this._graphTypeLookup.set(e.name,e)})),n.dataModel.relationshipTypes?.forEach((e=>{e.name&&this._graphTypeLookup.set(e.name,e)}));const r=this.linkChart?.linkChartProperties;if(r?.originIdOf(\"entitiesUrl\")===y.LINK_CHART&&(this.membershipModified=!1,this._originalInclusionList=await t.fetchAndConvertSerializedLinkChart({entitiesUrl:r?.entitiesUrl,relationshipsUrl:r?.relationshipsUrl}),this._alignLayersDataModelAndInclusionDefinition(n.dataModel),this.initializationLinkChartConfig={layoutSettings:r?.layoutSettings??void 0,layoutMode:S(r.layoutType)}),this._initializeLayerProperties({knowledgeGraph:n,inclusionModeDefinition:this._originalInclusionList}),this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.size||(this.dataManager.inclusionModeDefinition={generateAllSublayers:!1,namedTypeDefinitions:new Map},this.dataManager.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&this.dataManager.inclusionModeDefinition?.namedTypeDefinitions.set(e.name,{useAllData:!0})})),this.dataManager.knowledgeGraph.dataModel.relationshipTypes?.forEach((e=>{e.name&&this.dataManager.inclusionModeDefinition?.namedTypeDefinitions.set(e.name,{useAllData:!0})}))),this.dataPreloadedInLocalCache){const e=E.getInstance();for(const[t,a]of this.dataManager.inclusionModeDefinition?.namedTypeDefinitions??[])for(const i of a.members?.values()??[]){const a=e.readFromStoreById(`${t}__${i.id}`);if(a){o(this.dataManager.sublayerCaches,t,(()=>new Map)).set(i.id,a)}}await a()}else{const t=\"geographic-organic-standard\"===this.initializationLinkChartConfig?.layoutMode;this.addResolvingPromise(this.dataManager.refreshCacheContent(void 0,!1,t,!0).then((async()=>{s(e),await a()})))}i(null)}))}))),Promise.resolve(this)}set initializationInclusionModeDefinition(e){\"loaded\"!==this.loadStatus&&\"failed\"!==this.loadStatus?this._set(\"initializationInclusionModeDefinition\",e):n.getLogger(this).error(\"#initializationInclusionModeDefinition\",\"initializationInclusionModeDefinition cannot be changed after the layer is loaded.\")}get linkChart(){return this.parent}async addRecords(e,t){let a=[];t?.cascadeAddRelationshipEndNodes&&this.dataManager.knowledgeGraph.dataModel&&(a=await _(e,this.dataManager.knowledgeGraph));const i=e.concat(a).filter((e=>!this.sublayerIdsCache.get(e.typeName)?.has(e.id)));i.length>0&&(this.membershipModified=!0),await this._handleNewRecords(i,t)}async removeRecords(e,{cascadeRemoveRelationships:t=!0,recalculateLayout:a=!1,overrideMembershipCheck:i=!1}={cascadeRemoveRelationships:!0,recalculateLayout:!1,overrideMembershipCheck:!1}){let n=[];for(const r of e)(i||!1===this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.get(r.typeName)?.useAllData&&this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.get(r.typeName)?.members?.has(r.id))&&n.push(r);if(t){const e=new Set,t=[];for(const a of n)if(this.dataManager.nodeConnectionsLookup.has(a.id))for(const t of this.dataManager.nodeConnectionsLookup.get(a.id))e.add(t);for(const a of e)if(this.dataManager.memberIdTypeLookup.has(a))for(const e of this.dataManager.memberIdTypeLookup.get(a))this.dataManager.relationshipTypeNames.has(e)&&t.push({id:a,typeName:e});n=n.concat(t)}this.dataManager.removeFromLayer(n);for(const r of n)this.sublayerIdsCache.get(r.typeName)?.delete(r.id),this.dataManager.relationshipTypeNames.has(r.typeName)?this.relationshipLinkChartDiagramLookup.delete(r.id):this.entityLinkChartDiagramLookup.delete(r.id);a&&await this._calculateLayoutWithSublayerTimeInfo(this._currentLinkChartConfig.layoutMode,{layoutSettings:this._currentLinkChartConfig.layoutSettings}),n.length>0&&(this.membershipModified=!0);const o=[];return this.layers.forEach((e=>{o.push(e.refreshCachedQueryEngine())})),await Promise.all(o),this._refreshNamedTypes(),n}async expand(e,t){let a=[];try{const i=await this.dataManager.getConnectedRecordIds(e,t?.relationshipTypeNames,t);a=i.filter((e=>!this.sublayerIdsCache.get(e.typeName)?.has(e.id))),await this._handleNewRecords(i,t),i.length>0&&(this.membershipModified=!0),s(t?.signal)}catch(i){throw l(i)&&a.length>0&&this.removeRecords(a,{overrideMembershipCheck:!0}),i}return{records:a}}loadLayerAssumingLocalCache(){const e=[...this.memberRelationshipTypes,...this.memberEntityTypes];this.originIdOf(\"layers\")===y.DEFAULTS?this._createSublayers(e,this.layers,(e=>!!e.geometryType)):this._updateSublayers(e,this.layers),this.originIdOf(\"tables\")===y.DEFAULTS?this._createSublayers(e,this.tables,(e=>!e.geometryType)):this._updateSublayers(e,this.tables),this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.forEach(((e,t)=>{const a=o(this.sublayerIdsCache,t,(()=>new Set));e.members?.forEach((({id:e,linkChartLocation:i})=>{if(a.add(e),i){const a=\"coords\"in i&&\"lengths\"in i?i:w(i);this.dataManager.relationshipTypeNames.has(t)?this.relationshipLinkChartDiagramLookup.set(e,a):this.entityLinkChartDiagramLookup.set(e,a)}}))}))}async calculateLinkChartLayout(e=\"organic-standard\",t){const a=[],r=[],l=[];this.dataManager.sublayerCaches.forEach(((e,t)=>{this.dataManager.entityTypeNames.has(t)?e.forEach((e=>{a.push({typeName:t,feature:e})})):this.dataManager.relationshipTypeNames.has(t)&&e.forEach((e=>{r.push({typeName:t,feature:e})}))})),this.entityLinkChartDiagramLookup=new Map,this.relationshipLinkChartDiagramLookup=new Map;const d=new Map,p=new Map,c=new Map,u=new Map,y=new Uint8Array(a.length),g=new Float64Array(a.length),b=new Float64Array(a.length),v=new Float64Array(a.length),D=new Float64Array(a.length),x=new Uint32Array(r.length),I=new Uint32Array(r.length),E=new Float64Array(r.length),S=new Float64Array(r.length),_=[],R=\"organic-standard\",A=new m({xmin:-1e-7,ymin:-1e-7,xmax:1e-7,ymax:1e-7});let j,G=\"organic-standard\",V=0,q=0;const J=z.apply;switch(G=\"geographic-organic-standard\"===e?R:e,G){case\"organic-standard\":j=Q.apply;break;case\"organic-community\":j=B.apply;break;case\"hierarchical-bottom-to-top\":j=U.apply;break;case\"radial-root-centric\":j=F.apply;break;case\"tree-left-to-right\":j=O.apply;break;default:j=P.apply}let X=!1;a.forEach((({typeName:a,feature:i})=>{if(\"chronological-mono-timeline\"!==e&&\"chronological-multi-timeline\"!==e&&t?.lockedNodeLocations?.has(i.attributes[M])){\"geographic-organic-standard\"===e&&this.dataManager.geographicLookup.has(a)?y[V]=W.IsGeographic:y[V]=W.None;const n=t.lockedNodeLocations.get(i.attributes[M]);g[V]=n.x,b[V]=n.y}else if(\"geographic-organic-standard\"===e&&this.dataManager.geographicLookup.has(a)){y[V]=W.IsGeographic;let e=null;const t=i.attributes[this.dataManager.geographicLookup.get(a).name],n=this.dataManager.geographicLookup.get(a)?.geometryType;switch(n){case\"esriGeometryPoint\":g[V]=t?.x,b[V]=t?.y;break;case\"esriGeometryPolygon\":e=t?.centroid,null!=e?.x&&null!=e?.y?(g[V]=e.x,b[V]=e.y):y[V]=W.IsMovable;break;case\"esriGeometryPolyline\":case\"esriGeometryMultipoint\":e=t?.extent?.center,null!=e?.x&&null!=e?.y?(g[V]=e.x,b[V]=e.y):y[V]=W.IsMovable;break;default:y[V]=W.IsMovable}(null==g[V]||null==b[V]||Number.isNaN(g[V])||Number.isNaN(b[V]))&&(y[V]=W.IsMovable,g[V]=0,b[V]=0)}else if(\"chronological-mono-timeline\"===e||\"chronological-multi-timeline\"===e){!X&&t?.lockedNodeLocations?.has(i.attributes[M])&&(X=!0);const e=t?.timeInfoByTypeName?.get(a),n=e?.startField,o=n&&e?.startField?i.attributes[n]:null;v[V]=o?new Date(o).getTime():NaN;const r=e?.endField,s=r&&e?.endField?i.attributes[r]:null;D[V]=s?new Date(s).getTime():NaN,g[V]=0,b[V]=0,y[V]=W.IsMovable}else y[V]=W.IsMovable,g[V]=0,b[V]=0;u.set(i.attributes[M],V),_[V]={feature:i,typeName:a},V++})),X&&n.getLogger(this).warn(\"Locked node locations are not supported for chronological layout at this time.  Requested node locations were ignored\");let Y=!1;const Z=new Map;r.forEach((a=>{const i=a.feature.attributes[k],n=a.feature.attributes[C],o=u.get(i),r=u.get(n),s=t?.timeInfoByTypeName?.get(a.typeName),h=t?.timeInfoByTypeName?s?.startField:null,d=h?a.feature.attributes[h]:null,p=s?.endField,c=p?a.feature.attributes[p]:null;if(void 0!==o&&void 0!==r){let t=i+\"-\"+n;\"chronological-mono-timeline\"!==e&&\"chronological-multi-timeline\"!==e||(t=t+\"-\"+d+\"-\"+c);const s=Z.get(t),h=s?.has(a.typeName);h||(x[q]=o,I[q]=r,\"chronological-mono-timeline\"!==e&&\"chronological-multi-timeline\"!==e||(E[q]=d?new Date(d).getTime():NaN,S[q]=c?new Date(c).getTime():NaN),void 0===s?Z.set(t,new Map([[a.typeName,q]])):s.set(a.typeName,q),q++),l.push(a)}else Y=!0,this.relationshipLinkChartDiagramLookup.set(i,null)})),Y&&n.getLogger(this).warn(\"A relationship is a member of this layer that has either origin or destination entity nodes that are not members. The diagram geometry will be set to null\");const ee=this._validateOrganicLayoutSettings(e,t?.layoutSettings?.organicLayoutSettings),te=this._convertValidatedOrganicSettingsToCalculationSettings(ee);await $();let ae=H.Error,ie=null;if(\"chronological-mono-timeline\"===e||\"chronological-multi-timeline\"===e){let a;({status:ae,links:ie,graphics:a}=J((()=>t?.signal?.aborted??!1),y,g,b,v,D,x.subarray(0,q),I.subarray(0,q),E.subarray(0,q),S.subarray(0,q),\"chronological-multi-timeline\"===e,t?.layoutSettings?.chronologicalLayoutSettings)),ae===H.Success&&(this.chronologicalAuxiliaryGraphics=a)}else({status:ae,links:ie}=j((()=>t?.signal?.aborted??!1),y,g,b,x.subarray(0,q),I.subarray(0,q),te.computationBudgetTime,te.idealEdgeLengthMultiplier,te.repulsionRadiusMultiplier));if(s(t?.signal),ae===H.Error)throw new i(\"knowledge-graph:layout-failed\",\"Attempting to arrange the records in the specified layout failed\");if(ae===H.Canceled)throw h();for(let i=0;i<_.length;i++){if(b[i]>84.9999?b[i]=84.9999:b[i]<-84.9999&&(b[i]=-84.9999),g[i]>179.9999?g[i]=179.9999:g[i]<-179.9999&&(g[i]=-179.9999),_[i].feature.attributes[T]=new f(g[i],b[i]),d.has(_[i].typeName)){const e=d.get(_[i].typeName);e?.set(_[i].feature.attributes[M],_[i].feature)}else{const e=new Map;e.set(_[i].feature.attributes[M],_[i].feature),d.set(_[i].typeName,e)}c.set(_[i].feature.attributes[M],_[i].feature);const e=w(_[i].feature.attributes[T]);this.entityLinkChartDiagramLookup.set(_[i].feature.attributes[M],_[i].feature.attributes[T]?e:null);const t=o(this.dataManager.inclusionModeDefinition.namedTypeDefinitions,_[i].typeName,(()=>({useAllData:!1,members:new Map})));o(t.members,_[i].feature.attributes[M],(()=>({id:_[i].feature.attributes[M],linkChartLocation:void 0}))).linkChartLocation=_[i].feature.attributes[T],_[i].feature.attributes[T].x<A.xmin&&(A.xmin=_[i].feature.attributes[T].x),_[i].feature.attributes[T].x>A.xmax&&(A.xmax=_[i].feature.attributes[T].x),_[i].feature.attributes[T].y<A.ymin&&(A.ymin=_[i].feature.attributes[T].y),_[i].feature.attributes[T].y>A.ymax&&(A.ymax=_[i].feature.attributes[T].y)}if(this.linkChartExtent.xmin=A.xmin,this.linkChartExtent.xmax=A.xmax,this.linkChartExtent.ymin=A.ymin,this.linkChartExtent.ymax=A.ymax,!ie)throw new i(\"knowledge-graph:layout-failed\",\"Attempting to retrieve link geometry from diagram engine failed\");const ne=new Map,oe=new Map,re=new Map,se=new Set;for(let i=0;i<l.length;i++){const a=[],r=l[i],s=r.feature.attributes[k],h=r.feature.attributes[C];let d=s+\"-\"+h;if(\"chronological-mono-timeline\"===e||\"chronological-multi-timeline\"===e){const e=t?.timeInfoByTypeName?.get(r.typeName),a=t?.timeInfoByTypeName?e?.startField:null,i=a?r.feature.attributes[a]:null,n=e?.endField;d+=\"-\"+i+\"-\"+(n?r.feature.attributes[n]:null)}const y=Z.get(d).get(r.typeName),g=0===y?0:ie?.vertexEndIndex[y-1];if(!se.has(y)){if(se.add(y),ie.types[y]===K.Recursive){const e=[ie.vertices[2*g],ie.vertices[2*g+1]],t=[ie.vertices[2*(g+1)],ie.vertices[2*(g+1)+1]],i=[.5*(e[0]+t[0]),.5*(e[1]+t[1])],n=[i[0]-e[0],i[1]-e[1]],o=[i[0]+n[1],i[1]-n[0]],r=[i[0]-n[1],i[1]+n[0]];a.push(e),a.push(o),a.push(t),a.push(r),a.push(e)}else{if(ie.types[y]!==K.Regular){n.getLogger(this).warn(\"A relationship generated an unsupported link geometry type.  It will not be rendered\");continue}for(let e=g;e<ie.vertexEndIndex[y];e++)a.push([ie.vertices[2*e],ie.vertices[2*e+1]])}if(\"chronological-mono-timeline\"!==e&&\"chronological-multi-timeline\"!==e){const e=_[u.get(s)]?.feature.attributes[T],t=_[u.get(h)]?.feature.attributes[T];a[0][0]===e.x&&a[0][1]===e.y||(a[0]=[e.x,e.y]),a[a.length-1][0]===t.x&&a[a.length-1][1]===t.y||(a[a.length-1]=[t.x,t.y])}for(let e=1;e<a.length-1;e++)a[e][1]>85.5?a[e][1]=85.5:a[e][1]<-85.5&&(a[e][1]=-85.5),a[e][0]>179.9999?a[e][0]=179.9999:a[e][0]<-179.9999&&(a[e][0]=-179.9999);ne.has(d)?ne.get(d).push(a):ne.set(d,[a])}const m=ne.get(d);oe.has(d)||(oe.set(d,new Map),re.set(d,new Map));const f=oe.get(d),b=re.get(d);f.has(r.typeName)||(f.set(r.typeName,m.shift()),b.set(r.typeName,0));const N=f.get(r.typeName);b.set(r.typeName,b.get(r.typeName)+1);const v=new L({paths:[N]});if(r.feature.attributes[T]=v,p.has(r.typeName)){const e=p.get(r.typeName);e?.set(r.feature.attributes[M],r.feature)}else{const e=new Map;e.set(r.feature.attributes[M],r.feature),p.set(r.typeName,e)}c.set(r.feature.attributes[M],r.feature);const D=w(r.feature.attributes[T]);this.relationshipLinkChartDiagramLookup.set(r.feature.attributes[M],r.feature.attributes[T]?D:null);const x=o(this.dataManager.inclusionModeDefinition.namedTypeDefinitions,r.typeName,(()=>({useAllData:!1,members:new Map})));o(x.members,r.feature.attributes[M],(()=>({id:r.feature.attributes[M],linkChartLocation:void 0}))).linkChartLocation=D}for(const i of l)i.feature.attributes[N]=re.get(i.feature.attributes[k]+\"-\"+i.feature.attributes[C])?.get(i.typeName)??null;return this._currentLinkChartConfig={layoutMode:e,layoutSettings:t?.layoutSettings?.clone()},{nodes:d,links:p,idMap:c}}async applyNewLinkChartLayout(e=\"organic-standard\",t){const a=[];await this._calculateLayoutWithSublayerTimeInfo(e,t),this.layers.forEach((e=>{a.push(e.refreshCachedQueryEngine())})),this.membershipModified=!0,await Promise.all(a),this._refreshNamedTypes()}getCurrentNodeLocations(){const e=new Map;for(const[t,a]of this.dataManager.inclusionModeDefinition?.namedTypeDefinitions.entries()??[])this.dataManager.relationshipTypeNames.has(t)||a?.members?.forEach((t=>{const a=t.linkChartLocation;let i;const n=t.id;a&&(i=\"x\"in a?{x:a.x,y:a.y}:{x:a.coords[0],y:a.coords[1]},e.set(n,new f({x:i.x,y:i.y})))}));return e}async refreshLinkChartCache(e){await this.dataManager.refreshCacheContent(e);const t=[];this.layers.forEach((e=>{t.push(e.refreshCachedQueryEngine())})),await Promise.all(t),this._refreshNamedTypes()}async connectBetweenEntities(e,t){if(!e.length)return{records:[]};let a=[];try{let i=[];for(const e of this.dataManager.relationshipTypeNames){const t=this.sublayerIdsCache.get(e);t&&(i=i.concat(Array.from(t.keys())))}a=await this.dataManager.getRelationshipsBetweenNodes(e,i,t),await this._handleNewRecords(a,t),s(t)}catch(i){throw l(i)&&this.removeRecords(a),i}return{records:a}}async connectFromEntities(e,t){if(!e.length)return{records:[]};let a=[];try{let i=[];for(const e of this.dataManager.relationshipTypeNames){const t=this.sublayerIdsCache.get(e);t&&(i=i.concat(Array.from(t.keys())))}let n=[];for(const e of this.dataManager.entityTypeNames){const t=this.sublayerIdsCache.get(e);t&&(n=n.concat(Array.from(t)))}a=await this.dataManager.getRelationshipsFromNodes(e,n,i,t),await this._handleNewRecords(a,t),a.length>0&&(this.membershipModified=!0),s(t)}catch(i){throw l(i)&&this.removeRecords(a),i}return{records:a}}getCurrentLayout(){return this._currentLinkChartConfig.layoutMode}async _calculateLayoutWithSublayerTimeInfo(e=\"organic-standard\",t){const a=new Map;this.layers.forEach((e=>{a.set(e.objectType.name,e.timeInfo)})),await this.calculateLinkChartLayout(e,{timeInfoByTypeName:a,...t}),this.linkChart?.handleChronologicalOverlay()}async _handleNewRecords(e,t){const a=[];this.dataManager.addToLayer(e);for(const n of e)this.sublayerIdsCache.has(n.typeName)||(this.sublayerIdsCache.set(n.typeName,new Set),a.push(n.typeName)),this.sublayerIdsCache.get(n.typeName).add(n.id);for(const n of a){const e=this._graphTypeLookup.get(n);if(e){const t=this._createSublayer(e);\"entity\"===e.type?this.dataManager.entityTypeNames.add(n):this.dataManager.relationshipTypeNames.add(n),t.geometryType?this.layers.push(t):this.tables.push(t),this.dataManager.sublayerCaches.set(n,new Map)}}await I(this,a,t),await this.dataManager.refreshCacheContent(e.map((e=>e.id)),void 0,void 0,void 0,t);const i={layoutSettings:this._currentLinkChartConfig.layoutSettings,lockedNodeLocations:new Map};for(const[n,o]of this.entityLinkChartDiagramLookup.entries())o&&i.lockedNodeLocations.set(n,new f(o.coords[0],o.coords[1]));await this.applyNewLinkChartLayout(this._currentLinkChartConfig.layoutMode,i)}_createSublayers(e,t,a){e.forEach((e=>{const i=this._createSublayer(e);a(i)&&t.push(i),this._updateSublayerCaches(e)}))}_updateSublayers(e,t){t.forEach((t=>{t.parentCompositeLayer=this;const a=e.find((e=>e.type===t.graphType&&e.name===t.graphTypeName));a&&(t.objectType=a,t.read({title:a.name},{origin:\"service\"}),this._updateSublayerCaches(a))}))}_updateSublayerCaches(e){const t=this.dataManager.sublayerCaches;t.has(e.name)||t.set(e.name,new Map)}_layersLoadedFromAuthoritativeItem(){const e=this.originIdOf(\"layers\");return e>=y.PORTAL_ITEM&&e<y.USER}async _initializeDiagram(){this.initializationLinkChartConfig?this.initializationLinkChartConfig.doNotRecalculateLayout?(this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.forEach(((e,t)=>{e?.members?.forEach((e=>{const a=e.linkChartLocation;let i;const n=e.id;if(!a)return;i=\"x\"in a?{x:a.x,y:a.y}:{x:a.coords[0],y:a.coords[1]};const o=w(i);this.dataManager.relationshipTypeNames.has(t)?this.relationshipLinkChartDiagramLookup.set(n,o):this.entityLinkChartDiagramLookup.set(n,o),this.linkChartExtent.xmin>i.x&&(this.linkChartExtent.xmin=i.x),this.linkChartExtent.xmax<i.x&&(this.linkChartExtent.xmax=i.x),this.linkChartExtent.ymin>i.y&&(this.linkChartExtent.ymin=i.y),this.linkChartExtent.ymax<i.y&&(this.linkChartExtent.ymax=i.y)}))})),this.memberRelationshipTypes.forEach((e=>{e.name&&this.dataManager.sublayerCaches.get(e.name)?.forEach((e=>{const t=this.relationshipLinkChartDiagramLookup.get(e.attributes[k]),a=this.relationshipLinkChartDiagramLookup.get(e.attributes[C]);if(t&&a){const i=w(new L({paths:[[[t.coords[0],t.coords[1]],[a.coords[0],a.coords[1]]]]}));this.relationshipLinkChartDiagramLookup.set(e.attributes[M],i)}else this.relationshipLinkChartDiagramLookup.set(e.attributes[M],null)}))}))):await this._calculateLayoutWithSublayerTimeInfo(this.initializationLinkChartConfig.layoutMode,{lockedNodeLocations:this.getCurrentNodeLocations(),...this.initializationLinkChartConfig||{}}):await this._calculateLayoutWithSublayerTimeInfo(\"organic-standard\",{lockedNodeLocations:this.getCurrentNodeLocations()})}_refreshNamedTypes(){for(const e of this.layers)e.emit(\"refresh\",{dataChanged:!0});for(const e of this.tables)e.emit(\"refresh\",{dataChanged:!0})}_validateOrganicLayoutSettings(e,t){const a=e=>\"number\"==typeof e&&!isNaN(e),i=e=>a(e)&&e>=1,o=e=>a(e)&&e>=1,r=e=>Object.values(v).includes(e),s=e=>a(e)&&e>=0,l={};if(!new Set([\"organic-standard\",\"organic-community\",\"geographic-organic-standard\",\"chronological-multi-timeline\",\"chronological-mono-timeline\"]).has(e)||!t)return l;const{computationBudgetTime:h,autoRepulsionRadius:d,repulsionRadiusMultiplier:p,absoluteIdealEdgeLength:c,multiplicativeIdealEdgeLength:u,idealEdgeLengthType:y}=t;return o(h)?l.computationBudgetTime=h:h&&n.getLogger(this).warn(\"Invalid layout computationBudgetTime setting, will revert to default setting\"),l.autoRepulsionRadius=d,!d&&i(p)?l.repulsionRadiusMultiplier=p:d||(l.autoRepulsionRadius=!0,n.getLogger(this).warn(\"Invalid layout repulsionRadiusMultiplier setting, will revert to default setting\")),\"geographic-organic-standard\"===e&&(r(y)?l.idealEdgeLengthType=y:void 0!==y&&n.getLogger(this).warn('Invalid layout idealEdgeLengthType setting, will revert to \"multiplier\" setting'),\"absolute-value\"===y&&s(c)?l.absoluteIdealEdgeLength=c:\"absolute-value\"===y&&void 0!==c?n.getLogger(this).warn(\"Invalid layout idealEdgeLength setting, will revert to default setting\"):\"multiplier\"===y&&s(u)?l.multiplicativeIdealEdgeLength=u:\"multiplier\"===y&&void 0!==u&&n.getLogger(this).warn(\"Invalid layout idealEdgeLength setting, will revert to default setting\")),l}_convertValidatedOrganicSettingsToCalculationSettings(e){let t=e.idealEdgeLengthType===v.ABSOLUTE?e.absoluteIdealEdgeLength:e.multiplicativeIdealEdgeLength;return e.idealEdgeLengthType===v.ABSOLUTE&&(void 0===t?t=-1:t*=-1),{computationBudgetTime:e.computationBudgetTime??void 0,repulsionRadiusMultiplier:e.repulsionRadiusMultiplier&&!e.autoRepulsionRadius?e.repulsionRadiusMultiplier:void 0,idealEdgeLengthMultiplier:t}}_createSublayer(e){return new x({objectType:e,parentCompositeLayer:this,graphType:e.type})}_handleSublayersChange(e,t){t&&(t.forEach((e=>{e.parent=null})),this.removeHandles(\"sublayers-owner\")),e&&(e.forEach((e=>{e.parent=this})),this.addHandles([e.on(\"after-add\",(({item:e})=>{e.parent=this})),e.on(\"after-remove\",(({item:e})=>{e.parent=null}))],\"sublayers-owner\"))}_alignLayersDataModelAndInclusionDefinition(e){const t=new Set((e.entityTypes??[]).map((e=>e.name)).concat((e.relationshipTypes??[]).map((e=>e.name)))),i=new Set((e.entityTypes??[]).map((e=>e.name))),o=new Set((e.relationshipTypes??[]).map((e=>e.name)));if(this.layers){for(const a of this.layers)!a.graphType&&t.has(a.graphTypeName)&&(a.graphType=i.has(a.graphTypeName)?\"entity\":\"relationship\");const e=this.layers.filter((e=>t.has(e.graphTypeName)&&(\"entity\"===e.graphType?i.has(e.graphTypeName):o.has(e.graphTypeName))));this.setAtOrigin(\"layers\",e,g(this.originIdOf(\"layers\")))}else this.layers=new a;if(this.layers&&this._originalInclusionList){const e=new Set(this._originalInclusionList.namedTypeDefinitions.keys()),t=this.tables?.map((e=>e.graphTypeName))??[],a=this.layers.map((e=>e.graphTypeName)).concat(t);for(const n of a)e.has(n)||this._originalInclusionList.namedTypeDefinitions.set(n,{useAllData:!1,members:new Map});const i=[];for(const o of this._originalInclusionList.namedTypeDefinitions.keys())a.includes(o)||(n.getLogger(this).warn(`A named type, ${o}, was in the serialized feature collection but did not have a sublayer config in the item, so will be removed`),i.push(o));for(const n of i)this._originalInclusionList.namedTypeDefinitions.delete(n)}}};e([c(G)],q.prototype,\"url\",void 0),e([c()],q.prototype,\"dataPreloadedInLocalCache\",void 0),e([c()],q.prototype,\"initializationLinkChartConfig\",void 0),e([c()],q.prototype,\"membershipModified\",void 0),e([c()],q.prototype,\"dataManager\",void 0),e([c()],q.prototype,\"initializationInclusionModeDefinition\",null),e([c()],q.prototype,\"knowledgeGraph\",void 0),e([c({type:a.ofType(x),json:{write:{ignoreOrigin:!0}}})],q.prototype,\"layers\",void 0),e([c({readOnly:!0})],q.prototype,\"linkChart\",null),e([c()],q.prototype,\"entityLinkChartDiagramLookup\",void 0),e([c()],q.prototype,\"relationshipLinkChartDiagramLookup\",void 0),e([c()],q.prototype,\"linkChartExtent\",void 0),e([c()],q.prototype,\"memberEntityTypes\",void 0),e([c()],q.prototype,\"memberRelationshipTypes\",void 0),e([c({type:[\"LinkChartLayer\"]})],q.prototype,\"operationalLayerType\",void 0),e([c()],q.prototype,\"sublayerIdsCache\",void 0),e([c({type:a.ofType(x),json:{write:{ignoreOrigin:!0}}})],q.prototype,\"tables\",void 0),e([c({json:{read:!1}})],q.prototype,\"type\",void 0),e([c({json:{read:!1}})],q.prototype,\"chronologicalAuxiliaryGraphics\",void 0),q=e([u(\"esri.layers.LinkChartLayer\")],q);const J=q;export{J as default};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}