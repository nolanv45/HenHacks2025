{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from \"../../../core/Error.js\";\nimport { whenOrAbort as t, throwIfAborted as s, allSettledValues as n, isAborted as r, createAbortError as o } from \"../../../core/promiseUtils.js\";\nimport { removeFile as i, makeRelative as l } from \"../../../core/urlUtils.js\";\nimport a from \"../../Point.js\";\nasync function c(e, n, r) {\n  const {\n      source: o\n    } = n,\n    {\n      loadGLTFMesh: i\n    } = await t(import(\"./loadGLTFMesh.js\"), r),\n    l = await f(o, r);\n  s(r);\n  const c = i(new a({\n    x: 0,\n    y: 0,\n    z: 0,\n    spatialReference: e.spatialReference\n  }), l.url, {\n    resolveFile: u(l),\n    signal: r?.signal,\n    expectedType: l.type,\n    unitConversionDisabled: n.unitConversionDisabled\n  });\n  c.then(() => l.dispose(), () => l.dispose());\n  const {\n    vertexAttributes: m,\n    components: p\n  } = await c;\n  e.vertexAttributes = m, e.components = p;\n}\nfunction u(e) {\n  const t = i(e.url);\n  return s => {\n    const n = l(s, t, t),\n      r = n ? n.replace(/^ *\\.\\//, \"\") : null;\n    return (r ? e.files.get(r) : null) ?? s;\n  };\n}\nasync function f(t, s) {\n  if (Array.isArray(t)) {\n    if (!t.length) throw new e(\"mesh-load-external:missing-assets\", \"There must be at least one file to load\");\n    return t[0] instanceof File ? y(t) : h(t, s);\n  }\n  return p(t);\n}\nasync function m(e, t) {\n  const {\n    parts: n,\n    assetMimeType: r,\n    assetName: o\n  } = e;\n  if (1 === n.length) return new v(n[0].partUrl);\n  const i = await e.toBlob(t);\n  return s(t), v.fromBlob(i, x(o, r));\n}\nfunction p(e) {\n  return v.fromBlob(e, x(e.name, e.type));\n}\nfunction y(e) {\n  return j(e.map(e => ({\n    name: e.name,\n    mimeType: e.type,\n    source: p(e)\n  })));\n}\nasync function h(e, t) {\n  const i = await n(e.map(async e => {\n    const n = await m(e);\n    return s(t), {\n      name: e.assetName,\n      mimeType: e.assetMimeType,\n      source: n\n    };\n  }));\n  if (r(t)) throw i.forEach(e => e.source.dispose()), o();\n  return j(i);\n}\nconst d = /^model\\/gltf\\+json$/,\n  g = /^model\\/gltf-binary$/,\n  w = /\\.gltf$/i,\n  b = /\\.glb$/i;\nfunction T({\n  mimeType: e,\n  source: t,\n  name: s\n}) {\n  return d.test(e) || w.test(s) ? {\n    url: t.url,\n    type: \"gltf\"\n  } : g.test(e) || b.test(s) ? {\n    url: t.url,\n    type: \"glb\"\n  } : null;\n}\nfunction j(t) {\n  const s = new Map();\n  let n = null,\n    r = null;\n  for (const e of t) {\n    const {\n      source: t,\n      name: o\n    } = e;\n    n ??= T(e), \"ESRI3DO_NORM.glb\" === o && (r = T(e)), s.set(o, t.url), t.files.forEach((e, t) => s.set(t, e));\n  }\n  const o = r ?? n;\n  if (null == o) throw new e(\"mesh-load-external:missing-files\", \"Missing files to load external mesh source\");\n  return new v(o.url, () => t.forEach(({\n    source: e\n  }) => e.dispose()), s, o.type);\n}\nclass v {\n  constructor(e, t = () => {}, s = new Map(), n) {\n    this.url = e, this.dispose = t, this.files = s, this.type = n;\n  }\n  static fromBlob(e, t) {\n    const s = URL.createObjectURL(e);\n    return new v(s, () => URL.revokeObjectURL(s), void 0, t);\n  }\n}\nfunction x(e, t) {\n  return d.test(t) || w.test(e) ? \"gltf\" : g.test(t) || w.test(e) ? \"glb\" : void 0;\n}\nexport { c as loadExternal };","map":{"version":3,"names":["e","whenOrAbort","t","throwIfAborted","s","allSettledValues","n","isAborted","r","createAbortError","o","removeFile","i","makeRelative","l","a","c","source","loadGLTFMesh","f","x","y","z","spatialReference","url","resolveFile","u","signal","expectedType","type","unitConversionDisabled","then","dispose","vertexAttributes","m","components","p","replace","files","get","Array","isArray","length","File","h","parts","assetMimeType","assetName","v","partUrl","toBlob","fromBlob","name","j","map","mimeType","forEach","d","g","w","b","T","test","Map","set","constructor","URL","createObjectURL","revokeObjectURL","loadExternal"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/geometry/support/meshUtils/loadExternal.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Error.js\";import{whenOrAbort as t,throwIfAborted as s,allSettledValues as n,isAborted as r,createAbortError as o}from\"../../../core/promiseUtils.js\";import{removeFile as i,makeRelative as l}from\"../../../core/urlUtils.js\";import a from\"../../Point.js\";async function c(e,n,r){const{source:o}=n,{loadGLTFMesh:i}=await t(import(\"./loadGLTFMesh.js\"),r),l=await f(o,r);s(r);const c=i(new a({x:0,y:0,z:0,spatialReference:e.spatialReference}),l.url,{resolveFile:u(l),signal:r?.signal,expectedType:l.type,unitConversionDisabled:n.unitConversionDisabled});c.then((()=>l.dispose()),(()=>l.dispose()));const{vertexAttributes:m,components:p}=await c;e.vertexAttributes=m,e.components=p}function u(e){const t=i(e.url);return s=>{const n=l(s,t,t),r=n?n.replace(/^ *\\.\\//,\"\"):null;return(r?e.files.get(r):null)??s}}async function f(t,s){if(Array.isArray(t)){if(!t.length)throw new e(\"mesh-load-external:missing-assets\",\"There must be at least one file to load\");return t[0]instanceof File?y(t):h(t,s)}return p(t)}async function m(e,t){const{parts:n,assetMimeType:r,assetName:o}=e;if(1===n.length)return new v(n[0].partUrl);const i=await e.toBlob(t);return s(t),v.fromBlob(i,x(o,r))}function p(e){return v.fromBlob(e,x(e.name,e.type))}function y(e){return j(e.map((e=>({name:e.name,mimeType:e.type,source:p(e)}))))}async function h(e,t){const i=await n(e.map((async e=>{const n=await m(e);return s(t),{name:e.assetName,mimeType:e.assetMimeType,source:n}})));if(r(t))throw i.forEach((e=>e.source.dispose())),o();return j(i)}const d=/^model\\/gltf\\+json$/,g=/^model\\/gltf-binary$/,w=/\\.gltf$/i,b=/\\.glb$/i;function T({mimeType:e,source:t,name:s}){return d.test(e)||w.test(s)?{url:t.url,type:\"gltf\"}:g.test(e)||b.test(s)?{url:t.url,type:\"glb\"}:null}function j(t){const s=new Map;let n=null,r=null;for(const e of t){const{source:t,name:o}=e;n??=T(e),\"ESRI3DO_NORM.glb\"===o&&(r=T(e)),s.set(o,t.url),t.files.forEach(((e,t)=>s.set(t,e)))}const o=r??n;if(null==o)throw new e(\"mesh-load-external:missing-files\",\"Missing files to load external mesh source\");return new v(o.url,(()=>t.forEach((({source:e})=>e.dispose()))),s,o.type)}class v{constructor(e,t=()=>{},s=new Map,n){this.url=e,this.dispose=t,this.files=s,this.type=n}static fromBlob(e,t){const s=URL.createObjectURL(e);return new v(s,(()=>URL.revokeObjectURL(s)),void 0,t)}}function x(e,t){return d.test(t)||w.test(e)?\"gltf\":g.test(t)||w.test(e)?\"glb\":void 0}export{c as loadExternal};\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA,OAAOA,CAAC,MAAK,wBAAwB;AAAC,SAAOC,WAAW,IAAIC,CAAC,EAACC,cAAc,IAAIC,CAAC,EAACC,gBAAgB,IAAIC,CAAC,EAACC,SAAS,IAAIC,CAAC,EAACC,gBAAgB,IAAIC,CAAC,QAAK,+BAA+B;AAAC,SAAOC,UAAU,IAAIC,CAAC,EAACC,YAAY,IAAIC,CAAC,QAAK,2BAA2B;AAAC,OAAOC,CAAC,MAAK,gBAAgB;AAAC,eAAeC,CAACA,CAAChB,CAAC,EAACM,CAAC,EAACE,CAAC,EAAC;EAAC,MAAK;MAACS,MAAM,EAACP;IAAC,CAAC,GAACJ,CAAC;IAAC;MAACY,YAAY,EAACN;IAAC,CAAC,GAAC,MAAMV,CAAC,CAAC,MAAM,CAAC,mBAAmB,CAAC,EAACM,CAAC,CAAC;IAACM,CAAC,GAAC,MAAMK,CAAC,CAACT,CAAC,EAACF,CAAC,CAAC;EAACJ,CAAC,CAACI,CAAC,CAAC;EAAC,MAAMQ,CAAC,GAACJ,CAAC,CAAC,IAAIG,CAAC,CAAC;IAACK,CAAC,EAAC,CAAC;IAACC,CAAC,EAAC,CAAC;IAACC,CAAC,EAAC,CAAC;IAACC,gBAAgB,EAACvB,CAAC,CAACuB;EAAgB,CAAC,CAAC,EAACT,CAAC,CAACU,GAAG,EAAC;IAACC,WAAW,EAACC,CAAC,CAACZ,CAAC,CAAC;IAACa,MAAM,EAACnB,CAAC,EAAEmB,MAAM;IAACC,YAAY,EAACd,CAAC,CAACe,IAAI;IAACC,sBAAsB,EAACxB,CAAC,CAACwB;EAAsB,CAAC,CAAC;EAACd,CAAC,CAACe,IAAI,CAAE,MAAIjB,CAAC,CAACkB,OAAO,CAAC,CAAC,EAAG,MAAIlB,CAAC,CAACkB,OAAO,CAAC,CAAE,CAAC;EAAC,MAAK;IAACC,gBAAgB,EAACC,CAAC;IAACC,UAAU,EAACC;EAAC,CAAC,GAAC,MAAMpB,CAAC;EAAChB,CAAC,CAACiC,gBAAgB,GAACC,CAAC,EAAClC,CAAC,CAACmC,UAAU,GAACC,CAAC;AAAA;AAAC,SAASV,CAACA,CAAC1B,CAAC,EAAC;EAAC,MAAME,CAAC,GAACU,CAAC,CAACZ,CAAC,CAACwB,GAAG,CAAC;EAAC,OAAOpB,CAAC,IAAE;IAAC,MAAME,CAAC,GAACQ,CAAC,CAACV,CAAC,EAACF,CAAC,EAACA,CAAC,CAAC;MAACM,CAAC,GAACF,CAAC,GAACA,CAAC,CAAC+B,OAAO,CAAC,SAAS,EAAC,EAAE,CAAC,GAAC,IAAI;IAAC,OAAM,CAAC7B,CAAC,GAACR,CAAC,CAACsC,KAAK,CAACC,GAAG,CAAC/B,CAAC,CAAC,GAAC,IAAI,KAAGJ,CAAC;EAAA,CAAC;AAAA;AAAC,eAAee,CAACA,CAACjB,CAAC,EAACE,CAAC,EAAC;EAAC,IAAGoC,KAAK,CAACC,OAAO,CAACvC,CAAC,CAAC,EAAC;IAAC,IAAG,CAACA,CAAC,CAACwC,MAAM,EAAC,MAAM,IAAI1C,CAAC,CAAC,mCAAmC,EAAC,yCAAyC,CAAC;IAAC,OAAOE,CAAC,CAAC,CAAC,CAAC,YAAWyC,IAAI,GAACtB,CAAC,CAACnB,CAAC,CAAC,GAAC0C,CAAC,CAAC1C,CAAC,EAACE,CAAC,CAAC;EAAA;EAAC,OAAOgC,CAAC,CAAClC,CAAC,CAAC;AAAA;AAAC,eAAegC,CAACA,CAAClC,CAAC,EAACE,CAAC,EAAC;EAAC,MAAK;IAAC2C,KAAK,EAACvC,CAAC;IAACwC,aAAa,EAACtC,CAAC;IAACuC,SAAS,EAACrC;EAAC,CAAC,GAACV,CAAC;EAAC,IAAG,CAAC,KAAGM,CAAC,CAACoC,MAAM,EAAC,OAAO,IAAIM,CAAC,CAAC1C,CAAC,CAAC,CAAC,CAAC,CAAC2C,OAAO,CAAC;EAAC,MAAMrC,CAAC,GAAC,MAAMZ,CAAC,CAACkD,MAAM,CAAChD,CAAC,CAAC;EAAC,OAAOE,CAAC,CAACF,CAAC,CAAC,EAAC8C,CAAC,CAACG,QAAQ,CAACvC,CAAC,EAACQ,CAAC,CAACV,CAAC,EAACF,CAAC,CAAC,CAAC;AAAA;AAAC,SAAS4B,CAACA,CAACpC,CAAC,EAAC;EAAC,OAAOgD,CAAC,CAACG,QAAQ,CAACnD,CAAC,EAACoB,CAAC,CAACpB,CAAC,CAACoD,IAAI,EAACpD,CAAC,CAAC6B,IAAI,CAAC,CAAC;AAAA;AAAC,SAASR,CAACA,CAACrB,CAAC,EAAC;EAAC,OAAOqD,CAAC,CAACrD,CAAC,CAACsD,GAAG,CAAEtD,CAAC,KAAG;IAACoD,IAAI,EAACpD,CAAC,CAACoD,IAAI;IAACG,QAAQ,EAACvD,CAAC,CAAC6B,IAAI;IAACZ,MAAM,EAACmB,CAAC,CAACpC,CAAC;EAAC,CAAC,CAAE,CAAC,CAAC;AAAA;AAAC,eAAe4C,CAACA,CAAC5C,CAAC,EAACE,CAAC,EAAC;EAAC,MAAMU,CAAC,GAAC,MAAMN,CAAC,CAACN,CAAC,CAACsD,GAAG,CAAE,MAAMtD,CAAC,IAAE;IAAC,MAAMM,CAAC,GAAC,MAAM4B,CAAC,CAAClC,CAAC,CAAC;IAAC,OAAOI,CAAC,CAACF,CAAC,CAAC,EAAC;MAACkD,IAAI,EAACpD,CAAC,CAAC+C,SAAS;MAACQ,QAAQ,EAACvD,CAAC,CAAC8C,aAAa;MAAC7B,MAAM,EAACX;IAAC,CAAC;EAAA,CAAE,CAAC,CAAC;EAAC,IAAGE,CAAC,CAACN,CAAC,CAAC,EAAC,MAAMU,CAAC,CAAC4C,OAAO,CAAExD,CAAC,IAAEA,CAAC,CAACiB,MAAM,CAACe,OAAO,CAAC,CAAE,CAAC,EAACtB,CAAC,CAAC,CAAC;EAAC,OAAO2C,CAAC,CAACzC,CAAC,CAAC;AAAA;AAAC,MAAM6C,CAAC,GAAC,qBAAqB;EAACC,CAAC,GAAC,sBAAsB;EAACC,CAAC,GAAC,UAAU;EAACC,CAAC,GAAC,SAAS;AAAC,SAASC,CAACA,CAAC;EAACN,QAAQ,EAACvD,CAAC;EAACiB,MAAM,EAACf,CAAC;EAACkD,IAAI,EAAChD;AAAC,CAAC,EAAC;EAAC,OAAOqD,CAAC,CAACK,IAAI,CAAC9D,CAAC,CAAC,IAAE2D,CAAC,CAACG,IAAI,CAAC1D,CAAC,CAAC,GAAC;IAACoB,GAAG,EAACtB,CAAC,CAACsB,GAAG;IAACK,IAAI,EAAC;EAAM,CAAC,GAAC6B,CAAC,CAACI,IAAI,CAAC9D,CAAC,CAAC,IAAE4D,CAAC,CAACE,IAAI,CAAC1D,CAAC,CAAC,GAAC;IAACoB,GAAG,EAACtB,CAAC,CAACsB,GAAG;IAACK,IAAI,EAAC;EAAK,CAAC,GAAC,IAAI;AAAA;AAAC,SAASwB,CAACA,CAACnD,CAAC,EAAC;EAAC,MAAME,CAAC,GAAC,IAAI2D,GAAG,CAAD,CAAC;EAAC,IAAIzD,CAAC,GAAC,IAAI;IAACE,CAAC,GAAC,IAAI;EAAC,KAAI,MAAMR,CAAC,IAAIE,CAAC,EAAC;IAAC,MAAK;MAACe,MAAM,EAACf,CAAC;MAACkD,IAAI,EAAC1C;IAAC,CAAC,GAACV,CAAC;IAACM,CAAC,KAAGuD,CAAC,CAAC7D,CAAC,CAAC,EAAC,kBAAkB,KAAGU,CAAC,KAAGF,CAAC,GAACqD,CAAC,CAAC7D,CAAC,CAAC,CAAC,EAACI,CAAC,CAAC4D,GAAG,CAACtD,CAAC,EAACR,CAAC,CAACsB,GAAG,CAAC,EAACtB,CAAC,CAACoC,KAAK,CAACkB,OAAO,CAAE,CAACxD,CAAC,EAACE,CAAC,KAAGE,CAAC,CAAC4D,GAAG,CAAC9D,CAAC,EAACF,CAAC,CAAE,CAAC;EAAA;EAAC,MAAMU,CAAC,GAACF,CAAC,IAAEF,CAAC;EAAC,IAAG,IAAI,IAAEI,CAAC,EAAC,MAAM,IAAIV,CAAC,CAAC,kCAAkC,EAAC,4CAA4C,CAAC;EAAC,OAAO,IAAIgD,CAAC,CAACtC,CAAC,CAACc,GAAG,EAAE,MAAItB,CAAC,CAACsD,OAAO,CAAE,CAAC;IAACvC,MAAM,EAACjB;EAAC,CAAC,KAAGA,CAAC,CAACgC,OAAO,CAAC,CAAE,CAAC,EAAE5B,CAAC,EAACM,CAAC,CAACmB,IAAI,CAAC;AAAA;AAAC,MAAMmB,CAAC;EAACiB,WAAWA,CAACjE,CAAC,EAACE,CAAC,GAACA,CAAA,KAAI,CAAC,CAAC,EAACE,CAAC,GAAC,IAAI2D,GAAG,CAAD,CAAC,EAACzD,CAAC,EAAC;IAAC,IAAI,CAACkB,GAAG,GAACxB,CAAC,EAAC,IAAI,CAACgC,OAAO,GAAC9B,CAAC,EAAC,IAAI,CAACoC,KAAK,GAAClC,CAAC,EAAC,IAAI,CAACyB,IAAI,GAACvB,CAAC;EAAA;EAAC,OAAO6C,QAAQA,CAACnD,CAAC,EAACE,CAAC,EAAC;IAAC,MAAME,CAAC,GAAC8D,GAAG,CAACC,eAAe,CAACnE,CAAC,CAAC;IAAC,OAAO,IAAIgD,CAAC,CAAC5C,CAAC,EAAE,MAAI8D,GAAG,CAACE,eAAe,CAAChE,CAAC,CAAC,EAAE,KAAK,CAAC,EAACF,CAAC,CAAC;EAAA;AAAC;AAAC,SAASkB,CAACA,CAACpB,CAAC,EAACE,CAAC,EAAC;EAAC,OAAOuD,CAAC,CAACK,IAAI,CAAC5D,CAAC,CAAC,IAAEyD,CAAC,CAACG,IAAI,CAAC9D,CAAC,CAAC,GAAC,MAAM,GAAC0D,CAAC,CAACI,IAAI,CAAC5D,CAAC,CAAC,IAAEyD,CAAC,CAACG,IAAI,CAAC9D,CAAC,CAAC,GAAC,KAAK,GAAC,KAAK,CAAC;AAAA;AAAC,SAAOgB,CAAC,IAAIqD,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}