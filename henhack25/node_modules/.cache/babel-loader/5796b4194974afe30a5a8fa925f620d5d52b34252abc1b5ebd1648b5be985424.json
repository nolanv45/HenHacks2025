{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport t from \"../../../../../core/Error.js\";\nimport \"../../../../../core/has.js\";\nimport e from \"../../../../../core/Logger.js\";\nimport { debounce as r } from \"../../../../../core/promiseUtils.js\";\nimport { generateUUID as s } from \"../../../../../core/uuid.js\";\nimport { fetchPages as i } from \"./strategies/support/snapshotUtils.js\";\nconst o = 8e3;\nclass h {\n  constructor(h, a, c, n) {\n    this.store = h, this.queryInfo = a, this._options = c, this._fetch = n, this._nextBatch = new Set(), this._fetchFeatures = r(async () => {\n      if (0 === this._nextBatch.size || this._options.signal?.aborted) return;\n      const r = Array.from(this._nextBatch);\n      this._nextBatch.clear(), r.length > o && e.getLogger(\"esri.views.2d.layers.FeatureLayerView2D\").warn(new t(\"highlight-too-many-features\", `highlight is limited to ${o} features on large layers configured with a display filter to avoid performance issues`));\n      const h = this.queryInfo.objectIdsQueryPageSize,\n        a = Math.ceil(o / h),\n        c = Math.min(a, Math.ceil(r.length / h)),\n        n = Array.from({\n          length: c\n        }, (t, e) => {\n          const s = e * h,\n            i = Math.min(s + h, r.length);\n          return {\n            num: e,\n            query: this.queryInfo.createObjectIdsQuery(r.slice(s, i))\n          };\n        });\n      try {\n        await i({\n          chunkPrefix: \"cache.\" + s(),\n          fetch: this._fetch\n        }, this.store, n, this._options);\n      } catch (f) {}\n    });\n  }\n  prepareCacheUpdate(t, e) {\n    if (e) for (const r of e) this._nextBatch.delete(r);\n    for (const r of t) this._nextBatch.add(r);\n  }\n  applyCacheUpdate() {\n    return 0 === this._nextBatch.size || this._options.signal?.aborted ? null : this._fetchFeatures().catch(() => {});\n  }\n}\nexport { h as FeatureCache };","map":{"version":3,"names":["t","e","debounce","r","generateUUID","s","fetchPages","i","o","h","constructor","a","c","n","store","queryInfo","_options","_fetch","_nextBatch","Set","_fetchFeatures","size","signal","aborted","Array","from","clear","length","getLogger","warn","objectIdsQueryPageSize","Math","ceil","min","num","query","createObjectIdsQuery","slice","chunkPrefix","fetch","f","prepareCacheUpdate","delete","add","applyCacheUpdate","catch","FeatureCache"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/2d/layers/features/sources/FeatureCache.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport t from\"../../../../../core/Error.js\";import\"../../../../../core/has.js\";import e from\"../../../../../core/Logger.js\";import{debounce as r}from\"../../../../../core/promiseUtils.js\";import{generateUUID as s}from\"../../../../../core/uuid.js\";import{fetchPages as i}from\"./strategies/support/snapshotUtils.js\";const o=8e3;class h{constructor(h,a,c,n){this.store=h,this.queryInfo=a,this._options=c,this._fetch=n,this._nextBatch=new Set,this._fetchFeatures=r((async()=>{if(0===this._nextBatch.size||this._options.signal?.aborted)return;const r=Array.from(this._nextBatch);this._nextBatch.clear(),r.length>o&&e.getLogger(\"esri.views.2d.layers.FeatureLayerView2D\").warn(new t(\"highlight-too-many-features\",`highlight is limited to ${o} features on large layers configured with a display filter to avoid performance issues`));const h=this.queryInfo.objectIdsQueryPageSize,a=Math.ceil(o/h),c=Math.min(a,Math.ceil(r.length/h)),n=Array.from({length:c},((t,e)=>{const s=e*h,i=Math.min(s+h,r.length);return{num:e,query:this.queryInfo.createObjectIdsQuery(r.slice(s,i))}}));try{await i({chunkPrefix:\"cache.\"+s(),fetch:this._fetch},this.store,n,this._options)}catch(f){}}))}prepareCacheUpdate(t,e){if(e)for(const r of e)this._nextBatch.delete(r);for(const r of t)this._nextBatch.add(r)}applyCacheUpdate(){return 0===this._nextBatch.size||this._options.signal?.aborted?null:this._fetchFeatures().catch((()=>{}))}}export{h as FeatureCache};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}