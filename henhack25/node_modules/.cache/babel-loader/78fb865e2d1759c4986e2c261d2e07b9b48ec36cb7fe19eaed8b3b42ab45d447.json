{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport \"../../../../core/has.js\";\nimport { LRUCache as e } from \"../../../../core/LRUCache.js\";\nimport { getOrCreateMapValue as t } from \"../../../../core/MapUtils.js\";\nimport { throwIfAborted as s } from \"../../../../core/promiseUtils.js\";\nimport { getMetersPerVerticalUnitForSR as n } from \"../../../../core/unitUtils.js\";\nimport { getMetersPerUnit as o } from \"../../../../symbols/support/unitConversionUtils.js\";\nfunction i() {\n  let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : !1;\n  let t = arguments.length > 1 ? arguments[1] : undefined;\n  if (e) {\n    const {\n      elevationInfo: e,\n      alignPointsInFeatures: s\n    } = t;\n    return new c(e, s);\n  }\n  return new a();\n}\nclass a {\n  async alignCandidates(e, t, s) {\n    return e;\n  }\n  notifyElevationSourceChange() {}\n}\nconst r = 1024;\nclass c {\n  constructor(t, s) {\n    this._elevationInfo = t, this._alignPointsInFeatures = s, this._alignmentsCache = new e(r), this._cacheVersion = 0;\n  }\n  async alignCandidates(e, t, s) {\n    const n = this._elevationInfo;\n    return null == n || \"absolute-height\" !== n.mode || n.featureExpressionInfo ? this._alignComputedElevationCandidates(e, t, s) : (l(e, t, n), e);\n  }\n  notifyElevationSourceChange() {\n    this._alignmentsCache.clear(), this._cacheVersion++;\n  }\n  async _alignComputedElevationCandidates(e, n, o) {\n    const i = new Map();\n    for (const s of e) t(i, s.objectId, d).push(s);\n    const [a, r, c] = this._prepareQuery(i, n),\n      h = await this._alignPointsInFeatures(a, o);\n    s(o);\n    if (c !== this._cacheVersion) return this._alignComputedElevationCandidates(e, n, o);\n    this._applyCacheAndResponse(a, h, r);\n    const {\n        drapedObjectIds: u,\n        failedObjectIds: l\n      } = h,\n      p = [];\n    for (const t of e) {\n      const {\n        objectId: e\n      } = t;\n      u.has(e) && \"edge\" === t.type && (t.draped = !0), l.has(e) || p.push(t);\n    }\n    return p;\n  }\n  _prepareQuery(e, t) {\n    const s = [],\n      n = [];\n    for (const [o, i] of e) {\n      const e = [];\n      for (const t of i) this._addToQueriesOrCachedResult(o, t.target, e, n), \"edge\" === t.type && (this._addToQueriesOrCachedResult(o, t.start, e, n), this._addToQueriesOrCachedResult(o, t.end, e, n));\n      0 !== e.length && s.push({\n        objectId: o,\n        points: e\n      });\n    }\n    return [{\n      spatialReference: t.toJSON(),\n      pointsInFeatures: s\n    }, n, this._cacheVersion];\n  }\n  _addToQueriesOrCachedResult(e, t, s, n) {\n    const o = u(e, t),\n      i = this._alignmentsCache.get(o);\n    null == i ? s.push(t) : n.push(new h(t, i));\n  }\n  _applyCacheAndResponse(e, _ref, o) {\n    let {\n      elevations: t,\n      drapedObjectIds: s,\n      failedObjectIds: n\n    } = _ref;\n    for (const r of o) r.apply();\n    let i = 0;\n    const a = this._alignmentsCache;\n    for (const {\n      objectId: r,\n      points: c\n    } of e.pointsInFeatures) {\n      if (n.has(r)) {\n        i += c.length;\n        continue;\n      }\n      const e = !s.has(r);\n      for (const s of c) {\n        const n = u(r, s),\n          o = t[i++];\n        s.z = o, e && a.put(n, o, 1);\n      }\n    }\n  }\n}\nclass h {\n  constructor(e, t) {\n    this.point = e, this.z = t;\n  }\n  apply() {\n    this.point.z = this.z;\n  }\n}\nfunction u(e, _ref2) {\n  let {\n    x: t,\n    y: s,\n    z: n,\n    spatialReference: o\n  } = _ref2;\n  return `${e}-${t}-${s}-${n ?? 0}}-wkid:${o?.wkid}`;\n}\nfunction l(e, t, s) {\n  const {\n    offset: i,\n    unit: a\n  } = s;\n  if (null == i) return;\n  const r = n(t),\n    c = i * (o(a ?? \"meters\") / r);\n  for (const n of e) switch (n.type) {\n    case \"edge\":\n      n.start.z += c, n.end.z += c;\n      continue;\n    case \"vertex\":\n      n.target.z += c;\n      continue;\n  }\n}\nfunction d() {\n  return [];\n}\nexport { i as getSnappingCandidateElevationAligner };","map":{"version":3,"names":["LRUCache","e","getOrCreateMapValue","t","throwIfAborted","s","getMetersPerVerticalUnitForSR","n","getMetersPerUnit","o","i","arguments","length","undefined","elevationInfo","alignPointsInFeatures","c","a","alignCandidates","notifyElevationSourceChange","r","constructor","_elevationInfo","_alignPointsInFeatures","_alignmentsCache","_cacheVersion","mode","featureExpressionInfo","_alignComputedElevationCandidates","l","clear","Map","objectId","d","push","_prepareQuery","h","_applyCacheAndResponse","drapedObjectIds","u","failedObjectIds","p","has","type","draped","_addToQueriesOrCachedResult","target","start","end","points","spatialReference","toJSON","pointsInFeatures","get","_ref","elevations","apply","z","put","point","_ref2","x","y","wkid","offset","unit","getSnappingCandidateElevationAligner"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/interactive/snapping/featureSources/snappingCandidateElevationAlignment.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport\"../../../../core/has.js\";import{LRUCache as e}from\"../../../../core/LRUCache.js\";import{getOrCreateMapValue as t}from\"../../../../core/MapUtils.js\";import{throwIfAborted as s}from\"../../../../core/promiseUtils.js\";import{getMetersPerVerticalUnitForSR as n}from\"../../../../core/unitUtils.js\";import{getMetersPerUnit as o}from\"../../../../symbols/support/unitConversionUtils.js\";function i(e=!1,t){if(e){const{elevationInfo:e,alignPointsInFeatures:s}=t;return new c(e,s)}return new a}class a{async alignCandidates(e,t,s){return e}notifyElevationSourceChange(){}}const r=1024;class c{constructor(t,s){this._elevationInfo=t,this._alignPointsInFeatures=s,this._alignmentsCache=new e(r),this._cacheVersion=0}async alignCandidates(e,t,s){const n=this._elevationInfo;return null==n||\"absolute-height\"!==n.mode||n.featureExpressionInfo?this._alignComputedElevationCandidates(e,t,s):(l(e,t,n),e)}notifyElevationSourceChange(){this._alignmentsCache.clear(),this._cacheVersion++}async _alignComputedElevationCandidates(e,n,o){const i=new Map;for(const s of e)t(i,s.objectId,d).push(s);const[a,r,c]=this._prepareQuery(i,n),h=await this._alignPointsInFeatures(a,o);s(o);if(c!==this._cacheVersion)return this._alignComputedElevationCandidates(e,n,o);this._applyCacheAndResponse(a,h,r);const{drapedObjectIds:u,failedObjectIds:l}=h,p=[];for(const t of e){const{objectId:e}=t;u.has(e)&&\"edge\"===t.type&&(t.draped=!0),l.has(e)||p.push(t)}return p}_prepareQuery(e,t){const s=[],n=[];for(const[o,i]of e){const e=[];for(const t of i)this._addToQueriesOrCachedResult(o,t.target,e,n),\"edge\"===t.type&&(this._addToQueriesOrCachedResult(o,t.start,e,n),this._addToQueriesOrCachedResult(o,t.end,e,n));0!==e.length&&s.push({objectId:o,points:e})}return[{spatialReference:t.toJSON(),pointsInFeatures:s},n,this._cacheVersion]}_addToQueriesOrCachedResult(e,t,s,n){const o=u(e,t),i=this._alignmentsCache.get(o);null==i?s.push(t):n.push(new h(t,i))}_applyCacheAndResponse(e,{elevations:t,drapedObjectIds:s,failedObjectIds:n},o){for(const r of o)r.apply();let i=0;const a=this._alignmentsCache;for(const{objectId:r,points:c}of e.pointsInFeatures){if(n.has(r)){i+=c.length;continue}const e=!s.has(r);for(const s of c){const n=u(r,s),o=t[i++];s.z=o,e&&a.put(n,o,1)}}}}class h{constructor(e,t){this.point=e,this.z=t}apply(){this.point.z=this.z}}function u(e,{x:t,y:s,z:n,spatialReference:o}){return`${e}-${t}-${s}-${n??0}}-wkid:${o?.wkid}`}function l(e,t,s){const{offset:i,unit:a}=s;if(null==i)return;const r=n(t),c=i*(o(a??\"meters\")/r);for(const n of e)switch(n.type){case\"edge\":n.start.z+=c,n.end.z+=c;continue;case\"vertex\":n.target.z+=c;continue}}function d(){return[]}export{i as getSnappingCandidateElevationAligner};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}