{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { cyclicalPI as e, cyclical2PI as t } from \"../../../core/Cyclical.js\";\nimport { valueInUnit as r, createAngle as s } from \"../../../core/quantityUtils.js\";\nimport { create as o } from \"../../../core/libs/gl-matrix-2/factories/vec3f64.js\";\nimport { absoluteHeightElevationInfo as i } from \"../../../support/elevationInfoUtils.js\";\nimport { fromAnyMapPoint as n, markAsTarget as a, fromVec3 as p } from \"../sketch/normalizedPoint.js\";\nimport { SnappingAlgorithm as d } from \"./SnappingAlgorithm.js\";\nimport { editEdgeToSnappingEdge as l, squaredScreenDistance as h } from \"./snappingUtils.js\";\nimport { LineSnappingCandidate as c } from \"./candidates/LineSnappingCandidate.js\";\nimport { vectorToScreenPoint as f } from \"../support/viewUtils.js\";\nimport { radiansGeographicBetweenVec as g, pointFromDistanceAlongAzimuth as m } from \"../../support/angularMeasurementUtils.js\";\nimport { geodesicDistance as u } from \"../../support/geodesicLengthMeasurementUtils.js\";\nimport { projectPointToLineLike as x } from \"../../support/geometry3dUtils.js\";\nimport { LineType as j } from \"../../support/geometry2dUtils.js\";\nclass E extends d {\n  snapNewVertex(e, t) {\n    const r = t.editGeometryOperations.data.components[0],\n      s = r.edges.length,\n      o = [];\n    if (s < 1) return o;\n    const {\n        spatialReference: n\n      } = t,\n      a = f(e, n, i, this.view),\n      {\n        view: p\n      } = this,\n      d = r.edges[s - 1];\n    let h = d;\n    do {\n      if (this.edgeExceedsShortLineThreshold(h, t)) {\n        const r = l(h, p, t);\n        this._processCandidateProposal(r.left, r.right, e, a, t, o);\n      }\n      h = h.leftVertex.leftEdge;\n    } while (h && h !== d);\n    return o;\n  }\n  snapExistingVertex(e, t) {\n    const r = [],\n      s = t.vertexHandle,\n      o = s.component;\n    if (o.edges.length < 2) return r;\n    const {\n        view: a\n      } = this,\n      {\n        spatialReference: p\n      } = t,\n      d = f(e, p, i, a),\n      h = s.leftEdge,\n      c = s.rightEdge;\n    h && c && this.edgeExceedsShortLineThreshold(h, t) && this.edgeExceedsShortLineThreshold(c, t) && this._processCandidateProposal(n(h.leftVertex.pos, a, t), n(c.rightVertex.pos, a, t), e, d, t, r);\n    const g = o.edges[0];\n    let m = g;\n    do {\n      if (m !== s.leftEdge && m !== s.rightEdge && this.edgeExceedsShortLineThreshold(m, t)) {\n        const s = l(m, a, t);\n        this._processCandidateProposal(s.left, s.right, e, d, t, r);\n      }\n      m = m.rightVertex.rightEdge;\n    } while (m && m !== g);\n    return r;\n  }\n  _processCandidateProposal(e, t, r, s, n, d) {\n    const {\n        spatialReference: l,\n        pointer: g\n      } = n,\n      m = o();\n    v(m, e, t, r, n);\n    const u = a(p(m));\n    h(s, f(u, l, i, this.view)) < this.squaredProximityThreshold(g) && d.push(new c({\n      lineStart: e,\n      lineEnd: t,\n      targetPoint: u,\n      isDraped: \"on-the-ground\" === n.elevationInfo?.mode\n    }));\n  }\n}\nfunction v(e, t, r, s, o) {\n  w(e, t, r, s, o) || P(e, s, t, r);\n}\nfunction w(o, i, n, a, _ref) {\n  let {\n    spatialReference: p\n  } = _ref;\n  const d = g(i, n, p, p);\n  if (null == d) return !1;\n  const l = g(n, a, p, p);\n  if (null == l) return !1;\n  const h = u(n, a, p);\n  if (null == h) return !1;\n  const c = Math.abs(e.shortestSignedDiff(d, l)) > Math.PI / 2 ? t.normalize(d + Math.PI) : d;\n  return m(o, n, p, r(h, \"meters\"), s(c, \"radians\", \"geographic\"), \"geodesic\"), o[2] = a[2], !0;\n}\nfunction P(e, t, r, s) {\n  x(t, {\n    start: r,\n    end: s,\n    type: j.LINE\n  }, e), e[2] = t[2];\n}\nexport { E as LineSnapper };","map":{"version":3,"names":["cyclicalPI","e","cyclical2PI","t","valueInUnit","r","createAngle","s","create","o","absoluteHeightElevationInfo","i","fromAnyMapPoint","n","markAsTarget","a","fromVec3","p","SnappingAlgorithm","d","editEdgeToSnappingEdge","l","squaredScreenDistance","h","LineSnappingCandidate","c","vectorToScreenPoint","f","radiansGeographicBetweenVec","g","pointFromDistanceAlongAzimuth","m","geodesicDistance","u","projectPointToLineLike","x","LineType","j","E","snapNewVertex","editGeometryOperations","data","components","edges","length","spatialReference","view","edgeExceedsShortLineThreshold","_processCandidateProposal","left","right","leftVertex","leftEdge","snapExistingVertex","vertexHandle","component","rightEdge","pos","rightVertex","pointer","v","squaredProximityThreshold","push","lineStart","lineEnd","targetPoint","isDraped","elevationInfo","mode","w","P","_ref","Math","abs","shortestSignedDiff","PI","normalize","start","end","type","LINE","LineSnapper"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/interactive/snapping/LineSnapper.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{cyclicalPI as e,cyclical2PI as t}from\"../../../core/Cyclical.js\";import{valueInUnit as r,createAngle as s}from\"../../../core/quantityUtils.js\";import{create as o}from\"../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{absoluteHeightElevationInfo as i}from\"../../../support/elevationInfoUtils.js\";import{fromAnyMapPoint as n,markAsTarget as a,fromVec3 as p}from\"../sketch/normalizedPoint.js\";import{SnappingAlgorithm as d}from\"./SnappingAlgorithm.js\";import{editEdgeToSnappingEdge as l,squaredScreenDistance as h}from\"./snappingUtils.js\";import{LineSnappingCandidate as c}from\"./candidates/LineSnappingCandidate.js\";import{vectorToScreenPoint as f}from\"../support/viewUtils.js\";import{radiansGeographicBetweenVec as g,pointFromDistanceAlongAzimuth as m}from\"../../support/angularMeasurementUtils.js\";import{geodesicDistance as u}from\"../../support/geodesicLengthMeasurementUtils.js\";import{projectPointToLineLike as x}from\"../../support/geometry3dUtils.js\";import{LineType as j}from\"../../support/geometry2dUtils.js\";class E extends d{snapNewVertex(e,t){const r=t.editGeometryOperations.data.components[0],s=r.edges.length,o=[];if(s<1)return o;const{spatialReference:n}=t,a=f(e,n,i,this.view),{view:p}=this,d=r.edges[s-1];let h=d;do{if(this.edgeExceedsShortLineThreshold(h,t)){const r=l(h,p,t);this._processCandidateProposal(r.left,r.right,e,a,t,o)}h=h.leftVertex.leftEdge}while(h&&h!==d);return o}snapExistingVertex(e,t){const r=[],s=t.vertexHandle,o=s.component;if(o.edges.length<2)return r;const{view:a}=this,{spatialReference:p}=t,d=f(e,p,i,a),h=s.leftEdge,c=s.rightEdge;h&&c&&this.edgeExceedsShortLineThreshold(h,t)&&this.edgeExceedsShortLineThreshold(c,t)&&this._processCandidateProposal(n(h.leftVertex.pos,a,t),n(c.rightVertex.pos,a,t),e,d,t,r);const g=o.edges[0];let m=g;do{if(m!==s.leftEdge&&m!==s.rightEdge&&this.edgeExceedsShortLineThreshold(m,t)){const s=l(m,a,t);this._processCandidateProposal(s.left,s.right,e,d,t,r)}m=m.rightVertex.rightEdge}while(m&&m!==g);return r}_processCandidateProposal(e,t,r,s,n,d){const{spatialReference:l,pointer:g}=n,m=o();v(m,e,t,r,n);const u=a(p(m));h(s,f(u,l,i,this.view))<this.squaredProximityThreshold(g)&&d.push(new c({lineStart:e,lineEnd:t,targetPoint:u,isDraped:\"on-the-ground\"===n.elevationInfo?.mode}))}}function v(e,t,r,s,o){w(e,t,r,s,o)||P(e,s,t,r)}function w(o,i,n,a,{spatialReference:p}){const d=g(i,n,p,p);if(null==d)return!1;const l=g(n,a,p,p);if(null==l)return!1;const h=u(n,a,p);if(null==h)return!1;const c=Math.abs(e.shortestSignedDiff(d,l))>Math.PI/2?t.normalize(d+Math.PI):d;return m(o,n,p,r(h,\"meters\"),s(c,\"radians\",\"geographic\"),\"geodesic\"),o[2]=a[2],!0}function P(e,t,r,s){x(t,{start:r,end:s,type:j.LINE},e),e[2]=t[2]}export{E as LineSnapper};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}