{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { remove as e } from \"../arrayUtils.js\";\nimport { makeHandle as t } from \"../handleUtils.js\";\nimport s from \"../Logger.js\";\nimport { throwIfAborted as r } from \"../promiseUtils.js\";\nimport { open as i } from \"./workers.js\";\nclass h {\n  constructor(e, t, r, h, o = {}) {\n    this._mainMethod = t, this._transferLists = r, this._listeners = [], this._promise = i(e, {\n      ...o,\n      schedule: h\n    }).then(e => {\n      if (void 0 === this._thread) {\n        this._thread = e, this._promise = null, o.hasInitialize && this.broadcast({}, \"initialize\");\n        for (const e of this._listeners) this._connectListener(e);\n      } else e.close();\n    }), this._promise.catch(t => s.getLogger(\"esri.core.workers.WorkerHandle\").error(`Failed to initialize ${e} worker: ${t}`));\n  }\n  on(s, r) {\n    const i = {\n      removed: !1,\n      eventName: s,\n      callback: r,\n      threadHandle: null\n    };\n    return this._listeners.push(i), this._connectListener(i), t(() => {\n      i.removed = !0, e(this._listeners, i), this._thread && null != i.threadHandle && i.threadHandle.remove();\n    });\n  }\n  destroy() {\n    this._thread && (this._thread.close(), this._thread = null), this._promise = null, this._listeners.length = 0, this._transferLists = {};\n  }\n  invoke(e, t) {\n    return this.invokeMethod(this._mainMethod, e, t);\n  }\n  invokeMethod(e, t, s) {\n    if (this._thread) {\n      const r = this._transferLists[e],\n        i = r ? r(t) : [];\n      return this._thread.invoke(e, t, {\n        transferList: i,\n        signal: s\n      });\n    }\n    return this._promise ? this._promise.then(() => (r(s), this.invokeMethod(e, t, s))) : Promise.reject(null);\n  }\n  broadcast(e, t) {\n    return this._thread ? Promise.all(this._thread.broadcast(t, e)).then(() => {}) : this._promise ? this._promise.then(() => this.broadcast(e, t)) : Promise.reject();\n  }\n  get promise() {\n    return this._promise;\n  }\n  _connectListener(e) {\n    this._thread && this._thread.on(e.eventName, e.callback).then(t => {\n      e.removed || (e.threadHandle = t);\n    });\n  }\n}\nexport { h as WorkerHandle };","map":{"version":3,"names":["remove","e","makeHandle","t","s","throwIfAborted","r","open","i","h","constructor","o","_mainMethod","_transferLists","_listeners","_promise","schedule","then","_thread","hasInitialize","broadcast","_connectListener","close","catch","getLogger","error","on","removed","eventName","callback","threadHandle","push","destroy","length","invoke","invokeMethod","transferList","signal","Promise","reject","all","promise","WorkerHandle"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/core/workers/WorkerHandle.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{remove as e}from\"../arrayUtils.js\";import{makeHandle as t}from\"../handleUtils.js\";import s from\"../Logger.js\";import{throwIfAborted as r}from\"../promiseUtils.js\";import{open as i}from\"./workers.js\";class h{constructor(e,t,r,h,o={}){this._mainMethod=t,this._transferLists=r,this._listeners=[],this._promise=i(e,{...o,schedule:h}).then((e=>{if(void 0===this._thread){this._thread=e,this._promise=null,o.hasInitialize&&this.broadcast({},\"initialize\");for(const e of this._listeners)this._connectListener(e)}else e.close()})),this._promise.catch((t=>s.getLogger(\"esri.core.workers.WorkerHandle\").error(`Failed to initialize ${e} worker: ${t}`)))}on(s,r){const i={removed:!1,eventName:s,callback:r,threadHandle:null};return this._listeners.push(i),this._connectListener(i),t((()=>{i.removed=!0,e(this._listeners,i),this._thread&&null!=i.threadHandle&&i.threadHandle.remove()}))}destroy(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null,this._listeners.length=0,this._transferLists={}}invoke(e,t){return this.invokeMethod(this._mainMethod,e,t)}invokeMethod(e,t,s){if(this._thread){const r=this._transferLists[e],i=r?r(t):[];return this._thread.invoke(e,t,{transferList:i,signal:s})}return this._promise?this._promise.then((()=>(r(s),this.invokeMethod(e,t,s)))):Promise.reject(null)}broadcast(e,t){return this._thread?Promise.all(this._thread.broadcast(t,e)).then((()=>{})):this._promise?this._promise.then((()=>this.broadcast(e,t))):Promise.reject()}get promise(){return this._promise}_connectListener(e){this._thread&&this._thread.on(e.eventName,e.callback).then((t=>{e.removed||(e.threadHandle=t)}))}}export{h as WorkerHandle};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}