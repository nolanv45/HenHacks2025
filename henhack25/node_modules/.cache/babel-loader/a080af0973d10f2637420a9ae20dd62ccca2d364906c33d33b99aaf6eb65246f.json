{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from \"../../core/Error.js\";\nimport { updateOrigins as t } from \"../../core/accessorSupport/originUtils.js\";\nimport r from \"../../portal/Portal.js\";\nimport a from \"../../portal/PortalItem.js\";\nimport { createForItemWrite as o } from \"../../portal/support/jsonContext.js\";\nimport { addTypeKeyword as i, typeKeyword as n } from \"../../portal/support/portalItemUtils.js\";\nimport { evaluateWriteErrors as s } from \"../../webdoc/support/saveUtils.js\";\nfunction p(t, r, a) {\n  const o = a(t);\n  if (!o.isValid) throw new e(`${r}:invalid-parameters`, o.errorMessage, {\n    layer: t\n  });\n}\nasync function l(e) {\n  const {\n    layer: t,\n    errorNamePrefix: r,\n    validateLayer: a\n  } = e;\n  await t.load(), p(t, r, a);\n}\nfunction m(e, t) {\n  return `Layer (title: ${e.title}, id: ${e.id}) of type '${e.declaredClass}' ${t}`;\n}\nfunction c(t) {\n  const {\n    item: r,\n    errorNamePrefix: a,\n    layer: o,\n    validateItem: i\n  } = t;\n  if (u(t), i) {\n    const t = i(r);\n    if (!t.isValid) throw new e(`${a}:invalid-parameters`, t.errorMessage, {\n      layer: o\n    });\n  }\n}\nfunction u(t) {\n  const {\n      item: r,\n      itemType: a,\n      additionalItemType: o,\n      errorNamePrefix: i,\n      layer: n\n    } = t,\n    s = [a];\n  if (o && s.push(o), !s.includes(r.type)) {\n    const t = s.map(e => `'${e}'`).join(\", \");\n    throw new e(`${i}:portal-item-wrong-type`, `Portal item type should be one of: \"${t}\"`, {\n      item: r,\n      layer: n\n    });\n  }\n}\nfunction f(t) {\n  const {\n      layer: r,\n      errorNamePrefix: a\n    } = t,\n    {\n      portalItem: o\n    } = r;\n  if (!o) throw new e(`${a}:portal-item-not-set`, m(r, \"requires the portalItem property to be set\"));\n  if (!o.loaded) throw new e(`${a}:portal-item-not-loaded`, m(r, \"cannot be saved to a portal item that does not exist or is inaccessible\"));\n  c({\n    ...t,\n    item: o\n  });\n}\nfunction d(e) {\n  const {\n    newItem: t,\n    itemType: o\n  } = e;\n  let i = a.from(t);\n  return i.id && (i = i.clone(), i.id = null), i.type ??= o, i.portal ??= r.getDefault(), c({\n    ...e,\n    item: i\n  }), i;\n}\nfunction y(e) {\n  return o(e, \"portal-item\");\n}\nasync function w(e, t, r) {\n  \"beforeSave\" in e && \"function\" == typeof e.beforeSave && (await e.beforeSave());\n  const a = e.write({}, t);\n  return await Promise.all(t.resources?.pendingOperations ?? []), s(t, {\n    errorName: \"layer-write:unsupported\"\n  }, r), a;\n}\nfunction I(e) {\n  i(e, n.JSAPI), e.typeKeywords && (e.typeKeywords = e.typeKeywords.filter((e, t, r) => r.indexOf(e) === t));\n}\nasync function v(e, t, r) {\n  const a = e.portal;\n  await a.signIn(), await a.user.addItem({\n    item: e,\n    data: t,\n    folder: r?.folder\n  });\n}\nasync function P(e, r) {\n  const {\n    layer: a,\n    createItemData: o,\n    createJSONContext: i,\n    setItemProperties: n,\n    saveResources: s,\n    supplementalUnsupportedErrors: p\n  } = e;\n  await l(e), f(e);\n  const m = a.portalItem,\n    c = i ? i(m) : y(m),\n    u = await w(a, c, {\n      ...r,\n      supplementalUnsupportedErrors: p\n    }),\n    d = await o({\n      layer: a,\n      layerJSON: u\n    }, m);\n  return await n?.(a, m, d), I(m), await m.update({\n    data: d\n  }), t(c), await s?.(m, c), m;\n}\nasync function $(e, r) {\n  const {\n    layer: a,\n    createItemData: o,\n    createJSONContext: i,\n    setItemProperties: n,\n    saveResources: s,\n    supplementalUnsupportedErrors: p\n  } = e;\n  await l(e);\n  const m = d(e),\n    c = i ? i(m) : y(m),\n    u = await w(a, c, {\n      ...r,\n      supplementalUnsupportedErrors: p\n    }),\n    f = await o({\n      layer: a,\n      layerJSON: u\n    }, m);\n  return await n(a, m, f), I(m), await v(m, f, r), a.portalItem = m, t(c), await s?.(m, c), m;\n}\nexport { v as addItem, m as createErrorMessage, f as ensureItemConfig, p as ensureLayerConfig, w as getLayerJSON, d as getPortalItem, P as save, $ as saveAs, I as setCommonItemProperties };","map":{"version":3,"names":["e","updateOrigins","t","r","a","createForItemWrite","o","addTypeKeyword","i","typeKeyword","n","evaluateWriteErrors","s","p","isValid","errorMessage","layer","l","errorNamePrefix","validateLayer","load","m","title","id","declaredClass","c","item","validateItem","u","itemType","additionalItemType","push","includes","type","map","join","f","portalItem","loaded","d","newItem","from","clone","portal","getDefault","y","w","beforeSave","write","Promise","all","resources","pendingOperations","errorName","I","JSAPI","typeKeywords","filter","indexOf","v","signIn","user","addItem","data","folder","P","createItemData","createJSONContext","setItemProperties","saveResources","supplementalUnsupportedErrors","layerJSON","update","$","createErrorMessage","ensureItemConfig","ensureLayerConfig","getLayerJSON","getPortalItem","save","saveAs","setCommonItemProperties"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/layers/save/utils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import{updateOrigins as t}from\"../../core/accessorSupport/originUtils.js\";import r from\"../../portal/Portal.js\";import a from\"../../portal/PortalItem.js\";import{createForItemWrite as o}from\"../../portal/support/jsonContext.js\";import{addTypeKeyword as i,typeKeyword as n}from\"../../portal/support/portalItemUtils.js\";import{evaluateWriteErrors as s}from\"../../webdoc/support/saveUtils.js\";function p(t,r,a){const o=a(t);if(!o.isValid)throw new e(`${r}:invalid-parameters`,o.errorMessage,{layer:t})}async function l(e){const{layer:t,errorNamePrefix:r,validateLayer:a}=e;await t.load(),p(t,r,a)}function m(e,t){return`Layer (title: ${e.title}, id: ${e.id}) of type '${e.declaredClass}' ${t}`}function c(t){const{item:r,errorNamePrefix:a,layer:o,validateItem:i}=t;if(u(t),i){const t=i(r);if(!t.isValid)throw new e(`${a}:invalid-parameters`,t.errorMessage,{layer:o})}}function u(t){const{item:r,itemType:a,additionalItemType:o,errorNamePrefix:i,layer:n}=t,s=[a];if(o&&s.push(o),!s.includes(r.type)){const t=s.map((e=>`'${e}'`)).join(\", \");throw new e(`${i}:portal-item-wrong-type`,`Portal item type should be one of: \"${t}\"`,{item:r,layer:n})}}function f(t){const{layer:r,errorNamePrefix:a}=t,{portalItem:o}=r;if(!o)throw new e(`${a}:portal-item-not-set`,m(r,\"requires the portalItem property to be set\"));if(!o.loaded)throw new e(`${a}:portal-item-not-loaded`,m(r,\"cannot be saved to a portal item that does not exist or is inaccessible\"));c({...t,item:o})}function d(e){const{newItem:t,itemType:o}=e;let i=a.from(t);return i.id&&(i=i.clone(),i.id=null),i.type??=o,i.portal??=r.getDefault(),c({...e,item:i}),i}function y(e){return o(e,\"portal-item\")}async function w(e,t,r){\"beforeSave\"in e&&\"function\"==typeof e.beforeSave&&await e.beforeSave();const a=e.write({},t);return await Promise.all(t.resources?.pendingOperations??[]),s(t,{errorName:\"layer-write:unsupported\"},r),a}function I(e){i(e,n.JSAPI),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter(((e,t,r)=>r.indexOf(e)===t)))}async function v(e,t,r){const a=e.portal;await a.signIn(),await a.user.addItem({item:e,data:t,folder:r?.folder})}async function P(e,r){const{layer:a,createItemData:o,createJSONContext:i,setItemProperties:n,saveResources:s,supplementalUnsupportedErrors:p}=e;await l(e),f(e);const m=a.portalItem,c=i?i(m):y(m),u=await w(a,c,{...r,supplementalUnsupportedErrors:p}),d=await o({layer:a,layerJSON:u},m);return await(n?.(a,m,d)),I(m),await m.update({data:d}),t(c),await(s?.(m,c)),m}async function $(e,r){const{layer:a,createItemData:o,createJSONContext:i,setItemProperties:n,saveResources:s,supplementalUnsupportedErrors:p}=e;await l(e);const m=d(e),c=i?i(m):y(m),u=await w(a,c,{...r,supplementalUnsupportedErrors:p}),f=await o({layer:a,layerJSON:u},m);return await n(a,m,f),I(m),await v(m,f,r),a.portalItem=m,t(c),await(s?.(m,c)),m}export{v as addItem,m as createErrorMessage,f as ensureItemConfig,p as ensureLayerConfig,w as getLayerJSON,d as getPortalItem,P as save,$ as saveAs,I as setCommonItemProperties};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}