{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from \"../../core/Error.js\";\nimport { allSettledErrors as t, throwIfAborted as r, eachAlways as o } from \"../../core/promiseUtils.js\";\nimport { generateUUID as s } from \"../../core/uuid.js\";\nimport { getSiblingOfSameTypeI as a, contentToBlob as c } from \"../../portal/support/resourceUtils.js\";\nasync function p(e, t, r) {\n  const o = await u(e, t, r);\n  await h(o, t, r);\n}\nasync function n(e, t, r, o, s) {\n  const a = await u(r, o, s);\n  await e.update({\n    data: t\n  }), await h(a, o, s);\n}\nasync function u(o, p, n) {\n  if (!p?.resources) return;\n  const u = p.portalItem === o.portalItem ? new Set(o.paths) : new Set();\n  o.paths.length = 0, o.portalItem = p.portalItem;\n  const h = new Set(p.resources.toKeep.map(e => e.resource.path)),\n    i = new Set(),\n    m = [];\n  h.forEach(e => {\n    u.delete(e), o.paths.push(e);\n  });\n  const f = [],\n    l = [],\n    w = [];\n  for (const e of p.resources.toUpdate) if (u.delete(e.resource.path), h.has(e.resource.path) || i.has(e.resource.path)) {\n    const {\n        resource: t,\n        content: r,\n        finish: p\n      } = e,\n      n = a(t, s());\n    o.paths.push(n.path), f.push({\n      resource: n,\n      content: await c(r),\n      compress: e.compress\n    }), p && w.push(() => p(n));\n  } else {\n    o.paths.push(e.resource.path), l.push({\n      resource: e.resource,\n      content: await c(e.content),\n      compress: e.compress\n    });\n    const t = e.finish;\n    t && w.push(() => t(e.resource)), i.add(e.resource.path);\n  }\n  for (const e of p.resources.toAdd) if (o.paths.push(e.resource.path), u.has(e.resource.path)) u.delete(e.resource.path);else {\n    f.push({\n      resource: e.resource,\n      content: await c(e.content),\n      compress: e.compress\n    });\n    const t = e.finish;\n    t && w.push(() => t(e.resource));\n  }\n  if (f.length || l.length) {\n    const {\n      addOrUpdateResources: e\n    } = await import(\"../../portal/support/resourceUtils.js\");\n    await e(p.portalItem, f, \"add\", n), await e(p.portalItem, l, \"update\", n);\n  }\n  if (w.forEach(e => e()), 0 === m.length) return u;\n  const d = await t(m);\n  if (r(n), d.length > 0) throw new e(\"save:resources\", \"Failed to save one or more resources\", {\n    errors: d\n  });\n  return u;\n}\nasync function h(e, t, r) {\n  if (!e || !t.portalItem) return;\n  const s = [];\n  for (const o of e) {\n    const e = t.portalItem.resourceFromPath(o);\n    s.push(e.portalItem.removeResource(e, r));\n  }\n  await o(s);\n}\nexport { p as saveResources, n as updateItemWithResources };","map":{"version":3,"names":["e","allSettledErrors","t","throwIfAborted","r","eachAlways","o","generateUUID","s","getSiblingOfSameTypeI","a","contentToBlob","c","p","u","h","n","update","data","resources","portalItem","Set","paths","length","toKeep","map","resource","path","i","m","forEach","delete","push","f","l","w","toUpdate","has","content","finish","compress","add","toAdd","addOrUpdateResources","d","errors","resourceFromPath","removeResource","saveResources","updateItemWithResources"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/webdoc/support/resourceUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import{allSettledErrors as t,throwIfAborted as r,eachAlways as o}from\"../../core/promiseUtils.js\";import{generateUUID as s}from\"../../core/uuid.js\";import{getSiblingOfSameTypeI as a,contentToBlob as c}from\"../../portal/support/resourceUtils.js\";async function p(e,t,r){const o=await u(e,t,r);await h(o,t,r)}async function n(e,t,r,o,s){const a=await u(r,o,s);await e.update({data:t}),await h(a,o,s)}async function u(o,p,n){if(!p?.resources)return;const u=p.portalItem===o.portalItem?new Set(o.paths):new Set;o.paths.length=0,o.portalItem=p.portalItem;const h=new Set(p.resources.toKeep.map((e=>e.resource.path))),i=new Set,m=[];h.forEach((e=>{u.delete(e),o.paths.push(e)}));const f=[],l=[],w=[];for(const e of p.resources.toUpdate)if(u.delete(e.resource.path),h.has(e.resource.path)||i.has(e.resource.path)){const{resource:t,content:r,finish:p}=e,n=a(t,s());o.paths.push(n.path),f.push({resource:n,content:await c(r),compress:e.compress}),p&&w.push((()=>p(n)))}else{o.paths.push(e.resource.path),l.push({resource:e.resource,content:await c(e.content),compress:e.compress});const t=e.finish;t&&w.push((()=>t(e.resource))),i.add(e.resource.path)}for(const e of p.resources.toAdd)if(o.paths.push(e.resource.path),u.has(e.resource.path))u.delete(e.resource.path);else{f.push({resource:e.resource,content:await c(e.content),compress:e.compress});const t=e.finish;t&&w.push((()=>t(e.resource)))}if(f.length||l.length){const{addOrUpdateResources:e}=await import(\"../../portal/support/resourceUtils.js\");await e(p.portalItem,f,\"add\",n),await e(p.portalItem,l,\"update\",n)}if(w.forEach((e=>e())),0===m.length)return u;const d=await t(m);if(r(n),d.length>0)throw new e(\"save:resources\",\"Failed to save one or more resources\",{errors:d});return u}async function h(e,t,r){if(!e||!t.portalItem)return;const s=[];for(const o of e){const e=t.portalItem.resourceFromPath(o);s.push(e.portalItem.removeResource(e,r))}await o(s)}export{p as saveResources,n as updateItemWithResources};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}