{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { isAbortError as e } from \"../../../../core/promiseUtils.js\";\nimport { StyleUpdateType as t } from \"./enums.js\";\nimport s from \"./WorkerTile.js\";\nimport r from \"./style/StyleRepository.js\";\nconst o = 25;\nclass i {\n  constructor() {\n    this._spriteInfo = {}, this._glyphInfo = {}, this._sourceDataMaxLOD = o;\n  }\n  reset() {\n    return this._spriteInfo = {}, this._glyphInfo = {}, Promise.resolve();\n  }\n  getLayers() {\n    return this._styleRepository?.layers ?? [];\n  }\n  async createTileAndParse(t, r) {\n    const {\n        key: o\n      } = t,\n      i = {};\n    for (const e of Object.keys(t.sourceName2DataAndRefKey)) {\n      const s = t.sourceName2DataAndRefKey[e];\n      i[e] = s.refKey;\n    }\n    const a = new s(o, i, this, this._styleRepository);\n    try {\n      return await a.parse({\n        ...t,\n        sourceDataMaxLOD: this._sourceDataMaxLOD\n      }, r);\n    } catch (n) {\n      if (a.setObsolete(), a.release(), !e(n)) throw n;\n      return null;\n    }\n  }\n  updateStyle(e) {\n    if (!e || 0 === e.length || !this._styleRepository) return;\n    const s = this._styleRepository;\n    for (const r of e) {\n      const e = r.type,\n        o = r.data;\n      switch (e) {\n        case t.PAINTER_CHANGED:\n          s.setPaintProperties(o.layer, o.paint);\n          break;\n        case t.LAYOUT_CHANGED:\n          s.setLayoutProperties(o.layer, o.layout);\n          break;\n        case t.LAYER_REMOVED:\n          s.deleteStyleLayer(o.layer);\n          break;\n        case t.LAYER_CHANGED:\n          s.setStyleLayer(o.layer, o.index);\n          break;\n        case t.SPRITES_CHANGED:\n          this._spriteInfo = {};\n      }\n    }\n  }\n  setStyle(e) {\n    const {\n      style: t,\n      sourceDataMaxLOD: s\n    } = e;\n    this._styleRepository = new r(t), this._sourceDataMaxLOD = s, this._spriteInfo = {}, this._glyphInfo = {};\n  }\n  fetchSprites(e, t, s) {\n    const r = [],\n      o = this._spriteInfo;\n    for (const i of e) {\n      void 0 === o[i.name] && r.push(i);\n    }\n    return 0 === r.length ? Promise.resolve() : t.invoke(\"getSprites\", r, {\n      signal: s?.signal\n    }).then(e => {\n      for (const t in e) {\n        const s = e[t];\n        o[t] = s;\n      }\n    });\n  }\n  getSpriteItems() {\n    return this._spriteInfo;\n  }\n  fetchGlyphs(e, t, s, r, o) {\n    const i = [];\n    let a = this._glyphInfo[t];\n    return a ? s.forEach(e => {\n      a[e] || i.push(e);\n    }) : (a = this._glyphInfo[t] = [], s.forEach(e => i.push(e))), 0 === i.length ? Promise.resolve() : r.invoke(\"getGlyphs\", {\n      tileID: e,\n      font: t,\n      codePoints: i\n    }, o).then(e => {\n      for (let t = 0; t < e.length; t++) e[t] && (a[t] = e[t]);\n    });\n  }\n  getGlyphItems(e) {\n    return this._glyphInfo[e];\n  }\n}\nexport { i as default };","map":{"version":3,"names":["isAbortError","e","StyleUpdateType","t","s","r","o","i","constructor","_spriteInfo","_glyphInfo","_sourceDataMaxLOD","reset","Promise","resolve","getLayers","_styleRepository","layers","createTileAndParse","key","Object","keys","sourceName2DataAndRefKey","refKey","a","parse","sourceDataMaxLOD","n","setObsolete","release","updateStyle","length","type","data","PAINTER_CHANGED","setPaintProperties","layer","paint","LAYOUT_CHANGED","setLayoutProperties","layout","LAYER_REMOVED","deleteStyleLayer","LAYER_CHANGED","setStyleLayer","index","SPRITES_CHANGED","setStyle","style","fetchSprites","name","push","invoke","signal","then","getSpriteItems","fetchGlyphs","forEach","tileID","font","codePoints","getGlyphItems","default"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/2d/engine/vectorTiles/WorkerTileHandler.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{isAbortError as e}from\"../../../../core/promiseUtils.js\";import{StyleUpdateType as t}from\"./enums.js\";import s from\"./WorkerTile.js\";import r from\"./style/StyleRepository.js\";const o=25;class i{constructor(){this._spriteInfo={},this._glyphInfo={},this._sourceDataMaxLOD=o}reset(){return this._spriteInfo={},this._glyphInfo={},Promise.resolve()}getLayers(){return this._styleRepository?.layers??[]}async createTileAndParse(t,r){const{key:o}=t,i={};for(const e of Object.keys(t.sourceName2DataAndRefKey)){const s=t.sourceName2DataAndRefKey[e];i[e]=s.refKey}const a=new s(o,i,this,this._styleRepository);try{return await a.parse({...t,sourceDataMaxLOD:this._sourceDataMaxLOD},r)}catch(n){if(a.setObsolete(),a.release(),!e(n))throw n;return null}}updateStyle(e){if(!e||0===e.length||!this._styleRepository)return;const s=this._styleRepository;for(const r of e){const e=r.type,o=r.data;switch(e){case t.PAINTER_CHANGED:s.setPaintProperties(o.layer,o.paint);break;case t.LAYOUT_CHANGED:s.setLayoutProperties(o.layer,o.layout);break;case t.LAYER_REMOVED:s.deleteStyleLayer(o.layer);break;case t.LAYER_CHANGED:s.setStyleLayer(o.layer,o.index);break;case t.SPRITES_CHANGED:this._spriteInfo={}}}}setStyle(e){const{style:t,sourceDataMaxLOD:s}=e;this._styleRepository=new r(t),this._sourceDataMaxLOD=s,this._spriteInfo={},this._glyphInfo={}}fetchSprites(e,t,s){const r=[],o=this._spriteInfo;for(const i of e){void 0===o[i.name]&&r.push(i)}return 0===r.length?Promise.resolve():t.invoke(\"getSprites\",r,{signal:s?.signal}).then((e=>{for(const t in e){const s=e[t];o[t]=s}}))}getSpriteItems(){return this._spriteInfo}fetchGlyphs(e,t,s,r,o){const i=[];let a=this._glyphInfo[t];return a?s.forEach((e=>{a[e]||i.push(e)})):(a=this._glyphInfo[t]=[],s.forEach((e=>i.push(e)))),0===i.length?Promise.resolve():r.invoke(\"getGlyphs\",{tileID:e,font:t,codePoints:i},o).then((e=>{for(let t=0;t<e.length;t++)e[t]&&(a[t]=e[t])}))}getGlyphItems(e){return this._glyphInfo[e]}}export{i as default};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}