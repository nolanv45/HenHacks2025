{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from \"../../../../Color.js\";\nimport \"../../../../core/has.js\";\nimport { deg2rad as t } from \"../../../../core/mathUtils.js\";\nimport { releaseMaybe as r } from \"../../../../core/maybe.js\";\nimport { isPromiseLike as o } from \"../../../../core/promiseUtils.js\";\nimport { normalFromMat4 as a, fromMat4 as n } from \"../../../../core/libs/gl-matrix-2/math/mat3.js\";\nimport { create as s } from \"../../../../core/libs/gl-matrix-2/factories/mat3f64.js\";\nimport { fromTranslation as i, multiply as l, invert as c, getTranslation as u } from \"../../../../core/libs/gl-matrix-2/math/mat4.js\";\nimport { create as m, IDENTITY as f, clone as p } from \"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";\nimport { ONES as h } from \"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";\nimport { i as d, g, h as x, t as _, q as T, n as b, b as y, f as v, d as w, e as M } from \"../../../../chunks/vec32.js\";\nimport { ZEROS as R, ONES as j, create as P } from \"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";\nimport { ONES as C } from \"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";\nimport { canProjectWithoutEngine as A } from \"../../../../geometry/projection.js\";\nimport { computeTranslationToOriginAndRotation as E } from \"../../../../geometry/projection/computeTranslationToOriginAndRotation.js\";\nimport { projectBuffer as O } from \"../../../../geometry/projection/projectBuffer.js\";\nimport { projectVectorToPoint as N } from \"../../../../geometry/projection/projectVectorToPoint.js\";\nimport { create as I, fromBuffer as S, intersectsClippingArea as U } from \"../../../../geometry/support/aaBoundingBox.js\";\nimport { newFloatArray as B } from \"../../../../geometry/support/FloatArray.js\";\nimport { getZeroIndexArray as F, getContinuousIndexArray as D } from \"../../../../geometry/support/Indices.js\";\nimport G from \"../../../../geometry/support/MeshComponent.js\";\nimport V from \"../../../../geometry/support/MeshMaterialMetallicRoughness.js\";\nimport L from \"../../../../geometry/support/MeshTextureTransform.js\";\nimport { isRelativeVertexSpace as $, isAbsoluteVertexSpace as H } from \"../../../../geometry/support/meshVertexSpaceUtils.js\";\nimport { equals as q, isPlateCarree as k } from \"../../../../geometry/support/spatialReferenceUtils.js\";\nimport { t as z } from \"../../../../chunks/vec3.js\";\nimport { transformNormal as W, transformVectorENUPlateCarree as Y, VectorType as J, transformVectorWMPlateCarree as K, projectNormalToPCPF as Q, transformTangent as X, projectTangentToPCPF as Z } from \"../../../../geometry/support/meshUtils/projection.js\";\nimport { projectMeshVertexPositions as ee } from \"../../../../geometry/support/meshUtils/projectMeshVertexPositions.js\";\nimport { makeDehydratedPoint as te } from \"../../../../layers/graphics/dehydratedPoint.js\";\nimport { MeshTransformUpdateAction as re } from \"../../../../layers/graphics/sources/interfaces.js\";\nimport { ViewingMode as oe } from \"../../../ViewingMode.js\";\nimport { isEncodedMeshTexture as ae } from \"../../glTF/internal/resourceUtils.js\";\nimport { getTransformMatrix as ne } from \"../../glTF/internal/TextureTransformUtils.js\";\nimport { perObjectElevationAligner as se } from \"./ElevationAligners.js\";\nimport { needsElevationUpdates3D as ie, evaluateElevationInfoAtPoint as le } from \"./elevationAlignmentUtils.js\";\nimport { Graphics3DMeshObject3DGraphicLayer as ce } from \"./Graphics3DMeshObject3DGraphicLayer.js\";\nimport { Object3DEdgeState as ue } from \"./Graphics3DObject3DGraphicLayer.js\";\nimport { Graphics3DSymbolLayer as me } from \"./Graphics3DSymbolLayer.js\";\nimport { MaterialInfoCache as fe, MeshFastUpdateProcessor as pe } from \"./MeshFastUpdateProcessor.js\";\nimport { createMaterial as he } from \"../support/edgeUtils.js\";\nimport { parseColorMixMode as de, encodeSymbolColor as ge } from \"../support/symbolColorUtils.js\";\nimport { debugFlags as xe } from \"../../support/debugFlags.js\";\nimport { Attribute as _e } from \"../../webgl-engine/lib/Attribute.js\";\nimport { AlphaDiscardMode as Te, CullFaceOptions as be } from \"../../webgl-engine/lib/basicInterfaces.js\";\nimport { ContentObjectType as ye } from \"../../webgl-engine/lib/ContentObjectType.js\";\nimport { Geometry as ve } from \"../../webgl-engine/lib/Geometry.js\";\nimport { Object3D as we } from \"../../webgl-engine/lib/Object3D.js\";\nimport { Texture as Me } from \"../../webgl-engine/lib/Texture.js\";\nimport { VertexAttribute as Re } from \"../../webgl-engine/lib/VertexAttribute.js\";\nimport { DefaultMaterial as je } from \"../../webgl-engine/materials/DefaultMaterial.js\";\nimport { NativeLineMaterial as Pe } from \"../../webgl-engine/materials/NativeLineMaterial.js\";\nimport { useSchematicPBR as Ce, advancedMRRFactors as Ae, schematicMRRFactors as Ee } from \"../../webgl-engine/materials/pbrUtils.js\";\nimport { TextureWrapMode as Oe } from \"../../../webgl/enums.js\";\nconst Ne = [\"mesh\"];\nclass Ie extends me {\n  constructor(e, t, r, o) {\n    super(e, t, r, o), this._materialInfoCache = new fe(), this._fastUpdateProcessor = new pe(), this._textures = new Map(), this.ensureDrapedStatus(!1);\n  }\n  async doLoad() {\n    xe.DRAW_MESH_GEOMETRY_NORMALS && (this._debugVertexNormalMaterial = new Pe({\n      color: [1, 0, 1, 1]\n    }), this._debugTangentNormalMaterial = new Pe({\n      color: [1, .5, 0, 1]\n    }), this._debugFaceNormalMaterial = new Pe({\n      color: [0, 1, 1, 1]\n    }));\n  }\n  destroy() {\n    super.destroy(), this._textures.forEach(e => e.unload()), this._context.stage.removeMany(this._materialInfoCache.materials), this._context.stage.removeMany(Array.from(this._textures.values())), this._materialInfoCache.clear(), this._textures.clear(), this._fastUpdateProcessor.destroy(this._context.stage);\n  }\n  get materials() {\n    return this._materialInfoCache.materials;\n  }\n  createGraphics3DGraphic(e) {\n    const t = e.graphic;\n    if (!this._validateGeometry(t.geometry, Ne, \"fill on mesh-3d\")) return null;\n    const r = this.setGraphicElevationContext(t),\n      o = e.renderingInfo;\n    return this._createAs3DShape(t, o, r, t.uid);\n  }\n  onRemoveGraphic(e) {\n    this._fastUpdateProcessor.onRemoveGraphic(e, this._materialInfoCache, this._context);\n  }\n  layerOpacityChanged(e, t) {\n    const r = this._getLayerOpacity();\n    this._updateMaterialParameters(e => {\n      e.material.setParameters({\n        layerOpacity: r\n      });\n      const t = e.material.parameters;\n      this._setMaterialTransparentParameter(t, e), e.material.setParameters({\n        transparent: t.transparent\n      });\n    }), e.forEach(e => t(e)?.layerOpacityChanged(r, this._context.isAsync));\n  }\n  layerElevationInfoChanged(e, t) {\n    return this.updateGraphics3DGraphicElevationInfo(e, t, ie);\n  }\n  slicePlaneEnabledChanged(e, t) {\n    return this._updateMaterialParameters(_ref => {\n      let {\n        material: e\n      } = _ref;\n      e.setParameters({\n        hasSlicePlane: this._context.slicePlaneEnabled\n      });\n    }), e.forEach(e => t(e)?.slicePlaneEnabledChanged(this._context.slicePlaneEnabled, this._context.isAsync)), !0;\n  }\n  physicalBasedRenderingChanged() {\n    const e = this._usePBR();\n    return this._updateMaterialParameters(_ref2 => {\n      let {\n        material: t\n      } = _ref2;\n      return t.setParameters({\n        usePBR: e\n      });\n    }), !0;\n  }\n  updateTransform(e, t, r, o) {\n    if (!e.fastTransformUpdatesAllowed) return !1;\n    const a = e.fastTransformUpdatesEnabled;\n    switch (o) {\n      case re.EnableFastUpdates:\n        if (a) return !0;\n        break;\n      case re.DisableFastUpdates:\n        if (!a) return !0;\n        break;\n      default:\n        if (!a) return !!this.updateTransform(e, t, r, re.EnableFastUpdates) && (e.autoDisableFastTransformUpdates(() => this.updateTransform(e, t, r, re.DisableFastUpdates)), !0);\n    }\n    const n = this._context.renderCoordsHelper.spatialReference,\n      s = at,\n      {\n        origin: i,\n        transform: l\n      } = r;\n    if (!E(t, d(Ze, i.x, i.y, i.z ?? 0), s, n)) return !1;\n    switch (o) {\n      case re.EnableFastUpdates:\n        this._fastUpdateProcessor.enable(e, this._materialInfoCache, this._context);\n        break;\n      case re.DisableFastUpdates:\n        this._fastUpdateProcessor.disable(e, this._materialInfoCache, this._context);\n        break;\n      case re.UpdateFastLocalOrigin:\n        e.updateFastLocalOrigin(s, l, this._context.localOriginFactory);\n    }\n    const {\n      elevationContext: c\n    } = e;\n    c.centerPointInElevationSR = this._getCenterPointInElevationSR(s);\n    const {\n        elevationProvider: u,\n        renderCoordsHelper: m\n      } = this._context,\n      f = (e, t) => le(e, u, c, m, t);\n    return e.alignedSampledElevation = se(e, c, u.spatialReference, f, m, s), e.updateTransform(s, l, this._context.isAsync), e.updateAutoDisableFastTransformUpdates(() => this.updateTransform(e, t, r, re.DisableFastUpdates)), !0;\n  }\n  _requiresSymbolVertexColors() {\n    return this._drivenProperties.color || this._drivenProperties.opacity;\n  }\n  _materialPropertiesDefault(e, t) {\n    const r = this._requiresSymbolVertexColors(),\n      o = !!e.vertexAttributes.color,\n      a = !!e.vertexAttributes.tangent;\n    return {\n      hasSymbolVertexColors: r,\n      hasVertexColors: o,\n      hasVertexTangents: a,\n      uid: `vc:${o},vt:${a},vct${t},svc:${r}`\n    };\n  }\n  _materialProperties(e, t, r) {\n    const o = this._materialPropertiesDefault(e, r);\n    if (!t.material) return o;\n    const {\n        color: a,\n        colorTexture: n,\n        colorTextureTransform: s,\n        normalTexture: i,\n        normalTextureTransform: l,\n        doubleSided: c,\n        alphaCutoff: u,\n        alphaMode: m\n      } = t.material,\n      f = Ye(a),\n      p = Ye(n),\n      h = Je(s),\n      d = Ye(i),\n      g = Je(l);\n    if (o.color = a, o.colorTexture = n, o.normalTexture = i, o.uid = `${o.uid},cmuid:${f},ctmuid:${p},cttuid:${h},ntmuid:${d},nttuid:${g},ds:${c},ac:${u},am:${m}`, t.material instanceof V) {\n      const {\n          metallic: e,\n          roughness: r,\n          metallicRoughnessTexture: a,\n          metallicRoughnessTextureTransform: n,\n          emissiveColor: i,\n          emissiveTexture: c,\n          emissiveTextureTransform: u,\n          occlusionTexture: m,\n          occlusionTextureTransform: f\n        } = t.material,\n        p = Ye(a),\n        h = Je(n),\n        d = Ye(i),\n        g = Ye(c),\n        x = Je(u),\n        _ = Ye(m),\n        T = Je(f);\n      o.metallic = e, o.roughness = r, o.metallicRoughnessTexture = a, o.emissiveColor = i, o.emissiveTexture = c, o.occlusionTexture = m, o.colorTextureTransform = $e(s), o.normalTextureTransform = $e(l), o.emissiveTextureTransform = $e(u), o.occlusionTextureTransform = $e(f), o.metallicRoughnessTextureTransform = $e(n), o.uid = `${o.uid},mrm:${e},mrr:${r},mrt:${p},mrtt:${h},emuid:${d},etmuid:${g},ett:${x},otmuid:${_},ott:${T}`;\n    }\n    return o;\n  }\n  _getInternalTexture(e) {\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Te.Opaque;\n    const a = We(e);\n    if (!a) return null;\n    const n = `${e.contentHash}/${t}`;\n    let s = this._textures.get(n);\n    if (s) {\n      const e = this._context.stage.renderView.textures;\n      let t = null;\n      const a = e.acquire(s.id);\n      return null == a || o(a) || (s.events.on(\"unloaded\", () => t = r(t)), t = a), s;\n    }\n    let i = null;\n    const l = this._context.stage.renderView.renderingContext.parameters.maxMaxAnisotropy,\n      c = {\n        wrap: He(e.wrap),\n        noUnpackFlip: !0,\n        maxAnisotropy: l,\n        mipmap: l > 1\n      };\n    return ae(a) ? (i = a.data, c.preMultiplyAlpha = !1, c.encoding = a.encoding) : (i = a, c.preMultiplyAlpha = t !== Te.Opaque, c.downsampleUncompressed = this._context.graphicsCoreOwner.view.qualitySettings.graphics3D.uncompressedTextureDownsamplingEnabled), s = new Me(i, c), this._textures.set(n, s), s.load(this._context.stage.renderView.renderingContext), this._context.stage.add(s), s.events.on(\"unloaded\", () => {\n      this._textures.delete(n);\n    }), s;\n  }\n  _setInternalMaterialTextureParameters(t, r) {\n    if (null != t.colorTexture) {\n      const e = this._getInternalTexture(t.colorTexture, r.textureAlphaMode);\n      e ? (r.textureId = e.id, r.textureAlphaPremultiplied = !!e.parameters.preMultiplyAlpha) : r.textureId = void 0;\n    }\n    t.normalTexture && (r.normalTextureId = this._getInternalTexture(t.normalTexture)?.id), t.emissiveColor && (r.emissiveFactor = e.toUnitRGB(t.emissiveColor)), t.emissiveTexture && (r.emissiveTextureId = this._getInternalTexture(t.emissiveTexture)?.id), t.occlusionTexture && (r.occlusionTextureId = this._getInternalTexture(t.occlusionTexture)?.id), t.metallicRoughnessTexture && (r.metallicRoughnessTextureId = this._getInternalTexture(t.metallicRoughnessTexture)?.id);\n  }\n  _setInternalMaterialParameters(e, t) {\n    null != e.color && ze(e.color, t), this._setInternalMaterialTextureParameters(e, t), t.colorTextureTransformMatrix = ne(e.colorTextureTransform), t.normalTextureTransformMatrix = ne(e.normalTextureTransform);\n    const r = null != e.normalTextureTransform?.scale ? e.normalTextureTransform?.scale : h;\n    t.scale = [r[0], r[1]], t.occlusionTextureTransformMatrix = ne(e.occlusionTextureTransform), t.emissiveTextureTransformMatrix = ne(e.emissiveTextureTransform), t.metallicRoughnessTextureTransformMatrix = ne(e.metallicRoughnessTextureTransform);\n  }\n  _setExternalMaterialParameters(t) {\n    let r = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.symbolLayer?.material?.color;\n    const o = this._drivenProperties.color;\n    let a = this.symbolLayer.material?.colorMixMode ?? null;\n    if (o) t.externalColor = C;else {\n      const o = r ?? null;\n      o ? t.externalColor = e.toUnitRGBA(o) : (a = null, t.externalColor = C);\n    }\n    a && (t.colorMixMode = a), t.castShadows = !!this.symbolLayer.castShadows;\n  }\n  _getOrCreateMaterial(t, r) {\n    const o = r.material?.color,\n      a = r.material?.colorTexture,\n      n = r.material?.alphaMode,\n      s = \"blend\" === n,\n      i = !(\"opaque\" === n) && (ke(t) || null != o && o.a < 1 || a?.transparent || s),\n      l = this._materialProperties(t, r, i),\n      c = this._materialInfoCache.byUid(l.uid);\n    if (c) return this._setInternalMaterialTextureParameters(l, c.material.parameters), c.material;\n    const u = {\n        uid: l.uid,\n        material: null,\n        isComponentTransparent: i,\n        alphaMode: r.material ? r.material.alphaMode : \"opaque\"\n      },\n      m = Ce({\n        normalTexture: l.normalTexture,\n        metallicRoughnessTexture: l.metallicRoughnessTexture,\n        metallicFactor: l.metallic,\n        roughnessFactor: l.roughness,\n        emissiveTexture: l.emissiveTexture,\n        emissiveFactor: e.toUnitRGB(l.emissiveColor),\n        occlusionTexture: l.occlusionTexture\n      }),\n      f = {\n        usePBR: this._usePBR(),\n        isSchematic: m,\n        hasVertexColors: l.hasVertexColors,\n        hasSymbolColors: l.hasSymbolVertexColors,\n        hasVertexTangents: l.hasVertexTangents,\n        ambient: R,\n        diffuse: j,\n        opacity: 1,\n        doubleSided: !0,\n        doubleSidedType: \"winding-order\",\n        cullFace: be.None,\n        layerOpacity: this._getLayerOpacity(),\n        hasSlicePlane: this._context.slicePlaneEnabled\n      };\n    f.mrrFactors = m ? Ee : [l.metallic, l.roughness, Ae[2]], r.material && (f.doubleSided = r.material.doubleSided, f.cullFace = r.material.doubleSided ? be.None : be.Back, f.textureAlphaCutoff = r.material.alphaCutoff), this._setExternalMaterialParameters(f), this._setMaterialTransparentParameter(f, u), this._setInternalMaterialParameters(l, f);\n    const p = new je(f, this._context);\n    return u.material = p, this._materialInfoCache.set(l.uid, u), this._context.stage.add(p), p;\n  }\n  prepareSymbolLayerPatch(e) {\n    if (\"partial\" !== e.diff.type) return;\n    const t = e.diff.diff;\n    this._preparePatchColor(e, t);\n  }\n  _preparePatchColor(e, t) {\n    if (!t.material || \"partial\" !== t.material.type) return;\n    const r = t.material.diff;\n    if (!r.color || \"complete\" !== r.color.type || null == r.color.newValue || null == r.color.oldValue) return;\n    const o = r.color.newValue;\n    delete r.color, e.symbolLayerStatePatches.push(() => {\n      this._updateMaterialParameters(e => {\n        const t = e.material.parameters;\n        this._setExternalMaterialParameters(t, o), this._setMaterialTransparentParameter(t, e), e.material.setParameters({\n          externalColor: t.externalColor,\n          transparent: t.transparent\n        });\n      });\n    });\n  }\n  _usePBR() {\n    return this._context.physicalBasedRenderingEnabled;\n  }\n  _setMaterialTransparentParameter(e, t) {\n    e.transparent = this.needsDrivenTransparentPass || t.isComponentTransparent || e.layerOpacity < 1 || e.opacity < 1 || e.externalColor && e.externalColor[3] < 1, \"auto\" === t.alphaMode ? e.textureAlphaMode = e.transparent ? Te.MaskBlend : Te.Opaque : e.textureAlphaMode = \"opaque\" === t.alphaMode ? Te.Opaque : \"mask\" === t.alphaMode ? Te.Mask : Te.Blend;\n  }\n  _createFaceDebugNormals(e, t) {\n    const r = t.length,\n      o = e.spatialReference.isGeographic ? 20015077 / 180 : 1,\n      n = .1 * Math.max(e.extent.width * o, e.extent.height * o, e.extent.zmax - e.extent.zmin),\n      i = [],\n      l = [],\n      c = t[0].transformation,\n      u = a(s(), c);\n    for (let a = 0; a < r; a++) {\n      const e = t[a].attributes.get(Re.POSITION);\n      if (!e) continue;\n      const r = e.data,\n        o = e.indices;\n      for (let t = 0; t < o.length; t += 3) Le(r, o, t, rt), Ve(r, o, t, Ze, et, tt), g(Ze, Ze, et), g(Ze, Ze, tt), x(Ze, Ze, 1 / 3), _(Ze, Ze, c), i.push(...Ze), T(rt, rt, u), b(rt, rt), y(Ze, Ze, rt, n), i.push(...Ze), l.push(l.length), l.push(l.length);\n    }\n    return i.length ? new ve(this._debugFaceNormalMaterial, [[Re.POSITION, new _e(i, l, 3, !0)]], null, ye.Line) : null;\n  }\n  _createPerVertexDebugVectors(e, t, r, o, i) {\n    const l = t.length,\n      c = e.spatialReference.isGeographic ? 20015077 / 180 : 1,\n      u = .1 * i * Math.max(e.extent.width * c, e.extent.height * c, e.extent.zmax - e.extent.zmin),\n      m = [],\n      f = [],\n      p = t[0].transformation,\n      h = a(s(), p);\n    r === Re.TANGENT && n(h, p);\n    for (let a = 0; a < l; a++) {\n      const e = t[a],\n        o = e.attributes.get(Re.POSITION),\n        n = e.attributes.get(r);\n      if (!o || !n) continue;\n      const s = o.data,\n        i = o.indices,\n        l = n.data,\n        c = n.indices;\n      for (let t = 0; t < i.length; t++) {\n        const e = 3 * i[t],\n          r = c[t] * n.stride;\n        d(Ze, s[e + 0], s[e + 1], s[e + 2]), _(Ze, Ze, p), m.push(...Ze), d(et, l[r + 0], l[r + 1], l[r + 2]), T(et, et, h), b(et, et), y(Ze, Ze, et, u), m.push(...Ze), f.push(f.length), f.push(f.length);\n      }\n    }\n    return m.length ? new ve(o, [[Re.POSITION, new _e(m, f, 3, !0)]], null, ye.Line) : null;\n  }\n  _createAs3DShape(e, t, r, o) {\n    const a = e.geometry;\n    if (\"mesh\" !== a.type) return null;\n    const n = this._createGeometryInfo(a, t, o);\n    if (null == n) return null;\n    const {\n      geometries: s,\n      objectTransformation: i\n    } = n;\n    if (xe.DRAW_MESH_GEOMETRY_NORMALS) {\n      const e = this._createPerVertexDebugVectors(a, s, Re.NORMAL, this._debugVertexNormalMaterial, 1),\n        t = this._createPerVertexDebugVectors(a, s, Re.TANGENT, this._debugTangentNormalMaterial, .5),\n        r = this._createFaceDebugNormals(a, s);\n      e && s.push(e), t && s.push(t), r && s.push(r);\n    }\n    const l = new we({\n      geometries: s,\n      layerUid: this._context.layer.uid,\n      graphicUid: o,\n      isElevationSource: !0\n    });\n    l.transformation = i;\n    const c = he(this.symbolLayer, {\n        opacity: this._getLayerOpacity()\n      }),\n      u = c ? new ue(s[0].material, c, this._context.slicePlaneEnabled) : null,\n      m = new ce(this, l, s, null, null, se, r, u);\n    this._fastUpdateProcessor.onAddGraphic(), m.needsElevationUpdates = ie(r.mode), m.useObjectOriginAsAttachmentOrigin = !0, m.fastTransformUpdatesAllowed = this._fastTransformUpdatesAllowed(a), r.centerPointInElevationSR = this._getCenterPointInElevationSR(l.transformation);\n    const {\n        elevationProvider: f,\n        renderCoordsHelper: p\n      } = this._context,\n      h = (e, t) => le(e, f, r, p, t);\n    return m.alignedSampledElevation = se(m, r, f.spatialReference, h, p), m;\n  }\n  _fastTransformUpdatesAllowed(e) {\n    const {\n      vertexSpace: t,\n      spatialReference: r\n    } = e;\n    if (!$(t)) return !1;\n    const {\n        type: o\n      } = t,\n      {\n        view: a\n      } = this._context.graphicsCoreOwner,\n      {\n        viewingMode: n\n      } = a.state,\n      s = a.spatialReference;\n    return n === oe.Global && \"local\" === o || n === oe.Local && q(s, r) && \"georeferenced\" === o && !r.isGeographic;\n  }\n  _getCenterPointInElevationSR(e) {\n    const t = te(0, 0, 0, this._context.elevationProvider.spatialReference ?? null);\n    return N([e[12], e[13], e[14]], this._context.renderCoordsHelper.spatialReference, t), t;\n  }\n  _passthroughReprojectionInfo(e) {\n    return e.reprojection === it.NONE && !!e.objectTransformation;\n  }\n  _createPositionBuffer(e, t) {\n    const r = e.vertexAttributes.position;\n    let o,\n      a = r;\n    if (t.reprojection === it.NONE) return {\n      position: a,\n      georeferencedPositionBuffer: o\n    };\n    const n = t.reprojection === it.RENDER ? t.transformBeforeProject : null;\n    n && (a = z(new Float64Array(a.length), a, n));\n    const {\n      normal: s,\n      tangent: i\n    } = e.vertexAttributes;\n    this._passthroughReprojectionInfo(t) || !s && !i || (o = a);\n    const l = a === r || a === o ? new Float64Array(a.length) : a;\n    return O(a, e.spatialReference, 0, l, this._context.renderCoordsHelper.spatialReference, 0), {\n      position: l,\n      georeferencedPositionBuffer: o\n    };\n  }\n  _createNormalBuffer(e, t, r, o) {\n    const a = e.vertexAttributes.normal;\n    if (null == a) return null;\n    let n = a;\n    const s = o.reprojection === it.RENDER ? o.transformBeforeProject : null;\n    s && (n = W(n, new Float32Array(n.length), s));\n    const i = this._context.graphicsCoreOwner.view.viewingMode;\n    if (o.reprojection === it.NONE) return n;\n    if (\"local\" === i) {\n      if (!k(this._context.renderCoordsHelper.spatialReference)) return n;\n      if (null == r) return null;\n      if (e.spatialReference.isGeographic) {\n        const e = n === a ? new Float32Array(n.length) : n;\n        return Y(n, J.NORMAL, r, e);\n      }\n      if (e.spatialReference.isWebMercator) {\n        const e = n === a ? new Float32Array(n.length) : n;\n        return K(n, J.NORMAL, r, e);\n      }\n      return n;\n    }\n    if (null == r) return null;\n    const l = n === a ? new Float32Array(n.length) : n,\n      c = this._context.renderCoordsHelper.spatialReference;\n    return Q(n, r, e.spatialReference, t, c, l);\n  }\n  _createTangentBuffer(e, t, r, o) {\n    const a = e.vertexAttributes.tangent;\n    if (null == a) return null;\n    let n = a;\n    const s = o.reprojection === it.RENDER ? o.transformBeforeProject : null;\n    s && (n = X(n, new Float32Array(n.length), s));\n    const i = this._context.graphicsCoreOwner.view.viewingMode;\n    if (o.reprojection === it.NONE) return n;\n    if (\"local\" === i) {\n      if (!k(this._context.renderCoordsHelper.spatialReference)) return n;\n      if (null == r) return null;\n      if (e.spatialReference.isGeographic) {\n        const e = n === a ? new Float32Array(n.length) : n;\n        return Y(n, J.TANGENT, r, e);\n      }\n      if (e.spatialReference.isWebMercator) {\n        const e = n === a ? new Float32Array(n.length) : n;\n        return K(n, J.TANGENT, r, e);\n      }\n      return n;\n    }\n    if (null == r) return null;\n    const l = n === a ? new Float32Array(n.length) : n,\n      c = this._context.renderCoordsHelper.spatialReference;\n    return Z(n, r, e.spatialReference, t, c, l);\n  }\n  _createSymbolColorBuffer(e) {\n    if (this._requiresSymbolVertexColors()) {\n      const t = this._getVertexOpacityAndColor(e),\n        r = de(this.symbolLayer?.material?.colorMixMode),\n        o = new Uint8Array(4);\n      return ge(t, r, o), o;\n    }\n    return null;\n  }\n  _createBuffers(e, t) {\n    const r = e.vertexAttributes && e.vertexAttributes.position;\n    if (!r) return this.logger.warn(\"Mesh geometry must contain position vertex attributes\"), null;\n    const o = e.vertexAttributes.normal,\n      a = e.vertexAttributes.uv,\n      n = e.vertexAttributes.tangent;\n    if (o && o.length !== r.length) return this.logger.warn(\"Mesh normal vertex buffer must contain the same number of elements as the position buffer\"), null;\n    if (n && n.length / 4 != r.length / 3) return this.logger.warn(\"Mesh tangent vertex buffer must contain the same number of elements as the position buffer\"), null;\n    if (a && a.length / 2 != r.length / 3) return this.logger.warn(\"Mesh uv vertex buffer must contain the same number of elements as the position buffer\"), null;\n    const s = this._computeReprojectionInfo(e),\n      {\n        position: i,\n        georeferencedPositionBuffer: l\n      } = this._createPositionBuffer(e, s),\n      c = Ke(e),\n      u = this._createSymbolColorBuffer(t),\n      f = this._createNormalBuffer(e, i, l, s),\n      p = this._createTangentBuffer(e, i, l, s),\n      h = a,\n      {\n        transformation: d,\n        position: g,\n        normal: x,\n        tangent: _\n      } = this._passthroughReprojectionInfo(s) ? {\n        transformation: s.objectTransformation,\n        position: i,\n        normal: f,\n        tangent: p\n      } : this._transformOriginLocal(e, i, f, p);\n    return {\n      positionBuffer: g,\n      normalBuffer: x,\n      tangentBuffer: _,\n      uvBuffer: h,\n      colorBuffer: c,\n      symbolColorBuffer: u,\n      objectTransformation: d,\n      geometryTransformation: s.reprojection === it.NONE && s.geometryTransformation ? s.geometryTransformation : m()\n    };\n  }\n  _computeReprojectionInfo(e) {\n    const {\n        vertexSpace: t\n      } = e,\n      r = \"georeferenced\" === t.type ? q(this._context.renderCoordsHelper.spatialReference, e.spatialReference) ? it.NONE : it.RENDER : it.NONE;\n    if (H(t)) return {\n      reprojection: r\n    };\n    const o = t.origin,\n      a = m(),\n      n = e.transform?.localMatrix ?? f;\n    if (r === it.NONE) {\n      E(e.spatialReference, o, a, this._context.renderCoordsHelper.spatialReference);\n      return {\n        reprojection: r,\n        objectTransformation: a,\n        geometryTransformation: p(n)\n      };\n    }\n    const s = i(m(), o);\n    return l(s, s, n), {\n      reprojection: r,\n      transformBeforeProject: s\n    };\n  }\n  _transformOriginLocal(e, t, r, o) {\n    const a = this._context.renderCoordsHelper.spatialReference,\n      n = e.origin;\n    Xe[0] = n.x, Xe[1] = n.y, Xe[2] = n.z ?? 0;\n    const s = m();\n    E(e.spatialReference, Xe, s, a), c(ot, s);\n    const {\n        position: i,\n        normal: l,\n        tangent: u\n      } = e.vertexAttributes,\n      f = t === i ? new Float64Array(t.length) : t;\n    z(f, t, ot);\n    const p = r ? r === l ? new Float32Array(r.length) : r : null,\n      h = o ? o === u ? new Float32Array(o.length) : o : null;\n    return r && p && W(r, p, ot), o && h && X(o, h, ot), {\n      transformation: s,\n      position: f,\n      normal: p,\n      tangent: h\n    };\n  }\n  _validateFaces(e, t) {\n    const r = e.vertexAttributes.position.length / 3,\n      o = t.faces;\n    if (o) {\n      let e = -1;\n      for (let t = 0; t < o.length; t++) {\n        const r = o[t];\n        r > e && (e = r);\n      }\n      if (r <= e) return this.logger.warn(`Vertex index ${e} is out of bounds of the mesh position buffer`), !1;\n    } else if (r % 3 != 0) return this.logger.warn(\"Mesh position buffer length must be a multiple of 9 if no component faces are defined (3 values per vertex * 3 vertices per triangle)\"), !1;\n    return !0;\n  }\n  _isOutsideClippingArea(e) {\n    if (!this._context.clippingExtent) return !1;\n    const t = e.vertexAttributes?.position;\n    if (!t) return !1;\n    const r = this._context.elevationProvider.spatialReference,\n      o = ee(e, r ?? e.spatialReference);\n    return !!o && (S(o, nt), !U(nt, this._context.clippingExtent));\n  }\n  _createGeometryInfo(e, t, r) {\n    if (!A(e.spatialReference, this._context.renderCoordsHelper.spatialReference)) return this.logger.warn(\"Geometry spatial reference is not compatible with the view\"), null;\n    if (!this._validateVertexSpace(e)) return null;\n    if (this._isOutsideClippingArea(e)) return null;\n    const o = this._createBuffers(e, t);\n    if (null == o) return null;\n    const {\n        positionBuffer: a,\n        uvBuffer: n,\n        colorBuffer: s,\n        symbolColorBuffer: i,\n        normalBuffer: l,\n        tangentBuffer: c,\n        objectTransformation: m,\n        geometryTransformation: f\n      } = o,\n      p = e.components ?? st,\n      h = new Array();\n    let d = !1;\n    const g = u(Ze, m),\n      x = this._context.localOriginFactory.getOrigin(g);\n    for (const u of p) {\n      if (!this._validateFaces(e, u)) return null;\n      const t = Ue(e, u);\n      if (0 === t.length) continue;\n      const o = Be(a, l, u, t);\n      o.didFlipNormals && (d = !0);\n      const m = [[Re.POSITION, new _e(a, t, 3, !0)], [Re.NORMAL, new _e(o.normals, o.indices, 3, !0)]];\n      s && m.push([Re.COLOR, new _e(s, t, 4, !0)]), i && m.push([Re.SYMBOLCOLOR, new _e(i, F(t.length), 4, !0)]), n && m.push([Re.UV0, new _e(n, t, 2, !0)]), c && m.push([Re.TANGENT, new _e(c, t, 4, !0)]);\n      const p = this._context.stage.renderView.getObjectAndLayerIdColor({\n          graphicUid: r,\n          layerUid: this._context.layer.uid\n        }),\n        g = this._getOrCreateMaterial(e, u),\n        _ = new ve(g, m, null, ye.Mesh, p);\n      _.transformation = f, _.localOrigin = x, h.push(_);\n    }\n    return d && this.logger.warn(\"Normals have been automatically flipped to be consistent with the counter clock wise face winding order. It is better to generate mesh geometries that have consistent normals.\"), {\n      geometries: h,\n      objectTransformation: m\n    };\n  }\n  _updateMaterialParameters(e) {\n    this._materialInfoCache.forEachMaterialInfo(e), this._fastUpdateProcessor.forEachMaterialInfo(e), this._fastUpdateProcessor.forEachClonedMaterial((e, t) => {\n      t.setParameters(e.parameters);\n    });\n  }\n  _validateVertexSpace(e) {\n    const {\n        _context: {\n          graphicsCoreOwner: {\n            view: {\n              state: {\n                viewingMode: t\n              }\n            }\n          }\n        }\n      } = this,\n      {\n        vertexSpace: r\n      } = e;\n    return t !== oe.Local || \"local\" !== r.type || (this.logger.warn(\"Displaying a mesh with a local vertex space in a view in local viewing mode is not supported.\"), !1);\n  }\n  test() {\n    return {\n      ...super.test(),\n      materials: this._materialInfoCache.materials\n    };\n  }\n}\nclass Se {\n  constructor(e, t, r) {\n    this.normals = e, this.indices = t, this.didFlipNormals = r;\n  }\n}\nfunction Ue(e, t) {\n  return t.faces ?? D(e.vertexAttributes.position.length / 3);\n}\nfunction Be(e, t, r, o) {\n  switch (r.shading || \"flat\") {\n    default:\n    case \"source\":\n      return De(e, t, r, o);\n    case \"flat\":\n      return Fe(e, o);\n    case \"smooth\":\n      return Ge(e, o);\n  }\n}\nfunction Fe(e, t) {\n  const r = B(t.length),\n    o = new Array(3 * t.length);\n  for (let a = 0; a < t.length; a += 3) {\n    const n = Le(e, t, a, rt);\n    for (let e = 0; e < 3; e++) r[a + e] = n[e], o[a + e] = a / 3;\n  }\n  return new Se(r, o, !1);\n}\nfunction De(e, t, r, o) {\n  if (null == t) return Fe(e, o);\n  let a = !1;\n  if (!r.trustSourceNormals) for (let n = 0; n < o.length; n += 3) {\n    Le(e, o, n, rt);\n    for (let e = 0; e < 3; e++) {\n      const r = 3 * o[n + e];\n      Ze[0] = t[r], Ze[1] = t[r + 1], Ze[2] = t[r + 2], v(rt, Ze) < 0 && (t[r] = -t[r], t[r + 1] = -t[r + 1], t[r + 2] = -t[r + 2], a = !0);\n    }\n  }\n  return new Se(t, o, a);\n}\nfunction Ge(e, t) {\n  const r = {};\n  for (let n = 0; n < t.length; n += 3) {\n    const o = Le(e, t, n, rt);\n    for (let e = 0; e < 3; e++) {\n      const a = t[n + e];\n      let s = r[a];\n      s || (s = {\n        normal: P(),\n        count: 0\n      }, r[a] = s), g(s.normal, s.normal, o), s.count++;\n    }\n  }\n  const o = B(3 * t.length),\n    a = new Array(3 * t.length);\n  for (let n = 0; n < t.length; n++) {\n    const e = r[t[n]];\n    1 !== e.count && (b(e.normal, e.normal), e.count = 1);\n    for (let t = 0; t < 3; t++) o[3 * n + t] = e.normal[t];\n    a[n] = n;\n  }\n  return new Se(o, a, !1);\n}\nfunction Ve(e, t, r, o, a, n) {\n  const s = 3 * t[r],\n    i = 3 * t[r + 1],\n    l = 3 * t[r + 2];\n  o[0] = e[s], o[1] = e[s + 1], o[2] = e[s + 2], a[0] = e[i], a[1] = e[i + 1], a[2] = e[i + 2], n[0] = e[l], n[1] = e[l + 1], n[2] = e[l + 2];\n}\nfunction Le(e, t, r, o) {\n  return Ve(e, t, r, Ze, et, tt), w(et, et, Ze), w(tt, tt, Ze), M(Ze, et, tt), b(o, Ze), o;\n}\nfunction $e(e) {\n  if (!e) return null;\n  const {\n    scale: r,\n    offset: o,\n    rotation: a\n  } = e;\n  return {\n    scale: r,\n    offset: o,\n    rotation: t(a)\n  };\n}\nfunction He() {\n  let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"repeat\";\n  if (\"string\" == typeof e) {\n    const t = qe(e);\n    return {\n      s: t,\n      t\n    };\n  }\n  return {\n    s: qe(e.horizontal),\n    t: qe(e.vertical)\n  };\n}\nfunction qe(e) {\n  switch (e) {\n    case \"clamp\":\n      return Oe.CLAMP_TO_EDGE;\n    case \"mirror\":\n      return Oe.MIRRORED_REPEAT;\n    default:\n      return Oe.REPEAT;\n  }\n}\nfunction ke(e) {\n  const t = e.vertexAttributes.color;\n  if (null == t) return !1;\n  for (let r = 3; r < t.length; r += 4) if (255 !== t[r]) return !0;\n  return !1;\n}\nfunction ze(t, r) {\n  r.diffuse = e.toUnitRGB(t), r.opacity = t.a;\n}\nfunction We(e) {\n  return e.data ?? e.url;\n}\nfunction Ye(t) {\n  return null == t ? \"-\" : t instanceof e ? t.toHex() : t.contentHash;\n}\nfunction Je(e) {\n  const {\n    offset: t,\n    scale: r,\n    rotation: o\n  } = e ?? Qe;\n  return `${t[0]},${t[1]},${o},${r[0]},${r[1]}`;\n}\nfunction Ke(e) {\n  return e.vertexAttributes.color;\n}\nconst Qe = new L(),\n  Xe = P(),\n  Ze = P(),\n  et = P(),\n  tt = P(),\n  rt = P(),\n  ot = m(),\n  at = m(),\n  nt = I(),\n  st = [new G()];\nvar it;\n!function (e) {\n  e[e.NONE = 0] = \"NONE\", e[e.RENDER = 1] = \"RENDER\";\n}(it || (it = {}));\nexport { Ie as Graphics3DMeshFillSymbolLayer };","map":{"version":3,"names":["e","deg2rad","t","releaseMaybe","r","isPromiseLike","o","normalFromMat4","a","fromMat4","n","create","s","fromTranslation","i","multiply","l","invert","c","getTranslation","u","m","IDENTITY","f","clone","p","ONES","h","d","g","x","_","q","T","b","y","v","w","M","ZEROS","R","j","P","C","canProjectWithoutEngine","A","computeTranslationToOriginAndRotation","E","projectBuffer","O","projectVectorToPoint","N","I","fromBuffer","S","intersectsClippingArea","U","newFloatArray","B","getZeroIndexArray","F","getContinuousIndexArray","D","G","V","L","isRelativeVertexSpace","$","isAbsoluteVertexSpace","H","equals","isPlateCarree","k","z","transformNormal","W","transformVectorENUPlateCarree","Y","VectorType","J","transformVectorWMPlateCarree","K","projectNormalToPCPF","Q","transformTangent","X","projectTangentToPCPF","Z","projectMeshVertexPositions","ee","makeDehydratedPoint","te","MeshTransformUpdateAction","re","ViewingMode","oe","isEncodedMeshTexture","ae","getTransformMatrix","ne","perObjectElevationAligner","se","needsElevationUpdates3D","ie","evaluateElevationInfoAtPoint","le","Graphics3DMeshObject3DGraphicLayer","ce","Object3DEdgeState","ue","Graphics3DSymbolLayer","me","MaterialInfoCache","fe","MeshFastUpdateProcessor","pe","createMaterial","he","parseColorMixMode","de","encodeSymbolColor","ge","debugFlags","xe","Attribute","_e","AlphaDiscardMode","Te","CullFaceOptions","be","ContentObjectType","ye","Geometry","ve","Object3D","we","Texture","Me","VertexAttribute","Re","DefaultMaterial","je","NativeLineMaterial","Pe","useSchematicPBR","Ce","advancedMRRFactors","Ae","schematicMRRFactors","Ee","TextureWrapMode","Oe","Ne","Ie","constructor","_materialInfoCache","_fastUpdateProcessor","_textures","Map","ensureDrapedStatus","doLoad","DRAW_MESH_GEOMETRY_NORMALS","_debugVertexNormalMaterial","color","_debugTangentNormalMaterial","_debugFaceNormalMaterial","destroy","forEach","unload","_context","stage","removeMany","materials","Array","from","values","clear","createGraphics3DGraphic","graphic","_validateGeometry","geometry","setGraphicElevationContext","renderingInfo","_createAs3DShape","uid","onRemoveGraphic","layerOpacityChanged","_getLayerOpacity","_updateMaterialParameters","material","setParameters","layerOpacity","parameters","_setMaterialTransparentParameter","transparent","isAsync","layerElevationInfoChanged","updateGraphics3DGraphicElevationInfo","slicePlaneEnabledChanged","_ref","hasSlicePlane","slicePlaneEnabled","physicalBasedRenderingChanged","_usePBR","_ref2","usePBR","updateTransform","fastTransformUpdatesAllowed","fastTransformUpdatesEnabled","EnableFastUpdates","DisableFastUpdates","autoDisableFastTransformUpdates","renderCoordsHelper","spatialReference","at","origin","transform","Ze","enable","disable","UpdateFastLocalOrigin","updateFastLocalOrigin","localOriginFactory","elevationContext","centerPointInElevationSR","_getCenterPointInElevationSR","elevationProvider","alignedSampledElevation","updateAutoDisableFastTransformUpdates","_requiresSymbolVertexColors","_drivenProperties","opacity","_materialPropertiesDefault","vertexAttributes","tangent","hasSymbolVertexColors","hasVertexColors","hasVertexTangents","_materialProperties","colorTexture","colorTextureTransform","normalTexture","normalTextureTransform","doubleSided","alphaCutoff","alphaMode","Ye","Je","metallic","roughness","metallicRoughnessTexture","metallicRoughnessTextureTransform","emissiveColor","emissiveTexture","emissiveTextureTransform","occlusionTexture","occlusionTextureTransform","$e","_getInternalTexture","arguments","length","undefined","Opaque","We","contentHash","get","renderView","textures","acquire","id","events","on","renderingContext","maxMaxAnisotropy","wrap","He","noUnpackFlip","maxAnisotropy","mipmap","data","preMultiplyAlpha","encoding","downsampleUncompressed","graphicsCoreOwner","view","qualitySettings","graphics3D","uncompressedTextureDownsamplingEnabled","set","load","add","delete","_setInternalMaterialTextureParameters","textureAlphaMode","textureId","textureAlphaPremultiplied","normalTextureId","emissiveFactor","toUnitRGB","emissiveTextureId","occlusionTextureId","metallicRoughnessTextureId","_setInternalMaterialParameters","ze","colorTextureTransformMatrix","normalTextureTransformMatrix","scale","occlusionTextureTransformMatrix","emissiveTextureTransformMatrix","metallicRoughnessTextureTransformMatrix","_setExternalMaterialParameters","symbolLayer","colorMixMode","externalColor","toUnitRGBA","castShadows","_getOrCreateMaterial","ke","byUid","isComponentTransparent","metallicFactor","roughnessFactor","isSchematic","hasSymbolColors","ambient","diffuse","doubleSidedType","cullFace","None","mrrFactors","Back","textureAlphaCutoff","prepareSymbolLayerPatch","diff","type","_preparePatchColor","newValue","oldValue","symbolLayerStatePatches","push","physicalBasedRenderingEnabled","needsDrivenTransparentPass","MaskBlend","Mask","Blend","_createFaceDebugNormals","isGeographic","Math","max","extent","width","height","zmax","zmin","transformation","attributes","POSITION","indices","Le","rt","Ve","et","tt","Line","_createPerVertexDebugVectors","TANGENT","stride","_createGeometryInfo","geometries","objectTransformation","NORMAL","layerUid","layer","graphicUid","isElevationSource","onAddGraphic","needsElevationUpdates","mode","useObjectOriginAsAttachmentOrigin","_fastTransformUpdatesAllowed","vertexSpace","viewingMode","state","Global","Local","_passthroughReprojectionInfo","reprojection","it","NONE","_createPositionBuffer","position","georeferencedPositionBuffer","RENDER","transformBeforeProject","Float64Array","normal","_createNormalBuffer","Float32Array","isWebMercator","_createTangentBuffer","_createSymbolColorBuffer","_getVertexOpacityAndColor","Uint8Array","_createBuffers","logger","warn","uv","_computeReprojectionInfo","Ke","_transformOriginLocal","positionBuffer","normalBuffer","tangentBuffer","uvBuffer","colorBuffer","symbolColorBuffer","geometryTransformation","localMatrix","Xe","ot","_validateFaces","faces","_isOutsideClippingArea","clippingExtent","nt","_validateVertexSpace","components","st","getOrigin","Ue","Be","didFlipNormals","normals","COLOR","SYMBOLCOLOR","UV0","getObjectAndLayerIdColor","Mesh","localOrigin","forEachMaterialInfo","forEachClonedMaterial","test","Se","shading","De","Fe","Ge","trustSourceNormals","count","offset","rotation","qe","horizontal","vertical","CLAMP_TO_EDGE","MIRRORED_REPEAT","REPEAT","url","toHex","Qe","Graphics3DMeshFillSymbolLayer"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DMeshFillSymbolLayer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from\"../../../../Color.js\";import\"../../../../core/has.js\";import{deg2rad as t}from\"../../../../core/mathUtils.js\";import{releaseMaybe as r}from\"../../../../core/maybe.js\";import{isPromiseLike as o}from\"../../../../core/promiseUtils.js\";import{normalFromMat4 as a,fromMat4 as n}from\"../../../../core/libs/gl-matrix-2/math/mat3.js\";import{create as s}from\"../../../../core/libs/gl-matrix-2/factories/mat3f64.js\";import{fromTranslation as i,multiply as l,invert as c,getTranslation as u}from\"../../../../core/libs/gl-matrix-2/math/mat4.js\";import{create as m,IDENTITY as f,clone as p}from\"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{ONES as h}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{i as d,g,h as x,t as _,q as T,n as b,b as y,f as v,d as w,e as M}from\"../../../../chunks/vec32.js\";import{ZEROS as R,ONES as j,create as P}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{ONES as C}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{canProjectWithoutEngine as A}from\"../../../../geometry/projection.js\";import{computeTranslationToOriginAndRotation as E}from\"../../../../geometry/projection/computeTranslationToOriginAndRotation.js\";import{projectBuffer as O}from\"../../../../geometry/projection/projectBuffer.js\";import{projectVectorToPoint as N}from\"../../../../geometry/projection/projectVectorToPoint.js\";import{create as I,fromBuffer as S,intersectsClippingArea as U}from\"../../../../geometry/support/aaBoundingBox.js\";import{newFloatArray as B}from\"../../../../geometry/support/FloatArray.js\";import{getZeroIndexArray as F,getContinuousIndexArray as D}from\"../../../../geometry/support/Indices.js\";import G from\"../../../../geometry/support/MeshComponent.js\";import V from\"../../../../geometry/support/MeshMaterialMetallicRoughness.js\";import L from\"../../../../geometry/support/MeshTextureTransform.js\";import{isRelativeVertexSpace as $,isAbsoluteVertexSpace as H}from\"../../../../geometry/support/meshVertexSpaceUtils.js\";import{equals as q,isPlateCarree as k}from\"../../../../geometry/support/spatialReferenceUtils.js\";import{t as z}from\"../../../../chunks/vec3.js\";import{transformNormal as W,transformVectorENUPlateCarree as Y,VectorType as J,transformVectorWMPlateCarree as K,projectNormalToPCPF as Q,transformTangent as X,projectTangentToPCPF as Z}from\"../../../../geometry/support/meshUtils/projection.js\";import{projectMeshVertexPositions as ee}from\"../../../../geometry/support/meshUtils/projectMeshVertexPositions.js\";import{makeDehydratedPoint as te}from\"../../../../layers/graphics/dehydratedPoint.js\";import{MeshTransformUpdateAction as re}from\"../../../../layers/graphics/sources/interfaces.js\";import{ViewingMode as oe}from\"../../../ViewingMode.js\";import{isEncodedMeshTexture as ae}from\"../../glTF/internal/resourceUtils.js\";import{getTransformMatrix as ne}from\"../../glTF/internal/TextureTransformUtils.js\";import{perObjectElevationAligner as se}from\"./ElevationAligners.js\";import{needsElevationUpdates3D as ie,evaluateElevationInfoAtPoint as le}from\"./elevationAlignmentUtils.js\";import{Graphics3DMeshObject3DGraphicLayer as ce}from\"./Graphics3DMeshObject3DGraphicLayer.js\";import{Object3DEdgeState as ue}from\"./Graphics3DObject3DGraphicLayer.js\";import{Graphics3DSymbolLayer as me}from\"./Graphics3DSymbolLayer.js\";import{MaterialInfoCache as fe,MeshFastUpdateProcessor as pe}from\"./MeshFastUpdateProcessor.js\";import{createMaterial as he}from\"../support/edgeUtils.js\";import{parseColorMixMode as de,encodeSymbolColor as ge}from\"../support/symbolColorUtils.js\";import{debugFlags as xe}from\"../../support/debugFlags.js\";import{Attribute as _e}from\"../../webgl-engine/lib/Attribute.js\";import{AlphaDiscardMode as Te,CullFaceOptions as be}from\"../../webgl-engine/lib/basicInterfaces.js\";import{ContentObjectType as ye}from\"../../webgl-engine/lib/ContentObjectType.js\";import{Geometry as ve}from\"../../webgl-engine/lib/Geometry.js\";import{Object3D as we}from\"../../webgl-engine/lib/Object3D.js\";import{Texture as Me}from\"../../webgl-engine/lib/Texture.js\";import{VertexAttribute as Re}from\"../../webgl-engine/lib/VertexAttribute.js\";import{DefaultMaterial as je}from\"../../webgl-engine/materials/DefaultMaterial.js\";import{NativeLineMaterial as Pe}from\"../../webgl-engine/materials/NativeLineMaterial.js\";import{useSchematicPBR as Ce,advancedMRRFactors as Ae,schematicMRRFactors as Ee}from\"../../webgl-engine/materials/pbrUtils.js\";import{TextureWrapMode as Oe}from\"../../../webgl/enums.js\";const Ne=[\"mesh\"];class Ie extends me{constructor(e,t,r,o){super(e,t,r,o),this._materialInfoCache=new fe,this._fastUpdateProcessor=new pe,this._textures=new Map,this.ensureDrapedStatus(!1)}async doLoad(){xe.DRAW_MESH_GEOMETRY_NORMALS&&(this._debugVertexNormalMaterial=new Pe({color:[1,0,1,1]}),this._debugTangentNormalMaterial=new Pe({color:[1,.5,0,1]}),this._debugFaceNormalMaterial=new Pe({color:[0,1,1,1]}))}destroy(){super.destroy(),this._textures.forEach((e=>e.unload())),this._context.stage.removeMany(this._materialInfoCache.materials),this._context.stage.removeMany(Array.from(this._textures.values())),this._materialInfoCache.clear(),this._textures.clear(),this._fastUpdateProcessor.destroy(this._context.stage)}get materials(){return this._materialInfoCache.materials}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,Ne,\"fill on mesh-3d\"))return null;const r=this.setGraphicElevationContext(t),o=e.renderingInfo;return this._createAs3DShape(t,o,r,t.uid)}onRemoveGraphic(e){this._fastUpdateProcessor.onRemoveGraphic(e,this._materialInfoCache,this._context)}layerOpacityChanged(e,t){const r=this._getLayerOpacity();this._updateMaterialParameters((e=>{e.material.setParameters({layerOpacity:r});const t=e.material.parameters;this._setMaterialTransparentParameter(t,e),e.material.setParameters({transparent:t.transparent})})),e.forEach((e=>t(e)?.layerOpacityChanged(r,this._context.isAsync)))}layerElevationInfoChanged(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,ie)}slicePlaneEnabledChanged(e,t){return this._updateMaterialParameters((({material:e})=>{e.setParameters({hasSlicePlane:this._context.slicePlaneEnabled})})),e.forEach((e=>t(e)?.slicePlaneEnabledChanged(this._context.slicePlaneEnabled,this._context.isAsync))),!0}physicalBasedRenderingChanged(){const e=this._usePBR();return this._updateMaterialParameters((({material:t})=>t.setParameters({usePBR:e}))),!0}updateTransform(e,t,r,o){if(!e.fastTransformUpdatesAllowed)return!1;const a=e.fastTransformUpdatesEnabled;switch(o){case re.EnableFastUpdates:if(a)return!0;break;case re.DisableFastUpdates:if(!a)return!0;break;default:if(!a)return!!this.updateTransform(e,t,r,re.EnableFastUpdates)&&(e.autoDisableFastTransformUpdates((()=>this.updateTransform(e,t,r,re.DisableFastUpdates))),!0)}const n=this._context.renderCoordsHelper.spatialReference,s=at,{origin:i,transform:l}=r;if(!E(t,d(Ze,i.x,i.y,i.z??0),s,n))return!1;switch(o){case re.EnableFastUpdates:this._fastUpdateProcessor.enable(e,this._materialInfoCache,this._context);break;case re.DisableFastUpdates:this._fastUpdateProcessor.disable(e,this._materialInfoCache,this._context);break;case re.UpdateFastLocalOrigin:e.updateFastLocalOrigin(s,l,this._context.localOriginFactory)}const{elevationContext:c}=e;c.centerPointInElevationSR=this._getCenterPointInElevationSR(s);const{elevationProvider:u,renderCoordsHelper:m}=this._context,f=(e,t)=>le(e,u,c,m,t);return e.alignedSampledElevation=se(e,c,u.spatialReference,f,m,s),e.updateTransform(s,l,this._context.isAsync),e.updateAutoDisableFastTransformUpdates((()=>this.updateTransform(e,t,r,re.DisableFastUpdates))),!0}_requiresSymbolVertexColors(){return this._drivenProperties.color||this._drivenProperties.opacity}_materialPropertiesDefault(e,t){const r=this._requiresSymbolVertexColors(),o=!!e.vertexAttributes.color,a=!!e.vertexAttributes.tangent;return{hasSymbolVertexColors:r,hasVertexColors:o,hasVertexTangents:a,uid:`vc:${o},vt:${a},vct${t},svc:${r}`}}_materialProperties(e,t,r){const o=this._materialPropertiesDefault(e,r);if(!t.material)return o;const{color:a,colorTexture:n,colorTextureTransform:s,normalTexture:i,normalTextureTransform:l,doubleSided:c,alphaCutoff:u,alphaMode:m}=t.material,f=Ye(a),p=Ye(n),h=Je(s),d=Ye(i),g=Je(l);if(o.color=a,o.colorTexture=n,o.normalTexture=i,o.uid=`${o.uid},cmuid:${f},ctmuid:${p},cttuid:${h},ntmuid:${d},nttuid:${g},ds:${c},ac:${u},am:${m}`,t.material instanceof V){const{metallic:e,roughness:r,metallicRoughnessTexture:a,metallicRoughnessTextureTransform:n,emissiveColor:i,emissiveTexture:c,emissiveTextureTransform:u,occlusionTexture:m,occlusionTextureTransform:f}=t.material,p=Ye(a),h=Je(n),d=Ye(i),g=Ye(c),x=Je(u),_=Ye(m),T=Je(f);o.metallic=e,o.roughness=r,o.metallicRoughnessTexture=a,o.emissiveColor=i,o.emissiveTexture=c,o.occlusionTexture=m,o.colorTextureTransform=$e(s),o.normalTextureTransform=$e(l),o.emissiveTextureTransform=$e(u),o.occlusionTextureTransform=$e(f),o.metallicRoughnessTextureTransform=$e(n),o.uid=`${o.uid},mrm:${e},mrr:${r},mrt:${p},mrtt:${h},emuid:${d},etmuid:${g},ett:${x},otmuid:${_},ott:${T}`}return o}_getInternalTexture(e,t=Te.Opaque){const a=We(e);if(!a)return null;const n=`${e.contentHash}/${t}`;let s=this._textures.get(n);if(s){const e=this._context.stage.renderView.textures;let t=null;const a=e.acquire(s.id);return null==a||o(a)||(s.events.on(\"unloaded\",(()=>t=r(t))),t=a),s}let i=null;const l=this._context.stage.renderView.renderingContext.parameters.maxMaxAnisotropy,c={wrap:He(e.wrap),noUnpackFlip:!0,maxAnisotropy:l,mipmap:l>1};return ae(a)?(i=a.data,c.preMultiplyAlpha=!1,c.encoding=a.encoding):(i=a,c.preMultiplyAlpha=t!==Te.Opaque,c.downsampleUncompressed=this._context.graphicsCoreOwner.view.qualitySettings.graphics3D.uncompressedTextureDownsamplingEnabled),s=new Me(i,c),this._textures.set(n,s),s.load(this._context.stage.renderView.renderingContext),this._context.stage.add(s),s.events.on(\"unloaded\",(()=>{this._textures.delete(n)})),s}_setInternalMaterialTextureParameters(t,r){if(null!=t.colorTexture){const e=this._getInternalTexture(t.colorTexture,r.textureAlphaMode);e?(r.textureId=e.id,r.textureAlphaPremultiplied=!!e.parameters.preMultiplyAlpha):r.textureId=void 0}t.normalTexture&&(r.normalTextureId=this._getInternalTexture(t.normalTexture)?.id),t.emissiveColor&&(r.emissiveFactor=e.toUnitRGB(t.emissiveColor)),t.emissiveTexture&&(r.emissiveTextureId=this._getInternalTexture(t.emissiveTexture)?.id),t.occlusionTexture&&(r.occlusionTextureId=this._getInternalTexture(t.occlusionTexture)?.id),t.metallicRoughnessTexture&&(r.metallicRoughnessTextureId=this._getInternalTexture(t.metallicRoughnessTexture)?.id)}_setInternalMaterialParameters(e,t){null!=e.color&&ze(e.color,t),this._setInternalMaterialTextureParameters(e,t),t.colorTextureTransformMatrix=ne(e.colorTextureTransform),t.normalTextureTransformMatrix=ne(e.normalTextureTransform);const r=null!=e.normalTextureTransform?.scale?e.normalTextureTransform?.scale:h;t.scale=[r[0],r[1]],t.occlusionTextureTransformMatrix=ne(e.occlusionTextureTransform),t.emissiveTextureTransformMatrix=ne(e.emissiveTextureTransform),t.metallicRoughnessTextureTransformMatrix=ne(e.metallicRoughnessTextureTransform)}_setExternalMaterialParameters(t,r=this.symbolLayer?.material?.color){const o=this._drivenProperties.color;let a=this.symbolLayer.material?.colorMixMode??null;if(o)t.externalColor=C;else{const o=r??null;o?t.externalColor=e.toUnitRGBA(o):(a=null,t.externalColor=C)}a&&(t.colorMixMode=a),t.castShadows=!!this.symbolLayer.castShadows}_getOrCreateMaterial(t,r){const o=r.material?.color,a=r.material?.colorTexture,n=r.material?.alphaMode,s=\"blend\"===n,i=!(\"opaque\"===n)&&(ke(t)||null!=o&&o.a<1||a?.transparent||s),l=this._materialProperties(t,r,i),c=this._materialInfoCache.byUid(l.uid);if(c)return this._setInternalMaterialTextureParameters(l,c.material.parameters),c.material;const u={uid:l.uid,material:null,isComponentTransparent:i,alphaMode:r.material?r.material.alphaMode:\"opaque\"},m=Ce({normalTexture:l.normalTexture,metallicRoughnessTexture:l.metallicRoughnessTexture,metallicFactor:l.metallic,roughnessFactor:l.roughness,emissiveTexture:l.emissiveTexture,emissiveFactor:e.toUnitRGB(l.emissiveColor),occlusionTexture:l.occlusionTexture}),f={usePBR:this._usePBR(),isSchematic:m,hasVertexColors:l.hasVertexColors,hasSymbolColors:l.hasSymbolVertexColors,hasVertexTangents:l.hasVertexTangents,ambient:R,diffuse:j,opacity:1,doubleSided:!0,doubleSidedType:\"winding-order\",cullFace:be.None,layerOpacity:this._getLayerOpacity(),hasSlicePlane:this._context.slicePlaneEnabled};f.mrrFactors=m?Ee:[l.metallic,l.roughness,Ae[2]],r.material&&(f.doubleSided=r.material.doubleSided,f.cullFace=r.material.doubleSided?be.None:be.Back,f.textureAlphaCutoff=r.material.alphaCutoff),this._setExternalMaterialParameters(f),this._setMaterialTransparentParameter(f,u),this._setInternalMaterialParameters(l,f);const p=new je(f,this._context);return u.material=p,this._materialInfoCache.set(l.uid,u),this._context.stage.add(p),p}prepareSymbolLayerPatch(e){if(\"partial\"!==e.diff.type)return;const t=e.diff.diff;this._preparePatchColor(e,t)}_preparePatchColor(e,t){if(!t.material||\"partial\"!==t.material.type)return;const r=t.material.diff;if(!r.color||\"complete\"!==r.color.type||null==r.color.newValue||null==r.color.oldValue)return;const o=r.color.newValue;delete r.color,e.symbolLayerStatePatches.push((()=>{this._updateMaterialParameters((e=>{const t=e.material.parameters;this._setExternalMaterialParameters(t,o),this._setMaterialTransparentParameter(t,e),e.material.setParameters({externalColor:t.externalColor,transparent:t.transparent})}))}))}_usePBR(){return this._context.physicalBasedRenderingEnabled}_setMaterialTransparentParameter(e,t){e.transparent=this.needsDrivenTransparentPass||t.isComponentTransparent||e.layerOpacity<1||e.opacity<1||e.externalColor&&e.externalColor[3]<1,\"auto\"===t.alphaMode?e.textureAlphaMode=e.transparent?Te.MaskBlend:Te.Opaque:e.textureAlphaMode=\"opaque\"===t.alphaMode?Te.Opaque:\"mask\"===t.alphaMode?Te.Mask:Te.Blend}_createFaceDebugNormals(e,t){const r=t.length,o=e.spatialReference.isGeographic?20015077/180:1,n=.1*Math.max(e.extent.width*o,e.extent.height*o,e.extent.zmax-e.extent.zmin),i=[],l=[],c=t[0].transformation,u=a(s(),c);for(let a=0;a<r;a++){const e=t[a].attributes.get(Re.POSITION);if(!e)continue;const r=e.data,o=e.indices;for(let t=0;t<o.length;t+=3)Le(r,o,t,rt),Ve(r,o,t,Ze,et,tt),g(Ze,Ze,et),g(Ze,Ze,tt),x(Ze,Ze,1/3),_(Ze,Ze,c),i.push(...Ze),T(rt,rt,u),b(rt,rt),y(Ze,Ze,rt,n),i.push(...Ze),l.push(l.length),l.push(l.length)}return i.length?new ve(this._debugFaceNormalMaterial,[[Re.POSITION,new _e(i,l,3,!0)]],null,ye.Line):null}_createPerVertexDebugVectors(e,t,r,o,i){const l=t.length,c=e.spatialReference.isGeographic?20015077/180:1,u=.1*i*Math.max(e.extent.width*c,e.extent.height*c,e.extent.zmax-e.extent.zmin),m=[],f=[],p=t[0].transformation,h=a(s(),p);r===Re.TANGENT&&n(h,p);for(let a=0;a<l;a++){const e=t[a],o=e.attributes.get(Re.POSITION),n=e.attributes.get(r);if(!o||!n)continue;const s=o.data,i=o.indices,l=n.data,c=n.indices;for(let t=0;t<i.length;t++){const e=3*i[t],r=c[t]*n.stride;d(Ze,s[e+0],s[e+1],s[e+2]),_(Ze,Ze,p),m.push(...Ze),d(et,l[r+0],l[r+1],l[r+2]),T(et,et,h),b(et,et),y(Ze,Ze,et,u),m.push(...Ze),f.push(f.length),f.push(f.length)}}return m.length?new ve(o,[[Re.POSITION,new _e(m,f,3,!0)]],null,ye.Line):null}_createAs3DShape(e,t,r,o){const a=e.geometry;if(\"mesh\"!==a.type)return null;const n=this._createGeometryInfo(a,t,o);if(null==n)return null;const{geometries:s,objectTransformation:i}=n;if(xe.DRAW_MESH_GEOMETRY_NORMALS){const e=this._createPerVertexDebugVectors(a,s,Re.NORMAL,this._debugVertexNormalMaterial,1),t=this._createPerVertexDebugVectors(a,s,Re.TANGENT,this._debugTangentNormalMaterial,.5),r=this._createFaceDebugNormals(a,s);e&&s.push(e),t&&s.push(t),r&&s.push(r)}const l=new we({geometries:s,layerUid:this._context.layer.uid,graphicUid:o,isElevationSource:!0});l.transformation=i;const c=he(this.symbolLayer,{opacity:this._getLayerOpacity()}),u=c?new ue(s[0].material,c,this._context.slicePlaneEnabled):null,m=new ce(this,l,s,null,null,se,r,u);this._fastUpdateProcessor.onAddGraphic(),m.needsElevationUpdates=ie(r.mode),m.useObjectOriginAsAttachmentOrigin=!0,m.fastTransformUpdatesAllowed=this._fastTransformUpdatesAllowed(a),r.centerPointInElevationSR=this._getCenterPointInElevationSR(l.transformation);const{elevationProvider:f,renderCoordsHelper:p}=this._context,h=(e,t)=>le(e,f,r,p,t);return m.alignedSampledElevation=se(m,r,f.spatialReference,h,p),m}_fastTransformUpdatesAllowed(e){const{vertexSpace:t,spatialReference:r}=e;if(!$(t))return!1;const{type:o}=t,{view:a}=this._context.graphicsCoreOwner,{viewingMode:n}=a.state,s=a.spatialReference;return n===oe.Global&&\"local\"===o||n===oe.Local&&q(s,r)&&\"georeferenced\"===o&&!r.isGeographic}_getCenterPointInElevationSR(e){const t=te(0,0,0,this._context.elevationProvider.spatialReference??null);return N([e[12],e[13],e[14]],this._context.renderCoordsHelper.spatialReference,t),t}_passthroughReprojectionInfo(e){return e.reprojection===it.NONE&&!!e.objectTransformation}_createPositionBuffer(e,t){const r=e.vertexAttributes.position;let o,a=r;if(t.reprojection===it.NONE)return{position:a,georeferencedPositionBuffer:o};const n=t.reprojection===it.RENDER?t.transformBeforeProject:null;n&&(a=z(new Float64Array(a.length),a,n));const{normal:s,tangent:i}=e.vertexAttributes;this._passthroughReprojectionInfo(t)||!s&&!i||(o=a);const l=a===r||a===o?new Float64Array(a.length):a;return O(a,e.spatialReference,0,l,this._context.renderCoordsHelper.spatialReference,0),{position:l,georeferencedPositionBuffer:o}}_createNormalBuffer(e,t,r,o){const a=e.vertexAttributes.normal;if(null==a)return null;let n=a;const s=o.reprojection===it.RENDER?o.transformBeforeProject:null;s&&(n=W(n,new Float32Array(n.length),s));const i=this._context.graphicsCoreOwner.view.viewingMode;if(o.reprojection===it.NONE)return n;if(\"local\"===i){if(!k(this._context.renderCoordsHelper.spatialReference))return n;if(null==r)return null;if(e.spatialReference.isGeographic){const e=n===a?new Float32Array(n.length):n;return Y(n,J.NORMAL,r,e)}if(e.spatialReference.isWebMercator){const e=n===a?new Float32Array(n.length):n;return K(n,J.NORMAL,r,e)}return n}if(null==r)return null;const l=n===a?new Float32Array(n.length):n,c=this._context.renderCoordsHelper.spatialReference;return Q(n,r,e.spatialReference,t,c,l)}_createTangentBuffer(e,t,r,o){const a=e.vertexAttributes.tangent;if(null==a)return null;let n=a;const s=o.reprojection===it.RENDER?o.transformBeforeProject:null;s&&(n=X(n,new Float32Array(n.length),s));const i=this._context.graphicsCoreOwner.view.viewingMode;if(o.reprojection===it.NONE)return n;if(\"local\"===i){if(!k(this._context.renderCoordsHelper.spatialReference))return n;if(null==r)return null;if(e.spatialReference.isGeographic){const e=n===a?new Float32Array(n.length):n;return Y(n,J.TANGENT,r,e)}if(e.spatialReference.isWebMercator){const e=n===a?new Float32Array(n.length):n;return K(n,J.TANGENT,r,e)}return n}if(null==r)return null;const l=n===a?new Float32Array(n.length):n,c=this._context.renderCoordsHelper.spatialReference;return Z(n,r,e.spatialReference,t,c,l)}_createSymbolColorBuffer(e){if(this._requiresSymbolVertexColors()){const t=this._getVertexOpacityAndColor(e),r=de(this.symbolLayer?.material?.colorMixMode),o=new Uint8Array(4);return ge(t,r,o),o}return null}_createBuffers(e,t){const r=e.vertexAttributes&&e.vertexAttributes.position;if(!r)return this.logger.warn(\"Mesh geometry must contain position vertex attributes\"),null;const o=e.vertexAttributes.normal,a=e.vertexAttributes.uv,n=e.vertexAttributes.tangent;if(o&&o.length!==r.length)return this.logger.warn(\"Mesh normal vertex buffer must contain the same number of elements as the position buffer\"),null;if(n&&n.length/4!=r.length/3)return this.logger.warn(\"Mesh tangent vertex buffer must contain the same number of elements as the position buffer\"),null;if(a&&a.length/2!=r.length/3)return this.logger.warn(\"Mesh uv vertex buffer must contain the same number of elements as the position buffer\"),null;const s=this._computeReprojectionInfo(e),{position:i,georeferencedPositionBuffer:l}=this._createPositionBuffer(e,s),c=Ke(e),u=this._createSymbolColorBuffer(t),f=this._createNormalBuffer(e,i,l,s),p=this._createTangentBuffer(e,i,l,s),h=a,{transformation:d,position:g,normal:x,tangent:_}=this._passthroughReprojectionInfo(s)?{transformation:s.objectTransformation,position:i,normal:f,tangent:p}:this._transformOriginLocal(e,i,f,p);return{positionBuffer:g,normalBuffer:x,tangentBuffer:_,uvBuffer:h,colorBuffer:c,symbolColorBuffer:u,objectTransformation:d,geometryTransformation:s.reprojection===it.NONE&&s.geometryTransformation?s.geometryTransformation:m()}}_computeReprojectionInfo(e){const{vertexSpace:t}=e,r=\"georeferenced\"===t.type?q(this._context.renderCoordsHelper.spatialReference,e.spatialReference)?it.NONE:it.RENDER:it.NONE;if(H(t))return{reprojection:r};const o=t.origin,a=m(),n=e.transform?.localMatrix??f;if(r===it.NONE){E(e.spatialReference,o,a,this._context.renderCoordsHelper.spatialReference);return{reprojection:r,objectTransformation:a,geometryTransformation:p(n)}}const s=i(m(),o);return l(s,s,n),{reprojection:r,transformBeforeProject:s}}_transformOriginLocal(e,t,r,o){const a=this._context.renderCoordsHelper.spatialReference,n=e.origin;Xe[0]=n.x,Xe[1]=n.y,Xe[2]=n.z??0;const s=m();E(e.spatialReference,Xe,s,a),c(ot,s);const{position:i,normal:l,tangent:u}=e.vertexAttributes,f=t===i?new Float64Array(t.length):t;z(f,t,ot);const p=r?r===l?new Float32Array(r.length):r:null,h=o?o===u?new Float32Array(o.length):o:null;return r&&p&&W(r,p,ot),o&&h&&X(o,h,ot),{transformation:s,position:f,normal:p,tangent:h}}_validateFaces(e,t){const r=e.vertexAttributes.position.length/3,o=t.faces;if(o){let e=-1;for(let t=0;t<o.length;t++){const r=o[t];r>e&&(e=r)}if(r<=e)return this.logger.warn(`Vertex index ${e} is out of bounds of the mesh position buffer`),!1}else if(r%3!=0)return this.logger.warn(\"Mesh position buffer length must be a multiple of 9 if no component faces are defined (3 values per vertex * 3 vertices per triangle)\"),!1;return!0}_isOutsideClippingArea(e){if(!this._context.clippingExtent)return!1;const t=e.vertexAttributes?.position;if(!t)return!1;const r=this._context.elevationProvider.spatialReference,o=ee(e,r??e.spatialReference);return!!o&&(S(o,nt),!U(nt,this._context.clippingExtent))}_createGeometryInfo(e,t,r){if(!A(e.spatialReference,this._context.renderCoordsHelper.spatialReference))return this.logger.warn(\"Geometry spatial reference is not compatible with the view\"),null;if(!this._validateVertexSpace(e))return null;if(this._isOutsideClippingArea(e))return null;const o=this._createBuffers(e,t);if(null==o)return null;const{positionBuffer:a,uvBuffer:n,colorBuffer:s,symbolColorBuffer:i,normalBuffer:l,tangentBuffer:c,objectTransformation:m,geometryTransformation:f}=o,p=e.components??st,h=new Array;let d=!1;const g=u(Ze,m),x=this._context.localOriginFactory.getOrigin(g);for(const u of p){if(!this._validateFaces(e,u))return null;const t=Ue(e,u);if(0===t.length)continue;const o=Be(a,l,u,t);o.didFlipNormals&&(d=!0);const m=[[Re.POSITION,new _e(a,t,3,!0)],[Re.NORMAL,new _e(o.normals,o.indices,3,!0)]];s&&m.push([Re.COLOR,new _e(s,t,4,!0)]),i&&m.push([Re.SYMBOLCOLOR,new _e(i,F(t.length),4,!0)]),n&&m.push([Re.UV0,new _e(n,t,2,!0)]),c&&m.push([Re.TANGENT,new _e(c,t,4,!0)]);const p=this._context.stage.renderView.getObjectAndLayerIdColor({graphicUid:r,layerUid:this._context.layer.uid}),g=this._getOrCreateMaterial(e,u),_=new ve(g,m,null,ye.Mesh,p);_.transformation=f,_.localOrigin=x,h.push(_)}return d&&this.logger.warn(\"Normals have been automatically flipped to be consistent with the counter clock wise face winding order. It is better to generate mesh geometries that have consistent normals.\"),{geometries:h,objectTransformation:m}}_updateMaterialParameters(e){this._materialInfoCache.forEachMaterialInfo(e),this._fastUpdateProcessor.forEachMaterialInfo(e),this._fastUpdateProcessor.forEachClonedMaterial(((e,t)=>{t.setParameters(e.parameters)}))}_validateVertexSpace(e){const{_context:{graphicsCoreOwner:{view:{state:{viewingMode:t}}}}}=this,{vertexSpace:r}=e;return t!==oe.Local||\"local\"!==r.type||(this.logger.warn(\"Displaying a mesh with a local vertex space in a view in local viewing mode is not supported.\"),!1)}test(){return{...super.test(),materials:this._materialInfoCache.materials}}}class Se{constructor(e,t,r){this.normals=e,this.indices=t,this.didFlipNormals=r}}function Ue(e,t){return t.faces??D(e.vertexAttributes.position.length/3)}function Be(e,t,r,o){switch(r.shading||\"flat\"){default:case\"source\":return De(e,t,r,o);case\"flat\":return Fe(e,o);case\"smooth\":return Ge(e,o)}}function Fe(e,t){const r=B(t.length),o=new Array(3*t.length);for(let a=0;a<t.length;a+=3){const n=Le(e,t,a,rt);for(let e=0;e<3;e++)r[a+e]=n[e],o[a+e]=a/3}return new Se(r,o,!1)}function De(e,t,r,o){if(null==t)return Fe(e,o);let a=!1;if(!r.trustSourceNormals)for(let n=0;n<o.length;n+=3){Le(e,o,n,rt);for(let e=0;e<3;e++){const r=3*o[n+e];Ze[0]=t[r],Ze[1]=t[r+1],Ze[2]=t[r+2],v(rt,Ze)<0&&(t[r]=-t[r],t[r+1]=-t[r+1],t[r+2]=-t[r+2],a=!0)}}return new Se(t,o,a)}function Ge(e,t){const r={};for(let n=0;n<t.length;n+=3){const o=Le(e,t,n,rt);for(let e=0;e<3;e++){const a=t[n+e];let s=r[a];s||(s={normal:P(),count:0},r[a]=s),g(s.normal,s.normal,o),s.count++}}const o=B(3*t.length),a=new Array(3*t.length);for(let n=0;n<t.length;n++){const e=r[t[n]];1!==e.count&&(b(e.normal,e.normal),e.count=1);for(let t=0;t<3;t++)o[3*n+t]=e.normal[t];a[n]=n}return new Se(o,a,!1)}function Ve(e,t,r,o,a,n){const s=3*t[r],i=3*t[r+1],l=3*t[r+2];o[0]=e[s],o[1]=e[s+1],o[2]=e[s+2],a[0]=e[i],a[1]=e[i+1],a[2]=e[i+2],n[0]=e[l],n[1]=e[l+1],n[2]=e[l+2]}function Le(e,t,r,o){return Ve(e,t,r,Ze,et,tt),w(et,et,Ze),w(tt,tt,Ze),M(Ze,et,tt),b(o,Ze),o}function $e(e){if(!e)return null;const{scale:r,offset:o,rotation:a}=e;return{scale:r,offset:o,rotation:t(a)}}function He(e=\"repeat\"){if(\"string\"==typeof e){const t=qe(e);return{s:t,t}}return{s:qe(e.horizontal),t:qe(e.vertical)}}function qe(e){switch(e){case\"clamp\":return Oe.CLAMP_TO_EDGE;case\"mirror\":return Oe.MIRRORED_REPEAT;default:return Oe.REPEAT}}function ke(e){const t=e.vertexAttributes.color;if(null==t)return!1;for(let r=3;r<t.length;r+=4)if(255!==t[r])return!0;return!1}function ze(t,r){r.diffuse=e.toUnitRGB(t),r.opacity=t.a}function We(e){return e.data??e.url}function Ye(t){return null==t?\"-\":t instanceof e?t.toHex():t.contentHash}function Je(e){const{offset:t,scale:r,rotation:o}=e??Qe;return`${t[0]},${t[1]},${o},${r[0]},${r[1]}`}function Ke(e){return e.vertexAttributes.color}const Qe=new L,Xe=P(),Ze=P(),et=P(),tt=P(),rt=P(),ot=m(),at=m(),nt=I(),st=[new G];var it;!function(e){e[e.NONE=0]=\"NONE\",e[e.RENDER=1]=\"RENDER\"}(it||(it={}));export{Ie as Graphics3DMeshFillSymbolLayer};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}