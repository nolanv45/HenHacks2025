{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { squaredDistance as e } from \"../../../core/libs/gl-matrix-2/math/vec2.js\";\nimport { create as t } from \"../../../core/libs/gl-matrix-2/factories/vec2f64.js\";\nimport { absoluteHeightElevationInfo as r } from \"../../../support/elevationInfoUtils.js\";\nimport { fromAnyMapPoint as i, asVec2 as s, markAsTarget as o, fromValues as n } from \"../sketch/normalizedPoint.js\";\nimport { defaults as l } from \"./Settings.js\";\nimport { SnappingAlgorithm as a } from \"./SnappingAlgorithm.js\";\nimport { editEdgeToSnappingEdge as c, squaredScreenDistance as h } from \"./snappingUtils.js\";\nimport { ParallelLineSnappingCandidate as d } from \"./candidates/ParallelLineSnappingCandidate.js\";\nimport { vectorToScreenPoint as p } from \"../support/viewUtils.js\";\nimport { projectPointToLine as g } from \"../../support/geometry2dUtils.js\";\nclass f extends a {\n  snapNewVertex(e, t) {\n    const s = t.editGeometryOperations.data.components[0],\n      o = s.edges.length,\n      n = s.vertices.length,\n      l = [];\n    if (o < 2) return l;\n    const {\n        view: a\n      } = this,\n      h = p(e, t.spatialReference, r, a),\n      d = i(s.vertices[n - 1].pos, a, t),\n      g = i(s.vertices[0].pos, a, t),\n      f = s.edges[o - 1];\n    let m = f;\n    do {\n      if (this.edgeExceedsShortLineThreshold(m, t)) {\n        const r = c(m, a, t);\n        this._checkEdgeForParallelLines(r, d, e, h, t, l), this._checkEdgeForParallelLines(r, g, e, h, t, l);\n      }\n      m = m.leftVertex.leftEdge;\n    } while (m && m !== f);\n    return l;\n  }\n  snapExistingVertex(e, t) {\n    const s = [],\n      o = t.vertexHandle,\n      n = o.component;\n    if (n.edges.length < 3) return s;\n    const {\n        view: l\n      } = this,\n      a = p(e, t.spatialReference, r, l),\n      h = o.leftEdge,\n      d = o.rightEdge,\n      g = n.vertices[0],\n      f = i(g.pos, l, t),\n      m = n.vertices.length,\n      u = n.vertices[m - 1],\n      v = i(u.pos, l, t),\n      x = n.edges[0];\n    let E = x;\n    do {\n      if (E !== h && E !== d && this.edgeExceedsShortLineThreshold(E, t)) {\n        const r = c(E, l, t);\n        h && this._checkEdgeForParallelLines(r, i(h.leftVertex.pos, l, t), e, a, t, s), d && this._checkEdgeForParallelLines(r, i(d.rightVertex.pos, l, t), e, a, t, s), o === g ? this._checkEdgeForParallelLines(r, v, e, a, t, s) : o === u && this._checkEdgeForParallelLines(r, f, e, a, t, s);\n      }\n      E = E.rightVertex.rightEdge;\n    } while (E && E !== x);\n    return s;\n  }\n  _checkEdgeForParallelLines(t, i, a, c, f, v) {\n    const x = t.left,\n      E = t.right;\n    if (g(u, s(i), s(x), s(E)), e(u, s(i)) < l.parallelLineThreshold) return;\n    g(u, s(a), s(x), s(E), s(i));\n    const {\n        spatialReference: L,\n        pointer: P\n      } = f,\n      j = o(n(u[0], u[1], a[2]));\n    if (h(c, p(j, L, r, this.view)) < this.squaredProximityThreshold(P)) {\n      if (this.isVertical(j, i, f) || this.isVertical(x, E, f)) return;\n      if (m(t, v)) return;\n      v.push(new d({\n        referenceLine: t,\n        lineStart: i,\n        targetPoint: j,\n        isDraped: \"on-the-ground\" === f.elevationInfo?.mode\n      }));\n    }\n  }\n}\nfunction m(t, r) {\n  const i = t.left,\n    o = t.right;\n  for (const n of r) if (g(u, s(o), s(n.constraint.start), s(n.constraint.end), s(i)), e(u, s(o)) < l.parallelLineThreshold) return n.addReferenceLine(t), !0;\n  return !1;\n}\nconst u = t();\nexport { f as ParallelLineSnapper };","map":{"version":3,"names":["squaredDistance","e","create","t","absoluteHeightElevationInfo","r","fromAnyMapPoint","i","asVec2","s","markAsTarget","o","fromValues","n","defaults","l","SnappingAlgorithm","a","editEdgeToSnappingEdge","c","squaredScreenDistance","h","ParallelLineSnappingCandidate","d","vectorToScreenPoint","p","projectPointToLine","g","f","snapNewVertex","editGeometryOperations","data","components","edges","length","vertices","view","spatialReference","pos","m","edgeExceedsShortLineThreshold","_checkEdgeForParallelLines","leftVertex","leftEdge","snapExistingVertex","vertexHandle","component","rightEdge","u","v","x","E","rightVertex","left","right","parallelLineThreshold","L","pointer","P","j","squaredProximityThreshold","isVertical","push","referenceLine","lineStart","targetPoint","isDraped","elevationInfo","mode","constraint","start","end","addReferenceLine","ParallelLineSnapper"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/interactive/snapping/ParallelLineSnapper.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{squaredDistance as e}from\"../../../core/libs/gl-matrix-2/math/vec2.js\";import{create as t}from\"../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{absoluteHeightElevationInfo as r}from\"../../../support/elevationInfoUtils.js\";import{fromAnyMapPoint as i,asVec2 as s,markAsTarget as o,fromValues as n}from\"../sketch/normalizedPoint.js\";import{defaults as l}from\"./Settings.js\";import{SnappingAlgorithm as a}from\"./SnappingAlgorithm.js\";import{editEdgeToSnappingEdge as c,squaredScreenDistance as h}from\"./snappingUtils.js\";import{ParallelLineSnappingCandidate as d}from\"./candidates/ParallelLineSnappingCandidate.js\";import{vectorToScreenPoint as p}from\"../support/viewUtils.js\";import{projectPointToLine as g}from\"../../support/geometry2dUtils.js\";class f extends a{snapNewVertex(e,t){const s=t.editGeometryOperations.data.components[0],o=s.edges.length,n=s.vertices.length,l=[];if(o<2)return l;const{view:a}=this,h=p(e,t.spatialReference,r,a),d=i(s.vertices[n-1].pos,a,t),g=i(s.vertices[0].pos,a,t),f=s.edges[o-1];let m=f;do{if(this.edgeExceedsShortLineThreshold(m,t)){const r=c(m,a,t);this._checkEdgeForParallelLines(r,d,e,h,t,l),this._checkEdgeForParallelLines(r,g,e,h,t,l)}m=m.leftVertex.leftEdge}while(m&&m!==f);return l}snapExistingVertex(e,t){const s=[],o=t.vertexHandle,n=o.component;if(n.edges.length<3)return s;const{view:l}=this,a=p(e,t.spatialReference,r,l),h=o.leftEdge,d=o.rightEdge,g=n.vertices[0],f=i(g.pos,l,t),m=n.vertices.length,u=n.vertices[m-1],v=i(u.pos,l,t),x=n.edges[0];let E=x;do{if(E!==h&&E!==d&&this.edgeExceedsShortLineThreshold(E,t)){const r=c(E,l,t);h&&this._checkEdgeForParallelLines(r,i(h.leftVertex.pos,l,t),e,a,t,s),d&&this._checkEdgeForParallelLines(r,i(d.rightVertex.pos,l,t),e,a,t,s),o===g?this._checkEdgeForParallelLines(r,v,e,a,t,s):o===u&&this._checkEdgeForParallelLines(r,f,e,a,t,s)}E=E.rightVertex.rightEdge}while(E&&E!==x);return s}_checkEdgeForParallelLines(t,i,a,c,f,v){const x=t.left,E=t.right;if(g(u,s(i),s(x),s(E)),e(u,s(i))<l.parallelLineThreshold)return;g(u,s(a),s(x),s(E),s(i));const{spatialReference:L,pointer:P}=f,j=o(n(u[0],u[1],a[2]));if(h(c,p(j,L,r,this.view))<this.squaredProximityThreshold(P)){if(this.isVertical(j,i,f)||this.isVertical(x,E,f))return;if(m(t,v))return;v.push(new d({referenceLine:t,lineStart:i,targetPoint:j,isDraped:\"on-the-ground\"===f.elevationInfo?.mode}))}}}function m(t,r){const i=t.left,o=t.right;for(const n of r)if(g(u,s(o),s(n.constraint.start),s(n.constraint.end),s(i)),e(u,s(o))<l.parallelLineThreshold)return n.addReferenceLine(t),!0;return!1}const u=t();export{f as ParallelLineSnapper};\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,eAAe,IAAIC,CAAC,QAAK,6CAA6C;AAAC,SAAOC,MAAM,IAAIC,CAAC,QAAK,qDAAqD;AAAC,SAAOC,2BAA2B,IAAIC,CAAC,QAAK,wCAAwC;AAAC,SAAOC,eAAe,IAAIC,CAAC,EAACC,MAAM,IAAIC,CAAC,EAACC,YAAY,IAAIC,CAAC,EAACC,UAAU,IAAIC,CAAC,QAAK,8BAA8B;AAAC,SAAOC,QAAQ,IAAIC,CAAC,QAAK,eAAe;AAAC,SAAOC,iBAAiB,IAAIC,CAAC,QAAK,wBAAwB;AAAC,SAAOC,sBAAsB,IAAIC,CAAC,EAACC,qBAAqB,IAAIC,CAAC,QAAK,oBAAoB;AAAC,SAAOC,6BAA6B,IAAIC,CAAC,QAAK,+CAA+C;AAAC,SAAOC,mBAAmB,IAAIC,CAAC,QAAK,yBAAyB;AAAC,SAAOC,kBAAkB,IAAIC,CAAC,QAAK,kCAAkC;AAAC,MAAMC,CAAC,SAASX,CAAC;EAACY,aAAaA,CAAC5B,CAAC,EAACE,CAAC,EAAC;IAAC,MAAMM,CAAC,GAACN,CAAC,CAAC2B,sBAAsB,CAACC,IAAI,CAACC,UAAU,CAAC,CAAC,CAAC;MAACrB,CAAC,GAACF,CAAC,CAACwB,KAAK,CAACC,MAAM;MAACrB,CAAC,GAACJ,CAAC,CAAC0B,QAAQ,CAACD,MAAM;MAACnB,CAAC,GAAC,EAAE;IAAC,IAAGJ,CAAC,GAAC,CAAC,EAAC,OAAOI,CAAC;IAAC,MAAK;QAACqB,IAAI,EAACnB;MAAC,CAAC,GAAC,IAAI;MAACI,CAAC,GAACI,CAAC,CAACxB,CAAC,EAACE,CAAC,CAACkC,gBAAgB,EAAChC,CAAC,EAACY,CAAC,CAAC;MAACM,CAAC,GAAChB,CAAC,CAACE,CAAC,CAAC0B,QAAQ,CAACtB,CAAC,GAAC,CAAC,CAAC,CAACyB,GAAG,EAACrB,CAAC,EAACd,CAAC,CAAC;MAACwB,CAAC,GAACpB,CAAC,CAACE,CAAC,CAAC0B,QAAQ,CAAC,CAAC,CAAC,CAACG,GAAG,EAACrB,CAAC,EAACd,CAAC,CAAC;MAACyB,CAAC,GAACnB,CAAC,CAACwB,KAAK,CAACtB,CAAC,GAAC,CAAC,CAAC;IAAC,IAAI4B,CAAC,GAACX,CAAC;IAAC,GAAE;MAAC,IAAG,IAAI,CAACY,6BAA6B,CAACD,CAAC,EAACpC,CAAC,CAAC,EAAC;QAAC,MAAME,CAAC,GAACc,CAAC,CAACoB,CAAC,EAACtB,CAAC,EAACd,CAAC,CAAC;QAAC,IAAI,CAACsC,0BAA0B,CAACpC,CAAC,EAACkB,CAAC,EAACtB,CAAC,EAACoB,CAAC,EAAClB,CAAC,EAACY,CAAC,CAAC,EAAC,IAAI,CAAC0B,0BAA0B,CAACpC,CAAC,EAACsB,CAAC,EAAC1B,CAAC,EAACoB,CAAC,EAAClB,CAAC,EAACY,CAAC,CAAC;MAAA;MAACwB,CAAC,GAACA,CAAC,CAACG,UAAU,CAACC,QAAQ;IAAA,CAAC,QAAMJ,CAAC,IAAEA,CAAC,KAAGX,CAAC;IAAE,OAAOb,CAAC;EAAA;EAAC6B,kBAAkBA,CAAC3C,CAAC,EAACE,CAAC,EAAC;IAAC,MAAMM,CAAC,GAAC,EAAE;MAACE,CAAC,GAACR,CAAC,CAAC0C,YAAY;MAAChC,CAAC,GAACF,CAAC,CAACmC,SAAS;IAAC,IAAGjC,CAAC,CAACoB,KAAK,CAACC,MAAM,GAAC,CAAC,EAAC,OAAOzB,CAAC;IAAC,MAAK;QAAC2B,IAAI,EAACrB;MAAC,CAAC,GAAC,IAAI;MAACE,CAAC,GAACQ,CAAC,CAACxB,CAAC,EAACE,CAAC,CAACkC,gBAAgB,EAAChC,CAAC,EAACU,CAAC,CAAC;MAACM,CAAC,GAACV,CAAC,CAACgC,QAAQ;MAACpB,CAAC,GAACZ,CAAC,CAACoC,SAAS;MAACpB,CAAC,GAACd,CAAC,CAACsB,QAAQ,CAAC,CAAC,CAAC;MAACP,CAAC,GAACrB,CAAC,CAACoB,CAAC,CAACW,GAAG,EAACvB,CAAC,EAACZ,CAAC,CAAC;MAACoC,CAAC,GAAC1B,CAAC,CAACsB,QAAQ,CAACD,MAAM;MAACc,CAAC,GAACnC,CAAC,CAACsB,QAAQ,CAACI,CAAC,GAAC,CAAC,CAAC;MAACU,CAAC,GAAC1C,CAAC,CAACyC,CAAC,CAACV,GAAG,EAACvB,CAAC,EAACZ,CAAC,CAAC;MAAC+C,CAAC,GAACrC,CAAC,CAACoB,KAAK,CAAC,CAAC,CAAC;IAAC,IAAIkB,CAAC,GAACD,CAAC;IAAC,GAAE;MAAC,IAAGC,CAAC,KAAG9B,CAAC,IAAE8B,CAAC,KAAG5B,CAAC,IAAE,IAAI,CAACiB,6BAA6B,CAACW,CAAC,EAAChD,CAAC,CAAC,EAAC;QAAC,MAAME,CAAC,GAACc,CAAC,CAACgC,CAAC,EAACpC,CAAC,EAACZ,CAAC,CAAC;QAACkB,CAAC,IAAE,IAAI,CAACoB,0BAA0B,CAACpC,CAAC,EAACE,CAAC,CAACc,CAAC,CAACqB,UAAU,CAACJ,GAAG,EAACvB,CAAC,EAACZ,CAAC,CAAC,EAACF,CAAC,EAACgB,CAAC,EAACd,CAAC,EAACM,CAAC,CAAC,EAACc,CAAC,IAAE,IAAI,CAACkB,0BAA0B,CAACpC,CAAC,EAACE,CAAC,CAACgB,CAAC,CAAC6B,WAAW,CAACd,GAAG,EAACvB,CAAC,EAACZ,CAAC,CAAC,EAACF,CAAC,EAACgB,CAAC,EAACd,CAAC,EAACM,CAAC,CAAC,EAACE,CAAC,KAAGgB,CAAC,GAAC,IAAI,CAACc,0BAA0B,CAACpC,CAAC,EAAC4C,CAAC,EAAChD,CAAC,EAACgB,CAAC,EAACd,CAAC,EAACM,CAAC,CAAC,GAACE,CAAC,KAAGqC,CAAC,IAAE,IAAI,CAACP,0BAA0B,CAACpC,CAAC,EAACuB,CAAC,EAAC3B,CAAC,EAACgB,CAAC,EAACd,CAAC,EAACM,CAAC,CAAC;MAAA;MAAC0C,CAAC,GAACA,CAAC,CAACC,WAAW,CAACL,SAAS;IAAA,CAAC,QAAMI,CAAC,IAAEA,CAAC,KAAGD,CAAC;IAAE,OAAOzC,CAAC;EAAA;EAACgC,0BAA0BA,CAACtC,CAAC,EAACI,CAAC,EAACU,CAAC,EAACE,CAAC,EAACS,CAAC,EAACqB,CAAC,EAAC;IAAC,MAAMC,CAAC,GAAC/C,CAAC,CAACkD,IAAI;MAACF,CAAC,GAAChD,CAAC,CAACmD,KAAK;IAAC,IAAG3B,CAAC,CAACqB,CAAC,EAACvC,CAAC,CAACF,CAAC,CAAC,EAACE,CAAC,CAACyC,CAAC,CAAC,EAACzC,CAAC,CAAC0C,CAAC,CAAC,CAAC,EAAClD,CAAC,CAAC+C,CAAC,EAACvC,CAAC,CAACF,CAAC,CAAC,CAAC,GAACQ,CAAC,CAACwC,qBAAqB,EAAC;IAAO5B,CAAC,CAACqB,CAAC,EAACvC,CAAC,CAACQ,CAAC,CAAC,EAACR,CAAC,CAACyC,CAAC,CAAC,EAACzC,CAAC,CAAC0C,CAAC,CAAC,EAAC1C,CAAC,CAACF,CAAC,CAAC,CAAC;IAAC,MAAK;QAAC8B,gBAAgB,EAACmB,CAAC;QAACC,OAAO,EAACC;MAAC,CAAC,GAAC9B,CAAC;MAAC+B,CAAC,GAAChD,CAAC,CAACE,CAAC,CAACmC,CAAC,CAAC,CAAC,CAAC,EAACA,CAAC,CAAC,CAAC,CAAC,EAAC/B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAAC,IAAGI,CAAC,CAACF,CAAC,EAACM,CAAC,CAACkC,CAAC,EAACH,CAAC,EAACnD,CAAC,EAAC,IAAI,CAAC+B,IAAI,CAAC,CAAC,GAAC,IAAI,CAACwB,yBAAyB,CAACF,CAAC,CAAC,EAAC;MAAC,IAAG,IAAI,CAACG,UAAU,CAACF,CAAC,EAACpD,CAAC,EAACqB,CAAC,CAAC,IAAE,IAAI,CAACiC,UAAU,CAACX,CAAC,EAACC,CAAC,EAACvB,CAAC,CAAC,EAAC;MAAO,IAAGW,CAAC,CAACpC,CAAC,EAAC8C,CAAC,CAAC,EAAC;MAAOA,CAAC,CAACa,IAAI,CAAC,IAAIvC,CAAC,CAAC;QAACwC,aAAa,EAAC5D,CAAC;QAAC6D,SAAS,EAACzD,CAAC;QAAC0D,WAAW,EAACN,CAAC;QAACO,QAAQ,EAAC,eAAe,KAAGtC,CAAC,CAACuC,aAAa,EAAEC;MAAI,CAAC,CAAC,CAAC;IAAA;EAAC;AAAC;AAAC,SAAS7B,CAACA,CAACpC,CAAC,EAACE,CAAC,EAAC;EAAC,MAAME,CAAC,GAACJ,CAAC,CAACkD,IAAI;IAAC1C,CAAC,GAACR,CAAC,CAACmD,KAAK;EAAC,KAAI,MAAMzC,CAAC,IAAIR,CAAC,EAAC,IAAGsB,CAAC,CAACqB,CAAC,EAACvC,CAAC,CAACE,CAAC,CAAC,EAACF,CAAC,CAACI,CAAC,CAACwD,UAAU,CAACC,KAAK,CAAC,EAAC7D,CAAC,CAACI,CAAC,CAACwD,UAAU,CAACE,GAAG,CAAC,EAAC9D,CAAC,CAACF,CAAC,CAAC,CAAC,EAACN,CAAC,CAAC+C,CAAC,EAACvC,CAAC,CAACE,CAAC,CAAC,CAAC,GAACI,CAAC,CAACwC,qBAAqB,EAAC,OAAO1C,CAAC,CAAC2D,gBAAgB,CAACrE,CAAC,CAAC,EAAC,CAAC,CAAC;EAAC,OAAM,CAAC,CAAC;AAAA;AAAC,MAAM6C,CAAC,GAAC7C,CAAC,CAAC,CAAC;AAAC,SAAOyB,CAAC,IAAI6C,mBAAmB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}