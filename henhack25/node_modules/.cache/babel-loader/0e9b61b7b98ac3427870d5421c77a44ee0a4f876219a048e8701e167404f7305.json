{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../../../../chunks/tslib.es6.js\";\nimport { isSome as o } from \"../../../../../core/arrayUtils.js\";\nimport e from \"../../../../../core/Collection.js\";\nimport i from \"../../../../../core/Evented.js\";\nimport { makeHandle as n } from \"../../../../../core/handleUtils.js\";\nimport { destroyMaybe as s } from \"../../../../../core/maybe.js\";\nimport { zeroMeters as a, scale as l } from \"../../../../../core/quantityUtils.js\";\nimport { watch as r, syncAndInitial as p } from \"../../../../../core/reactiveUtils.js\";\nimport { property as c } from \"../../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../../core/has.js\";\nimport \"../../../../../core/Logger.js\";\nimport { subclass as h } from \"../../../../../core/accessorSupport/decorators/subclass.js\";\nimport { UpdatingHandles as u } from \"../../../../../core/support/UpdatingHandles.js\";\nimport { makeDehydratedPoint as m } from \"../../../../../layers/graphics/dehydratedPoint.js\";\nimport { getConvertedElevation as d } from \"../../../../../support/elevationInfoUtils.js\";\nimport { SnappingVisualizer3D as f } from \"../../SnappingVisualizer3D.js\";\nimport { orientation as v } from \"../geometryUtils.js\";\nimport { SupportedObjectResult as g } from \"../isSupportedObjectUtils.js\";\nimport { manipulatedObjectGeometry as _ } from \"../manipulatedObjectUtils.js\";\nimport { canMoveZOperations as M } from \"../manipulatorUtils.js\";\nimport { meshTransformFastUpdateHandles as j } from \"../meshFastUpdateUtils.js\";\nimport { connectTooltipToManipulatedObject as b } from \"../tooltipUtils3D.js\";\nimport { createVisualElements as y } from \"../visualElementUtils.js\";\nimport { discRadius as T } from \"../manipulations/config.js\";\nimport { ManipulationType as w, MoveManipulation as I } from \"../manipulations/MoveManipulation.js\";\nimport { axisConstrainedDragSign as S } from \"../manipulations/moveUtils.js\";\nimport { MoveXYObjectManipulation as O } from \"../manipulations/MoveXYObjectManipulation.js\";\nimport { isSupportedObject as x } from \"./isSupportedObject.js\";\nimport { OutlineVisualElement as E } from \"../../visualElements/OutlineVisualElement.js\";\nimport { dragManipulatedObjectMany as U, resetManipulatedObjectMany as P } from \"../../../../interactive/dragEventPipeline.js\";\nimport { InteractiveToolBase as k } from \"../../../../interactive/InteractiveToolBase.js\";\nimport { EditGeometryOperations as H } from \"../../../../interactive/editGeometry/EditGeometryOperations.js\";\nimport X from \"../../../../interactive/sketch/SketchOptions.js\";\nimport { SnappingContext as Y } from \"../../../../interactive/snapping/SnappingContext.js\";\nimport { createSnapDragEventPipelineStep as R } from \"../../../../interactive/snapping/SnappingDragPipelineStep.js\";\nimport { makeTooltip as A, enterInputModeIfAvailable as z } from \"../../../../interactive/tooltip/tooltipCommonUtils.js\";\nimport { MovePointTooltipInfo as D } from \"../../../../interactive/tooltip/infos/MovePointTooltipInfo.js\";\nimport { TranslateTooltipInfo as Z } from \"../../../../interactive/tooltip/infos/TranslateTooltipInfo.js\";\nimport { TranslateXYTooltipInfo as C } from \"../../../../interactive/tooltip/infos/TranslateXYTooltipInfo.js\";\nimport { TranslateZTooltipInfo as F } from \"../../../../interactive/tooltip/infos/TranslateZTooltipInfo.js\";\nimport { autoDistanceBetweenPoints2D as V } from \"../../../../support/automaticLengthMeasurementUtils.js\";\nimport { verticalSignedDistanceBetweenPoints as G } from \"../../../../support/euclideanLengthMeasurementUtils.js\";\nclass L {\n  constructor(t) {\n    this.objects = t, this.type = \"move-start\";\n  }\n}\nclass B {\n  constructor(t, o, e) {\n    this.dx = t, this.dy = o, this.objects = e, this.type = \"move\";\n  }\n}\nclass N {\n  constructor(t) {\n    this.objects = t, this.type = \"move-stop\";\n  }\n}\nconst q = Symbol(\"manipulators\"),\n  J = Symbol(\"tooltips\");\nlet K = class extends k {\n  constructor(t) {\n    super(t), this._infos = new Map(), this.events = new i(), this.objects = new e(), this.enableZ = !0, this.sketchOptions = new X(), this.type = \"move-3d\", this._latestTooltipInfo = null, this._translateTooltipInfo = null, this._translateXYTooltipInfo = null, this._translateZTooltipInfo = null, this._updatingHandles = new u(), this._moveManipulation = null;\n  }\n  initialize() {\n    const {\n      view: t\n    } = this;\n    this.tooltip = A(() => ({\n      view: t,\n      options: this.sketchOptions.tooltips\n    })), this.addHandles([this.objects.on(\"change\", t => {\n      t.removed.forEach(t => this.removeHandles(t)), this._updateObjectInfos(t), this._setupFastTransformUpdates(t.added), this._refreshManipulators();\n    }), this.objects.on(\"change\", () => this._connectTooltips())]);\n    const o = this.objects.toArray();\n    this._updateObjectInfos({\n      added: o,\n      removed: []\n    }), this._setupFastTransformUpdates(o), this._refreshManipulators(), this._connectTooltips(), this.finishToolCreation();\n  }\n  destroy() {\n    this.tooltip = s(this.tooltip), this._moveManipulation = s(this._moveManipulation), this._set(\"view\", null), this._updatingHandles.destroy();\n  }\n  onInputEvent(t) {\n    if (!this.destroyed && !z(t, this.tooltip)) return super.onInputEvent(t);\n  }\n  get updating() {\n    return this._updatingHandles.updating;\n  }\n  get _shouldShowMovePointTooltip() {\n    const {\n      objects: t\n    } = this;\n    if (1 !== t.length) return !1;\n    const o = _(t.at(0))?.type;\n    return \"point\" === o || \"mesh\" === o;\n  }\n  get activeTooltipInfo() {\n    return this._shouldShowMovePointTooltip ? this._movePointTooltipInfo : this._latestTooltipInfo;\n  }\n  reset() {}\n  _updateObjectInfos({\n    added: t,\n    removed: o\n  }) {\n    for (const e of t) {\n      if (x(e) !== g.SUPPORTED) continue;\n      const t = new Q(e);\n      this._infos.set(e, t);\n    }\n    for (const e of o) this._infos.delete(e);\n  }\n  _setupFastTransformUpdates(t) {\n    for (const o of t) {\n      const t = this._infos.get(o);\n      this.addHandles(j(t.object), o);\n    }\n  }\n  _refreshManipulators() {\n    if (this.removeHandles(q), this._moveManipulation = s(this._moveManipulation), this.manipulators.removeAll(), 0 === this._infos.size) return;\n    const t = Array.from(this._infos.values());\n    this._createManipulators(t), this._createVisualElements(t), this._updateMoveManipulation(t);\n  }\n  _createManipulators(t) {\n    for (const o of t) {\n      const e = o.object;\n      o.manipulationXY = new O({\n        tool: this,\n        view: this.view,\n        object: e\n      }), o.manipulationXY.forEachManipulator(t => {\n        this.addHandles([t.events.on(\"immediate-click\", t => {\n          this.events.emit(\"immediate-click\", {\n            ...t,\n            object: e\n          }), t.stopPropagation();\n        }), t.events.on(\"grab-changed\", ({\n          action: t\n        }) => {\n          \"start\" === t ? this._showTooltip(w.XY) : this._hideTooltip();\n        })], q);\n      }), this.addHandles(o.manipulationXY.createDragPipeline((o, e, i, n) => this._buildDragEventPipeline(t, w.XY, o, e, i, n)), q);\n    }\n    this._createMoveManipulation(t);\n  }\n  _createMoveManipulation(t) {\n    const o = new I({\n      tool: this,\n      view: this.view,\n      snapToScene: !1,\n      xyAvailable: !0,\n      xyAxisAvailable: !0,\n      zAvailable: !0,\n      radius: 1 === t.length ? I.radiusForSymbol(t[0].object.graphic?.symbol) : T\n    });\n    this._moveManipulation = o, o.elevationInfo = {\n      mode: \"absolute-height\",\n      offset: 0\n    }, o.forEachManipulator(t => {\n      this.addHandles(t.events.on(\"immediate-click\", e => {\n        const i = this.objects.at(0);\n        !o.zManipulation.hasManipulator(t) && 1 === this.objects.length && i && this.events.emit(\"immediate-click\", {\n          ...e,\n          object: i\n        }), e.stopPropagation();\n      }), q);\n    });\n    const e = t => o => {\n      this.addHandles([o.events.on(\"focus-changed\", ({\n        action: o\n      }) => {\n        \"focus\" === o ? this._showTooltip(t) : this._hideTooltip();\n      }), o.events.on(\"grab-changed\", () => {\n        this._latestTooltipInfo && (this._latestTooltipInfo.distance = a);\n      })], q);\n    };\n    this._moveManipulation.xyManipulation.forEachManipulator(e(w.XY)), this._moveManipulation.xyAxisManipulation.forEachManipulator(e(w.XY_AXIS)), this._moveManipulation.zManipulation.forEachManipulator(e(w.Z));\n    const i = () => this._updateMoveManipulation(t);\n    for (const a of t) this.addHandles([a.object.on(\"committed\", i), r(() => a.object.visible, i)], q);\n    const n = t[t.length - 1];\n    this.addHandles(n.object.on(\"committed\", () => this._updateMoveManipulationAngle(n)), q);\n    const {\n        object: s\n      } = n,\n      {\n        operations: l\n      } = s;\n    if (l) {\n      const e = s.graphic;\n      this.addHandles(o.createDragPipeline((o, e, i, n, s) => this._buildDragEventPipeline(t, o, e, i, n, s), s.elevationInfo, l.data.spatialReference, e), q);\n    }\n    this._updateMoveManipulationAngle(n);\n  }\n  _createVisualElements(t) {\n    for (const o of t) {\n      const e = o.object,\n        i = y({\n          view: this.view,\n          object: e,\n          forEachManipulator: t => {\n            o.manipulationXY?.forEachManipulator(t), this._moveManipulation?.forEachManipulator(t);\n          },\n          onManipulatorsChanged: () => n()\n        });\n      null != i && (o.geometryRepresentation = i.visualElement, o.geometryRepresentation instanceof E && this.addHandles([o.geometryRepresentation.events.on(\"attachment-origin-changed\", () => {\n        o.object.isDraped || this._updateMoveManipulation(t);\n      }), r(() => o.object.isDraped, () => this._updateMoveManipulation(t))], q), this.addHandles(i, q));\n    }\n  }\n  _updateMoveManipulationAngle(t) {\n    this._moveManipulation && (this._moveManipulation.angle = v(_(t.object)));\n  }\n  _updateMoveManipulation(t) {\n    const o = m(0, 0, 0, this.view.spatialReference);\n    let e = 0,\n      i = !1;\n    const n = this._moveManipulation;\n    if (n) {\n      for (const n of t) {\n        if (!n.object.visible) continue;\n        this.enableZ && M(n.object.operations, n.object.elevationInfo) && (i = !0);\n        const t = n.geometryRepresentation instanceof E && !n.object.isDraped ? n.geometryRepresentation.attachmentOrigin : n.object.origin;\n        if (null != t) {\n          const {\n            x: i,\n            y: n,\n            z: s\n          } = t;\n          o.x += i, o.y += n, s && (o.z ??= 0, o.z += s), e++;\n        }\n      }\n      e > 0 ? (o.x /= e, o.y /= e, o.z ??= 0, o.z /= e, n.location = o, n.xyManipulation.available = !0, n.xyAxisManipulation.available = !0, n.zManipulation.available = i) : n.available = !1;\n    }\n  }\n  _buildDragEventPipeline(t, o, e, i, n, s) {\n    const a = [],\n      l = [];\n    let r = null,\n      p = null;\n    const c = () => {\n      for (const t of a) t.dragging = !1;\n      a.length = 0, l.length = 0, r = null, p = null, this._moveManipulation && (this._moveManipulation.interactive = !0);\n    };\n    if (1 === t.length && o === w.XY) {\n      const o = t[0].object;\n      ({\n        steps: i,\n        cancel: n\n      } = this._buildSnappingPipelineSteps(o, o.elevationInfo, i, n, s));\n    }\n    return n = n.next(t => p?.(t)).next(() => (l.length && this.events.emit(\"move-stop\", new N(l)), this.destroyed || c(), null)), {\n      steps: i = i.next(o => {\n        if (\"start\" === o.action) {\n          a.length = 0, l.length = 0;\n          for (const o of t) o.dragging || !o.manipulationXY?.hasManipulator(e) && o.manipulationXY?.grabbing || (a.push(o), l.push(o.object), o.dragging = !0);\n          if (0 !== l.length && (this._moveManipulation && (this._moveManipulation.interactive = !1), r = U(l), p = P(l), this._emitRecordUndo(), this.events.emit(\"move-start\", new L(l)), this.destroyed)) return null;\n        }\n        return 0 !== l.length ? o : null;\n      }).next(t => r?.(t)).next(t => (this._updateMoveTooltip(o, t), t)).next(t => {\n        switch (t.action) {\n          case \"start\":\n          case \"update\":\n            if (t.translationX || t.translationY || t.translationZ) {\n              const o = this.view.toScreen(t.mapStart),\n                e = this.view.toScreen(t.mapEnd);\n              if (!o || !e) return null;\n              const i = e.x - o.x,\n                n = e.y - o.y;\n              if (this.events.emit(\"move\", new B(i, n, l)), this.destroyed) return null;\n            }\n            break;\n          case \"end\":\n            if (this.events.emit(\"move-stop\", new N(l)), this.destroyed) return null;\n            c();\n        }\n        return null;\n      }),\n      cancel: n\n    };\n  }\n  _connectTooltips() {\n    let t;\n    if (this.removeHandles(J), this._shouldShowMovePointTooltip) {\n      const o = this.objects.at(0),\n        {\n          events: e\n        } = this;\n      this._movePointTooltipInfo ??= new D({\n        viewType: this.view.type,\n        sketchOptions: this.sketchOptions\n      });\n      const i = {\n        onBeforeUpdate: () => this.endDrag(),\n        onMoveStart: () => {\n          this._emitRecordUndo(), e.emit(\"move-start\", new L([o]));\n        },\n        onMove: () => e.emit(\"move\", new B(0, 0, [o])),\n        onMoveStop: () => e.emit(\"move-stop\", new N([o])),\n        onRotateStart: () => {},\n        onRotate: () => {},\n        onRotateStop: () => {},\n        onScaleStart: () => {},\n        onScale: () => {},\n        onScaleStop: () => {}\n      };\n      t = b(this.tooltip, o, () => ({\n        sketchOptions: this.sketchOptions,\n        activeTooltipInfo: this._movePointTooltipInfo,\n        callbacks: i\n      }));\n    } else t = r(() => this.sketchOptions.tooltips.effectiveEnabled ? this._latestTooltipInfo : null, t => {\n      this.tooltip.info = t;\n    }, p);\n    this.addHandles(t, J);\n  }\n  _showTooltip(t) {\n    this._shouldShowMovePointTooltip || this._updateMoveTooltip(t);\n  }\n  _hideTooltip() {\n    this._shouldShowMovePointTooltip || (this.tooltip?.clear(), this._latestTooltipInfo = null);\n  }\n  _updateMoveTooltip(t, o) {\n    if (this._shouldShowMovePointTooltip) return;\n    const {\n      sketchOptions: e\n    } = this;\n    switch (t) {\n      case w.XY:\n        this._latestTooltipInfo = this._translateTooltipInfo ??= new Z({\n          sketchOptions: e\n        }), W(this._latestTooltipInfo, o, (t, o) => V(t, o));\n        break;\n      case w.XY_AXIS:\n        this._latestTooltipInfo = this._translateXYTooltipInfo ??= new C({\n          sketchOptions: e\n        }), W(this._latestTooltipInfo, o, (t, e) => l(V(t, e), S(o)));\n        break;\n      case w.Z:\n        this._latestTooltipInfo = this._translateZTooltipInfo ??= new F({\n          sketchOptions: e\n        }), W(this._latestTooltipInfo, o, G);\n    }\n    this._latestTooltipInfo.sketchOptions = e;\n  }\n  _emitRecordUndo() {\n    const t = this.objects.toArray().map(t => t.createUndoRecord?.()).filter(o);\n    t.length > 0 && this.events.emit(\"record-undo\", {\n      updates: t\n    });\n  }\n  _buildSnappingPipelineSteps(t, o, e, i, n) {\n    const s = _(t);\n    if (null == s || \"point\" !== s.type && \"mesh\" !== s.type) return {\n      steps: e,\n      cancel: i\n    };\n    const a = (\"point\" === s.type ? s : s.origin).clone(),\n      l = new Y({\n        elevationInfo: o,\n        pointer: n,\n        editGeometryOperations: H.fromGeometry(a, this.view.state.viewingMode),\n        visualizer: new f(),\n        excludeFeature: t.graphic\n      }),\n      r = this.snappingManager,\n      {\n        snappingStep: p,\n        cancelSnapping: c\n      } = R({\n        snappingContext: l,\n        snappingManager: r,\n        updatingHandles: this._updatingHandles\n      });\n    return i = i.next(c), {\n      steps: e = e.next(o => {\n        a.z = d(this.view, a, t.elevationInfo, {\n          mode: \"absolute-height\",\n          offset: 0\n        });\n        return {\n          ...o,\n          snapOrigin: l.coordinateHelper.pointToVector(a)\n        };\n      }).next(...p),\n      cancel: i\n    };\n  }\n};\nt([c({\n  constructOnly: !0,\n  nonNullable: !0\n})], K.prototype, \"view\", void 0), t([c()], K.prototype, \"objects\", void 0), t([c({\n  constructOnly: !0,\n  nonNullable: !0\n})], K.prototype, \"enableZ\", void 0), t([c({\n  constructOnly: !0,\n  type: X\n})], K.prototype, \"sketchOptions\", void 0), t([c({\n  constructOnly: !0\n})], K.prototype, \"snappingManager\", void 0), t([c()], K.prototype, \"type\", void 0), t([c()], K.prototype, \"updating\", null), t([c()], K.prototype, \"_latestTooltipInfo\", void 0), t([c()], K.prototype, \"_shouldShowMovePointTooltip\", null), t([c()], K.prototype, \"activeTooltipInfo\", null), K = t([h(\"esri.views.3d.interactive.editingTools.move.MoveTool3D\")], K);\nclass Q {\n  constructor(t) {\n    this.object = t, this.geometryRepresentation = null, this.manipulationXY = null, this.dragging = !1;\n  }\n}\nfunction W(t, o, e) {\n  if (null == o || \"end\" === o.action) return void (t.distance = a);\n  const {\n      mapStart: i,\n      mapEnd: n\n    } = o,\n    s = e(i, n);\n  t.distance = null != s ? s : a;\n}\nexport { B as MoveEvent, L as MoveStartEvent, N as MoveStopEvent, K as MoveTool3D };","map":{"version":3,"names":["_","t","isSome","o","e","i","makeHandle","n","destroyMaybe","s","zeroMeters","a","scale","l","watch","r","syncAndInitial","p","property","c","subclass","h","UpdatingHandles","u","makeDehydratedPoint","m","getConvertedElevation","d","SnappingVisualizer3D","f","orientation","v","SupportedObjectResult","g","manipulatedObjectGeometry","canMoveZOperations","M","meshTransformFastUpdateHandles","j","connectTooltipToManipulatedObject","b","createVisualElements","y","discRadius","T","ManipulationType","w","MoveManipulation","I","axisConstrainedDragSign","S","MoveXYObjectManipulation","O","isSupportedObject","x","OutlineVisualElement","E","dragManipulatedObjectMany","U","resetManipulatedObjectMany","P","InteractiveToolBase","k","EditGeometryOperations","H","X","SnappingContext","Y","createSnapDragEventPipelineStep","R","makeTooltip","A","enterInputModeIfAvailable","z","MovePointTooltipInfo","D","TranslateTooltipInfo","Z","TranslateXYTooltipInfo","C","TranslateZTooltipInfo","F","autoDistanceBetweenPoints2D","V","verticalSignedDistanceBetweenPoints","G","L","constructor","objects","type","B","dx","dy","N","q","Symbol","J","K","_infos","Map","events","enableZ","sketchOptions","_latestTooltipInfo","_translateTooltipInfo","_translateXYTooltipInfo","_translateZTooltipInfo","_updatingHandles","_moveManipulation","initialize","view","tooltip","options","tooltips","addHandles","on","removed","forEach","removeHandles","_updateObjectInfos","_setupFastTransformUpdates","added","_refreshManipulators","_connectTooltips","toArray","finishToolCreation","destroy","_set","onInputEvent","destroyed","updating","_shouldShowMovePointTooltip","length","at","activeTooltipInfo","_movePointTooltipInfo","reset","SUPPORTED","Q","set","delete","get","object","manipulators","removeAll","size","Array","from","values","_createManipulators","_createVisualElements","_updateMoveManipulation","manipulationXY","tool","forEachManipulator","emit","stopPropagation","action","_showTooltip","XY","_hideTooltip","createDragPipeline","_buildDragEventPipeline","_createMoveManipulation","snapToScene","xyAvailable","xyAxisAvailable","zAvailable","radius","radiusForSymbol","graphic","symbol","elevationInfo","mode","offset","zManipulation","hasManipulator","distance","xyManipulation","xyAxisManipulation","XY_AXIS","visible","_updateMoveManipulationAngle","operations","data","spatialReference","onManipulatorsChanged","geometryRepresentation","visualElement","isDraped","angle","attachmentOrigin","origin","location","available","dragging","interactive","steps","cancel","_buildSnappingPipelineSteps","next","grabbing","push","_emitRecordUndo","_updateMoveTooltip","translationX","translationY","translationZ","toScreen","mapStart","mapEnd","viewType","onBeforeUpdate","endDrag","onMoveStart","onMove","onMoveStop","onRotateStart","onRotate","onRotateStop","onScaleStart","onScale","onScaleStop","callbacks","effectiveEnabled","info","clear","W","map","createUndoRecord","filter","updates","clone","pointer","editGeometryOperations","fromGeometry","state","viewingMode","visualizer","excludeFeature","snappingManager","snappingStep","cancelSnapping","snappingContext","updatingHandles","snapOrigin","coordinateHelper","pointToVector","constructOnly","nonNullable","prototype","MoveEvent","MoveStartEvent","MoveStopEvent","MoveTool3D"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/3d/interactive/editingTools/move/MoveTool3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../../chunks/tslib.es6.js\";import{isSome as o}from\"../../../../../core/arrayUtils.js\";import e from\"../../../../../core/Collection.js\";import i from\"../../../../../core/Evented.js\";import{makeHandle as n}from\"../../../../../core/handleUtils.js\";import{destroyMaybe as s}from\"../../../../../core/maybe.js\";import{zeroMeters as a,scale as l}from\"../../../../../core/quantityUtils.js\";import{watch as r,syncAndInitial as p}from\"../../../../../core/reactiveUtils.js\";import{property as c}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/Logger.js\";import{subclass as h}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{UpdatingHandles as u}from\"../../../../../core/support/UpdatingHandles.js\";import{makeDehydratedPoint as m}from\"../../../../../layers/graphics/dehydratedPoint.js\";import{getConvertedElevation as d}from\"../../../../../support/elevationInfoUtils.js\";import{SnappingVisualizer3D as f}from\"../../SnappingVisualizer3D.js\";import{orientation as v}from\"../geometryUtils.js\";import{SupportedObjectResult as g}from\"../isSupportedObjectUtils.js\";import{manipulatedObjectGeometry as _}from\"../manipulatedObjectUtils.js\";import{canMoveZOperations as M}from\"../manipulatorUtils.js\";import{meshTransformFastUpdateHandles as j}from\"../meshFastUpdateUtils.js\";import{connectTooltipToManipulatedObject as b}from\"../tooltipUtils3D.js\";import{createVisualElements as y}from\"../visualElementUtils.js\";import{discRadius as T}from\"../manipulations/config.js\";import{ManipulationType as w,MoveManipulation as I}from\"../manipulations/MoveManipulation.js\";import{axisConstrainedDragSign as S}from\"../manipulations/moveUtils.js\";import{MoveXYObjectManipulation as O}from\"../manipulations/MoveXYObjectManipulation.js\";import{isSupportedObject as x}from\"./isSupportedObject.js\";import{OutlineVisualElement as E}from\"../../visualElements/OutlineVisualElement.js\";import{dragManipulatedObjectMany as U,resetManipulatedObjectMany as P}from\"../../../../interactive/dragEventPipeline.js\";import{InteractiveToolBase as k}from\"../../../../interactive/InteractiveToolBase.js\";import{EditGeometryOperations as H}from\"../../../../interactive/editGeometry/EditGeometryOperations.js\";import X from\"../../../../interactive/sketch/SketchOptions.js\";import{SnappingContext as Y}from\"../../../../interactive/snapping/SnappingContext.js\";import{createSnapDragEventPipelineStep as R}from\"../../../../interactive/snapping/SnappingDragPipelineStep.js\";import{makeTooltip as A,enterInputModeIfAvailable as z}from\"../../../../interactive/tooltip/tooltipCommonUtils.js\";import{MovePointTooltipInfo as D}from\"../../../../interactive/tooltip/infos/MovePointTooltipInfo.js\";import{TranslateTooltipInfo as Z}from\"../../../../interactive/tooltip/infos/TranslateTooltipInfo.js\";import{TranslateXYTooltipInfo as C}from\"../../../../interactive/tooltip/infos/TranslateXYTooltipInfo.js\";import{TranslateZTooltipInfo as F}from\"../../../../interactive/tooltip/infos/TranslateZTooltipInfo.js\";import{autoDistanceBetweenPoints2D as V}from\"../../../../support/automaticLengthMeasurementUtils.js\";import{verticalSignedDistanceBetweenPoints as G}from\"../../../../support/euclideanLengthMeasurementUtils.js\";class L{constructor(t){this.objects=t,this.type=\"move-start\"}}class B{constructor(t,o,e){this.dx=t,this.dy=o,this.objects=e,this.type=\"move\"}}class N{constructor(t){this.objects=t,this.type=\"move-stop\"}}const q=Symbol(\"manipulators\"),J=Symbol(\"tooltips\");let K=class extends k{constructor(t){super(t),this._infos=new Map,this.events=new i,this.objects=new e,this.enableZ=!0,this.sketchOptions=new X,this.type=\"move-3d\",this._latestTooltipInfo=null,this._translateTooltipInfo=null,this._translateXYTooltipInfo=null,this._translateZTooltipInfo=null,this._updatingHandles=new u,this._moveManipulation=null}initialize(){const{view:t}=this;this.tooltip=A((()=>({view:t,options:this.sketchOptions.tooltips}))),this.addHandles([this.objects.on(\"change\",(t=>{t.removed.forEach((t=>this.removeHandles(t))),this._updateObjectInfos(t),this._setupFastTransformUpdates(t.added),this._refreshManipulators()})),this.objects.on(\"change\",(()=>this._connectTooltips()))]);const o=this.objects.toArray();this._updateObjectInfos({added:o,removed:[]}),this._setupFastTransformUpdates(o),this._refreshManipulators(),this._connectTooltips(),this.finishToolCreation()}destroy(){this.tooltip=s(this.tooltip),this._moveManipulation=s(this._moveManipulation),this._set(\"view\",null),this._updatingHandles.destroy()}onInputEvent(t){if(!this.destroyed&&!z(t,this.tooltip))return super.onInputEvent(t)}get updating(){return this._updatingHandles.updating}get _shouldShowMovePointTooltip(){const{objects:t}=this;if(1!==t.length)return!1;const o=_(t.at(0))?.type;return\"point\"===o||\"mesh\"===o}get activeTooltipInfo(){return this._shouldShowMovePointTooltip?this._movePointTooltipInfo:this._latestTooltipInfo}reset(){}_updateObjectInfos({added:t,removed:o}){for(const e of t){if(x(e)!==g.SUPPORTED)continue;const t=new Q(e);this._infos.set(e,t)}for(const e of o)this._infos.delete(e)}_setupFastTransformUpdates(t){for(const o of t){const t=this._infos.get(o);this.addHandles(j(t.object),o)}}_refreshManipulators(){if(this.removeHandles(q),this._moveManipulation=s(this._moveManipulation),this.manipulators.removeAll(),0===this._infos.size)return;const t=Array.from(this._infos.values());this._createManipulators(t),this._createVisualElements(t),this._updateMoveManipulation(t)}_createManipulators(t){for(const o of t){const e=o.object;o.manipulationXY=new O({tool:this,view:this.view,object:e}),o.manipulationXY.forEachManipulator((t=>{this.addHandles([t.events.on(\"immediate-click\",(t=>{this.events.emit(\"immediate-click\",{...t,object:e}),t.stopPropagation()})),t.events.on(\"grab-changed\",(({action:t})=>{\"start\"===t?this._showTooltip(w.XY):this._hideTooltip()}))],q)})),this.addHandles(o.manipulationXY.createDragPipeline(((o,e,i,n)=>this._buildDragEventPipeline(t,w.XY,o,e,i,n))),q)}this._createMoveManipulation(t)}_createMoveManipulation(t){const o=new I({tool:this,view:this.view,snapToScene:!1,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:!0,radius:1===t.length?I.radiusForSymbol(t[0].object.graphic?.symbol):T});this._moveManipulation=o,o.elevationInfo={mode:\"absolute-height\",offset:0},o.forEachManipulator((t=>{this.addHandles(t.events.on(\"immediate-click\",(e=>{const i=this.objects.at(0);!o.zManipulation.hasManipulator(t)&&1===this.objects.length&&i&&this.events.emit(\"immediate-click\",{...e,object:i}),e.stopPropagation()})),q)}));const e=t=>o=>{this.addHandles([o.events.on(\"focus-changed\",(({action:o})=>{\"focus\"===o?this._showTooltip(t):this._hideTooltip()})),o.events.on(\"grab-changed\",(()=>{this._latestTooltipInfo&&(this._latestTooltipInfo.distance=a)}))],q)};this._moveManipulation.xyManipulation.forEachManipulator(e(w.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(e(w.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(e(w.Z));const i=()=>this._updateMoveManipulation(t);for(const a of t)this.addHandles([a.object.on(\"committed\",i),r((()=>a.object.visible),i)],q);const n=t[t.length-1];this.addHandles(n.object.on(\"committed\",(()=>this._updateMoveManipulationAngle(n))),q);const{object:s}=n,{operations:l}=s;if(l){const e=s.graphic;this.addHandles(o.createDragPipeline(((o,e,i,n,s)=>this._buildDragEventPipeline(t,o,e,i,n,s)),s.elevationInfo,l.data.spatialReference,e),q)}this._updateMoveManipulationAngle(n)}_createVisualElements(t){for(const o of t){const e=o.object,i=y({view:this.view,object:e,forEachManipulator:t=>{o.manipulationXY?.forEachManipulator(t),this._moveManipulation?.forEachManipulator(t)},onManipulatorsChanged:()=>n()});null!=i&&(o.geometryRepresentation=i.visualElement,o.geometryRepresentation instanceof E&&this.addHandles([o.geometryRepresentation.events.on(\"attachment-origin-changed\",(()=>{o.object.isDraped||this._updateMoveManipulation(t)})),r((()=>o.object.isDraped),(()=>this._updateMoveManipulation(t)))],q),this.addHandles(i,q))}}_updateMoveManipulationAngle(t){this._moveManipulation&&(this._moveManipulation.angle=v(_(t.object)))}_updateMoveManipulation(t){const o=m(0,0,0,this.view.spatialReference);let e=0,i=!1;const n=this._moveManipulation;if(n){for(const n of t){if(!n.object.visible)continue;this.enableZ&&M(n.object.operations,n.object.elevationInfo)&&(i=!0);const t=n.geometryRepresentation instanceof E&&!n.object.isDraped?n.geometryRepresentation.attachmentOrigin:n.object.origin;if(null!=t){const{x:i,y:n,z:s}=t;o.x+=i,o.y+=n,s&&(o.z??=0,o.z+=s),e++}}e>0?(o.x/=e,o.y/=e,o.z??=0,o.z/=e,n.location=o,n.xyManipulation.available=!0,n.xyAxisManipulation.available=!0,n.zManipulation.available=i):n.available=!1}}_buildDragEventPipeline(t,o,e,i,n,s){const a=[],l=[];let r=null,p=null;const c=()=>{for(const t of a)t.dragging=!1;a.length=0,l.length=0,r=null,p=null,this._moveManipulation&&(this._moveManipulation.interactive=!0)};if(1===t.length&&o===w.XY){const o=t[0].object;({steps:i,cancel:n}=this._buildSnappingPipelineSteps(o,o.elevationInfo,i,n,s))}return n=n.next((t=>p?.(t))).next((()=>(l.length&&this.events.emit(\"move-stop\",new N(l)),this.destroyed||c(),null))),{steps:i=i.next((o=>{if(\"start\"===o.action){a.length=0,l.length=0;for(const o of t)o.dragging||!o.manipulationXY?.hasManipulator(e)&&o.manipulationXY?.grabbing||(a.push(o),l.push(o.object),o.dragging=!0);if(0!==l.length&&(this._moveManipulation&&(this._moveManipulation.interactive=!1),r=U(l),p=P(l),this._emitRecordUndo(),this.events.emit(\"move-start\",new L(l)),this.destroyed))return null}return 0!==l.length?o:null})).next((t=>r?.(t))).next((t=>(this._updateMoveTooltip(o,t),t))).next((t=>{switch(t.action){case\"start\":case\"update\":if(t.translationX||t.translationY||t.translationZ){const o=this.view.toScreen(t.mapStart),e=this.view.toScreen(t.mapEnd);if(!o||!e)return null;const i=e.x-o.x,n=e.y-o.y;if(this.events.emit(\"move\",new B(i,n,l)),this.destroyed)return null}break;case\"end\":if(this.events.emit(\"move-stop\",new N(l)),this.destroyed)return null;c()}return null})),cancel:n}}_connectTooltips(){let t;if(this.removeHandles(J),this._shouldShowMovePointTooltip){const o=this.objects.at(0),{events:e}=this;this._movePointTooltipInfo??=new D({viewType:this.view.type,sketchOptions:this.sketchOptions});const i={onBeforeUpdate:()=>this.endDrag(),onMoveStart:()=>{this._emitRecordUndo(),e.emit(\"move-start\",new L([o]))},onMove:()=>e.emit(\"move\",new B(0,0,[o])),onMoveStop:()=>e.emit(\"move-stop\",new N([o])),onRotateStart:()=>{},onRotate:()=>{},onRotateStop:()=>{},onScaleStart:()=>{},onScale:()=>{},onScaleStop:()=>{}};t=b(this.tooltip,o,(()=>({sketchOptions:this.sketchOptions,activeTooltipInfo:this._movePointTooltipInfo,callbacks:i})))}else t=r((()=>this.sketchOptions.tooltips.effectiveEnabled?this._latestTooltipInfo:null),(t=>{this.tooltip.info=t}),p);this.addHandles(t,J)}_showTooltip(t){this._shouldShowMovePointTooltip||this._updateMoveTooltip(t)}_hideTooltip(){this._shouldShowMovePointTooltip||(this.tooltip?.clear(),this._latestTooltipInfo=null)}_updateMoveTooltip(t,o){if(this._shouldShowMovePointTooltip)return;const{sketchOptions:e}=this;switch(t){case w.XY:this._latestTooltipInfo=this._translateTooltipInfo??=new Z({sketchOptions:e}),W(this._latestTooltipInfo,o,((t,o)=>V(t,o)));break;case w.XY_AXIS:this._latestTooltipInfo=this._translateXYTooltipInfo??=new C({sketchOptions:e}),W(this._latestTooltipInfo,o,((t,e)=>l(V(t,e),S(o))));break;case w.Z:this._latestTooltipInfo=this._translateZTooltipInfo??=new F({sketchOptions:e}),W(this._latestTooltipInfo,o,G)}this._latestTooltipInfo.sketchOptions=e}_emitRecordUndo(){const t=this.objects.toArray().map((t=>t.createUndoRecord?.())).filter(o);t.length>0&&this.events.emit(\"record-undo\",{updates:t})}_buildSnappingPipelineSteps(t,o,e,i,n){const s=_(t);if(null==s||\"point\"!==s.type&&\"mesh\"!==s.type)return{steps:e,cancel:i};const a=(\"point\"===s.type?s:s.origin).clone(),l=new Y({elevationInfo:o,pointer:n,editGeometryOperations:H.fromGeometry(a,this.view.state.viewingMode),visualizer:new f,excludeFeature:t.graphic}),r=this.snappingManager,{snappingStep:p,cancelSnapping:c}=R({snappingContext:l,snappingManager:r,updatingHandles:this._updatingHandles});return i=i.next(c),{steps:e=e.next((o=>{a.z=d(this.view,a,t.elevationInfo,{mode:\"absolute-height\",offset:0});return{...o,snapOrigin:l.coordinateHelper.pointToVector(a)}})).next(...p),cancel:i}}};t([c({constructOnly:!0,nonNullable:!0})],K.prototype,\"view\",void 0),t([c()],K.prototype,\"objects\",void 0),t([c({constructOnly:!0,nonNullable:!0})],K.prototype,\"enableZ\",void 0),t([c({constructOnly:!0,type:X})],K.prototype,\"sketchOptions\",void 0),t([c({constructOnly:!0})],K.prototype,\"snappingManager\",void 0),t([c()],K.prototype,\"type\",void 0),t([c()],K.prototype,\"updating\",null),t([c()],K.prototype,\"_latestTooltipInfo\",void 0),t([c()],K.prototype,\"_shouldShowMovePointTooltip\",null),t([c()],K.prototype,\"activeTooltipInfo\",null),K=t([h(\"esri.views.3d.interactive.editingTools.move.MoveTool3D\")],K);class Q{constructor(t){this.object=t,this.geometryRepresentation=null,this.manipulationXY=null,this.dragging=!1}}function W(t,o,e){if(null==o||\"end\"===o.action)return void(t.distance=a);const{mapStart:i,mapEnd:n}=o,s=e(i,n);t.distance=null!=s?s:a}export{B as MoveEvent,L as MoveStartEvent,N as MoveStopEvent,K as MoveTool3D};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}