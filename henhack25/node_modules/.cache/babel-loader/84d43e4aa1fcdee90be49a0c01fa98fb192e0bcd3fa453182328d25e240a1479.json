{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { Z as e } from \"../chunks/languageUtils.js\";\nimport t from \"../core/Logger.js\";\nimport { getOrCreateMapValue as r } from \"../core/MapUtils.js\";\nimport { throwIfAborted as n } from \"../core/promiseUtils.js\";\nimport { addMaybe as i } from \"../core/SetUtils.js\";\nimport { isFeatureTemplateDefinition as o, isGroupTemplateDefinition as s, isPresetTemplateDefinition as a } from \"./sharedTemplates/templateDefinitions/templateDefinitionUtils.js\";\nimport { isSubtypeGroupLayer as l, isFeatureLayer as f } from \"../layers/support/layerUtils.js\";\nimport { getServices as u } from \"../undoredo/support/Services.js\";\nconst p = () => t.getLogger(\"esri.editing.templateUtils\");\nfunction c(e) {\n  return null != e && \"prototype\" in e;\n}\nfunction m(e) {\n  return d(e) && !(\"definition\" in e);\n}\nfunction y(e) {\n  return d(e) && \"definition\" in e;\n}\nfunction d(e) {\n  return null != e && \"templateId\" in e;\n}\nfunction g(e) {\n  return y(e) && \"feature\" === e?.type && (null == e.definition || o(e.definition));\n}\nfunction w(e) {\n  return y(e) && \"group\" === e?.type && (null == e.definition || s(e.definition));\n}\nfunction A(e) {\n  return y(e) && \"preset\" === e?.type && (null == e.definition || a(e.definition));\n}\nfunction h(e) {\n  return y(e) && null != e?.definition;\n}\nconst j = e => {\n  if (null == e || \"object\" != typeof e) return [];\n  return [...(\"templates\" in e && Array.isArray(e.templates) ? e.templates : []), ...(\"types\" in e && Array.isArray(e.types) ? e.types.flatMap(e => e.templates) : [])];\n};\nasync function v(e, t, r) {\n  if (null == t) return e.map(e => ({\n    layer: e,\n    templates: j(e)\n  }));\n  const i = await M(e, t);\n  n(r);\n  const o = new Map(),\n    s = Array.from(i).map(e => S({\n      serviceInfo: e,\n      out: o,\n      signal: r,\n      view: t\n    })),\n    a = await Promise.allSettled(s);\n  for (const n of a.filter(e => \"rejected\" === e.status)) p().warn(\"Failed to fetch shared templates for service. Will use standard templates if available.\", n.reason);\n  return e.map(e => ({\n    layer: e,\n    templates: o.get(e) ?? j(e)\n  }));\n}\nasync function S({\n  serviceInfo: e,\n  out: t,\n  signal: r\n}) {\n  const {\n      featureService: i,\n      layersAndTables: o\n    } = e,\n    s = await b({\n      featureService: i,\n      layers: o.toArray(),\n      signal: r\n    });\n  n(r);\n  for (const [n, a] of s.entries()) if (0 !== a.length) if (l(n)) {\n    const e = L(a),\n      r = [],\n      i = e.get(1 / 0) ?? r;\n    for (const o of n.sublayers) {\n      const n = e.get(o.subtypeCode) ?? r;\n      t.set(o, [...n, ...i]);\n    }\n  } else t.set(n, a);\n}\nasync function b({\n  featureService: e,\n  layers: t,\n  signal: n\n}) {\n  if (!e.capabilities?.editing.supportsSharedTemplates) return new Map();\n  const i = new Map(t.map(e => [e.layerId, e])),\n    o = await e.querySharedTemplates({\n      query: {\n        layers: Array.from(i.keys())\n      },\n      requestOptions: {\n        signal: n\n      }\n    }),\n    s = new Map();\n  for (const a of o) for (const e of a.layerIds) i.has(e) && r(s, i.get(e), () => []).push(a);\n  return s;\n}\nasync function M(e, t) {\n  const r = await u(t).load(),\n    n = new Set();\n  for (const o of e) i(n, U(r, o));\n  return await Promise.all(Array.from(n).map(e => e.featureService.load())), n;\n}\nfunction U(t, r) {\n  return e(r) && r.parent ? t.tablesAndLayersLookup.get(r.parent) : f(r) ? t.tablesAndLayersLookup.get(r) : null;\n}\nfunction L(e) {\n  const t = new Map();\n  for (const n of e) r(t, n.subtypeCode ?? 1 / 0, () => []).push(n);\n  return t;\n}\nexport { j as getAllStandardFeatureTemplatesForLayer, U as getServiceInfoForLayer, v as getTemplatesForLayers, h as isLoadedSharedTemplate, g as isSharedFeatureTemplate, w as isSharedGroupTemplate, A as isSharedPresetTemplate, y as isSharedTemplate, m as isSharedTemplateMetadata, d as isSharedTemplateOrMetadata, c as isStandardFeatureTemplate };","map":{"version":3,"names":["Z","e","t","getOrCreateMapValue","r","throwIfAborted","n","addMaybe","i","isFeatureTemplateDefinition","o","isGroupTemplateDefinition","s","isPresetTemplateDefinition","a","isSubtypeGroupLayer","l","isFeatureLayer","f","getServices","u","p","getLogger","c","m","d","y","g","type","definition","w","A","h","j","Array","isArray","templates","types","flatMap","v","map","layer","M","Map","from","S","serviceInfo","out","signal","view","Promise","allSettled","filter","status","warn","reason","get","featureService","layersAndTables","b","layers","toArray","entries","length","L","sublayers","subtypeCode","set","capabilities","editing","supportsSharedTemplates","layerId","querySharedTemplates","query","keys","requestOptions","layerIds","has","push","load","Set","U","all","parent","tablesAndLayersLookup","getAllStandardFeatureTemplatesForLayer","getServiceInfoForLayer","getTemplatesForLayers","isLoadedSharedTemplate","isSharedFeatureTemplate","isSharedGroupTemplate","isSharedPresetTemplate","isSharedTemplate","isSharedTemplateMetadata","isSharedTemplateOrMetadata","isStandardFeatureTemplate"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/editing/templateUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{Z as e}from\"../chunks/languageUtils.js\";import t from\"../core/Logger.js\";import{getOrCreateMapValue as r}from\"../core/MapUtils.js\";import{throwIfAborted as n}from\"../core/promiseUtils.js\";import{addMaybe as i}from\"../core/SetUtils.js\";import{isFeatureTemplateDefinition as o,isGroupTemplateDefinition as s,isPresetTemplateDefinition as a}from\"./sharedTemplates/templateDefinitions/templateDefinitionUtils.js\";import{isSubtypeGroupLayer as l,isFeatureLayer as f}from\"../layers/support/layerUtils.js\";import{getServices as u}from\"../undoredo/support/Services.js\";const p=()=>t.getLogger(\"esri.editing.templateUtils\");function c(e){return null!=e&&\"prototype\"in e}function m(e){return d(e)&&!(\"definition\"in e)}function y(e){return d(e)&&\"definition\"in e}function d(e){return null!=e&&\"templateId\"in e}function g(e){return y(e)&&\"feature\"===e?.type&&(null==e.definition||o(e.definition))}function w(e){return y(e)&&\"group\"===e?.type&&(null==e.definition||s(e.definition))}function A(e){return y(e)&&\"preset\"===e?.type&&(null==e.definition||a(e.definition))}function h(e){return y(e)&&null!=e?.definition}const j=e=>{if(null==e||\"object\"!=typeof e)return[];return[...\"templates\"in e&&Array.isArray(e.templates)?e.templates:[],...\"types\"in e&&Array.isArray(e.types)?e.types.flatMap((e=>e.templates)):[]]};async function v(e,t,r){if(null==t)return e.map((e=>({layer:e,templates:j(e)})));const i=await M(e,t);n(r);const o=new Map,s=Array.from(i).map((e=>S({serviceInfo:e,out:o,signal:r,view:t}))),a=await Promise.allSettled(s);for(const n of a.filter((e=>\"rejected\"===e.status)))p().warn(\"Failed to fetch shared templates for service. Will use standard templates if available.\",n.reason);return e.map((e=>({layer:e,templates:o.get(e)??j(e)})))}async function S({serviceInfo:e,out:t,signal:r}){const{featureService:i,layersAndTables:o}=e,s=await b({featureService:i,layers:o.toArray(),signal:r});n(r);for(const[n,a]of s.entries())if(0!==a.length)if(l(n)){const e=L(a),r=[],i=e.get(1/0)??r;for(const o of n.sublayers){const n=e.get(o.subtypeCode)??r;t.set(o,[...n,...i])}}else t.set(n,a)}async function b({featureService:e,layers:t,signal:n}){if(!e.capabilities?.editing.supportsSharedTemplates)return new Map;const i=new Map(t.map((e=>[e.layerId,e]))),o=await e.querySharedTemplates({query:{layers:Array.from(i.keys())},requestOptions:{signal:n}}),s=new Map;for(const a of o)for(const e of a.layerIds)i.has(e)&&r(s,i.get(e),(()=>[])).push(a);return s}async function M(e,t){const r=await u(t).load(),n=new Set;for(const o of e)i(n,U(r,o));return await Promise.all(Array.from(n).map((e=>e.featureService.load()))),n}function U(t,r){return e(r)&&r.parent?t.tablesAndLayersLookup.get(r.parent):f(r)?t.tablesAndLayersLookup.get(r):null}function L(e){const t=new Map;for(const n of e)r(t,n.subtypeCode??1/0,(()=>[])).push(n);return t}export{j as getAllStandardFeatureTemplatesForLayer,U as getServiceInfoForLayer,v as getTemplatesForLayers,h as isLoadedSharedTemplate,g as isSharedFeatureTemplate,w as isSharedGroupTemplate,A as isSharedPresetTemplate,y as isSharedTemplate,m as isSharedTemplateMetadata,d as isSharedTemplateOrMetadata,c as isStandardFeatureTemplate};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}