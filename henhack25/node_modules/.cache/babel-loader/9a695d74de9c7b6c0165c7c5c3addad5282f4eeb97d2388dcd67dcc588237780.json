{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { tileSize as e, textureBindingRenderer0 as t, textureBindingRenderer1 as i } from \"../../../definitions.js\";\nimport { FeatureTechnique as o } from \"../FeatureTechnique.js\";\nimport { isHighlight as r, isHittest as s, getFeatureUniforms as n, getSelectionDefines as a, getFeaturePipelineState as l, getViewUniforms as d } from \"../featureTechniqueUtils.js\";\nimport { TechniqueType as u } from \"../TechniqueType.js\";\nimport { DotDensityPointShader as c } from \"./DotDensityPointShader.js\";\nimport { DotDensityPolygonShader as p } from \"./DotDensityPolygonShader.js\";\nimport { DotDensityResources as h } from \"./DotDensityResources.js\";\nimport { FillShader as m } from \"../shaders/FillShader.js\";\nimport { FramebufferBit as f } from \"../../../../../../webgl/enums.js\";\nclass w extends o {\n  constructor() {\n    super(...arguments), this.type = u.DotDensity, this.shaders = {\n      polygon: new p(),\n      point: new c(),\n      fill: new m()\n    }, this._resources = new Map();\n  }\n  render(e, t) {\n    r(e) || s(e) ? this._renderPolygons(e, t) : this._renderDotDensity(e, t);\n  }\n  _renderPolygons(e, t) {\n    const {\n      painter: i\n    } = e;\n    i.setShader({\n      shader: this.shaders.fill,\n      uniforms: {\n        ...n(e, t.target),\n        visualVariableColor: null,\n        visualVariableOpacity: null\n      },\n      defines: {\n        ...a(e)\n      },\n      optionalAttributes: {\n        zoomRange: !1\n      },\n      useComputeBuffer: s(e)\n    }), i.setPipelineState(l(e)), i.submitDraw(e, t);\n  }\n  _renderDotDensity(o, r) {\n    const {\n        context: s,\n        painter: u,\n        requiredLevel: c\n      } = o,\n      p = r.instance.getInput().uniforms,\n      h = this._getOrCreateResourcesRecord(s),\n      m = h.getDotDensityTextures(s, e, p.seed),\n      w = 1 / 2 ** (c - r.target.key.level),\n      g = e,\n      x = g * window.devicePixelRatio * g * window.devicePixelRatio,\n      D = 1 / w * (1 / w),\n      y = p.dotScale ? o.state.scale / p.dotScale : 1,\n      b = p.dotValue * y * D;\n    u.setShader({\n      shader: this.shaders.polygon,\n      uniforms: {\n        ...n(o, r.target),\n        instance: {\n          isActive: p.isActive,\n          colors: p.colors,\n          dotValue: Math.max(1, b)\n        },\n        draw: {\n          dotTexture0: {\n            unit: t,\n            texture: m[0]\n          },\n          dotTexture1: {\n            unit: i,\n            texture: m[1]\n          },\n          tileZoomFactor: w,\n          pixelRatio: window.devicePixelRatio,\n          tileDotsOverArea: x / (e * window.devicePixelRatio * e * window.devicePixelRatio)\n        }\n      },\n      defines: {\n        ...a(o),\n        blending: p.blending\n      },\n      optionalAttributes: {},\n      useComputeBuffer: !1\n    });\n    const R = s.getViewport();\n    s.setViewport(0, 0, e, e);\n    const v = s.getBoundFramebufferObject(),\n      P = h.getFBO(s);\n    s.bindFramebuffer(P), s.setClearColor(0, 0, 0, 0), s.clear(f.COLOR), u.setPipelineState({\n      color: {\n        write: [!0, !0, !0, !0],\n        blendMode: \"composite\"\n      },\n      depth: !1,\n      stencil: !1\n    }), u.updatePipelineState(s), u.submitDraw(o, r), s.bindFramebuffer(v), s.setViewport(R.x, R.y, R.width, R.height);\n    const S = h.getFBO(s).colorTexture,\n      _ = {\n        shader: this.shaders.point,\n        uniforms: {\n          view: d(o, r.target),\n          instance: {\n            dotSize: p.dotSize\n          },\n          draw: {\n            locations: {\n              unit: t,\n              texture: S\n            },\n            tileZoomFactor: 1,\n            pixelRatio: window.devicePixelRatio\n          }\n        },\n        defines: {\n          ...a(o)\n        },\n        optionalAttributes: {},\n        useComputeBuffer: !1\n      };\n    u.setPipelineState(l(o)), u.submitDrawMesh(s, _, h.getDotDensityMesh(s));\n  }\n  shutdown(e) {\n    super.shutdown(e), this._resources.get(e)?.destroy(), this._resources.delete(e);\n  }\n  _getOrCreateResourcesRecord(e) {\n    let t = this._resources.get(e);\n    return null == t && (t = new h(), this._resources.set(e, t)), t;\n  }\n}\nexport { w as DotDensityTechnique };","map":{"version":3,"names":["tileSize","e","textureBindingRenderer0","t","textureBindingRenderer1","i","FeatureTechnique","o","isHighlight","r","isHittest","s","getFeatureUniforms","n","getSelectionDefines","a","getFeaturePipelineState","l","getViewUniforms","d","TechniqueType","u","DotDensityPointShader","c","DotDensityPolygonShader","p","DotDensityResources","h","FillShader","m","FramebufferBit","f","w","constructor","arguments","type","DotDensity","shaders","polygon","point","fill","_resources","Map","render","_renderPolygons","_renderDotDensity","painter","setShader","shader","uniforms","target","visualVariableColor","visualVariableOpacity","defines","optionalAttributes","zoomRange","useComputeBuffer","setPipelineState","submitDraw","context","requiredLevel","instance","getInput","_getOrCreateResourcesRecord","getDotDensityTextures","seed","key","level","g","x","window","devicePixelRatio","D","y","dotScale","state","scale","b","dotValue","isActive","colors","Math","max","draw","dotTexture0","unit","texture","dotTexture1","tileZoomFactor","pixelRatio","tileDotsOverArea","blending","R","getViewport","setViewport","v","getBoundFramebufferObject","P","getFBO","bindFramebuffer","setClearColor","clear","COLOR","color","write","blendMode","depth","stencil","updatePipelineState","width","height","S","colorTexture","_","view","dotSize","locations","submitDrawMesh","getDotDensityMesh","shutdown","get","destroy","delete","set","DotDensityTechnique"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/dotDensity/DotDensityTechnique.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{tileSize as e,textureBindingRenderer0 as t,textureBindingRenderer1 as i}from\"../../../definitions.js\";import{FeatureTechnique as o}from\"../FeatureTechnique.js\";import{isHighlight as r,isHittest as s,getFeatureUniforms as n,getSelectionDefines as a,getFeaturePipelineState as l,getViewUniforms as d}from\"../featureTechniqueUtils.js\";import{TechniqueType as u}from\"../TechniqueType.js\";import{DotDensityPointShader as c}from\"./DotDensityPointShader.js\";import{DotDensityPolygonShader as p}from\"./DotDensityPolygonShader.js\";import{DotDensityResources as h}from\"./DotDensityResources.js\";import{FillShader as m}from\"../shaders/FillShader.js\";import{FramebufferBit as f}from\"../../../../../../webgl/enums.js\";class w extends o{constructor(){super(...arguments),this.type=u.DotDensity,this.shaders={polygon:new p,point:new c,fill:new m},this._resources=new Map}render(e,t){r(e)||s(e)?this._renderPolygons(e,t):this._renderDotDensity(e,t)}_renderPolygons(e,t){const{painter:i}=e;i.setShader({shader:this.shaders.fill,uniforms:{...n(e,t.target),visualVariableColor:null,visualVariableOpacity:null},defines:{...a(e)},optionalAttributes:{zoomRange:!1},useComputeBuffer:s(e)}),i.setPipelineState(l(e)),i.submitDraw(e,t)}_renderDotDensity(o,r){const{context:s,painter:u,requiredLevel:c}=o,p=r.instance.getInput().uniforms,h=this._getOrCreateResourcesRecord(s),m=h.getDotDensityTextures(s,e,p.seed),w=1/2**(c-r.target.key.level),g=e,x=g*window.devicePixelRatio*g*window.devicePixelRatio,D=1/w*(1/w),y=p.dotScale?o.state.scale/p.dotScale:1,b=p.dotValue*y*D;u.setShader({shader:this.shaders.polygon,uniforms:{...n(o,r.target),instance:{isActive:p.isActive,colors:p.colors,dotValue:Math.max(1,b)},draw:{dotTexture0:{unit:t,texture:m[0]},dotTexture1:{unit:i,texture:m[1]},tileZoomFactor:w,pixelRatio:window.devicePixelRatio,tileDotsOverArea:x/(e*window.devicePixelRatio*e*window.devicePixelRatio)}},defines:{...a(o),blending:p.blending},optionalAttributes:{},useComputeBuffer:!1});const R=s.getViewport();s.setViewport(0,0,e,e);const v=s.getBoundFramebufferObject(),P=h.getFBO(s);s.bindFramebuffer(P),s.setClearColor(0,0,0,0),s.clear(f.COLOR),u.setPipelineState({color:{write:[!0,!0,!0,!0],blendMode:\"composite\"},depth:!1,stencil:!1}),u.updatePipelineState(s),u.submitDraw(o,r),s.bindFramebuffer(v),s.setViewport(R.x,R.y,R.width,R.height);const S=h.getFBO(s).colorTexture,_={shader:this.shaders.point,uniforms:{view:d(o,r.target),instance:{dotSize:p.dotSize},draw:{locations:{unit:t,texture:S},tileZoomFactor:1,pixelRatio:window.devicePixelRatio}},defines:{...a(o)},optionalAttributes:{},useComputeBuffer:!1};u.setPipelineState(l(o)),u.submitDrawMesh(s,_,h.getDotDensityMesh(s))}shutdown(e){super.shutdown(e),this._resources.get(e)?.destroy(),this._resources.delete(e)}_getOrCreateResourcesRecord(e){let t=this._resources.get(e);return null==t&&(t=new h,this._resources.set(e,t)),t}}export{w as DotDensityTechnique};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}