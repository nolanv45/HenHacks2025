{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport t from \"../../../core/Accessor.js\";\nimport { createTask as n } from \"../../../core/asyncUtils.js\";\nimport i from \"../../../core/Evented.js\";\nimport \"../../../core/has.js\";\nimport { throwIfAborted as s, isAborted as a } from \"../../../core/promiseUtils.js\";\nimport { watch as r, syncAndInitial as o, sync as p } from \"../../../core/reactiveUtils.js\";\nimport { property as d } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/Logger.js\";\nimport \"../../../core/RandomLCG.js\";\nimport { subclass as c } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { project as h, initializeProjection as l } from \"../../../geometry/projection.js\";\nimport { absoluteHeightElevationInfo as u } from \"../../../support/elevationInfoUtils.js\";\nimport { fromPoint as f, markAsTarget as g, toElevationAlignedDehydratedPoint as _ } from \"../sketch/normalizedPoint.js\";\nimport { defaults as S } from \"./Settings.js\";\nimport { SnappingDomain as m } from \"./SnappingDomain.js\";\nimport v from \"./SnappingOptions.js\";\nimport { sortCandidatesInPlace as y, squaredScreenDistance as C } from \"./snappingUtils.js\";\nimport { DrapedEdgeSnappingCandidate as w } from \"./candidates/DrapedEdgeSnappingCandidate.js\";\nimport { EdgeSnappingCandidate as E } from \"./candidates/EdgeSnappingCandidate.js\";\nimport { IntersectionSnappingCandidate as P } from \"./candidates/IntersectionSnappingCandidate.js\";\nimport { LineSnappingCandidate as T } from \"./candidates/LineSnappingCandidate.js\";\nimport { ParallelLineSnappingCandidate as j } from \"./candidates/ParallelLineSnappingCandidate.js\";\nimport { RightAngleSnappingCandidate as M, SelfSnappingRightAngleType as R } from \"./candidates/RightAngleSnappingCandidate.js\";\nimport { RightAngleTriangleSnappingCandidate as q } from \"./candidates/RightAngleTriangleSnappingCandidate.js\";\nimport { vectorToScreenPoint as A } from \"../support/viewUtils.js\";\nlet I = class extends i.EventedMixin(t) {\n  constructor(e) {\n    super(e), this.options = new v(), this._engineCache = new Map(), this._loadTask = null, this._engines = [], this._currentMainCandidate = null, this._currentOtherActiveCandidates = [], this._currentSnappedType = x.MAIN;\n  }\n  initialize() {\n    this.addHandles([r(() => {\n      const {\n        distance: e,\n        touchSensitivityMultiplier: t,\n        effectiveSelfEnabled: n,\n        effectiveFeatureEnabled: i,\n        effectiveGridEnabled: s\n      } = this.options;\n      return {\n        selfEnabled: n,\n        featureEnabled: i,\n        gridEnabled: \"2d\" === this.view.type && s,\n        viewReady: this.view.ready,\n        viewSpatialReference: this.view.spatialReference,\n        distance: e,\n        touchSensitivityMultiplier: t\n      };\n    }, (e, t) => {\n      t && (this.doneSnapping(), this.emit(\"changed\")), this._loadTask?.abort(), this._loadTask = n(n => this._updateEngines(e, t, n));\n    }, o), r(() => this.options, e => {\n      for (const t of this._engines) t.options = e;\n    }, p)]);\n  }\n  destroy() {\n    this._loadTask?.abort(), this._destroyEngines();\n  }\n  get updating() {\n    return this._engines.some(e => e.updating) || !this._loadTask?.finished;\n  }\n  _destroyEngines() {\n    this._engineCache.forEach(e => e.destroy()), this._engineCache.clear(), this._engines = [];\n  }\n  async _updateEngines(e, t, n) {\n    if (!e.viewReady) return void this._destroyEngines();\n    t?.viewSpatialReference !== e.viewSpatialReference && this._destroyEngines();\n    const i = this._engineCache,\n      s = await Promise.allSettled([e.featureEnabled && !i.has(\"feature\") ? this._createFeatureSnappingEngine(n) : void 0, e.selfEnabled && !i.has(\"self\") ? this._createSelfSnappingEngine(n) : void 0, e.gridEnabled && !i.has(\"grid\") ? this._createGridSnappingEngine(n) : void 0]);\n    if (n.aborted) for (const a of s) \"fulfilled\" === a.status && a.value?.engine.destroy();else {\n      for (const e of s) \"fulfilled\" === e.status && e.value && i.set(e.value.type, e.value.engine);\n      this._engines = Array.from(i.values());\n    }\n  }\n  async _createSelfSnappingEngine(e) {\n    const {\n      SelfSnappingEngine: t\n    } = await import(\"./SelfSnappingEngine.js\");\n    return s(e), {\n      type: \"self\",\n      engine: new t({\n        view: this.view,\n        options: this.options\n      })\n    };\n  }\n  async _createGridSnappingEngine(e) {\n    const {\n      view: t\n    } = this;\n    if (\"2d\" !== t.type) return;\n    const {\n      GridSnappingEngine: n\n    } = await import(\"./GridSnappingEngine.js\");\n    return s(e), {\n      type: \"grid\",\n      engine: new n({\n        view: t,\n        options: this.options\n      })\n    };\n  }\n  async _createFeatureSnappingEngine(e) {\n    const {\n      FeatureSnappingEngine: t\n    } = await import(\"./FeatureSnappingEngine.js\");\n    s(e);\n    const {\n        view: n,\n        options: i\n      } = this,\n      {\n        spatialReference: a\n      } = n;\n    return {\n      type: \"feature\",\n      engine: new t({\n        view: n,\n        options: i,\n        spatialReference: a\n      })\n    };\n  }\n  get _squaredMouseProximityThreshold() {\n    return this.options.distance * this.options.distance;\n  }\n  get _squaredTouchProximityThreshold() {\n    const {\n        distance: e,\n        touchSensitivityMultiplier: t\n      } = this.options,\n      n = e * t;\n    return n * n;\n  }\n  snap(e) {\n    return H(e) ? this._snapMultiPoint(e) : this._snapSinglePoint(e);\n  }\n  update(e) {\n    const {\n      point: t,\n      context: n\n    } = e;\n    this._removeVisualization();\n    const i = this._currentMainCandidate;\n    if (null == i) return t;\n    const s = this._selectUpdateInput(e);\n    if (null == s) return t;\n    const {\n        spatialReference: a\n      } = n,\n      r = h(s, a);\n    if (null == r) return t;\n    const {\n        view: o\n      } = this,\n      {\n        elevationInfo: p,\n        visualizer: d\n      } = n,\n      c = [],\n      l = f(r, o, p),\n      u = i.constraint.closestTo(l);\n    if (!this._arePointsWithinScreenThreshold(l, u, n) || !N(i, n.drawConstraints)) return this._resetSnappingState(), t;\n    i.targetPoint = g(u), c.push(...i.hints);\n    for (const h of this._currentOtherActiveCandidates) N(h, n.drawConstraints) && (h.targetPoint = g(u), c.push(...h.hints));\n    return null != d && this.addHandles(d.draw(c, {\n      spatialReference: a,\n      elevationInfo: L(n),\n      view: o,\n      selfSnappingZ: n.selfSnappingZ\n    }), b), _(u, o, t, n);\n  }\n  doneSnapping() {\n    this._removeVisualization(), this._resetSnappingState();\n  }\n  _selectUpdateInput({\n    point: e,\n    scenePoint: t\n  }) {\n    switch (this._currentSnappedType) {\n      case x.MAIN:\n        return e;\n      case x.SCENE:\n        return t;\n    }\n  }\n  _resetSnappingState() {\n    this._currentMainCandidate = null, this._currentOtherActiveCandidates = [], this._currentSnappedType = x.MAIN;\n  }\n  _removeVisualization() {\n    this.removeHandles(b);\n  }\n  async _snapSinglePoint({\n    point: e,\n    context: t,\n    signal: n\n  }) {\n    const {\n        view: i\n      } = this,\n      {\n        elevationInfo: s\n      } = t,\n      a = f(e, i, s),\n      r = await this._fetchCandidates(a, m.ALL, t, n);\n    return this._createSnapResult(a, x.MAIN, r, i, e, t, n);\n  }\n  async _snapMultiPoint({\n    point: e,\n    scenePoint: t,\n    context: n,\n    signal: i\n  }) {\n    const {\n        view: s\n      } = this,\n      {\n        coordinateHelper: a,\n        elevationInfo: r,\n        spatialReference: o\n      } = n;\n    await l(t.spatialReference, o);\n    const p = h(t, o),\n      d = f(p, s, r),\n      c = await this._fetchCandidates(d, m.FEATURE, n, i);\n    if (c.length > 0) {\n      const e = await this._fetchCandidates(d, m.SELF, n, i);\n      return this._createSnapResult(d, x.SCENE, [...c, ...e], s, p, n, i);\n    }\n    const u = f(e, s, r),\n      g = await this._fetchCandidates(u, m.SELF, n, i);\n    return this._createSnapResult(u, x.MAIN, g, s, {\n      z: a.hasZ() && e.hasZ ? e.z ?? 0 : void 0,\n      m: a.hasM() && e.hasM ? e.m ?? 0 : void 0\n    }, n, i);\n  }\n  async _fetchCandidates(e, t, n, i) {\n    return (await Promise.all(this._engines.map(s => s.fetchCandidates(e, t, n, i)))).flat();\n  }\n  _createSnapResult(e, t, n, i, s, r, o) {\n    return {\n      get valid() {\n        return !a(o);\n      },\n      apply: () => {\n        const {\n            spatialReference: a\n          } = r,\n          {\n            snappedPoint: o,\n            hints: p\n          } = this._processCandidates(e, t, n, r);\n        return this._removeVisualization(), null != r.visualizer && this.addHandles(r.visualizer.draw(p, {\n          spatialReference: a,\n          elevationInfo: u,\n          view: i,\n          selfSnappingZ: r.selfSnappingZ\n        }), b), _(o, i, s, r);\n      }\n    };\n  }\n  _processCandidates(e, t, n, i) {\n    if (n.length < 1) return this.doneSnapping(), {\n      snappedPoint: e,\n      hints: []\n    };\n    this._currentSnappedType !== t && this._resetSnappingState(), y(e, n);\n    const s = this._currentMainCandidate;\n    if (null != s) {\n      const a = O(s, n);\n      if (a >= 0) {\n        if (!(n[a] instanceof P)) return this._intersectWithOtherCandidates(a, n, e, t, i);\n        if (this._arePointsWithinScreenThreshold(e, s.targetPoint, i)) return this._updateSnappingCandidate(s, t, n, i);\n      }\n    }\n    return this._intersectWithOtherCandidates(0, n, e, t, i);\n  }\n  _intersectWithOtherCandidates(e, t, n, i, s) {\n    const {\n        coordinateHelper: a\n      } = s,\n      r = t[e],\n      o = [];\n    for (let p = 0; p < t.length; ++p) {\n      if (p === e) continue;\n      const i = t[p],\n        s = r.constraint.intersect(i.constraint);\n      if (s) for (const e of s.closestPoints(r.targetPoint)) o.push([new P(g(e), r, i, i.isDraped), this._squaredScreenDistance(n, e, a)]);\n    }\n    return o.length > 0 && (o.sort((e, t) => e[1] - t[1]), o[0][1] < this._squaredPointProximityThreshold(s.pointer)) ? this._updateSnappingCandidate(o[0][0], i, t, s) : N(r, s.drawConstraints) ? this._updateSnappingCandidate(r, i, t, s) : {\n      snappedPoint: n,\n      hints: []\n    };\n  }\n  _updateSnappingCandidate(e, t, n, i) {\n    this.doneSnapping(), this._currentMainCandidate = e, this._currentSnappedType = t;\n    const s = this._currentMainCandidate.targetPoint,\n      a = [];\n    a.push(...e.hints);\n    for (const r of n) {\n      if (e instanceof P) {\n        if (r.constraint.equals(e.first.constraint) || r.constraint.equals(e.second.constraint)) continue;\n      } else if (r.constraint.equals(e.constraint)) continue;\n      const t = r.constraint.closestTo(s);\n      this._squaredScreenDistance(t, s, i.coordinateHelper) < z() && (r.targetPoint = s, this._currentOtherActiveCandidates.push(r), a.push(...r.hints));\n    }\n    return {\n      snappedPoint: s,\n      hints: a\n    };\n  }\n  _squaredPointProximityThreshold(e) {\n    return \"touch\" === e ? this._squaredTouchProximityThreshold : this._squaredMouseProximityThreshold;\n  }\n  _arePointsWithinScreenThreshold(e, t, n) {\n    return this._squaredScreenDistance(e, t, n.coordinateHelper) < this._squaredPointProximityThreshold(n.pointer);\n  }\n  _squaredScreenDistance(e, t, n) {\n    return C(this._toScreen(e, n), this._toScreen(t, n));\n  }\n  _toScreen(e, t) {\n    return A(e, t.spatialReference, u, this.view);\n  }\n  get test() {}\n};\nvar x;\ne([d({\n  constructOnly: !0\n})], I.prototype, \"view\", void 0), e([d()], I.prototype, \"options\", void 0), e([d({\n  readOnly: !0\n})], I.prototype, \"updating\", null), e([d()], I.prototype, \"_loadTask\", void 0), e([d()], I.prototype, \"_engines\", void 0), e([d()], I.prototype, \"_squaredMouseProximityThreshold\", null), e([d()], I.prototype, \"_squaredTouchProximityThreshold\", null), I = e([c(\"esri.views.interactive.snapping.SnappingManager\")], I), function (e) {\n  e[e.MAIN = 0] = \"MAIN\", e[e.SCENE = 1] = \"SCENE\";\n}(x || (x = {}));\nconst b = \"visualization-handle\";\nfunction z() {\n  return S.satisfiesConstraintScreenThreshold * S.satisfiesConstraintScreenThreshold;\n}\nfunction N(e, t) {\n  return !t || null == t.direction && null == t.distance || !(e instanceof w || e instanceof E || e instanceof T || e instanceof j || e instanceof q) && (!(e instanceof M) || null == t.direction && e.selfSnappingType === R.LastVertex);\n}\nfunction O(e, t) {\n  return e instanceof P ? k(t, e.first) >= 0 && k(t, e.second) >= 0 ? 0 : -1 : k(t, e);\n}\nfunction k(e, t) {\n  let n = -1;\n  for (let i = 0; i < e.length; ++i) if (t.constraint.equals(e[i].constraint)) {\n    n = i;\n    break;\n  }\n  return n;\n}\nfunction H(e) {\n  return null != e.scenePoint;\n}\nfunction L({\n  coordinateHelper: e,\n  elevationInfo: t\n}) {\n  return e.hasZ() ? u : t;\n}\nexport { I as SnappingManager };","map":{"version":3,"names":["_","e","t","createTask","n","i","throwIfAborted","s","isAborted","a","watch","r","syncAndInitial","o","sync","p","property","d","subclass","c","project","h","initializeProjection","l","absoluteHeightElevationInfo","u","fromPoint","f","markAsTarget","g","toElevationAlignedDehydratedPoint","defaults","S","SnappingDomain","m","v","sortCandidatesInPlace","y","squaredScreenDistance","C","DrapedEdgeSnappingCandidate","w","EdgeSnappingCandidate","E","IntersectionSnappingCandidate","P","LineSnappingCandidate","T","ParallelLineSnappingCandidate","j","RightAngleSnappingCandidate","M","SelfSnappingRightAngleType","R","RightAngleTriangleSnappingCandidate","q","vectorToScreenPoint","A","I","EventedMixin","constructor","options","_engineCache","Map","_loadTask","_engines","_currentMainCandidate","_currentOtherActiveCandidates","_currentSnappedType","x","MAIN","initialize","addHandles","distance","touchSensitivityMultiplier","effectiveSelfEnabled","effectiveFeatureEnabled","effectiveGridEnabled","selfEnabled","featureEnabled","gridEnabled","view","type","viewReady","ready","viewSpatialReference","spatialReference","doneSnapping","emit","abort","_updateEngines","destroy","_destroyEngines","updating","some","finished","forEach","clear","Promise","allSettled","has","_createFeatureSnappingEngine","_createSelfSnappingEngine","_createGridSnappingEngine","aborted","status","value","engine","set","Array","from","values","SelfSnappingEngine","GridSnappingEngine","FeatureSnappingEngine","_squaredMouseProximityThreshold","_squaredTouchProximityThreshold","snap","H","_snapMultiPoint","_snapSinglePoint","update","point","context","_removeVisualization","_selectUpdateInput","elevationInfo","visualizer","constraint","closestTo","_arePointsWithinScreenThreshold","N","drawConstraints","_resetSnappingState","targetPoint","push","hints","draw","L","selfSnappingZ","b","scenePoint","SCENE","removeHandles","signal","_fetchCandidates","ALL","_createSnapResult","coordinateHelper","FEATURE","length","SELF","z","hasZ","hasM","all","map","fetchCandidates","flat","valid","apply","snappedPoint","_processCandidates","O","_intersectWithOtherCandidates","_updateSnappingCandidate","intersect","closestPoints","isDraped","_squaredScreenDistance","sort","_squaredPointProximityThreshold","pointer","equals","first","second","_toScreen","test","constructOnly","prototype","readOnly","satisfiesConstraintScreenThreshold","direction","selfSnappingType","LastVertex","k","SnappingManager"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/interactive/snapping/SnappingManager.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Accessor.js\";import{createTask as n}from\"../../../core/asyncUtils.js\";import i from\"../../../core/Evented.js\";import\"../../../core/has.js\";import{throwIfAborted as s,isAborted as a}from\"../../../core/promiseUtils.js\";import{watch as r,syncAndInitial as o,sync as p}from\"../../../core/reactiveUtils.js\";import{property as d}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{subclass as c}from\"../../../core/accessorSupport/decorators/subclass.js\";import{project as h,initializeProjection as l}from\"../../../geometry/projection.js\";import{absoluteHeightElevationInfo as u}from\"../../../support/elevationInfoUtils.js\";import{fromPoint as f,markAsTarget as g,toElevationAlignedDehydratedPoint as _}from\"../sketch/normalizedPoint.js\";import{defaults as S}from\"./Settings.js\";import{SnappingDomain as m}from\"./SnappingDomain.js\";import v from\"./SnappingOptions.js\";import{sortCandidatesInPlace as y,squaredScreenDistance as C}from\"./snappingUtils.js\";import{DrapedEdgeSnappingCandidate as w}from\"./candidates/DrapedEdgeSnappingCandidate.js\";import{EdgeSnappingCandidate as E}from\"./candidates/EdgeSnappingCandidate.js\";import{IntersectionSnappingCandidate as P}from\"./candidates/IntersectionSnappingCandidate.js\";import{LineSnappingCandidate as T}from\"./candidates/LineSnappingCandidate.js\";import{ParallelLineSnappingCandidate as j}from\"./candidates/ParallelLineSnappingCandidate.js\";import{RightAngleSnappingCandidate as M,SelfSnappingRightAngleType as R}from\"./candidates/RightAngleSnappingCandidate.js\";import{RightAngleTriangleSnappingCandidate as q}from\"./candidates/RightAngleTriangleSnappingCandidate.js\";import{vectorToScreenPoint as A}from\"../support/viewUtils.js\";let I=class extends(i.EventedMixin(t)){constructor(e){super(e),this.options=new v,this._engineCache=new Map,this._loadTask=null,this._engines=[],this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=x.MAIN}initialize(){this.addHandles([r((()=>{const{distance:e,touchSensitivityMultiplier:t,effectiveSelfEnabled:n,effectiveFeatureEnabled:i,effectiveGridEnabled:s}=this.options;return{selfEnabled:n,featureEnabled:i,gridEnabled:\"2d\"===this.view.type&&s,viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,distance:e,touchSensitivityMultiplier:t}}),((e,t)=>{t&&(this.doneSnapping(),this.emit(\"changed\")),this._loadTask?.abort(),this._loadTask=n((n=>this._updateEngines(e,t,n)))}),o),r((()=>this.options),(e=>{for(const t of this._engines)t.options=e}),p)])}destroy(){this._loadTask?.abort(),this._destroyEngines()}get updating(){return this._engines.some((e=>e.updating))||!this._loadTask?.finished}_destroyEngines(){this._engineCache.forEach((e=>e.destroy())),this._engineCache.clear(),this._engines=[]}async _updateEngines(e,t,n){if(!e.viewReady)return void this._destroyEngines();t?.viewSpatialReference!==e.viewSpatialReference&&this._destroyEngines();const i=this._engineCache,s=await Promise.allSettled([e.featureEnabled&&!i.has(\"feature\")?this._createFeatureSnappingEngine(n):void 0,e.selfEnabled&&!i.has(\"self\")?this._createSelfSnappingEngine(n):void 0,e.gridEnabled&&!i.has(\"grid\")?this._createGridSnappingEngine(n):void 0]);if(n.aborted)for(const a of s)\"fulfilled\"===a.status&&a.value?.engine.destroy();else{for(const e of s)\"fulfilled\"===e.status&&e.value&&i.set(e.value.type,e.value.engine);this._engines=Array.from(i.values())}}async _createSelfSnappingEngine(e){const{SelfSnappingEngine:t}=await import(\"./SelfSnappingEngine.js\");return s(e),{type:\"self\",engine:new t({view:this.view,options:this.options})}}async _createGridSnappingEngine(e){const{view:t}=this;if(\"2d\"!==t.type)return;const{GridSnappingEngine:n}=await import(\"./GridSnappingEngine.js\");return s(e),{type:\"grid\",engine:new n({view:t,options:this.options})}}async _createFeatureSnappingEngine(e){const{FeatureSnappingEngine:t}=await import(\"./FeatureSnappingEngine.js\");s(e);const{view:n,options:i}=this,{spatialReference:a}=n;return{type:\"feature\",engine:new t({view:n,options:i,spatialReference:a})}}get _squaredMouseProximityThreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:t}=this.options,n=e*t;return n*n}snap(e){return H(e)?this._snapMultiPoint(e):this._snapSinglePoint(e)}update(e){const{point:t,context:n}=e;this._removeVisualization();const i=this._currentMainCandidate;if(null==i)return t;const s=this._selectUpdateInput(e);if(null==s)return t;const{spatialReference:a}=n,r=h(s,a);if(null==r)return t;const{view:o}=this,{elevationInfo:p,visualizer:d}=n,c=[],l=f(r,o,p),u=i.constraint.closestTo(l);if(!this._arePointsWithinScreenThreshold(l,u,n)||!N(i,n.drawConstraints))return this._resetSnappingState(),t;i.targetPoint=g(u),c.push(...i.hints);for(const h of this._currentOtherActiveCandidates)N(h,n.drawConstraints)&&(h.targetPoint=g(u),c.push(...h.hints));return null!=d&&this.addHandles(d.draw(c,{spatialReference:a,elevationInfo:L(n),view:o,selfSnappingZ:n.selfSnappingZ}),b),_(u,o,t,n)}doneSnapping(){this._removeVisualization(),this._resetSnappingState()}_selectUpdateInput({point:e,scenePoint:t}){switch(this._currentSnappedType){case x.MAIN:return e;case x.SCENE:return t}}_resetSnappingState(){this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=x.MAIN}_removeVisualization(){this.removeHandles(b)}async _snapSinglePoint({point:e,context:t,signal:n}){const{view:i}=this,{elevationInfo:s}=t,a=f(e,i,s),r=await this._fetchCandidates(a,m.ALL,t,n);return this._createSnapResult(a,x.MAIN,r,i,e,t,n)}async _snapMultiPoint({point:e,scenePoint:t,context:n,signal:i}){const{view:s}=this,{coordinateHelper:a,elevationInfo:r,spatialReference:o}=n;await l(t.spatialReference,o);const p=h(t,o),d=f(p,s,r),c=await this._fetchCandidates(d,m.FEATURE,n,i);if(c.length>0){const e=await this._fetchCandidates(d,m.SELF,n,i);return this._createSnapResult(d,x.SCENE,[...c,...e],s,p,n,i)}const u=f(e,s,r),g=await this._fetchCandidates(u,m.SELF,n,i);return this._createSnapResult(u,x.MAIN,g,s,{z:a.hasZ()&&e.hasZ?e.z??0:void 0,m:a.hasM()&&e.hasM?e.m??0:void 0},n,i)}async _fetchCandidates(e,t,n,i){return(await Promise.all(this._engines.map((s=>s.fetchCandidates(e,t,n,i))))).flat()}_createSnapResult(e,t,n,i,s,r,o){return{get valid(){return!a(o)},apply:()=>{const{spatialReference:a}=r,{snappedPoint:o,hints:p}=this._processCandidates(e,t,n,r);return this._removeVisualization(),null!=r.visualizer&&this.addHandles(r.visualizer.draw(p,{spatialReference:a,elevationInfo:u,view:i,selfSnappingZ:r.selfSnappingZ}),b),_(o,i,s,r)}}}_processCandidates(e,t,n,i){if(n.length<1)return this.doneSnapping(),{snappedPoint:e,hints:[]};this._currentSnappedType!==t&&this._resetSnappingState(),y(e,n);const s=this._currentMainCandidate;if(null!=s){const a=O(s,n);if(a>=0){if(!(n[a]instanceof P))return this._intersectWithOtherCandidates(a,n,e,t,i);if(this._arePointsWithinScreenThreshold(e,s.targetPoint,i))return this._updateSnappingCandidate(s,t,n,i)}}return this._intersectWithOtherCandidates(0,n,e,t,i)}_intersectWithOtherCandidates(e,t,n,i,s){const{coordinateHelper:a}=s,r=t[e],o=[];for(let p=0;p<t.length;++p){if(p===e)continue;const i=t[p],s=r.constraint.intersect(i.constraint);if(s)for(const e of s.closestPoints(r.targetPoint))o.push([new P(g(e),r,i,i.isDraped),this._squaredScreenDistance(n,e,a)])}return o.length>0&&(o.sort(((e,t)=>e[1]-t[1])),o[0][1]<this._squaredPointProximityThreshold(s.pointer))?this._updateSnappingCandidate(o[0][0],i,t,s):N(r,s.drawConstraints)?this._updateSnappingCandidate(r,i,t,s):{snappedPoint:n,hints:[]}}_updateSnappingCandidate(e,t,n,i){this.doneSnapping(),this._currentMainCandidate=e,this._currentSnappedType=t;const s=this._currentMainCandidate.targetPoint,a=[];a.push(...e.hints);for(const r of n){if(e instanceof P){if(r.constraint.equals(e.first.constraint)||r.constraint.equals(e.second.constraint))continue}else if(r.constraint.equals(e.constraint))continue;const t=r.constraint.closestTo(s);this._squaredScreenDistance(t,s,i.coordinateHelper)<z()&&(r.targetPoint=s,this._currentOtherActiveCandidates.push(r),a.push(...r.hints))}return{snappedPoint:s,hints:a}}_squaredPointProximityThreshold(e){return\"touch\"===e?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}_arePointsWithinScreenThreshold(e,t,n){return this._squaredScreenDistance(e,t,n.coordinateHelper)<this._squaredPointProximityThreshold(n.pointer)}_squaredScreenDistance(e,t,n){return C(this._toScreen(e,n),this._toScreen(t,n))}_toScreen(e,t){return A(e,t.spatialReference,u,this.view)}get test(){}};var x;e([d({constructOnly:!0})],I.prototype,\"view\",void 0),e([d()],I.prototype,\"options\",void 0),e([d({readOnly:!0})],I.prototype,\"updating\",null),e([d()],I.prototype,\"_loadTask\",void 0),e([d()],I.prototype,\"_engines\",void 0),e([d()],I.prototype,\"_squaredMouseProximityThreshold\",null),e([d()],I.prototype,\"_squaredTouchProximityThreshold\",null),I=e([c(\"esri.views.interactive.snapping.SnappingManager\")],I),function(e){e[e.MAIN=0]=\"MAIN\",e[e.SCENE=1]=\"SCENE\"}(x||(x={}));const b=\"visualization-handle\";function z(){return S.satisfiesConstraintScreenThreshold*S.satisfiesConstraintScreenThreshold}function N(e,t){return!t||null==t.direction&&null==t.distance||!(e instanceof w||e instanceof E||e instanceof T||e instanceof j||e instanceof q)&&(!(e instanceof M)||null==t.direction&&e.selfSnappingType===R.LastVertex)}function O(e,t){return e instanceof P?k(t,e.first)>=0&&k(t,e.second)>=0?0:-1:k(t,e)}function k(e,t){let n=-1;for(let i=0;i<e.length;++i)if(t.constraint.equals(e[i].constraint)){n=i;break}return n}function H(e){return null!=e.scenePoint}function L({coordinateHelper:e,elevationInfo:t}){return e.hasZ()?u:t}export{I as SnappingManager};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}