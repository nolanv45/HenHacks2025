{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport { normalFromMat4 as e } from \"../../../../../../core/libs/gl-matrix-2/math/mat3.js\";\nimport { create as r } from \"../../../../../../core/libs/gl-matrix-2/factories/mat3f64.js\";\nimport { IDENTITY as o } from \"../../../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";\nimport { i as a } from \"../../../../../../chunks/vec32.js\";\nimport { create as n } from \"../../../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";\nimport { ShaderOutput as i } from \"../ShaderOutput.js\";\nimport { DoublePrecision as t } from \"../util/DoublePrecision.glsl.js\";\nimport { addViewNormal as s } from \"../util/View.glsl.js\";\nimport { Float3BindUniform as l } from \"../../shaderModules/Float3BindUniform.js\";\nimport { glsl as m } from \"../../shaderModules/glsl.js\";\nimport { Matrix3PassUniform as c } from \"../../shaderModules/Matrix3PassUniform.js\";\nimport { Matrix4PassUniform as d } from \"../../shaderModules/Matrix4PassUniform.js\";\nimport { VertexAttribute as u } from \"../../../lib/VertexAttribute.js\";\nimport { encodeDoubleHi as v, encodeDoubleLo as g } from \"../../../../../webgl/doublePrecisionUtils.js\";\nimport { NoParameters as p } from \"../../../../../webgl/NoParameters.js\";\nclass x extends p {\n  constructor() {\n    super(...arguments), this.modelTransformation = null;\n  }\n}\nconst f = r();\nfunction M(r, n) {\n  const p = n.hasModelTransformation,\n    x = n.instancedDoublePrecision;\n  p && (r.vertex.uniforms.add(new d(\"model\", e => e.modelTransformation ?? o)), r.vertex.uniforms.add(new c(\"normalLocalOriginFromModel\", r => (e(f, r.modelTransformation ?? o), f)))), n.instanced && x && (r.attributes.add(u.INSTANCEMODELORIGINHI, \"vec3\"), r.attributes.add(u.INSTANCEMODELORIGINLO, \"vec3\"), r.attributes.add(u.INSTANCEMODEL, \"mat3\"), r.attributes.add(u.INSTANCEMODELNORMAL, \"mat3\"));\n  const M = r.vertex;\n  x && (M.include(t, n), M.uniforms.add(new l(\"viewOriginHi\", e => v(a(O, e.camera.viewInverseTransposeMatrix[3], e.camera.viewInverseTransposeMatrix[7], e.camera.viewInverseTransposeMatrix[11]), O)), new l(\"viewOriginLo\", e => g(a(O, e.camera.viewInverseTransposeMatrix[3], e.camera.viewInverseTransposeMatrix[7], e.camera.viewInverseTransposeMatrix[11]), O)))), M.code.add(m`\n    vec3 getVertexInLocalOriginSpace() {\n      return ${p ? x ? \"(model * vec4(instanceModel * localPosition().xyz, 1.0)).xyz\" : \"(model * localPosition()).xyz\" : x ? \"instanceModel * localPosition().xyz\" : \"localPosition().xyz\"};\n    }\n\n    vec3 subtractOrigin(vec3 _pos) {\n      ${x ? m`\n          // Negated inputs are intentionally the first two arguments. The other way around the obfuscation in dpAdd() stopped\n          // working for macOS 14+ and iOS 17+.\n          // Issue: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/56280\n          vec3 originDelta = dpAdd(-instanceModelOriginHi, -instanceModelOriginLo, viewOriginHi, viewOriginLo);\n          return _pos - originDelta;` : \"return vpos;\"}\n    }\n    `), M.code.add(m`\n    vec3 dpNormal(vec4 _normal) {\n      return normalize(${p ? x ? \"normalLocalOriginFromModel * (instanceModelNormal * _normal.xyz)\" : \"normalLocalOriginFromModel * _normal.xyz\" : x ? \"instanceModelNormal * _normal.xyz\" : \"_normal.xyz\"});\n    }\n    `), n.output === i.Normal && (s(M), M.code.add(m`\n    vec3 dpNormalView(vec4 _normal) {\n      return normalize((viewNormal * ${p ? x ? \"vec4(normalLocalOriginFromModel * (instanceModelNormal * _normal.xyz), 1.0)\" : \"vec4(normalLocalOriginFromModel * _normal.xyz, 1.0)\" : x ? \"vec4(instanceModelNormal * _normal.xyz, 1.0)\" : \"_normal\"}).xyz);\n    }\n    `)), n.hasVertexTangents && M.code.add(m`\n    vec4 dpTransformVertexTangent(vec4 _tangent) {\n      ${p ? x ? \"return vec4(normalLocalOriginFromModel * (instanceModelNormal * _tangent.xyz), _tangent.w);\" : \"return vec4(normalLocalOriginFromModel * _tangent.xyz, _tangent.w);\" : x ? \"return vec4(instanceModelNormal * _tangent.xyz, _tangent.w);\" : \"return _tangent;\"}\n    }`);\n}\nconst O = n();\nexport { x as InstancedDoublePassParameters, M as InstancedDoublePrecision };","map":{"version":3,"names":["normalFromMat4","e","create","r","IDENTITY","o","i","a","n","ShaderOutput","DoublePrecision","t","addViewNormal","s","Float3BindUniform","l","glsl","m","Matrix3PassUniform","c","Matrix4PassUniform","d","VertexAttribute","u","encodeDoubleHi","v","encodeDoubleLo","g","NoParameters","p","x","constructor","arguments","modelTransformation","f","M","hasModelTransformation","instancedDoublePrecision","vertex","uniforms","add","instanced","attributes","INSTANCEMODELORIGINHI","INSTANCEMODELORIGINLO","INSTANCEMODEL","INSTANCEMODELNORMAL","include","O","camera","viewInverseTransposeMatrix","code","output","Normal","hasVertexTangents","InstancedDoublePassParameters","InstancedDoublePrecision"],"sources":["C:/Users/nolan/tasks/HenHacks2025/henhack25/node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/InstancedDoublePrecision.glsl.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{normalFromMat4 as e}from\"../../../../../../core/libs/gl-matrix-2/math/mat3.js\";import{create as r}from\"../../../../../../core/libs/gl-matrix-2/factories/mat3f64.js\";import{IDENTITY as o}from\"../../../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{i as a}from\"../../../../../../chunks/vec32.js\";import{create as n}from\"../../../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{ShaderOutput as i}from\"../ShaderOutput.js\";import{DoublePrecision as t}from\"../util/DoublePrecision.glsl.js\";import{addViewNormal as s}from\"../util/View.glsl.js\";import{Float3BindUniform as l}from\"../../shaderModules/Float3BindUniform.js\";import{glsl as m}from\"../../shaderModules/glsl.js\";import{Matrix3PassUniform as c}from\"../../shaderModules/Matrix3PassUniform.js\";import{Matrix4PassUniform as d}from\"../../shaderModules/Matrix4PassUniform.js\";import{VertexAttribute as u}from\"../../../lib/VertexAttribute.js\";import{encodeDoubleHi as v,encodeDoubleLo as g}from\"../../../../../webgl/doublePrecisionUtils.js\";import{NoParameters as p}from\"../../../../../webgl/NoParameters.js\";class x extends p{constructor(){super(...arguments),this.modelTransformation=null}}const f=r();function M(r,n){const p=n.hasModelTransformation,x=n.instancedDoublePrecision;p&&(r.vertex.uniforms.add(new d(\"model\",(e=>e.modelTransformation??o))),r.vertex.uniforms.add(new c(\"normalLocalOriginFromModel\",(r=>(e(f,r.modelTransformation??o),f))))),n.instanced&&x&&(r.attributes.add(u.INSTANCEMODELORIGINHI,\"vec3\"),r.attributes.add(u.INSTANCEMODELORIGINLO,\"vec3\"),r.attributes.add(u.INSTANCEMODEL,\"mat3\"),r.attributes.add(u.INSTANCEMODELNORMAL,\"mat3\"));const M=r.vertex;x&&(M.include(t,n),M.uniforms.add(new l(\"viewOriginHi\",(e=>v(a(O,e.camera.viewInverseTransposeMatrix[3],e.camera.viewInverseTransposeMatrix[7],e.camera.viewInverseTransposeMatrix[11]),O))),new l(\"viewOriginLo\",(e=>g(a(O,e.camera.viewInverseTransposeMatrix[3],e.camera.viewInverseTransposeMatrix[7],e.camera.viewInverseTransposeMatrix[11]),O))))),M.code.add(m`\n    vec3 getVertexInLocalOriginSpace() {\n      return ${p?x?\"(model * vec4(instanceModel * localPosition().xyz, 1.0)).xyz\":\"(model * localPosition()).xyz\":x?\"instanceModel * localPosition().xyz\":\"localPosition().xyz\"};\n    }\n\n    vec3 subtractOrigin(vec3 _pos) {\n      ${x?m`\n          // Negated inputs are intentionally the first two arguments. The other way around the obfuscation in dpAdd() stopped\n          // working for macOS 14+ and iOS 17+.\n          // Issue: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/56280\n          vec3 originDelta = dpAdd(-instanceModelOriginHi, -instanceModelOriginLo, viewOriginHi, viewOriginLo);\n          return _pos - originDelta;`:\"return vpos;\"}\n    }\n    `),M.code.add(m`\n    vec3 dpNormal(vec4 _normal) {\n      return normalize(${p?x?\"normalLocalOriginFromModel * (instanceModelNormal * _normal.xyz)\":\"normalLocalOriginFromModel * _normal.xyz\":x?\"instanceModelNormal * _normal.xyz\":\"_normal.xyz\"});\n    }\n    `),n.output===i.Normal&&(s(M),M.code.add(m`\n    vec3 dpNormalView(vec4 _normal) {\n      return normalize((viewNormal * ${p?x?\"vec4(normalLocalOriginFromModel * (instanceModelNormal * _normal.xyz), 1.0)\":\"vec4(normalLocalOriginFromModel * _normal.xyz, 1.0)\":x?\"vec4(instanceModelNormal * _normal.xyz, 1.0)\":\"_normal\"}).xyz);\n    }\n    `)),n.hasVertexTangents&&M.code.add(m`\n    vec4 dpTransformVertexTangent(vec4 _tangent) {\n      ${p?x?\"return vec4(normalLocalOriginFromModel * (instanceModelNormal * _tangent.xyz), _tangent.w);\":\"return vec4(normalLocalOriginFromModel * _tangent.xyz, _tangent.w);\":x?\"return vec4(instanceModelNormal * _tangent.xyz, _tangent.w);\":\"return _tangent;\"}\n    }`)}const O=n();export{x as InstancedDoublePassParameters,M as InstancedDoublePrecision};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}