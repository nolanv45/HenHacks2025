{"version":3,"file":"static/js/5039.75361dfd.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/rest/query/operations/query.js","../node_modules/@arcgis/core/layers/support/StreamConnection.js","../node_modules/@arcgis/core/layers/graphics/sources/connections/WebSocketConnection.js","../node_modules/@arcgis/core/layers/graphics/sources/connections/GeoEventConnection.js","../node_modules/@arcgis/core/layers/support/ClientSideConnection.js","../node_modules/@arcgis/core/layers/graphics/sources/connections/createConnection.js","../node_modules/@arcgis/core/rest/operations/urlUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport t from\"../../../request.js\";import{urlToObject as e,join as n}from\"../../../core/urlUtils.js\";import{getJsonType as r}from\"../../../geometry/support/jsonUtils.js\";import{normalizeCentralMeridian as i}from\"../../../geometry/support/normalizeUtils.js\";import{srToRESTValue as a}from\"../../../geometry/support/spatialReferenceUtils.js\";import{mapParameters as o}from\"../../operations/urlUtils.js\";import{parsePBFFeatureQuery as u}from\"./pbfQueryUtils.js\";import{applyFeatureSetZUnitScaling as l}from\"./queryZScale.js\";const s=\"Layer does not support extent calculation.\";function m(t,e){if(e&&\"extent\"===t.type)return`${t.xmin},${t.ymin},${t.xmax},${t.ymax}`;if(e&&\"point\"===t.type)return`${t.x},${t.y}`;const n=t.toJSON();return delete n.spatialReference,JSON.stringify(n)}function y(t,e){const n=t.geometry,i=t.toJSON();delete i.compactGeometryEnabled,delete i.defaultSpatialReferenceEnabled;const o=i;let u,l,s;if(null!=n&&(l=n.spatialReference,s=a(l),o.geometryType=r(n),o.geometry=m(n,t.compactGeometryEnabled),o.inSR=s),i.groupByFieldsForStatistics&&(o.groupByFieldsForStatistics=i.groupByFieldsForStatistics.join(\",\")),i.objectIds&&(o.objectIds=i.objectIds.join(\",\")),i.orderByFields&&(o.orderByFields=i.orderByFields.join(\",\")),!i.outFields||!i.returnDistinctValues&&(e?.returnCountOnly||e?.returnExtentOnly||e?.returnIdsOnly)?delete o.outFields:i.outFields.includes(\"*\")?o.outFields=\"*\":o.outFields=i.outFields.join(\",\"),i.outSR?(o.outSR=a(i.outSR),u=t.outSpatialReference):n&&(i.returnGeometry||i.returnCentroid)&&(o.outSR=o.inSR,u=l),i.returnGeometry&&delete i.returnGeometry,i.outStatistics&&(o.outStatistics=JSON.stringify(i.outStatistics)),i.fullText&&(o.fullText=JSON.stringify(i.fullText)),i.pixelSize&&(o.pixelSize=JSON.stringify(i.pixelSize)),i.quantizationParameters&&(t.defaultSpatialReferenceEnabled&&null!=l&&null!=t.quantizationParameters?.extent&&l.equals(t.quantizationParameters.extent.spatialReference)&&delete i.quantizationParameters.extent.spatialReference,o.quantizationParameters=JSON.stringify(i.quantizationParameters)),i.parameterValues&&(o.parameterValues=JSON.stringify(i.parameterValues)),i.rangeValues&&(o.rangeValues=JSON.stringify(i.rangeValues)),i.dynamicDataSource&&(o.layer=JSON.stringify({source:i.dynamicDataSource}),delete i.dynamicDataSource),i.timeExtent){const t=i.timeExtent,{start:e,end:n}=t;null==e&&null==n||(o.time=e===n?e:`${e??\"null\"},${n??\"null\"}`),delete i.timeExtent}return t.defaultSpatialReferenceEnabled&&null!=l&&null!=u&&l.equals(u)&&(o.defaultSR=o.inSR,delete o.inSR,delete o.outSR),o}async function c(t,e,n,r){const i=null!=e.timeExtent&&e.timeExtent.isEmpty?{data:{features:[]}}:await E(t,e,\"json\",r);return l(e,n,i.data),i}async function f(t,e,n,r){if(null!=e.timeExtent&&e.timeExtent.isEmpty)return{data:n.createFeatureResult()};const i=await d(t,e,r),a=i;return a.data=u(i.data,n),a}function d(t,e,n){return E(t,e,\"pbf\",n)}function p(t,e,n){return null!=e.timeExtent&&e.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):E(t,e,\"json\",n,{returnIdsOnly:!0})}function S(t,e,n){return null!=e.timeExtent&&e.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):E(t,e,\"json\",n,{returnIdsOnly:!0,returnCountOnly:!0})}async function x(t,e,n){if(null!=e.timeExtent&&e.timeExtent.isEmpty)return{data:{count:0,extent:null}};const r=await E(t,e,\"json\",n,{returnExtentOnly:!0,returnCountOnly:!0}),i=r.data;if(i.hasOwnProperty(\"extent\"))return r;if(i.features)throw new Error(s);if(i.hasOwnProperty(\"count\"))throw new Error(s);return r}async function E(r,a,u,l={},s={}){const m=\"string\"==typeof r?e(r):r,c=a.geometry?[a.geometry]:[],f=await i(c,null,{signal:l.signal}),d=f?.[0];null!=d&&((a=a.clone()).geometry=d);const p=o({...m.query,f:u,...s,...y(a,s)});return t(n(m.path,g(a,s)?\"query3d\":\"query\"),{...l,responseType:\"pbf\"===u?\"array-buffer\":\"json\",query:{...p,...l.query}})}function g(t,e){return null!=t.formatOf3DObjects&&!(e.returnCountOnly||e.returnExtentOnly||e.returnIdsOnly)}export{m as encodeGeometry,c as executeQuery,S as executeQueryForCount,x as executeQueryForExtent,p as executeQueryForIds,f as executeQueryPBF,d as executeQueryPBFBuffer,y as queryToQueryStringParameters,E as runQuery};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Error.js\";import o from\"../../core/Evented.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";let c=class extends o.EventedAccessor{destroy(){this.emit(\"destroy\")}get connectionError(){return this.errorString?new e(\"stream-connection\",this.errorString):null}onFeature(r){this.emit(\"data-received\",r)}onMessage(r){this.emit(\"message-received\",r)}};r([t({readOnly:!0})],c.prototype,\"connectionError\",null),c=r([s(\"esri.layers.support.StreamConnection\")],c);const n=c;export{n as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Error.js\";import o from\"../../../../core/Logger.js\";import{after as s,createResolver as r}from\"../../../../core/promiseUtils.js\";import{addQueryParameters as n}from\"../../../../core/urlUtils.js\";import{property as i}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/RandomLCG.js\";import{subclass as c}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{getGeometryZScaler as a}from\"../../../../geometry/support/zscale.js\";import l from\"../../../support/StreamConnection.js\";var h;!function(e){e[e.CONNECTING=0]=\"CONNECTING\",e[e.OPEN=1]=\"OPEN\",e[e.CLOSING=2]=\"CLOSING\",e[e.CLOSED=3]=\"CLOSED\"}(h||(h={}));let d=class extends l{constructor(e){super({}),this._outstandingMessages=[],this.errorString=null;const{geometryType:t,spatialReference:o,sourceSpatialReference:s}=e;this._config=e,this._featureZScaler=a(t,s,o),this._open()}normalizeCtorArgs(){return{}}async _open(){await this._tryCreateWebSocket(),this.destroyed||await this._handshake()}destroy(){super.destroy(),null!=this._websocket&&(this._websocket.onopen=null,this._websocket.onclose=null,this._websocket.onerror=null,this._websocket.onmessage=null,this._websocket.close()),this._websocket=null}get connectionStatus(){if(null==this._websocket)return\"disconnected\";switch(this._websocket.readyState){case h.CONNECTING:case h.OPEN:return\"connected\";case h.CLOSING:case h.CLOSED:return\"disconnected\"}}sendMessageToSocket(e){null!=this._websocket?this._websocket.send(JSON.stringify(e)):this._outstandingMessages.push(e)}sendMessageToClient(e){this._onMessage(e)}updateCustomParameters(e){this._config.customParameters=e,null!=this._websocket&&this._websocket.close()}async _tryCreateWebSocket(e=this._config.source.path,r=1e3,i=0){try{if(this.destroyed)return;const t=n(e,this._config.customParameters??{});this._websocket=await this._createWebSocket(t),this.notifyChange(\"connectionStatus\")}catch(c){const n=r/1e3;return this._config.maxReconnectionAttempts&&i>=this._config.maxReconnectionAttempts?(o.getLogger(this).error(new t(\"websocket-connection\",\"Exceeded maxReconnectionAttempts attempts. No further attempts will be made\")),void this.destroy()):(o.getLogger(this).error(new t(\"websocket-connection\",`Failed to connect. Attempting to reconnect in ${n}s`,c)),await s(r),this._tryCreateWebSocket(e,Math.min(1.5*r,1e3*this._config.maxReconnectionInterval),i+1))}}_setWebSocketJSONParseHandler(e){e.onmessage=e=>{try{const t=JSON.parse(e.data);this._onMessage(t)}catch(s){return void o.getLogger(this).error(new t(\"websocket-connection\",\"Failed to parse message, invalid JSON\",{error:s}))}}}_createWebSocket(e){return new Promise(((t,o)=>{const s=new WebSocket(e);s.onopen=()=>{if(s.onopen=null,this.destroyed)return s.onclose=null,void s.close();s.onclose=e=>this._onClose(e),s.onerror=e=>this._onError(e),this._setWebSocketJSONParseHandler(s),t(s)},s.onclose=e=>{s.onopen=s.onclose=null,o(e)}}))}async _handshake(e=1e4){const s=this._websocket;if(null==s)return;const n=r(),i=s.onmessage,{filter:c,outFields:a,spatialReference:l}=this._config;return n.timeout(e),s.onmessage=e=>{let r=null;try{r=JSON.parse(e.data)}catch(h){}r&&\"object\"==typeof r||(o.getLogger(this).error(new t(\"websocket-connection\",\"Protocol violation. Handshake failed - malformed message\",e.data)),n.reject(),this.destroy()),r.spatialReference?.wkid!==l?.wkid&&(o.getLogger(this).error(new t(\"websocket-connection\",`Protocol violation. Handshake failed - expected wkid of ${l.wkid}`,e.data)),n.reject(),this.destroy()),\"json\"!==r.format&&(o.getLogger(this).error(new t(\"websocket-connection\",\"Protocol violation. Handshake failed - format is not set\",e.data)),n.reject(),this.destroy()),c&&r.filter!==c&&o.getLogger(this).error(new t(\"websocket-connection\",\"Tried to set filter, but server doesn't support it\")),a&&r.outFields!==a&&o.getLogger(this).error(new t(\"websocket-connection\",\"Tried to set outFields, but server doesn't support it\")),s.onmessage=i;for(const t of this._outstandingMessages)s.send(JSON.stringify(t));this._outstandingMessages=[],n.resolve()},s.send(JSON.stringify({filter:c,outFields:a,format:\"json\",spatialReference:{wkid:l.wkid}})),n.promise}_onMessage(e){if(this.onMessage(e),\"type\"in e)switch(e.type){case\"features\":case\"featureResult\":for(const t of e.features)null!=this._featureZScaler&&this._featureZScaler(t.geometry),this.onFeature(t)}}_onError(e){const t=\"Encountered an error over WebSocket connection\";this._set(\"errorString\",t),o.getLogger(this).error(\"websocket-connection\",t)}_onClose(e){this._websocket=null,this.notifyChange(\"connectionStatus\"),1e3!==e.code&&o.getLogger(this).error(\"websocket-connection\",`WebSocket closed unexpectedly with error code ${e.code}`),this.destroyed||this._open()}};e([i()],d.prototype,\"connectionStatus\",null),e([i()],d.prototype,\"errorString\",void 0),d=e([c(\"esri.layers.graphics.sources.connections.WebSocketConnection\")],d);export{d as WebSocketConnection};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../request.js\";import r from\"../../../../core/Error.js\";import i from\"../../../../core/Logger.js\";import{createResolver as o}from\"../../../../core/promiseUtils.js\";import{addQueryParameters as s}from\"../../../../core/urlUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/RandomLCG.js\";import{subclass as n}from\"../../../../core/accessorSupport/decorators/subclass.js\";import a from\"../../../../geometry/SpatialReference.js\";import{fromJSON as c}from\"../../../../geometry/support/jsonUtils.js\";import{WebSocketConnection as u}from\"./WebSocketConnection.js\";import{executeQuery as l}from\"../../../../rest/query/operations/query.js\";import f from\"../../../../rest/support/Query.js\";const h=1e4,d={maxQueryDepth:5,maxRecordCountFactor:3};let g=class extends u{constructor(e){super({...d,...e}),this._buddyServicesQuery=null,this._relatedFeatures=null}async _open(){const e=await this._fetchServiceDefinition(this._config.source);e.timeInfo.trackIdField||i.getLogger(this).warn(\"GeoEvent service was configured without a TrackIdField. This may result in certain functionality being disabled. The purgeOptions.maxObservations property will have no effect.\");const t=this._fetchWebSocketUrl(e.streamUrls,this._config.spatialReference);this._buddyServicesQuery||(this._buddyServicesQuery=this._queryBuddyServices()),await this._buddyServicesQuery,await this._tryCreateWebSocket(t);const{filter:r,outFields:o}=this._config;this.destroyed||this._setFilter(r,o)}_onMessage(e){if(\"attributes\"in e){let o;try{o=this._enrich(e),null!=this._featureZScaler&&this._featureZScaler(o.geometry)}catch(t){return void i.getLogger(this).error(new r(\"geoevent-connection\",\"Failed to parse message\",t))}this.onFeature(o)}else this.onMessage(e)}async _fetchServiceDefinition(e){const r={f:\"json\",...this._config.customParameters},i=t(e.path,{query:r,responseType:\"json\"}),o=(await i).data;return this._serviceDefinition=o,o}_fetchWebSocketUrl(e,t){const r=e[0],{urls:i,token:o}=r,n=this._inferWebSocketBaseUrl(i);return s(`${n}/subscribe`,{outSR:\"\"+t.wkid,token:o})}_inferWebSocketBaseUrl(e){if(1===e.length)return e[0];for(const t of e)if(t.includes(\"wss\"))return t;return i.getLogger(this).error(new r(\"geoevent-connection\",\"Unable to infer WebSocket url\",e)),null}async _setFilter(e,t){const s=this._websocket;if(null==s||null==e&&null==t)return;const n=JSON.stringify({filter:this._serializeFilter(e,t)});let a=!1;const c=o(),u=()=>{a||(this.destroyed||this._websocket!==s||i.getLogger(this).error(new r(\"geoevent-connection\",\"Server timed out when setting filter\")),c.reject())},l=e=>{const t=JSON.parse(e.data);t.filter&&(t.error&&(i.getLogger(this).error(new r(\"geoevent-connection\",\"Failed to set service filter\",t.error)),this._set(\"errorString\",`Could not set service filter - ${t.error}`),c.reject(t.error)),this._setWebSocketJSONParseHandler(s),a=!0,c.resolve())};return s.onmessage=l,s.send(n),setTimeout(u,h),c.promise}_serializeFilter(e,t){const o={};if(null==e&&null==t)return o;if(e?.geometry)try{const t=c(e.geometry);if(\"extent\"!==t.type)throw new r(`Expected extent but found type ${t.type}`);o.geometry=JSON.stringify(t.shiftCentralMeridian())}catch(s){i.getLogger(this).error(new r(\"geoevent-connection\",\"Encountered an error when setting connection geometryDefinition\",s))}return e?.where&&\"1 = 1\"!==e.where&&\"1=1\"!==e.where&&(o.where=e.where),null!=t&&(o.outFields=t.join(\",\")),o}_enrich(e){if(!this._relatedFeatures)return e;const t=this._serviceDefinition.relatedFeatures.joinField,o=e.attributes[t],s=this._relatedFeatures.get(o);if(!s)return i.getLogger(this).warn(\"geoevent-connection\",\"Feature join failed. Is the join field configured correctly?\",e),e;const{attributes:n,geometry:a}=s;for(const r in n)e.attributes[r]=n[r];return a&&(e.geometry=a),e.geometry||e.centroid||i.getLogger(this).error(new r(\"geoevent-connection\",\"Found malformed feature - no geometry found\",e)),e}async _queryBuddyServices(){try{const{relatedFeatures:e,keepLatestArchive:t}=this._serviceDefinition,r=this._queryRelatedFeatures(e),i=this._queryArchive(t);await r;const o=await i;if(!o)return;for(const s of o.features)this.onFeature(this._enrich(s))}catch(e){i.getLogger(this).error(new r(\"geoevent-connection\",\"Encountered an error when querying buddy services\",{error:e}))}}async _queryRelatedFeatures(e){if(!e)return;const t=await this._queryBuddy(e.featuresUrl);this._addRelatedFeatures(t)}async _queryArchive(e){if(e)return this._queryBuddy(e.featuresUrl)}async _queryBuddy(e){const t=new((await import(\"../../../FeatureLayer.js\")).default)({url:e}),{capabilities:r}=await t.load(),i=r.query.supportsMaxRecordCountFactor,o=r.query.supportsPagination,s=r.query.supportsCentroid,n=this._config.maxRecordCountFactor,c=t.capabilities.query.maxRecordCount,u=i?c*n:c,h=new f;if(h.outFields=this._config.outFields??[\"*\"],h.where=this._config.filter?.where??\"1=1\",h.returnGeometry=!0,h.returnExceededLimitFeatures=!0,h.outSpatialReference=a.fromJSON(this._config.spatialReference),s&&(h.returnCentroid=!0),i&&(h.maxRecordCountFactor=n),o)return h.num=u,t.destroy(),this._queryPages(e,h);const d=await l(e,h,this._config.sourceSpatialReference);return t.destroy(),d.data}async _queryPages(e,t,r=[],i=0){t.start=null!=t.num?i*t.num:null;const{data:o}=await l(e,t,this._config.sourceSpatialReference);return o.exceededTransferLimit&&i<(this._config.maxQueryDepth??0)?(o.features.forEach((e=>r.push(e))),this._queryPages(e,t,r,i+1)):(r.forEach((e=>o.features.push(e))),o)}_addRelatedFeatures(e){const t=new Map,r=e.features,i=this._serviceDefinition.relatedFeatures.joinField;for(const o of r){const e=o.attributes[i];t.set(e,o)}this._relatedFeatures=t}};g=e([n(\"esri.layers.graphics.sources.connections.GeoEventConnection\")],g);const y=g;export{y as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import{getGeometryZScaler as o}from\"../../geometry/support/zscale.js\";import s from\"./StreamConnection.js\";let a=class extends s{constructor(e){super({}),this.connectionStatus=\"connected\",this.errorString=null;const{geometryType:r,spatialReference:t,sourceSpatialReference:s}=e;this._featureZScaler=o(r,s,t)}normalizeCtorArgs(){return{}}updateCustomParameters(e){}sendMessageToSocket(e){}sendMessageToClient(e){if(\"type\"in e)switch(e.type){case\"features\":case\"featureResult\":for(const r of e.features)null!=this._featureZScaler&&this._featureZScaler(r.geometry),this.onFeature(r)}this.onMessage(e)}};e([r()],a.prototype,\"connectionStatus\",void 0),e([r()],a.prototype,\"errorString\",void 0),a=e([t(\"esri.layers.support.ClientSideConnection\")],a);export{a as ClientSideConnection};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from\"./GeoEventConnection.js\";import{WebSocketConnection as t}from\"./WebSocketConnection.js\";import{ClientSideConnection as n}from\"../../../support/ClientSideConnection.js\";function o(e,t){if(null==e&&null==t)return null;const n={};return null!=t&&(n.geometry=t),null!=e&&(n.where=e),n}function r(r,i,s,c,l,u,a,m,p){const f={source:r,sourceSpatialReference:i,spatialReference:s,geometryType:c,filter:o(l,u),maxReconnectionAttempts:a,maxReconnectionInterval:m,customParameters:p};if(!r)return new n(f);return r.path.startsWith(\"wss://\")||r.path.startsWith(\"ws://\")?new t(f):new e(f)}export{r as createConnection};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nfunction t(n){const o={};for(const e in n){if(\"declaredClass\"===e)continue;const r=n[e];if(null!=r&&\"function\"!=typeof r)if(Array.isArray(r)){o[e]=[];for(let n=0;n<r.length;n++)o[e][n]=t(r[n])}else\"object\"==typeof r?r.toJSON&&(o[e]=JSON.stringify(r)):o[e]=r}return o}export{t as mapParameters};\n"],"names":["s","y","t","e","n","geometry","i","toJSON","compactGeometryEnabled","defaultSpatialReferenceEnabled","o","u","l","spatialReference","a","geometryType","r","type","xmin","ymin","xmax","ymax","x","JSON","stringify","m","inSR","groupByFieldsForStatistics","join","objectIds","orderByFields","outFields","returnDistinctValues","returnCountOnly","returnExtentOnly","returnIdsOnly","includes","outSR","outSpatialReference","returnGeometry","returnCentroid","outStatistics","fullText","pixelSize","quantizationParameters","extent","equals","parameterValues","rangeValues","dynamicDataSource","layer","source","timeExtent","start","end","time","defaultSR","async","c","isEmpty","data","features","E","f","createFeatureResult","d","p","Promise","resolve","S","count","hasOwnProperty","Error","arguments","length","undefined","signal","clone","query","path","formatOf3DObjects","responseType","EventedAccessor","destroy","this","emit","connectionError","errorString","onFeature","onMessage","readOnly","prototype","h","CONNECTING","OPEN","CLOSING","CLOSED","constructor","super","_outstandingMessages","sourceSpatialReference","_config","_featureZScaler","_open","normalizeCtorArgs","_tryCreateWebSocket","destroyed","_handshake","_websocket","onopen","onclose","onerror","onmessage","close","connectionStatus","readyState","sendMessageToSocket","send","push","sendMessageToClient","_onMessage","updateCustomParameters","customParameters","_createWebSocket","notifyChange","maxReconnectionAttempts","getLogger","error","Math","min","maxReconnectionInterval","_setWebSocketJSONParseHandler","parse","WebSocket","_onClose","_onError","filter","timeout","reject","wkid","format","promise","_set","code","maxQueryDepth","maxRecordCountFactor","g","_buddyServicesQuery","_relatedFeatures","_fetchServiceDefinition","timeInfo","trackIdField","warn","_fetchWebSocketUrl","streamUrls","_queryBuddyServices","_setFilter","_enrich","_serviceDefinition","urls","token","_inferWebSocketBaseUrl","_serializeFilter","setTimeout","shiftCentralMeridian","where","relatedFeatures","joinField","attributes","get","centroid","keepLatestArchive","_queryRelatedFeatures","_queryArchive","_queryBuddy","featuresUrl","_addRelatedFeatures","default","url","capabilities","load","supportsMaxRecordCountFactor","supportsPagination","supportsCentroid","maxRecordCount","returnExceededLimitFeatures","fromJSON","num","_queryPages","exceededTransferLimit","forEach","Map","set","startsWith","Array","isArray"],"sourceRoot":""}